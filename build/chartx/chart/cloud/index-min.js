define("chartx/chart/cloud/index",["chartx/chart/index","chartx/layout/cloud/index","canvax/shape/Rect","chartx/utils/dataformat","chartx/components/tips/tip"],function(a,b,c,d,e){var f=a.Canvax;return a.extend({init:function(a,b,c){this.data=b,this.options=c,this.layoutData=[],this.layoutRange={},this.dataZoom={enabled:!1,range:{start:0,end:b.length-1}},this.padding.top=10,this.padding.bottom=5,c.dataZoom?(this.dataZoom.enabled=!0,this.padding.bottom+=46):this.padding.top=this.padding.bottom=this.padding.left=this.padding.right=0,this.fontFamily="Impact",_.deepExtend(this,c),this.dataFrame=this._initData(b,c)},draw:function(){var a=this;if(a.core=new f.Display.Sprite({id:"core"}),a.stageTip=new f.Display.Sprite({id:"tip"}),a.stage.addChild(a.core),a.stage.addChild(a.stageTip),a._graphs=new f.Display.Sprite({id:"graphs",context:{x:a.width/2,y:(a.height-a.padding.bottom)/2}}),a.core.addChild(a._graphs),a.dataZoom.enabled){a._initDataZoom();var b=a.options.dataZoom.range;a.layoutData=a.dataFrame.yAxis.org[0].slice(b.start,b.end+1)}else a.layoutData=a.dataFrame.yAxis.org[0];a._drawGraphs(),a._tip=new e(a.tips,a.canvax.getDomContainer()),a.stageTip.addChild(a._tip.sprite),a.inited=!0},replayGraphs:function(a){var b=this,c=a.start,d=a.end;(c!=b.layoutRange.start||d!=b.layoutRange.end)&&(b.layoutRange.start=c,b.layoutRange.end=d,b.layoutData=b.dataFrame.yAxis.org[0].slice(c,d+1),b._drawGraphs())},_initData:function(a,b){return d.apply(this,arguments)},_initDataZoom:function(){var a=this;require(["chartx/components/datazoom/index"],function(b){var c=a.width-a.padding.left-a.padding.right,d=a.padding.left,e=_.deepExtend({w:c,h:30,count:data.length-1,pos:{x:d,y:a.height-a.padding.bottom},dragIng:function(b){a.dataZoom.range.start=~~a._dataZoom.range.start,a.dataZoom.range.end=~~a._dataZoom.range.end,a._updateRange(a.dataZoom.range)},dragEnd:function(a){}},a.dataZoom);a._dataZoom=new b(e),a.core.addChild(a._dataZoom.sprite)})},_updateRange:function(a){this.replayGraphs(a)},_getInfoHandler:function(a){var b=this;return{iGroup:a.index,iNode:-1,iLay:-1,dataZoom:b.dataZoom,data:b.dataFrame.getRowData(a.index+b.dataZoom.range.start),nodesInfoList:[{field:b.dataFrame.yAxis.field[0],x:a.context.x,y:a.context.y,value:a.text,fontSize:a.context.fontSize,fillStyle:a.context.fillStyle}]}},_getColor:function(a,b){var c="#ffffff";return _.isString(a)?a:_.isFunction(a)?a(b):c},_drawGraphs:function(){function a(a,b){c.width,c.height;c._graphs&&c._graphs.removeAllChildren(),_.each(a,function(a,b){var d=new f.Display.Text(a.text,{context:{x:a.x,y:a.y,fontSize:a.size,fontFamily:a.font,rotation:a.rotate,textBaseline:"middle",textAlign:"center",cursor:"pointer",fontWeight:"bold",fillStyle:c._getColor(c.options.graphs&&c.options.graphs.text&&c.options.graphs.text.fillStyle&&c.options.graphs.text.fillStyle,{iGroup:a.index,value:a.text})}});d.index=a.index,d.on("mouseover",function(a){a.eventInfo=c._getInfoHandler(a.target),c._tip.show(a)}),d.on("mousemove",function(a){a.eventInfo=c._getInfoHandler(a.target),c._tip.move(a)}),d.on("mouseout",function(a){c._tip.hide(a)}),d.on("click",function(a){a.eventInfo=c._getInfoHandler(a.target),c.fire(a.type,a)}),c._graphs.addChild(d)})}var c=this,d=b().size([c.width-c.padding.left-c.padding.right,c.height-c.padding.bottom]).words(c.layoutData.map(function(a){return{text:a,size:12+50*Math.random()}})).padding(7).rotate(function(){return 30*(~~(6*Math.random())-3)}).font(c.fontFamily).fontSize(function(a){return a.size}).on("end",a);d.start()}})});