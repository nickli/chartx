define("chartx/chart/funnel/index",["chartx/chart/index","chartx/utils/tools","chartx/utils/datasection","./graphs","chartx/components/tips/tip","chartx/utils/simple-data-format"],function(a,b,c,d,e,f){var g=a.Canvax;return a.extend({min:0,max:100,gap:2,_graphs:null,_tip:null,init:function(a,b,c){_.deepExtend(this,c),this.dataFrame=this._initData(b,c)},_setStages:function(){this.core=new g.Display.Sprite({id:"core"}),this.stageBg=new g.Display.Sprite({id:"bg"}),this.stageTip=new g.Display.Sprite({id:"tip"}),this.stage.addChild(this.stageBg),this.stage.addChild(this.core),this.stage.addChild(this.stageTip)},draw:function(){this._setStages(),this._initModule(),this._startDraw(),this._drawEnd(),this.inited=!0},_initData:function(a,b){var c=f.apply(this,arguments);c.graphs;var d=[],e=c.data[b.xAxis.field],g=c.data[b.yAxis.field];return _.each(e,function(a,b){d.push({name:a,value:g[b]})}),c.org=_.sortBy(d,"value"),c},_initModule:function(){this._graphs=new d(this.graphs),this._tip=new e(this.tips,this.canvax.getDomContainer())},_startDraw:function(a){var b=this,c=a&&a.w||b.width,d=a&&a.h||b.height;b.graphsw=c,b.graphsH=d,b.dataFrame.data=b._trimGraphs().data,b._graphs.draw(b.dataFrame.data,{pos:{x:0,y:0}}),b._bindEvent()},_trimGraphs:function(){var a=this,b=[],c=_.clone(a.dataFrame.org),d=c.length,e=a.graphsw,f=a.graphsH,g=e/2,h=(f-a.gap*(d-1))/d;return _.each(c,function(c,i){var j={};c.polygon=j;var k=(c.value-a.min)/a.max*e,l=d-i,m=(h+a.gap)*(l-1),n=g-k/2,o=g+k/2,p=b[0];0==i?j.pointList=[[n,m],[o,m],[g,f]]:j.pointList=[[n,m],[o,m],[p.polygon.topRightX,m+h],[p.polygon.topLeftX,m+h]],j.topLeftX=n,j.topRightX=o,c.text={label:c.name,x:e/2,y:m+h/2},b.unshift(c)}),{data:b}},_drawEnd:function(){this.core.addChild(this._graphs.sprite),this.stageTip.addChild(this._tip.sprite)},_bindEvent:function(){var a=this;a._graphs.sprite.on("panstart mouseover",function(b){b.eventInfo&&(a._setXaxisYaxisToeventInfo(b),a._tip.show(b))}),a._graphs.sprite.on("panmove mousemove",function(b){b.eventInfo&&(a._setXaxisYaxisToeventInfo(b),a._tip.move(b))}),a._graphs.sprite.on("panend mouseout",function(b){b.eventInfo&&a._tip.hide(b)})},_setXaxisYaxisToeventInfo:function(a){var b=this,c=a.eventInfo.iNode,d=b.dataFrame.data[c];a.eventInfo.nodesInfoList=[{field:d.name,value:d.value}]}})});