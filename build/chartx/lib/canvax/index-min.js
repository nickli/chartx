define("canvax/animation/AnimationFrame",["canvax/animation/Tween","canvax/core/Base"],function(a,b){function c(){return l||(l=requestAnimationFrame(function(){a.update();var b=k;for(k=[],l=null;b.length>0;)b.shift().task()})),l}function d(a){return a?(k.push(a),c()):void 0}function e(a){for(var b=!1,c=0,d=k.length;d>c;c++)k[c].id===a.id&&(b=!0,k.splice(c,1),c--,d--);return 0==k.length&&(cancelAnimationFrame(l),l=null),b}function f(c){function f(){return h._isCompleteed||h._isStoped?void(h=null):void d({id:i,task:f,desc:g.desc,tween:h})}var g=_.extend({from:null,to:null,duration:500,onStart:function(){},onUpdate:function(){},onComplete:function(){},onStop:function(){},repeat:0,delay:0,easing:"Linear.None",desc:""},c),h={},i="tween_"+b.getUID();return g.id&&(i=i+"_"+g.id),g.from&&g.to&&(h=new a.Tween(g.from).to(g.to,g.duration).onStart(function(){g.onStart.apply(this)}).onUpdate(function(){g.onUpdate.apply(this)}).onComplete(function(){e({id:i}),h._isCompleteed=!0,g.onComplete.apply(this,[this])}).onStop(function(){e({id:i}),h._isStoped=!0,g.onStop.apply(this,[this])}).repeat(g.repeat).delay(g.delay).easing(a.Easing[g.easing.split(".")[0]][g.easing.split(".")[1]]),h.id=i,h.start(),f()),h}function g(a,b){a.stop()}window.Tween=a;for(var h=0,i=["ms","moz","webkit","o"],j=0;j<i.length&&!window.requestAnimationFrame;++j)window.requestAnimationFrame=window[i[j]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[j]+"CancelAnimationFrame"]||window[i[j]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a,b){var c=(new Date).getTime(),d=Math.max(0,16-(c-h)),e=window.setTimeout(function(){a(c+d)},d);return h=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});var k=[],l=null;return{registFrame:d,destroyFrame:e,registTween:f,destroyTween:g}}),define("canvax/animation/Tween",[],function(){var a=a||function(){var b=[];return{getAll:function(){return b},removeAll:function(){b=[]},add:function(a){b.push(a)},remove:function(a){var c=_.indexOf(b,a);-1!==c&&b.splice(c,1)},update:function(c,d){if(0===b.length)return!1;var e=0;for(c=void 0!==c?c:a.now();e<b.length;){var f=b[e],g=f.update(c);if(!b[e])break;f===b[e]&&(g||d?e++:b.splice(e,1))}return!0}}}();return"undefined"==typeof window&&"undefined"!=typeof process?a.now=function(){var a=process.hrtime();return 1e3*a[0]+a[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?a.now=window.performance.now.bind(window.performance):void 0!==Date.now?a.now=Date.now:a.now=function(){return(new Date).getTime()},a.Tween=function(b){var c,d=b,e={},f={},g={},h=1e3,i=0,j=!1,k=!1,l=!1,m=0,n=null,o=a.Easing.Linear.None,p=a.Interpolation.Linear,q=[],r=null,s=!1,t=null,u=null,v=null;this.to=function(a,b){return f=a,void 0!==b&&(h=b),this},this.start=function(b){a.add(this),k=!0,s=!1,n=void 0!==b?b:a.now(),n+=m;for(var c in f){if(f[c]instanceof Array){if(0===f[c].length)continue;f[c]=[d[c]].concat(f[c])}void 0!==d[c]&&(e[c]=d[c],e[c]instanceof Array==!1&&(e[c]*=1),g[c]=e[c]||0)}return this},this.stop=function(){return k?(a.remove(this),k=!1,null!==v&&v.call(d,d),this.stopChainedTweens(),this):this},this.end=function(){return this.update(n+h),this},this.stopChainedTweens=function(){for(var a=0,b=q.length;b>a;a++)q[a].stop()},this.delay=function(a){return m=a,this},this.repeat=function(a){return i=a,this},this.repeatDelay=function(a){return c=a,this},this.yoyo=function(a){return j=a,this},this.easing=function(a){return o=a,this},this.interpolation=function(a){return p=a,this},this.chain=function(){return q=arguments,this},this.onStart=function(a){return r=a,this},this.onUpdate=function(a){return t=a,this},this.onComplete=function(a){return u=a,this},this.onStop=function(a){return v=a,this},this.update=function(a){var b,k,v;if(n>a)return!0;s===!1&&(null!==r&&r.call(d,d),s=!0),k=(a-n)/h,k=k>1?1:k,v=o(k);for(b in f)if(void 0!==e[b]){var w=e[b]||0,x=f[b];x instanceof Array?d[b]=p(x,v):("string"==typeof x&&(x="+"===x.charAt(0)||"-"===x.charAt(0)?w+parseFloat(x):parseFloat(x)),"number"==typeof x&&(d[b]=w+(x-w)*v))}if(null!==t&&t.call(d,v),1===k){if(i>0){isFinite(i)&&i--;for(b in g){if("string"==typeof f[b]&&(g[b]=g[b]+parseFloat(f[b])),j){var y=g[b];g[b]=f[b],f[b]=y}e[b]=g[b]}return j&&(l=!l),n=void 0!==c?a+c:a+m,!0}null!==u&&u.call(d,d);for(var z=0,A=q.length;A>z;z++)q[z].start(n+h);return!1}return!0}},a.Easing={Linear:{None:function(a){return a}},Quadratic:{In:function(a){return a*a},Out:function(a){return a*(2-a)},InOut:function(a){return(a*=2)<1?.5*a*a:-.5*(--a*(a-2)-1)}},Cubic:{In:function(a){return a*a*a},Out:function(a){return--a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a:.5*((a-=2)*a*a+2)}},Quartic:{In:function(a){return a*a*a*a},Out:function(a){return 1- --a*a*a*a},InOut:function(a){return(a*=2)<1?.5*a*a*a*a:-.5*((a-=2)*a*a*a-2)}},Quintic:{In:function(a){return a*a*a*a*a},Out:function(a){return--a*a*a*a*a+1},InOut:function(a){return(a*=2)<1?.5*a*a*a*a*a:.5*((a-=2)*a*a*a*a+2)}},Sinusoidal:{In:function(a){return 1-Math.cos(a*Math.PI/2)},Out:function(a){return Math.sin(a*Math.PI/2)},InOut:function(a){return.5*(1-Math.cos(Math.PI*a))}},Exponential:{In:function(a){return 0===a?0:Math.pow(1024,a-1)},Out:function(a){return 1===a?1:1-Math.pow(2,-10*a)},InOut:function(a){return 0===a?0:1===a?1:(a*=2)<1?.5*Math.pow(1024,a-1):.5*(-Math.pow(2,-10*(a-1))+2)}},Circular:{In:function(a){return 1-Math.sqrt(1-a*a)},Out:function(a){return Math.sqrt(1- --a*a)},InOut:function(a){return(a*=2)<1?-.5*(Math.sqrt(1-a*a)-1):.5*(Math.sqrt(1-(a-=2)*a)+1)}},Elastic:{In:function(a){return 0===a?0:1===a?1:-Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)},Out:function(a){return 0===a?0:1===a?1:Math.pow(2,-10*a)*Math.sin(5*(a-.1)*Math.PI)+1},InOut:function(a){return 0===a?0:1===a?1:(a*=2,1>a?-.5*Math.pow(2,10*(a-1))*Math.sin(5*(a-1.1)*Math.PI):.5*Math.pow(2,-10*(a-1))*Math.sin(5*(a-1.1)*Math.PI)+1)}},Back:{In:function(a){var b=1.70158;return a*a*((b+1)*a-b)},Out:function(a){var b=1.70158;return--a*a*((b+1)*a+b)+1},InOut:function(a){var b=2.5949095;return(a*=2)<1?.5*a*a*((b+1)*a-b):.5*((a-=2)*a*((b+1)*a+b)+2)}},Bounce:{In:function(b){return 1-a.Easing.Bounce.Out(1-b)},Out:function(a){return 1/2.75>a?7.5625*a*a:2/2.75>a?7.5625*(a-=1.5/2.75)*a+.75:2.5/2.75>a?7.5625*(a-=2.25/2.75)*a+.9375:7.5625*(a-=2.625/2.75)*a+.984375},InOut:function(b){return.5>b?.5*a.Easing.Bounce.In(2*b):.5*a.Easing.Bounce.Out(2*b-1)+.5}}},a.Interpolation={Linear:function(b,c){var d=b.length-1,e=d*c,f=Math.floor(e),g=a.Interpolation.Utils.Linear;return 0>c?g(b[0],b[1],e):c>1?g(b[d],b[d-1],d-e):g(b[f],b[f+1>d?d:f+1],e-f)},Bezier:function(b,c){for(var d=0,e=b.length-1,f=Math.pow,g=a.Interpolation.Utils.Bernstein,h=0;e>=h;h++)d+=f(1-c,e-h)*f(c,h)*b[h]*g(e,h);return d},CatmullRom:function(b,c){var d=b.length-1,e=d*c,f=Math.floor(e),g=a.Interpolation.Utils.CatmullRom;return b[0]===b[d]?(0>c&&(f=Math.floor(e=d*(1+c))),g(b[(f-1+d)%d],b[f],b[(f+1)%d],b[(f+2)%d],e-f)):0>c?b[0]-(g(b[0],b[0],b[1],b[1],-e)-b[0]):c>1?b[d]-(g(b[d],b[d],b[d-1],b[d-1],e-d)-b[d]):g(b[f?f-1:0],b[f],b[f+1>d?d:f+1],b[f+2>d?d:f+2],e-f)},Utils:{Linear:function(a,b,c){return(b-a)*c+a},Bernstein:function(b,c){var d=a.Interpolation.Utils.Factorial;return d(b)/d(c)/d(b-c)},Factorial:function(){var a=[1];return function(b){var c=1;if(a[b])return a[b];for(var d=b;d>1;d--)c*=d;return a[b]=c,c}}(),CatmullRom:function(a,b,c,d,e){var f=.5*(c-a),g=.5*(d-b),h=e*e,i=e*h;return(2*b-2*c+f+g)*i+(-3*b+3*c-2*f-g)*h+f*e+b}}},a}),define("canvax/core/Base",["canvax/library/underscore",document.createElement("canvas").getContext?"":"canvax/library/flashCanvas/flashcanvas"],function(a,b){a=a||window._;var c=function(a,b){return document[a]?function(b,c,d){if(b.length)for(var e=0;e<b.length;e++)arguments.callee(b[e],c,d);else b[a](c,d,!1)}:function(a,c,d){if(a.length)for(var e=0;e<a.length;e++)arguments.callee(a[e],c,d);else a[b]("on"+c,function(){return d.call(a,window.event)})}},d={mainFrameRate:60,now:0,getEl:function(b){return a.isString(b)?document.getElementById(b):1==b.nodeType?b:b.length?b[0]:null},getOffset:function(a){var b=a.getBoundingClientRect(),c=a.ownerDocument,d=c.body,e=c.documentElement,f=e.clientTop||d.clientTop||0,g=e.clientLeft||d.clientLeft||0,h=1;if(d.getBoundingClientRect){var i=d.getBoundingClientRect();h=(i.right-i.left)/d.clientWidth}h>1&&(f=0,g=0);var j=b.top/h+(window.pageYOffset||e&&e.scrollTop/h||d.scrollTop/h)-f,k=b.left/h+(window.pageXOffset||e&&e.scrollLeft/h||d.scrollLeft/h)-g;return{top:j,left:k}},addEvent:c("addEventListener","attachEvent"),removeEvent:c("removeEventListener","detachEvent"),_pixelCtx:null,__emptyFunc:function(){},_devicePixelRatio:window.devicePixelRatio||1,_createCanvas:function(a,b,c){var d=document.createElement("canvas");return d.style.position="absolute",d.style.width=b+"px",d.style.height=c+"px",d.style.left=0,d.style.top=0,d.setAttribute("width",b*this._devicePixelRatio),d.setAttribute("height",c*this._devicePixelRatio),d.setAttribute("id",a),d},canvasSupport:function(){return!!document.createElement("canvas").getContext},createObject:function(a,b){var c,e=Object.create;return e?c=e(a):(d.__emptyFunc.prototype=a,c=new d.__emptyFunc),c.constructor=b,c},setContextStyle:function(b,c){for(p in c)"textBaseline"!=p&&p in b&&(c[p]||a.isNumber(c[p]))&&("globalAlpha"==p?b[p]*=c[p]:b[p]=c[p])},creatClass:function(b,c,e){if(!c||!b)return b;var f,g=c.prototype;return f=d.createObject(g,b),b.prototype=a.extend(f,b.prototype),b.superclass=d.createObject(g,c),e&&a.extend(f,e),b},initElement:function(a){b&&b.initElement&&b.initElement(a)},checkOpt:function(a){return a?a&&!a.context?(a.context={},a):a:{context:{}}},_UID:0,getUID:function(){return this._UID++},createId:function(a){var b=a.charCodeAt(a.length-1);return b>=48&&57>=b&&(a+="_"),a+d.getUID()},copy:function(b,c,d){if(a.isEmpty(c))return b;for(var e in c)(!d||b.hasOwnProperty(e)||void 0!==b[e])&&(b[e]=c[e]);return b},getCssOrderArr:function(a){var b,c,d,e;return"number"==typeof a?b=c=d=e=a:a instanceof Array?1===a.length?b=c=d=e=a[0]:2===a.length?(b=d=a[0],c=e=a[1]):3===a.length?(b=a[0],c=e=a[1],d=a[2]):(b=a[0],c=a[1],d=a[2],e=a[3]):b=c=d=e=0,[b,c,d,e]},setDeepExtend:function(){(function(){var b,c,d,e,f,g,h=[].slice;d=function(b){var c,e;return!a.isObject(b)||a.isFunction(b)?b:a.isDate(b)?new Date(b.getTime()):a.isRegExp(b)?new RegExp(b.source,b.toString().replace(/.*\//,"")):(e=a.isArray(b||a.isArguments(b)),c=function(a,b,c){return e?a.push(d(b)):a[c]=d(b),a},a.reduce(b,c,e?[]:{}))},g=function(b){return!(null!=b&&void 0!=b&&b.prototype!=={}.prototype&&b.prototype!==Object.prototype||!a.isObject(b)||a.isArray(b)||a.isFunction(b)||a.isDate(b)||a.isRegExp(b)||a.isArguments(b))},c=function(b){return a.filter(a.keys(b),function(a){return g(b[a])})},b=function(b){return a.filter(a.keys(b),function(c){return a.isArray(b[c])})},f=function(d,e,g){if(!e)return d;var h,i,j,k,l,m,n,o,p,q;if(null==g&&(g=20),0>=g)return a.extend(d,e);for(m=a.intersection(c(d),c(e)),i=function(a){return e[a]=f(d[a],e[a],g-1)},n=0,p=m.length;p>n;n++)l=m[n],i(l);for(k=a.intersection(b(d),b(e)),h=function(a){return e[a]},o=0,q=k.length;q>o;o++)j=k[o],h(j);return a.extend(d,e)},e=function(){var b,c,e,g;if(e=2<=arguments.length?h.call(arguments,0,g=arguments.length-1):(g=0,[]),c=arguments[g++],a.isNumber(c)||(e.push(c),c=20),e.length<=1)return e[0];if(0>=c)return a.extend.apply(this,e);for(b=e.shift();e.length>0;)b=f(b,d(e.shift()),c);return b},a.mixin({deepClone:d,isBasicObject:g,basicObjects:c,arrays:b,deepExtend:e})}).call(window)}};return d.setDeepExtend(),d}),define("canvax/core/PropertyFactory",[],function(){function a(b,d,f){function g(b,e){(!c[b]||c[b]&&"$"!==b.charAt(0))&&(d[b]=e);var g=typeof e;if("function"===g)c[b]||l.push(b);else{if(-1!==_.indexOf(i,b)||"$"===b.charAt(0)&&!f[b])return l.push(b);var m=function(c){var e,f=m.value,i=f;if(!arguments.length)return!f||"object"!==g||f instanceof Array||f.$model||f.addColorStop||(f.$parent=j,f=a(f,f),m.value=f),f;var k=typeof c;if(!h&&f!==c){!c||"object"!==k||c instanceof Array||c.addColorStop?f=c:(f=c.$model?c:a(c,c),e=f.$model),m.value=f,d[b]=e?e:f,e||j.$fire&&j.$fire(b,f,i),g!=k&&(g=k);var l=j;if(!j.$watch)for(;l.$parent;)l=l.$parent;l.$watch&&l.$watch.call(l,b,f,i)}};m.value=e,k[b]={set:m,get:m,enumerable:!0}}}var h=!0,i=b.$skipArray,j={},k={},l=_.keys(c);d=d||{},f=f||{},i=_.isArray(i)?i.concat(l):l;for(var m in b)g(m,b[m]);return j=e(j,k,l),_.forEach(l,function(a){b[a]&&("function"==typeof b[a]?j[a]=function(){b[a].apply(this,arguments)}:j[a]=b[a])}),j.$model=d,j.$accessor=k,j.hasOwnProperty=function(a){return a in j.$model},h=!1,j}function b(a,b,c){var d=a[b]&&a[b].set;return 3!==arguments.length?d():void d(c)}var c={$skipArray:0,$watch:1,$fire:2,$model:3,$accessor:4,$owner:5,$parent:7},d=Object.defineProperty;try{d({},"_",{value:"x"});var e=Object.defineProperties}catch(f){"__defineGetter__"in Object&&(d=function(a,b,c){return"value"in c&&(a[b]=c.value),"get"in c&&a.__defineGetter__(b,c.get),"set"in c&&a.__defineSetter__(b,c.set),a},e=function(a,b){for(var c in b)b.hasOwnProperty(c)&&d(a,c,b[c]);return a})}return!e&&window.VBArray&&(window.execScript(["Function parseVB(code)","	ExecuteGlobal(code)","End Function"].join("\n"),"VBScript"),e=function(a,c,d){a=d.slice(0),a.push("hasOwnProperty");var e="VBClass"+setTimeout("1"),f={},g=[];g.push("Class "+e,"	Private [__data__], [__proxy__]","	Public Default Function [__const__](d, p)","		Set [__data__] = d: set [__proxy__] = p","		Set [__const__] = Me","	End Function"),_.forEach(a,function(a){f[a]!==!0&&(f[a]=!0,g.push("	Public ["+a+"]"))});for(var h in c)f[h]=!0,g.push("	Public Property Let ["+h+"](val)",'		Call [__proxy__]([__data__], "'+h+'", val)',"	End Property","	Public Property Set ["+h+"](val)",'		Call [__proxy__]([__data__], "'+h+'", val)',"	End Property","	Public Property Get ["+h+"]","	On Error Resume Next","		Set["+h+'] = [__proxy__]([__data__],"'+h+'")',"	If Err.Number <> 0 Then","		["+h+'] = [__proxy__]([__data__],"'+h+'")',"	End If","	On Error Goto 0","	End Property");return g.push("End Class"),g.push("Function "+e+"Factory(a, b)","	Dim o","	Set o = (New "+e+")(a, b)","	Set "+e+"Factory = o","End Function"),window.parseVB(g.join("\r\n")),window[e+"Factory"](c,b)}),window.PropertyFactory=a,a}),define("canvax/display/Point",[],function(){var a=function(a,b){if(1!=arguments.length||"object"!=typeof arguments[0])a||(a=0),b||(b=0),this.x=1*a,this.y=1*b;else{var c=arguments[0];if("x"in c&&"y"in c)this.x=1*c.x,this.y=1*c.y;else{var d=0;for(var e in c){if(0!=d){this.y=1*c[e];break}this.x=1*c[e],d++}}}};return a}),define("canvax/event/CanvaxEvent",["canvax/core/Base"],function(a){var b=function(a){this.target=null,this.currentTarget=null,this.params=null,this.type=a.type,this.points=null,this._stopPropagation=!1};return b.prototype={stopPropagation:function(){this._stopPropagation=!0}},b.pageX=function(a){return a.pageX?a.pageX:a.clientX?a.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft):null},b.pageY=function(a){return a.pageY?a.pageY:a.clientY?a.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop):null},b}),define("canvax/event/EventManager",[],function(){var a=function(){this._eventMap={}};return a.prototype={_addEventListener:function(a,b){if("function"!=typeof b)return!1;var c=!0,d=this;return d._eventMap||(d._eventMap=[]),_.each(a.split(" "),function(a){var e=d._eventMap[a];return e?-1==_.indexOf(e,b)?(e.push(b),d._eventEnabled=!0,!0):void(c=!1):(e=d._eventMap[a]=[],e.push(b),d._eventEnabled=!0,!0)}),c},_removeEventListener:function(a,b){if(1==arguments.length)return this.removeEventListenerByType(a);var c=this._eventMap[a];if(!c)return!1;for(var d=0;d<c.length;d++){var e=c[d];if(e===b)return c.splice(d,1),0==c.length&&(delete this._eventMap[a],_.isEmpty(this._eventMap)&&(this._eventEnabled=!1)),!0}return!1},_removeEventListenerByType:function(a){var b=this._eventMap[a];return b?!1:(delete this._eventMap[a],_.isEmpty(this._eventMap)&&(this._eventEnabled=!1),!0)},_removeAllEventListeners:function(){this._eventMap={},this._eventEnabled=!1},_dispatchEvent:function(a){var b=this._eventMap[a.type];if(b){a.target||(a.target=this),b=b.slice();for(var c=0;c<b.length;c++){var d=b[c];"function"==typeof d&&d.call(this,a)}}return a._stopPropagation||this.parent&&(a.currentTarget=this.parent,this.parent._dispatchEvent(a)),!0},_hasEventListener:function(a){var b=this._eventMap[a];return null!=b&&b.length>0}},a}),define("canvax/event/EventDispatcher",["canvax/core/Base","canvax/event/EventManager"],function(a,b){var c=function(){arguments.callee.superclass.constructor.call(this,name)};return a.creatClass(c,b,{on:function(a,b){return this._addEventListener(a,b),this},addEventListener:function(a,b){return this._addEventListener(a,b),this},un:function(a,b){return this._removeEventListener(a,b),this},removeEventListener:function(a,b){return this._removeEventListener(a,b),this},removeEventListenerByType:function(a){return this._removeEventListenerByType(a),this},removeAllEventListeners:function(){return this._removeAllEventListeners(),this},fire:function(a,b){var c=b||{},d=this;_.isObject(a)&&a.type&&(c=_.extend(c,a),a=a.type);var e=c?c.currentTarget:null;return _.each(a.split(" "),function(a){var b=null;c?(b=c.type,c.type=a):c={type:a},c.currentTarget=d,d.dispatchEvent(c),b&&(c.type=b)}),c.currentTarget=e,this},dispatchEvent:function(a){if(this instanceof DisplayObjectContainer&&a.point){var b=this.getObjectsUnderPoint(a.point,1)[0];return void(b&&b.dispatchEvent(a))}{if(!this.context||"mouseover"!=a.type){if(this._dispatchEvent(a),this.context&&"mouseout"==a.type&&this._hoverClass){var c=this.getStage().parent;this._hoverClass=!1,c._hoverStage.removeChildById(this.id),this._globalAlpha&&(this.context.globalAlpha=this._globalAlpha,delete this._globalAlpha)}return this}var d=this._heartBeatNum,e=this.context.globalAlpha;if(this._dispatchEvent(a),d!=this._heartBeatNum&&(this._hoverClass=!0,this.hoverClone)){var c=this.getStage().parent,f=this.clone(!0);f._transform=this.getConcatenatedMatrix(),c._hoverStage.addChildAt(f,0),this._globalAlpha=e,this.context.globalAlpha=0}}},hasEvent:function(a){return this._hasEventListener(a)},hasEventListener:function(a){return this._hasEventListener(a)},hover:function(a,b){return this.on("mouseover",a),this.on("mouseout",b),this},once:function(a,b){return this.on(a,function(){b.apply(this,arguments),this.un(a,arguments.callee)}),this}}),c}),define("canvax/event/EventHandler",["canvax/core/Base","ontouchstart"in window?"canvax/event/handler/touch":"canvax/event/handler/mouse","canvax/display/Point","canvax/event/CanvaxEvent"],function(a,b,c,d){var e=function(a){this.canvax=a,this.curPoints=[new c(0,0)],this.curPointsTarget=[],this._touching=!1,this._draging=!1,this._cursor="default"};return a.creatClass(e,b,{__dispatchEventInChilds:function(a,b){if(!(b||"length"in b))return!1;var c=this,e=!1;return _.each(b,function(b,f){if(b){e=!0;var g=new d(a);g.target=g.currentTarget=b||this,g.stagePoint=c.curPoints[f],g.point=g.target.globalToLocal(g.stagePoint),b.dispatchEvent(g)}}),e},_clone2hoverStage:function(a,b){var c=this,d=c.canvax,e=d._hoverStage.getChildById(a.id);return e||(e=a.clone(!0),e._transform=a.getConcatenatedMatrix(),d._hoverStage.addChildAt(e,0)),e.context.globalAlpha=a._globalAlpha,e._dragPoint=a.globalToLocal(c.curPoints[b]),e},_dragHander:function(a,b,d){var e=this,f=e.canvax,g=f._hoverStage.getChildById(b.id),h=new c(e.curPoints[d].x-g._dragPoint.x,e.curPoints[d].y-g._dragPoint.y);g.context.x=h.x,g.context.y=h.y,b.drag&&b.drag(a);var i=h;"stage"!=b.type&&b.parent&&"stage"!=b.parent.type&&(i=b.parent.globalToLocal(h)),b._notWatch=!0,b.context.x=i.x,b.context.y=i.y,b._notWatch=!1},_dragEnd:function(a,b,c){var d=this,e=d.canvax,f=e._hoverStage.getChildById(b.id);f.destroy(),b.context.globalAlpha=b._globalAlpha},_stopBubble:function(a){a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0},_stopDefault:function(a){return a&&a.preventDefault?a.preventDefault():window.event.returnValue=!1,!1}}),e}),define("canvax/geom/Math",[],function(){function a(a,b){return a=(b?a*g:a).toFixed(4),"undefined"==typeof f.sin[a]&&(f.sin[a]=Math.sin(a)),f.sin[a]}function b(a,b){return a=(b?a*g:a).toFixed(4),"undefined"==typeof f.cos[a]&&(f.cos[a]=Math.cos(a)),f.cos[a]}function c(a){return a*g}function d(a){return a/g}function e(a){var b=(360+a%360)%360;return 0==b&&0!==a&&(b=360),b}var f={sin:{},cos:{}},g=Math.PI/180;return{PI:Math.PI,sin:a,cos:b,degreeToRadian:c,radianToDegree:d,degreeTo360:e}}),define("canvax/geom/HitTestPoint",["canvax/geom/Math"],function(a){function b(a,b){var d=b.x,e=b.y;return a&&a.type?c(a,d,e):!1}function c(a,b,c){switch(a.type){case"line":return e(a.context,b,c);case"brokenline":return f(a,b,c);case"text":return!0;case"rect":return!0;case"circle":return h(a,b,c);case"ellipse":return j(a,b,c);case"sector":return i(a,b,c);case"path":case"droplet":return l(a,b,c);case"polygon":case"isogon":return k(a,b,c)}}function d(a,c,d){return!b(a,c,d)}function e(a,b,c){var d=a.xStart,e=a.yStart,f=a.xEnd,g=a.yEnd,h=Math.max(a.lineWidth,3),i=0,j=d;if(c>e+h&&c>g+h||e-h>c&&g-h>c||b>d+h&&b>f+h||d-h>b&&f-h>b)return!1;if(d===f)return Math.abs(b-d)<=h/2;i=(e-g)/(d-f),j=(d*g-f*e)/(d-f);var k=(i*b-c+j)*(i*b-c+j)/(i*i+1);return h/2*h/2>=k}function f(a,b,c){for(var d,f=a.context,h=f.pointList,i=!1,j=0,k=h.length-1;k>j&&(d={xStart:h[j][0],yStart:h[j][1],xEnd:h[j+1][0],yEnd:h[j+1][1],lineWidth:f.lineWidth},!g({x:Math.min(d.xStart,d.xEnd)-d.lineWidth,y:Math.min(d.yStart,d.yEnd)-d.lineWidth,width:Math.abs(d.xStart-d.xEnd)+d.lineWidth,height:Math.abs(d.yStart-d.yEnd)+d.lineWidth},b,c)||!(i=e(d,b,c)));j++);return i}function g(a,b,c){return b>=a.x&&b<=a.x+a.width&&c>=a.y&&c<=a.y+a.height?!0:!1}function h(a,b,c,d){var e=a.context;return!d&&(d=e.r),d+=e.lineWidth,d*d>b*b+c*c}function i(b,c,d){var e=b.context;if(!h(b,c,d)||e.r0>0&&h(b,c,d,e.r0))return!1;var f=a.degreeTo360(e.startAngle),g=a.degreeTo360(e.endAngle),i=a.degreeTo360(Math.atan2(d,c)/Math.PI*180%360),j=!0;(f>g&&!e.clockwise||g>f&&e.clockwise)&&(j=!1);var k=[Math.min(f,g),Math.max(f,g)],l=i>k[0]&&i<k[1];return l&&j||!l&&!j}function j(a,b,c){var d,e=a.context,f={x:0,y:0},g=e.hr,h=e.vr,i={x:b,y:c};return i.x-=f.x,i.y-=f.y,i.x*=i.x,i.y*=i.y,g*=g,h*=h,d=h*i.x+g*i.y-g*h,0>d}function k(a,b,c){var d=a.context?a.context:a,f=_.clone(d.pointList);f.push(f[0]);for(var g,h=0,i=f[0][1]>c,j=1;j<f.length;j++){var k=e({xStart:f[j-1][0],yStart:f[j-1][1],xEnd:f[j][0],yEnd:f[j][1],lineWidth:d.lineWidth||1},b,c);if(k)return!0;if(d.fillStyle&&(g=i,i=f[j][1]>c,g!=i)){var l=(g?1:0)-(i?1:0);l*((f[j-1][0]-b)*(f[j][1]-c)-(f[j-1][1]-c)*(f[j][0]-b))>0&&(h+=l)}}return h}function l(a,b,c){for(var d=a.context,e=d.pointList,f=!1,g=0,h=e.length;h>g&&!(f=k({pointList:e[g],lineWidth:d.lineWidth,fillStyle:d.fillStyle},b,c));g++);return f}var m={};return m={isInside:b,isOutside:d}}),define("canvax/geom/Matrix",["canvax/core/Base"],function(a){var b=function(a,b,c,d,e,f){this.a=void 0!=a?a:1,this.b=void 0!=b?b:0,this.c=void 0!=c?c:0,this.d=void 0!=d?d:1,this.tx=void 0!=e?e:0,this.ty=void 0!=f?f:0};return a.creatClass(b,function(){},{concat:function(a){var b=this.a,c=this.c,d=this.tx;return this.a=b*a.a+this.b*a.c,this.b=b*a.b+this.b*a.d,this.c=c*a.a+this.d*a.c,this.d=c*a.b+this.d*a.d,this.tx=d*a.a+this.ty*a.c+a.tx,this.ty=d*a.b+this.ty*a.d+a.ty,this},concatTransform:function(a,c,d,e,f){var g=1,h=0;if(f%360){var i=f*Math.PI/180;g=Math.cos(i),h=Math.sin(i)}return this.concat(new b(g*d,h*d,-h*e,g*e,a,c)),this},rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=this.a,e=this.c,f=this.tx;if(a>0)this.a=d*b-this.b*c,this.b=d*c+this.b*b,this.c=e*b-this.d*c,this.d=e*c+this.d*b,this.tx=f*b-this.ty*c,this.ty=f*c+this.ty*b;else{var g=Math.sin(Math.abs(a)),h=Math.cos(Math.abs(a));this.a=d*h+this.b*g,this.b=-d*g+this.b*h,this.c=e*h+this.d*g,this.d=-e*g+h*this.d,this.tx=h*f+g*this.ty,this.ty=h*this.ty-g*f}return this},scale:function(a,b){return this.a*=a,this.d*=b,this.tx*=a,this.ty*=b,this},translate:function(a,b){return this.tx+=a,this.ty+=b,this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},invert:function(){var a=this.a,b=this.b,c=this.c,d=this.d,e=this.tx,f=a*d-b*c;return this.a=d/f,this.b=-b/f,this.c=-c/f,this.d=a/f,this.tx=(c*this.ty-d*e)/f,this.ty=-(a*this.ty-b*e)/f,this},clone:function(){return new b(this.a,this.b,this.c,this.d,this.tx,this.ty)},toArray:function(){return[this.a,this.b,this.c,this.d,this.tx,this.ty]},mulVector:function(a){var b=this.a,c=this.c,d=this.tx,e=this.b,f=this.d,g=this.ty,h=[0,0];return h[0]=a[0]*b+a[1]*c+d,h[1]=a[0]*e+a[1]*f+g,h}}),b}),define("canvax/geom/Vector",[],function(){function a(a,b){var c=0,d=0;if(1==arguments.length&&_.isObject(a)){var e=arguments[0];_.isArray(e)?(c=e[0],d=e[1]):e.hasOwnProperty("x")&&e.hasOwnProperty("y")&&(c=e.x,d=e.y)}this._axes=[c,d]}return a.prototype={distance:function(a){var b=this._axes[0]-a._axes[0],c=this._axes[1]-a._axes[1];return Math.sqrt(b*b+c*c)}},a}),define("canvax/geom/SmoothSpline",["canvax/geom/Vector"],function(a){function b(a,b,c,d,e,f,g){var h=.25*(c-a),i=.25*(d-b);return(2*(b-c)+h+i)*g+(-3*(b-c)-2*h-i)*f+h*e+b}return function(c){var d=c.points,e=c.isLoop,f=c.smoothFilter,g=d.length;if(1==g)return d;for(var h=[],i=0,j=new a(d[0]),k=null,l=1;g>l;l++)k=new a(d[l]),i+=j.distance(k),j=k;j=null,k=null;var m=i/6;m=g>m?g:m;for(var l=0;m>l;l++){var n,o,p,q=l/(m-1)*(e?g:g-1),r=Math.floor(q),s=q-r,t=d[r%g];e?(n=d[(r-1+g)%g],o=d[(r+1)%g],p=d[(r+2)%g]):(n=d[0===r?r:r-1],o=d[r>g-2?g-1:r+1],p=d[r>g-3?g-1:r+2]);var u=s*s,v=s*u,w=[b(n[0],t[0],o[0],p[0],s,u,v),b(n[1],t[1],o[1],p[1],s,u,v)];_.isFunction(f)&&f(w),h.push(w)}return h}}),define("canvax/display/DisplayObject",["canvax/event/EventDispatcher","canvax/geom/Matrix","canvax/display/Point","canvax/core/Base","canvax/geom/HitTestPoint","canvax/animation/AnimationFrame","canvax/core/PropertyFactory"],function(a,b,c,d,e,f,g){var h=function(a){arguments.callee.superclass.constructor.apply(this,arguments);var b=this;a=d.checkOpt(a),b.id=a.id||null,b._transform=null,b._heartBeatNum=0,b.stage=null,b.parent=null,b._eventEnabled=!1,b.dragEnabled="dragEnabled"in a?a.dragEnabled:!1,b.xyToInt="xyToInt"in a?a.xyToInt:!0,b._createContext(a);var c=d.createId(b.type);null==b.id&&(b.id=c),b.init.apply(b,arguments),this._updateTransform()};return d.creatClass(h,a,{init:function(){},_createContext:function(a){var b=this;b.context=null;var c=d.copy({width:0,height:0,x:0,y:0,scaleX:1,scaleY:1,scaleOrigin:{x:0,y:0},rotation:0,rotateOrigin:{x:0,y:0},visible:!0,cursor:"default",fillStyle:null,lineCap:null,lineJoin:null,lineWidth:null,miterLimit:null,shadowBlur:null,shadowColor:null,shadowOffsetX:null,shadowOffsetY:null,strokeStyle:null,globalAlpha:1,font:null,textAlign:"left",textBaseline:"top",arcScaleX_:null,arcScaleY_:null,lineScale_:null,globalCompositeOperation:null},a.context,!0);b._context&&(c=_.extend(c,b._context)),b._notWatch=!1,c.$owner=b,c.$watch=function(a,b,c){var d=["x","y","scaleX","scaleY","rotation","scaleOrigin","rotateOrigin, lineWidth"];_.indexOf(d,a)>=0&&this.$owner._updateTransform(),this.$owner._notWatch||(this.$owner.$watch&&this.$owner.$watch(a,b,c),this.$owner.heartBeat({convertType:"context",shape:this.$owner,name:a,value:b,preValue:c}))},b.context=g(c)},clone:function(a){var b={id:this.id,context:_.clone(this.context.$model)};this.img&&(b.img=this.img);var c=new this.constructor(b,"clone");return this.children&&(c.children=this.children),a||(c.id=d.createId(c.type)),c},heartBeat:function(a){var b=this.getStage();b&&(this._heartBeatNum++,b.heartBeat&&b.heartBeat(a))},getCurrentWidth:function(){return Math.abs(this.context.width*this.context.scaleX)},getCurrentHeight:function(){return Math.abs(this.context.height*this.context.scaleY)},getStage:function(){if(this.stage)return this.stage;var a=this;if("stage"!=a.type){for(;a.parent&&(a=a.parent,"stage"!=a.type););if("stage"!==a.type)return!1}return this.stage=a,a},localToGlobal:function(a,d){!a&&(a=new c(0,0));var e=this.getConcatenatedMatrix(d);if(null==e)return c(0,0);var f=new b(1,0,0,1,a.x,a.y);return f.concat(e),new c(f.tx,f.ty)},globalToLocal:function(a,d){if(!a&&(a=new c(0,0)),"stage"==this.type)return a;var e=this.getConcatenatedMatrix(d);if(null==e)return new c(0,0);e.invert();var f=new b(1,0,0,1,a.x,a.y);return f.concat(e),new c(f.tx,f.ty)},localToTarget:function(a,b){var c=localToGlobal(a);return b.globalToLocal(c)},getConcatenatedMatrix:function(a){for(var c=new b,d=this;null!=d;d=d.parent)if(c.concat(d._transform),!d.parent||a&&d.parent&&d.parent==a||d.parent&&"stage"==d.parent.type)return c;return c},setEventEnable:function(a){return _.isBoolean(a)?(this._eventEnabled=a,!0):!1},getIndex:function(){return this.parent?_.indexOf(this.parent.children,this):void 0},toBack:function(a){if(this.parent){var b=this.getIndex(),c=0;if(_.isNumber(a)){if(0==a)return;c=b-a}var d=this.parent.children.splice(b,1)[0];0>c&&(c=0),this.parent.addChildAt(d,c)}},toFront:function(a){if(this.parent){var b=this.getIndex(),c=this.parent.children.length,d=c;if(_.isNumber(a)){if(0==a)return;d=b+a+1}var e=this.parent.children.splice(b,1)[0];d>c&&(d=c),this.parent.addChildAt(e,d-1)}},_transformHander:function(a){var b=this._transform;b||(b=this._updateTransform()),a.transform.apply(a,b.toArray())},_updateTransform:function(){var a=new b;a.identity();var d=this.context;if(1!==d.scaleX||1!==d.scaleY){var e=new c(d.scaleOrigin);(e.x||e.y)&&a.translate(-e.x,-e.y),a.scale(d.scaleX,d.scaleY),(e.x||e.y)&&a.translate(e.x,e.y)}var f=d.rotation;if(f){var e=new c(d.rotateOrigin);(e.x||e.y)&&a.translate(-e.x,-e.y),a.rotate(f%360*Math.PI/180),(e.x||e.y)&&a.translate(e.x,e.y)}var g,h;if(this.xyToInt){var g=parseInt(d.x),h=parseInt(d.y);parseInt(d.lineWidth,10)%2==1&&d.strokeStyle&&(g+=.5,h+=.5)}else g=d.x,h=d.y;return(0!=g||0!=h)&&a.translate(g,h),this._transform=a,a},getChildInPoint:function(a){var b;"stage"!=this.type&&this.parent&&"stage"!=this.parent.type&&(a=this.parent.globalToLocal(a));var c=a.x,d=a.y;if(this._notWatch=!0,this._transform){var f=this._transform.clone().invert(),g=[c,d];g=f.mulVector(g),c=g[0],d=g[1]}var h=this._rect=this.getRect(this.context);return h?(!this.context.width&&h.width&&(this.context.width=h.width),!this.context.height&&h.height&&(this.context.height=h.height),h.width&&h.height?(b=c>=h.x&&c<=h.x+h.width&&d>=h.y&&d<=h.y+h.height?e.isInside(this,{x:c,y:d}):!1,this._notWatch=!1,b):!1):!1},animate:function(a,b){var c=a,d={};for(var e in c)d[e]=this.context[e];!b&&(b={}),b.from=d,b.to=c;var g=this,h=function(){};b.onUpdate&&(h=b.onUpdate);var i;b.onUpdate=function(){if(!g.context&&i)return f.destroyTween(i),void(i=null);for(var a in this)g.context[a]=this[a];h.apply(g,[this])};var j=function(){};return b.onComplete&&(j=b.onComplete),b.onComplete=function(a){j.apply(g,arguments)},i=f.registTween(b)},_render:function(a){!this.context.visible||this.context.globalAlpha<=0||(a.save(),this._transformHander(a),"text"!=this.type&&d.setContextStyle(a,this.context.$model),this.render(a),a.restore())},render:function(a){},remove:function(){this.parent&&(this.parent.removeChild(this),this.parent=null)},destroy:function(){this.remove(),this.fire("destroy"),this.context=null,delete this.context}}),h}),define("canvax/display/DisplayObjectContainer",["canvax/core/Base","canvax/display/DisplayObject","canvax/display/Point"],function(a,b,c){return DisplayObjectContainer=function(a){var b=this;b.children=[],b.mouseChildren=[],arguments.callee.superclass.constructor.apply(this,arguments),b._eventEnabled=!0},a.creatClass(DisplayObjectContainer,b,{addChild:function(a){return a?-1!=this.getChildIndex(a)?(a.parent=this,a):(a.parent&&a.parent.removeChild(a),this.children.push(a),a.parent=this,this.heartBeat&&this.heartBeat({convertType:"children",target:a,src:this}),this._afterAddChild&&this._afterAddChild(a),a):void 0},addChildAt:function(a,b){return-1!=this.getChildIndex(a)?(a.parent=this,
a):(a.parent&&a.parent.removeChild(a),this.children.splice(b,0,a),a.parent=this,this.heartBeat&&this.heartBeat({convertType:"children",target:a,src:this}),this._afterAddChild&&this._afterAddChild(a,b),a)},removeChild:function(a){return this.removeChildAt(_.indexOf(this.children,a))},removeChildAt:function(a){if(0>a||a>this.children.length-1)return!1;var b=this.children[a];return null!=b&&(b.parent=null),this.children.splice(a,1),this.heartBeat&&this.heartBeat({convertType:"children",target:b,src:this}),this._afterDelChild&&this._afterDelChild(b,a),b},removeChildById:function(a){for(var b=0,c=this.children.length;c>b;b++)if(this.children[b].id==a)return this.removeChildAt(b);return!1},removeAllChildren:function(){for(;this.children.length>0;)this.removeChildAt(0)},destroy:function(){this.parent&&(this.parent.removeChild(this),this.parent=null),this.fire("destroy");for(var a=0,b=this.children.length;b>a;a++)this.getChildAt(a).destroy(),a--,b--},getChildById:function(a,b){if(b)return null;for(var c=0,d=this.children.length;d>c;c++)if(this.children[c].id==a)return this.children[c];return null},getChildAt:function(a){return 0>a||a>this.children.length-1?null:this.children[a]},getChildIndex:function(a){return _.indexOf(this.children,a)},setChildIndex:function(a,b){if(a.parent==this){var c=_.indexOf(this.children,a);b!=c&&(this.children.splice(c,1),this.children.splice(b,0,a))}},getNumChildren:function(){return this.children.length},getObjectsUnderPoint:function(a,b){for(var c=[],d=this.children.length-1;d>=0;d--){var e=this.children[d];if(null!=e&&(e._eventEnabled||e.dragEnabled)&&e.context.visible)if(e instanceof DisplayObjectContainer){if(e.mouseChildren&&e.getNumChildren()>0){var f=e.getObjectsUnderPoint(a);f.length>0&&(c=c.concat(f))}}else if(e.getChildInPoint(a)&&(c.push(e),void 0!=b&&!isNaN(b)&&c.length==b))return c}return c},render:function(a){for(var b=0,c=this.children.length;c>b;b++)this.children[b]._render(a)}}),DisplayObjectContainer}),define("canvax/display/Shape",["canvax/display/DisplayObject","canvax/core/Base"],function(a,b){var c=function(a){var b=this;b._hoverable=!1,b._clickable=!1,b._hoverClass=!1,b.hoverClone=!0,b.pointChkPriority=!0,b._dragDuplicate=null,b.type=b.type||"shape",a.draw&&(b.draw=a.draw),b.initCompProperty(a),arguments.callee.superclass.constructor.apply(this,arguments),b._rect=null};return b.creatClass(c,a,{init:function(){},initCompProperty:function(a){for(var b in a)"id"!=b&&"context"!=b&&(this[b]=a[b])},draw:function(){},drawEnd:function(a){if(!this._hasFillAndStroke){var b=this.context;"stroke"!=this._drawTypeOnly&&"path"!=this.type&&a.closePath(),b.strokeStyle&&b.lineWidth&&a.stroke(),b.fillStyle&&"stroke"!=this._drawTypeOnly&&a.fill()}},render:function(){var a=this.getStage().context2D;"shape"==this.context.type?this.draw.apply(this):this.draw&&(a.beginPath(),this.draw(a,this.context),this.drawEnd(a))},dashedLineTo:function(a,b,c,d,e,f){f="undefined"==typeof f?3:f,f=Math.max(f,this.context.lineWidth);for(var g=d-b,h=e-c,i=Math.floor(Math.sqrt(g*g+h*h)/f),j=0;i>j;++j){var k=parseInt(b+g/i*j),l=parseInt(c+h/i*j);a[j%2===0?"moveTo":"lineTo"](k,l),j==i-1&&j%2===0&&a.lineTo(d,e)}},getRectFormPointList:function(a){for(var b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=Number.MAX_VALUE,e=Number.MIN_VALUE,f=a.pointList,g=0,h=f.length;h>g;g++)f[g][0]<b&&(b=f[g][0]),f[g][0]>c&&(c=f[g][0]),f[g][1]<d&&(d=f[g][1]),f[g][1]>e&&(e=f[g][1]);var i;return i=a.strokeStyle||a.fillStyle?a.lineWidth||1:0,{x:Math.round(b-i/2),y:Math.round(d-i/2),width:c-b+i,height:e-d+i}}}),c}),define("canvax/display/Sprite",["canvax/display/DisplayObjectContainer","canvax/core/Base"],function(a,b){var c=function(){var a=this;a.type="sprite",arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{init:function(){}}),c}),define("canvax/display/Stage",["canvax/display/DisplayObjectContainer","canvax/core/Base"],function(a,b){var c=function(){var a=this;a.type="stage",a.context2D=null,a.stageRending=!1,a._isReady=!1,arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{init:function(){},initStage:function(a,c,d){var e=this;e.context2D=a,e.context.width=c,e.context.height=d,e.context.scaleX=b._devicePixelRatio,e.context.scaleY=b._devicePixelRatio,e._isReady=!0},render:function(a){this.stageRending=!0,this.clear(),c.superclass.render.call(this,a),this.stageRending=!1},heartBeat:function(a){this._isReady&&(a||(a={}),a.stage=this,this.parent&&this.parent.heartBeat(a))},clear:function(a,b,c,d){arguments.length>=4?this.context2D.clearRect(a,b,c,d):this.context2D.clearRect(0,0,this.parent.width,this.parent.height)}}),c}),define("canvax/display/Text",["canvax/display/DisplayObject","canvax/core/Base"],function(a,b){var c=function(a,c){var d=this;d.type="text",d._reNewline=/\r?\n/,d.fontProperts=["fontStyle","fontVariant","fontWeight","fontSize","fontFamily"],c=b.checkOpt(c),d._context=_.deepExtend({fontSize:13,fontWeight:"normal",fontFamily:"微软雅黑,sans-serif",textDecoration:null,fillStyle:"blank",strokeStyle:null,lineWidth:0,lineHeight:1.2,backgroundColor:null,textBackgroundColor:null},c.context),d._context.font=d._getFontDeclaration(),d.text=a.toString(),arguments.callee.superclass.constructor.apply(this,[c])};return b.creatClass(c,a,{$watch:function(a,b,c){_.indexOf(this.fontProperts,a)>=0&&(this._context[a]=b,this._notWatch=!1,this.context.font=this._getFontDeclaration(),this.context.width=this.getTextWidth(),this.context.height=this.getTextHeight())},init:function(a,b){var c=this.context;c.width=this.getTextWidth(),c.height=this.getTextHeight()},render:function(a){for(p in this.context.$model)p in a&&"textBaseline"!=p&&this.context.$model[p]&&(a[p]=this.context.$model[p]);this._renderText(a,this._getTextLines())},resetText:function(a){this.text=a.toString(),this.heartBeat()},getTextWidth:function(){var a=0;return b._pixelCtx.save(),b._pixelCtx.font=this.context.font,a=this._getTextWidth(b._pixelCtx,this._getTextLines()),b._pixelCtx.restore(),a},getTextHeight:function(){return this._getTextHeight(b._pixelCtx,this._getTextLines())},_getTextLines:function(){return this.text.split(this._reNewline)},_renderText:function(a,b){a.save(),this._renderTextStroke(a,b),this._renderTextFill(a,b),a.restore()},_getFontDeclaration:function(){var a=this,b=[];return _.each(this.fontProperts,function(c){var d=a._context[c];"fontSize"==c&&(d=parseFloat(d)+"px"),d&&b.push(d)}),b.join(" ")},_renderTextFill:function(a,b){if(this.context.fillStyle){this._boundaries=[];for(var c=0,d=0,e=b.length;e>d;d++){var f=this._getHeightOfLine(a,d,b);c+=f,this._renderTextLine("fillText",a,b[d],0,this._getTopOffset()+c,d)}}},_renderTextStroke:function(a,b){if(this.context.strokeStyle&&this.context.lineWidth){var c=0;a.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),supportsLineDash&&a.setLineDash(this.strokeDashArray)),a.beginPath();for(var d=0,e=b.length;e>d;d++){var f=this._getHeightOfLine(a,d,b);c+=f,this._renderTextLine("strokeText",a,b[d],0,this._getTopOffset()+c,d)}a.closePath(),a.restore()}},_renderTextLine:function(a,b,c,d,e,f){if(e-=this._getHeightOfLine()/4,"justify"!==this.context.textAlign)return void this._renderChars(a,b,c,d,e,f);var g=b.measureText(c).width,h=this.context.width;if(h>g)for(var i=c.split(/\s+/),j=b.measureText(c.replace(/\s+/g,"")).width,k=h-j,l=i.length-1,m=k/l,n=0,o=0,p=i.length;p>o;o++)this._renderChars(a,b,i[o],d+n,e,f),n+=b.measureText(i[o]).width+m;else this._renderChars(a,b,c,d,e,f)},_renderChars:function(a,b,c,d,e){b[a](c,0,e)},_getHeightOfLine:function(){return this.context.fontSize*this.context.lineHeight},_getTextWidth:function(a,b){for(var c=a.measureText(b[0]||"|").width,d=1,e=b.length;e>d;d++){var f=a.measureText(b[d]).width;f>c&&(c=f)}return c},_getTextHeight:function(a,b){return this.context.fontSize*b.length*this.context.lineHeight},_getTopOffset:function(){var a=0;switch(this.context.textBaseline){case"top":a=0;break;case"middle":a=-this.context.height/2;break;case"bottom":a=-this.context.height}return a},getRect:function(){var a=this.context,b=0,c=0;return"center"==a.textAlign&&(b=-a.width/2),"right"==a.textAlign&&(b=-a.width),"middle"==a.textBaseline&&(c=-a.height/2),"bottom"==a.textBaseline&&(c=-a.height),{x:b,y:c,width:a.width,height:a.height}}}),c}),define("canvax/shape/BrokenLine",["canvax/display/Shape","canvax/core/Base","canvax/geom/SmoothSpline"],function(a,b,c){var d=function(a,c){var d=this;d.type="brokenline",d._drawTypeOnly="stroke",a=b.checkOpt(a),"clone"!==c&&d._initPointList(a.context),d._context=_.deepExtend({lineType:null,smooth:!1,pointList:[],smoothFilter:null},a.context),arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(d,a,{$watch:function(a,b,c){"pointList"==a&&this._initPointList(this.context,b,c)},_initPointList:function(a,b,d){var e=a;if(e.smooth){var f={points:e.pointList};_.isFunction(e.smoothFilter)&&(f.smoothFilter=e.smoothFilter),this._notWatch=!0;var g=c(f);b&&b.length>0&&(g[g.length-1][0]=b[b.length-1][0]),e.pointList=g,this._notWatch=!1}},draw:function(a,b){this._draw(a,b)},_draw:function(a,b){var c=b.pointList;if(!(c.length<2))if(b.lineType&&"solid"!=b.lineType){if("dashed"==b.lineType||"dotted"==b.lineType)if(b.smooth)for(var d=0,e=c.length;e>d&&d!=e-1;d++)a.moveTo(c[d][0],c[d][1]),a.lineTo(c[d+1][0],c[d+1][1]),d+=1;else{a.moveTo(c[0][0],c[0][1]);for(var f=1,g=c.length;g>f;f++){var h=c[f-1][0],i=c[f][0],j=c[f-1][1],k=c[f][1];this.dashedLineTo(a,h,j,i,k,5)}}}else{a.moveTo(c[0][0],c[0][1]);for(var f=1,g=c.length;g>f;f++)a.lineTo(c[f][0],c[f][1])}},getRect:function(a){var a=a?a:this.context;return this.getRectFormPointList(a)}}),d}),define("canvax/shape/Circle",["canvax/display/Shape","canvax/core/Base"],function(a,b){var c=function(a){var c=this;c.type="circle",a=b.checkOpt(a),"xyToInt"in a||(a.xyToInt=!1),c._context={r:a.context.r||0},arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{draw:function(a,b){b&&a.arc(0,0,b.r,0,2*Math.PI,!0)},getRect:function(a){var b,a=a?a:this.context;return b=a.fillStyle||a.strokeStyle?a.lineWidth||1:0,{x:Math.round(0-a.r-b/2),y:Math.round(0-a.r-b/2),width:2*a.r+b,height:2*a.r+b}}}),c}),define("canvax/shape/Line",["canvax/display/Shape","canvax/core/Base"],function(a,b){var c=function(a){var c=this;this.type="line",this.drawTypeOnly="stroke",a=b.checkOpt(a),c._context={lineType:a.context.lineType||null,xStart:a.context.xStart||0,yStart:a.context.yStart||0,xEnd:a.context.xEnd||0,yEnd:a.context.yEnd||0,dashLength:a.context.dashLength},arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{draw:function(a,b){b.lineType&&"solid"!=b.lineType?("dashed"==b.lineType||"dotted"==b.lineType)&&this.dashedLineTo(a,b.xStart,b.yStart,b.xEnd,b.yEnd,b.dashLength):(a.moveTo(parseInt(b.xStart),parseInt(b.yStart)),a.lineTo(parseInt(b.xEnd),parseInt(b.yEnd)))},getRect:function(a){var b=a.lineWidth||1,a=a?a:this.context;return{x:Math.min(a.xStart,a.xEnd)-b,y:Math.min(a.yStart,a.yEnd)-b,width:Math.abs(a.xStart-a.xEnd)+b,height:Math.abs(a.yStart-a.yEnd)+b}}}),c}),define("canvax/shape/Path",["canvax/display/Shape","canvax/core/Base","canvax/geom/Matrix","canvax/geom/bezier"],function(a,b,c,d){var e=function(a){var c=this;c.type="path",a=b.checkOpt(a),"drawTypeOnly"in a&&(c.drawTypeOnly=a.drawTypeOnly),c.__parsePathData=null;var d={pointList:[],path:a.context.path||""};c._context=_.deepExtend(d,c._context||{}),arguments.callee.superclass.constructor.apply(c,arguments)};return b.creatClass(e,a,{$watch:function(a,b,c){"path"==a&&(this.__parsePathData=null,this.context.pointList=[])},_parsePathData:function(a){if(this.__parsePathData)return this.__parsePathData;if(!a)return[];this.__parsePathData=[];var b=_.compact(a.replace(/[Mm]/g,"\\r$&").split("\\r")),c=this;return _.each(b,function(a){c.__parsePathData.push(c._parseChildPathData(a))}),this.__parsePathData},_parseChildPathData:function(a){var b=a,c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];b=b.replace(/  /g," "),b=b.replace(/ /g,","),b=b.replace(/(\d)-/g,"$1,-"),b=b.replace(/,,/g,",");var d;for(d=0;d<c.length;d++)b=b.replace(new RegExp(c[d],"g"),"|"+c[d]);var e=b.split("|"),f=[],g=0,h=0;for(d=1;d<e.length;d++){var i=e[d],j=i.charAt(0);i=i.slice(1),i=i.replace(new RegExp("e,-","g"),"e-");var k=i.split(",");k.length>0&&""===k[0]&&k.shift();for(var l=0;l<k.length;l++)k[l]=parseFloat(k[l]);for(;k.length>0&&!isNaN(k[0]);){var m,n,o,p,q,r,s,t,u=null,v=[],w=g,x=h;switch(j){case"l":g+=k.shift(),h+=k.shift(),u="L",v.push(g,h);break;case"L":g=k.shift(),h=k.shift(),v.push(g,h);break;case"m":g+=k.shift(),h+=k.shift(),u="M",v.push(g,h),j="l";break;case"M":g=k.shift(),h=k.shift(),u="M",v.push(g,h),j="L";break;case"h":g+=k.shift(),u="L",v.push(g,h);break;case"H":g=k.shift(),u="L",v.push(g,h);break;case"v":h+=k.shift(),u="L",v.push(g,h);break;case"V":h=k.shift(),u="L",v.push(g,h);break;case"C":v.push(k.shift(),k.shift(),k.shift(),k.shift()),g=k.shift(),h=k.shift(),v.push(g,h);break;case"c":v.push(g+k.shift(),h+k.shift(),g+k.shift(),h+k.shift()),g+=k.shift(),h+=k.shift(),u="C",v.push(g,h);break;case"S":m=g,n=h,o=f[f.length-1],"C"===o.command&&(m=g+(g-o.points[2]),n=h+(h-o.points[3])),v.push(m,n,k.shift(),k.shift()),g=k.shift(),h=k.shift(),u="C",v.push(g,h);break;case"s":m=g,n=h,o=f[f.length-1],"C"===o.command&&(m=g+(g-o.points[2]),n=h+(h-o.points[3])),v.push(m,n,g+k.shift(),h+k.shift()),g+=k.shift(),h+=k.shift(),u="C",v.push(g,h);break;case"Q":v.push(k.shift(),k.shift()),g=k.shift(),h=k.shift(),v.push(g,h);break;case"q":v.push(g+k.shift(),h+k.shift()),g+=k.shift(),h+=k.shift(),u="Q",v.push(g,h);break;case"T":m=g,n=h,o=f[f.length-1],"Q"===o.command&&(m=g+(g-o.points[0]),n=h+(h-o.points[1])),g=k.shift(),h=k.shift(),u="Q",v.push(m,n,g,h);break;case"t":m=g,n=h,o=f[f.length-1],"Q"===o.command&&(m=g+(g-o.points[0]),n=h+(h-o.points[1])),g+=k.shift(),h+=k.shift(),u="Q",v.push(m,n,g,h);break;case"A":p=k.shift(),q=k.shift(),r=k.shift(),s=k.shift(),t=k.shift(),w=g,x=h,g=k.shift(),h=k.shift(),u="A",v=this._convertPoint(w,x,g,h,s,t,p,q,r);break;case"a":p=k.shift(),q=k.shift(),r=k.shift(),s=k.shift(),t=k.shift(),w=g,x=h,g+=k.shift(),h+=k.shift(),u="A",v=this._convertPoint(w,x,g,h,s,t,p,q,r)}f.push({command:u||j,points:v})}("z"===j||"Z"===j)&&f.push({command:"z",points:[]})}return f},_convertPoint:function(a,b,c,d,e,f,g,h,i){var j=i*(Math.PI/180),k=Math.cos(j)*(a-c)/2+Math.sin(j)*(b-d)/2,l=-1*Math.sin(j)*(a-c)/2+Math.cos(j)*(b-d)/2,m=k*k/(g*g)+l*l/(h*h);m>1&&(g*=Math.sqrt(m),h*=Math.sqrt(m));var n=Math.sqrt((g*g*h*h-g*g*l*l-h*h*k*k)/(g*g*l*l+h*h*k*k));e===f&&(n*=-1),isNaN(n)&&(n=0);var o=n*g*l/h,p=n*-h*k/g,q=(a+c)/2+Math.cos(j)*o-Math.sin(j)*p,r=(b+d)/2+Math.sin(j)*o+Math.cos(j)*p,s=function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])},t=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(s(a)*s(b))},u=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(t(a,b))},v=u([1,0],[(k-o)/g,(l-p)/h]),w=[(k-o)/g,(l-p)/h],x=[(-1*k-o)/g,(-1*l-p)/h],y=u(w,x);return t(w,x)<=-1&&(y=Math.PI),t(w,x)>=1&&(y=0),0===f&&y>0&&(y-=2*Math.PI),1===f&&0>y&&(y+=2*Math.PI),[q,r,g,h,v,y,j,f]},_getBezierPoints:function(a){var b=Math.abs(Math.sqrt(Math.pow(a.slice(-1)[0]-a[1],2)+Math.pow(a.slice(-2,-1)[0]-a[0],2)));b=Math.ceil(b/5);for(var c=[],e=0;b>=e;e++){var f=e/b,g=d.getPointByTime(f,a);c.push(g.x),c.push(g.y)}return c},_getArcPoints:function(a){var b=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=e>f?e:f,l=e>f?1:e/f,m=e>f?f/e:1,n=new c;n.identity(),n.scale(l,m),n.rotate(i),n.translate(b,d);var o=[],p=(360-(j?-1:1)*h*180/Math.PI)%360;p=Math.ceil(Math.min(180*Math.abs(h)/Math.PI,k*Math.abs(h)/8));for(var q=0;p>=q;q++){var r=[Math.cos(g+h/p*q)*k,Math.sin(g+h/p*q)*k];r=n.mulVector(r),o.push(r[0]),o.push(r[1])}return o},draw:function(a,b){this._draw(a,b)},_draw:function(a,b){var d=b.path,e=this._parsePathData(d);this._setPointList(e,b);for(var f=0,g=e.length;g>f;f++)for(var h=0,i=e[f].length;i>h;h++){var j=e[f][h].command,k=e[f][h].points;switch(j){case"L":a.lineTo(k[0],k[1]);break;case"M":a.moveTo(k[0],k[1]);break;case"C":a.bezierCurveTo(k[0],k[1],k[2],k[3],k[4],k[5]);break;case"Q":a.quadraticCurveTo(k[0],k[1],k[2],k[3]);break;case"A":var l=k[0],m=k[1],n=k[2],o=k[3],p=k[4],q=k[5],r=k[6],s=k[7],t=n>o?n:o,u=n>o?1:n/o,v=n>o?o/n:1,w=new c;w.identity(),w.scale(u,v),w.rotate(r),w.translate(l,m),a.transform.apply(a,w.toArray()),a.arc(0,0,t,p,p+q,1-s),a.transform.apply(a,w.invert().toArray());break;case"z":a.closePath()}}return this},_setPointList:function(a,b){if(!(b.pointList.length>0))for(var c=b.pointList=[],d=0,e=a.length;e>d;d++){for(var f=[],g=0,h=a[d].length;h>g;g++){var i=a[d][g].points,j=a[d][g].command;if("A"==j.toUpperCase()&&(i=this._getArcPoints(i),a[d][g]._points=i),"C"==j.toUpperCase()||"Q"==j.toUpperCase()){var k=[0,0];if(f.length>0)k=f.slice(-1)[0];else if(g>0){var l=a[d][g-1]._points||a[d][g-1].points;l.length>=2&&(k=l.slice(-2))}i=this._getBezierPoints(k.concat(i)),a[d][g]._points=i}for(var m=0,n=i.length;n>m;m+=2){var o=i[m],p=i[m+1];!o&&0!=o||!p&&0!=p||f.push([o,p])}}f.length>0&&c.push(f)}},getRect:function(a){var b,a=a?a:this.context;b=a.strokeStyle||a.fillStyle?a.lineWidth||1:0;var c=Number.MAX_VALUE,d=-Number.MAX_VALUE,e=Number.MAX_VALUE,f=-Number.MAX_VALUE,g=0,h=0,i=this._parsePathData(a.path);this._setPointList(i,a);for(var j=0,k=i.length;k>j;j++)for(var l=0;l<i[j].length;l++)for(var m=i[j][l]._points||i[j][l].points,n=0;n<m.length;n++)n%2===0?(m[n]+g<c&&(c=m[n]+g),m[n]+g>d&&(d=m[n]+g)):(m[n]+h<e&&(e=m[n]+h),m[n]+h>f&&(f=m[n]+h));var o;return o=c===Number.MAX_VALUE||d===Number.MIN_VALUE||e===Number.MAX_VALUE||f===Number.MIN_VALUE?{x:0,y:0,width:0,height:0}:{x:Math.round(c-b/2),y:Math.round(e-b/2),width:d-c+b,height:f-e+b}}}),e}),define("canvax/shape/Polygon",["canvax/core/Base","canvax/shape/BrokenLine"],function(a,b){var c=function(b,c){var d=this;if(b=a.checkOpt(b),"clone"!==c){var e=b.context.pointList[0],f=b.context.pointList[b.context.pointList.length-1];b.context.smooth?b.context.pointList.unshift(f):b.context.pointList.push(e)}arguments.callee.superclass.constructor.apply(this,arguments),"clone"!==c&&b.context.smooth&&f,d._drawTypeOnly=null,d.type="polygon"};return a.creatClass(c,b,{draw:function(a,b){if(b.fillStyle&&("dashed"==b.lineType||"dotted"==b.lineType)){var c=b.pointList;a.save(),a.beginPath(),a.moveTo(c[0][0],c[0][1]);for(var d=1,e=c.length;e>d;d++)a.lineTo(c[d][0],c[d][1]);a.closePath(),a.restore(),a.fill(),this._drawTypeOnly="stroke"}a.save(),a.beginPath(),this._draw(a,b),a.closePath(),a.restore()}}),c}),define("canvax/shape/Rect",["canvax/display/Shape","canvax/core/Base"],function(a,b){var c=function(a){var c=this;c.type="rect",a=b.checkOpt(a),c._context={width:a.context.width||0,height:a.context.height||0,radius:a.context.radius||[]},arguments.callee.superclass.constructor.apply(this,arguments)};return b.creatClass(c,a,{_buildRadiusPath:function(a,c){var d=0,e=0,f=this.context.width,g=this.context.height,h=b.getCssOrderArr(c.radius);a.moveTo(parseInt(d+h[0]),parseInt(e)),a.lineTo(parseInt(d+f-h[1]),parseInt(e)),0!==h[1]&&a.quadraticCurveTo(d+f,e,d+f,e+h[1]),a.lineTo(parseInt(d+f),parseInt(e+g-h[2])),0!==h[2]&&a.quadraticCurveTo(d+f,e+g,d+f-h[2],e+g),a.lineTo(parseInt(d+h[3]),parseInt(e+g)),0!==h[3]&&a.quadraticCurveTo(d,e+g,d,e+g-h[3]),a.lineTo(parseInt(d),parseInt(e+h[0])),0!==h[0]&&a.quadraticCurveTo(d,e,d+h[0],e)},draw:function(a,b){b.$model.radius.length?this._buildRadiusPath(a,b):(b.fillStyle&&a.fillRect(0,0,this.context.width,this.context.height),b.lineWidth&&a.strokeRect(0,0,this.context.width,this.context.height))},getRect:function(a){var b,a=a?a:this.context;return b=a.fillStyle||a.strokeStyle?a.lineWidth||1:0,{x:Math.round(0-b/2),y:Math.round(0-b/2),width:this.context.width+b,height:this.context.height+b}}}),c}),define("canvax/shape/Sector",["canvax/display/Shape","canvax/geom/Math","canvax/core/Base"],function(a,b,c){var d=function(a){var b=this;b.type="sector",b.regAngle=[],b.isRing=!1,a=c.checkOpt(a),b._context={pointList:[],r0:a.context.r0||0,r:a.context.r||0,startAngle:a.context.startAngle||0,endAngle:a.context.endAngle||0,clockwise:a.context.clockwise||!1},arguments.callee.superclass.constructor.apply(this,arguments)};return c.creatClass(d,a,{draw:function(a,c){var d="undefined"==typeof c.r0?0:c.r0,e=c.r,f=b.degreeTo360(c.startAngle),g=b.degreeTo360(c.endAngle);f==g&&c.startAngle!=c.endAngle&&(this.isRing=!0,f=0,g=360),f=b.degreeToRadian(f),g=b.degreeToRadian(g),.025>g-f&&(f-=.003),a.arc(0,0,e,f,g,this.context.clockwise),0!==d?this.isRing?(a.moveTo(d,0),a.arc(0,0,d,f,g,!this.context.clockwise)):a.arc(0,0,d,g,f,!this.context.clockwise):a.lineTo(0,0)},getRegAngle:function(){this.regIn=!0;var a=this.context,c=b.degreeTo360(a.startAngle),d=b.degreeTo360(a.endAngle);(c>d&&!a.clockwise||d>c&&a.clockwise)&&(this.regIn=!1),this.regAngle=[Math.min(c,d),Math.max(c,d)]},getRect:function(a){var a=a?a:this.context,c="undefined"==typeof a.r0?0:a.r0,d=a.r;this.getRegAngle();var e=b.degreeTo360(a.startAngle),f=b.degreeTo360(a.endAngle),g=[],h={90:[0,d],180:[-d,0],270:[0,-d],360:[d,0]};for(var i in h){var j=parseInt(i)>this.regAngle[0]&&parseInt(i)<this.regAngle[1];(this.isRing||j&&this.regIn||!j&&!this.regIn)&&g.push(h[i])}return this.isRing||(e=b.degreeToRadian(e),f=b.degreeToRadian(f),g.push([b.cos(e)*c,b.sin(e)*c]),g.push([b.cos(e)*d,b.sin(e)*d]),g.push([b.cos(f)*d,b.sin(f)*d]),g.push([b.cos(f)*c,b.sin(f)*c])),a.pointList=g,this.getRectFormPointList(a)}}),d}),define("canvax/index",["canvax/core/Base","canvax/animation/AnimationFrame","canvax/event/EventHandler","canvax/event/EventDispatcher","canvax/event/EventManager","canvax/display/DisplayObjectContainer","canvax/display/Stage","canvax/display/Sprite","canvax/display/Shape","canvax/display/Point","canvax/display/Text","canvax/animation/AnimationFrame"],function(a,b,c,d,e,f,g,h,i,j,k,b){var l=function(b){if(this.type="canvax",this._cid=(new Date).getTime()+"_"+Math.floor(100*Math.random()),this._rootDom=a.getEl(b.el),this._rootDom){this.width=parseInt("width"in b||this._rootDom.offsetWidth,10),this.height=parseInt("height"in b||this._rootDom.offsetHeight,10),this.preventDefault=!0,b.preventDefault===!1&&(this.preventDefault=!1);var c="<div id='cc-"+this._cid+"' class='canvax-c' ";c+="style='position:relative;width:"+this.width+"px;height:"+this.height+"px;'>",c+="   <div id='cdc-"+this._cid+"' class='canvax-dom-container' ",c+="   style='position:absolute;width:"+this.width+"px;height:"+this.height+"px;'>",c+="   </div>",c+="</div>",this._rootDom.innerHTML=c,this.el=a.getEl("cc-"+this._cid),this.rootOffset=a.getOffset(this.el),this.lastGetRO=0,this.convertStages={},this._heartBeat=!1,this._preRenderTime=0,this._taskList=[],this._hoverStage=null,this._isReady=!1,this.evt=null,arguments.callee.superclass.constructor.apply(this,arguments)}};return a.creatClass(l,f,{init:function(){this.context.width=this.width,this.context.height=this.height,this._creatHoverStage(),this.evt=new c(this),this.evt.init(),this._createPixelContext(),this._isReady=!0},resize:function(b){this.width=parseInt(b&&"width"in b||this._rootDom.offsetWidth,10),this.height=parseInt(b&&"height"in b||this._rootDom.offsetHeight,10),this.el.style.width=this.width+"px",this.el.style.height=this.height+"px",this.rootOffset=a.getOffset(this.el),this._notWatch=!0,this.context.width=this.width,this.context.height=this.height,this._notWatch=!1;var c=this,d=function(b){var d=b.canvas;d.style.width=c.width+"px",d.style.height=c.height+"px",d.setAttribute("width",c.width*a._devicePixelRatio),d.setAttribute("height",c.height*a._devicePixelRatio),b.resize&&b.resize(c.width,c.height)};_.each(this.children,function(a,b){a._notWatch=!0,a.context.width=c.width,a.context.height=c.height,d(a.context2D),a._notWatch=!1});var e=a.getEl("cdc-"+this._cid);e.style.width=this.width+"px",e.style.height=this.height+"px",this.heartBeat()},getDomContainer:function(){return a.getEl("cdc-"+this._cid)},getHoverStage:function(){return this._hoverStage},_creatHoverStage:function(){this._hoverStage=new g({id:"activCanvas"+(new Date).getTime(),context:{width:this.context.width,height:this.context.height}}),this._hoverStage._eventEnabled=!1,this.addChild(this._hoverStage)},_createPixelContext:function(){var b=a.getEl("_pixelCanvas");b||(b=a._createCanvas("_pixelCanvas",0,0),document.body.appendChild(b),a.initElement(b),a.canvasSupport()?b.style.display="none":(b.style.zIndex=-1,b.style.position="absolute",b.style.left=-this.context.width+"px",b.style.top=-this.context.height+"px",b.style.visibility="hidden"),a._pixelCtx=b.getContext("2d"))},updateRootOffset:function(){var b=(new Date).getTime();b-this.lastGetRO>1e3&&(this.rootOffset=a.getOffset(this.el),this.lastGetRO=b)},__startEnter:function(){var a=this;a.requestAid||(a.requestAid=b.registFrame({id:"enterFrame",task:_.bind(a.__enterFrame,a)}))},__enterFrame:function(){var b=this;if(b.requestAid=null,a.now=(new Date).getTime(),b._heartBeat&&(_.each(_.values(b.convertStages),function(a){a.stage._render(a.stage.context2D)}),b._heartBeat=!1,b.convertStages={},b._preRenderTime=(new Date).getTime()),b._taskList.length>0)for(var c=0,d=b._taskList.length;d>c;c++){var e=b._taskList[c];e.__enterFrame?e.__enterFrame():b.__taskList.splice(c--,1)}b._taskList.length>0&&b.__startEnter()},_afterAddChild:function(b,c){var d;d=b.context2D?b.context2D.canvas:a._createCanvas(b.id,this.context.width,this.context.height);var e=a.getEl("cdc-"+this._cid);1==this.children.length?this.el.insertBefore(d,e):this.children.length>1&&(void 0==c?this.el.insertBefore(d,this._hoverStage.context2D.canvas):c>=this.children.length-1?this.el.insertBefore(d,e):this.el.insertBefore(d,this.children[c].context2D.canvas)),a.initElement(d),b.initStage(d.getContext("2d"),this.context.width,this.context.height)},_afterDelChild:function(a){this.el.removeChild(a.context2D.canvas)},_convertCanvax:function(a){_.each(this.children,function(b){b.context[a.name]=a.value})},heartBeat:function(a){var b=this;if(a){if("context"==a.convertType){var c=a.stage,d=a.shape;a.name,a.value,a.preValue;if(!b._isReady)return;if("canvax"==d.type)b._convertCanvax(a);else if(b.convertStages[c.id]||(b.convertStages[c.id]={stage:c,convertShapes:{}}),d){if(b.convertStages[c.id].convertShapes[d.id])return;b.convertStages[c.id].convertShapes[d.id]={shape:d,convertType:a.convertType}}}if("children"==a.convertType){var e=a.target,c=a.src.getStage();(c||"stage"==e.type)&&(c=c||e,b.convertStages[c.id]||(b.convertStages[c.id]={stage:c,convertShapes:{}}))}if(!a.convertType){var c=a.stage;b.convertStages[c.id]||(b.convertStages[c.id]={stage:c,convertShapes:{}})}}else _.each(b.children,function(a,c){b.convertStages[a.id]={stage:a,convertShapes:{}}});b._heartBeat?b._heartBeat=!0:(b._heartBeat=!0,b.__startEnter())},toDataURL:function(){var b=a._createCanvas("curr_base64_canvas",this.context.width,this.context.height),c=b.getContext("2d");return _.each(this.children,function(a){c.drawImage(a.context2D.canvas,0,0)}),b.toDataURL()}}),l.Display={Stage:g,Sprite:h,Shape:i,Point:j,Text:k},l.Event={EventDispatcher:d,EventManager:e},l});