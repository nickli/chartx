define("canvax/animation/AnimationFrame",["canvax/animation/Tween","canvax/core/Base"],function(a,b){function c(){return l||(l=requestAnimationFrame(function(){a.update();var b=k;for(k=[],l=null;b.length>0;)b.shift().task()})),l}function d(a){return a?(k.push(a),c()):void 0}function e(a){for(var b=!1,c=0,d=k.length;d>c;c++)k[c].id===a.id&&(b=!0,k.splice(c,1),c--,d--);return 0==k.length&&(cancelAnimationFrame(l),l=null),b}function f(c){function f(){return h._isCompleteed||h._isStoped?void(h=null):void d({id:i,task:f,desc:g.desc,tween:h})}var g=_.extend({from:null,to:null,duration:500,onStart:function(){},onUpdate:function(){},onComplete:function(){},onStop:function(){},repeat:0,delay:0,easing:"Linear.None",desc:""},c),h={},i="tween_"+b.getUID();return g.id&&(i=i+"_"+g.id),g.from&&g.to&&(h=new a.Tween(g.from).to(g.to,g.duration).onStart(function(){g.onStart.apply(this)}).onUpdate(function(){g.onUpdate.apply(this)}).onComplete(function(){e({id:i}),h._isCompleteed=!0,g.onComplete.apply(this,[this])}).onStop(function(){e({id:i}),h._isStoped=!0,g.onStop.apply(this,[this])}).repeat(g.repeat).delay(g.delay).easing(a.Easing[g.easing.split(".")[0]][g.easing.split(".")[1]]),h.id=i,h.start(),f()),h}function g(a,b){a.stop()}window.Tween=a;for(var h=0,i=["ms","moz","webkit","o"],j=0;j<i.length&&!window.requestAnimationFrame;++j)window.requestAnimationFrame=window[i[j]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[j]+"CancelAnimationFrame"]||window[i[j]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a,b){var c=(new Date).getTime(),d=Math.max(0,16-(c-h)),e=window.setTimeout(function(){a(c+d)},d);return h=c+d,e}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});var k=[],l=null;return{registFrame:d,destroyFrame:e,registTween:f,destroyTween:g}});