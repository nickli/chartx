define("chartx/utils/math3d/mat4",["chartx/utils/math3d/common"],function(a){var b={scalar:{},SIMD:{}};return b.create=function(){var b=new a.ARRAY_TYPE(16);return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=1,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=1,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},b.clone=function(b){var c=new a.ARRAY_TYPE(16);return c[0]=b[0],c[1]=b[1],c[2]=b[2],c[3]=b[3],c[4]=b[4],c[5]=b[5],c[6]=b[6],c[7]=b[7],c[8]=b[8],c[9]=b[9],c[10]=b[10],c[11]=b[11],c[12]=b[12],c[13]=b[13],c[14]=b[14],c[15]=b[15],c},b.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},b.fromValues=function(b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=new a.ARRAY_TYPE(16);return r[0]=b,r[1]=c,r[2]=d,r[3]=e,r[4]=f,r[5]=g,r[6]=h,r[7]=i,r[8]=j,r[9]=k,r[10]=l,r[11]=m,r[12]=n,r[13]=o,r[14]=p,r[15]=q,r},b.set=function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a[4]=f,a[5]=g,a[6]=h,a[7]=i,a[8]=j,a[9]=k,a[10]=l,a[11]=m,a[12]=n,a[13]=o,a[14]=p,a[15]=q,a},b.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},b.scalar.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=c,a[6]=b[9],a[7]=b[13],a[8]=d,a[9]=f,a[11]=b[14],a[12]=e,a[13]=g,a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a},b.SIMD.transpose=function(a,b){var c,d,e,f,g,h,i,j,k,l;return c=SIMD.Float32x4.load(b,0),d=SIMD.Float32x4.load(b,4),e=SIMD.Float32x4.load(b,8),f=SIMD.Float32x4.load(b,12),g=SIMD.Float32x4.shuffle(c,d,0,1,4,5),h=SIMD.Float32x4.shuffle(e,f,0,1,4,5),i=SIMD.Float32x4.shuffle(g,h,0,2,4,6),j=SIMD.Float32x4.shuffle(g,h,1,3,5,7),SIMD.Float32x4.store(a,0,i),SIMD.Float32x4.store(a,4,j),g=SIMD.Float32x4.shuffle(c,d,2,3,6,7),h=SIMD.Float32x4.shuffle(e,f,2,3,6,7),k=SIMD.Float32x4.shuffle(g,h,0,2,4,6),l=SIMD.Float32x4.shuffle(g,h,1,3,5,7),SIMD.Float32x4.store(a,8,k),SIMD.Float32x4.store(a,12,l),a},b.transpose=a.USE_SIMD?b.SIMD.transpose:b.scalar.transpose,b.scalar.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(e*C-d*D-f*B)*E,a[2]=(p*x-q*w+r*v)*E,a[3]=(m*w-l*x-n*v)*E,a[4]=(i*A-g*D-j*z)*E,a[5]=(c*D-e*A+f*z)*E,a[6]=(q*u-o*x-r*t)*E,a[7]=(k*x-m*u+n*t)*E,a[8]=(g*C-h*A+j*y)*E,a[9]=(d*A-c*C-f*y)*E,a[10]=(o*w-p*u+r*s)*E,a[11]=(l*u-k*w-n*s)*E,a[12]=(h*z-g*B-i*y)*E,a[13]=(c*B-d*z+e*y)*E,a[14]=(p*t-o*v-q*s)*E,a[15]=(k*v-l*t+m*s)*E,a):null},b.SIMD.invert=function(a,b){var c,d,e,f,g,h,i,j,k,l,m=SIMD.Float32x4.load(b,0),n=SIMD.Float32x4.load(b,4),o=SIMD.Float32x4.load(b,8),p=SIMD.Float32x4.load(b,12);return g=SIMD.Float32x4.shuffle(m,n,0,1,4,5),d=SIMD.Float32x4.shuffle(o,p,0,1,4,5),c=SIMD.Float32x4.shuffle(g,d,0,2,4,6),d=SIMD.Float32x4.shuffle(d,g,1,3,5,7),g=SIMD.Float32x4.shuffle(m,n,2,3,6,7),f=SIMD.Float32x4.shuffle(o,p,2,3,6,7),e=SIMD.Float32x4.shuffle(g,f,0,2,4,6),f=SIMD.Float32x4.shuffle(f,g,1,3,5,7),g=SIMD.Float32x4.mul(e,f),g=SIMD.Float32x4.swizzle(g,1,0,3,2),h=SIMD.Float32x4.mul(d,g),i=SIMD.Float32x4.mul(c,g),g=SIMD.Float32x4.swizzle(g,2,3,0,1),h=SIMD.Float32x4.sub(SIMD.Float32x4.mul(d,g),h),i=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,g),i),i=SIMD.Float32x4.swizzle(i,2,3,0,1),g=SIMD.Float32x4.mul(d,e),g=SIMD.Float32x4.swizzle(g,1,0,3,2),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,g),h),k=SIMD.Float32x4.mul(c,g),g=SIMD.Float32x4.swizzle(g,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(f,g)),k=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,g),k),k=SIMD.Float32x4.swizzle(k,2,3,0,1),g=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(d,2,3,0,1),f),g=SIMD.Float32x4.swizzle(g,1,0,3,2),e=SIMD.Float32x4.swizzle(e,2,3,0,1),h=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,g),h),j=SIMD.Float32x4.mul(c,g),g=SIMD.Float32x4.swizzle(g,2,3,0,1),h=SIMD.Float32x4.sub(h,SIMD.Float32x4.mul(e,g)),j=SIMD.Float32x4.sub(SIMD.Float32x4.mul(c,g),j),j=SIMD.Float32x4.swizzle(j,2,3,0,1),g=SIMD.Float32x4.mul(c,d),g=SIMD.Float32x4.swizzle(g,1,0,3,2),j=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,g),j),k=SIMD.Float32x4.sub(SIMD.Float32x4.mul(e,g),k),g=SIMD.Float32x4.swizzle(g,2,3,0,1),j=SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,g),j),k=SIMD.Float32x4.sub(k,SIMD.Float32x4.mul(e,g)),g=SIMD.Float32x4.mul(c,f),g=SIMD.Float32x4.swizzle(g,1,0,3,2),i=SIMD.Float32x4.sub(i,SIMD.Float32x4.mul(e,g)),j=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,g),j),g=SIMD.Float32x4.swizzle(g,2,3,0,1),i=SIMD.Float32x4.add(SIMD.Float32x4.mul(e,g),i),j=SIMD.Float32x4.sub(j,SIMD.Float32x4.mul(d,g)),g=SIMD.Float32x4.mul(c,e),g=SIMD.Float32x4.swizzle(g,1,0,3,2),i=SIMD.Float32x4.add(SIMD.Float32x4.mul(f,g),i),k=SIMD.Float32x4.sub(k,SIMD.Float32x4.mul(d,g)),g=SIMD.Float32x4.swizzle(g,2,3,0,1),i=SIMD.Float32x4.sub(i,SIMD.Float32x4.mul(f,g)),k=SIMD.Float32x4.add(SIMD.Float32x4.mul(d,g),k),l=SIMD.Float32x4.mul(c,h),l=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(l,2,3,0,1),l),l=SIMD.Float32x4.add(SIMD.Float32x4.swizzle(l,1,0,3,2),l),g=SIMD.Float32x4.reciprocalApproximation(l),l=SIMD.Float32x4.sub(SIMD.Float32x4.add(g,g),SIMD.Float32x4.mul(l,SIMD.Float32x4.mul(g,g))),(l=SIMD.Float32x4.swizzle(l,0,0,0,0))?(SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(l,h)),SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(l,i)),SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(l,j)),SIMD.Float32x4.store(a,12,SIMD.Float32x4.mul(l,k)),a):null},b.invert=a.USE_SIMD?b.SIMD.invert:b.scalar.invert,b.scalar.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15];return a[0]=h*(m*r-n*q)-l*(i*r-j*q)+p*(i*n-j*m),a[1]=-(d*(m*r-n*q)-l*(e*r-f*q)+p*(e*n-f*m)),a[2]=d*(i*r-j*q)-h*(e*r-f*q)+p*(e*j-f*i),a[3]=-(d*(i*n-j*m)-h*(e*n-f*m)+l*(e*j-f*i)),a[4]=-(g*(m*r-n*q)-k*(i*r-j*q)+o*(i*n-j*m)),a[5]=c*(m*r-n*q)-k*(e*r-f*q)+o*(e*n-f*m),a[6]=-(c*(i*r-j*q)-g*(e*r-f*q)+o*(e*j-f*i)),a[7]=c*(i*n-j*m)-g*(e*n-f*m)+k*(e*j-f*i),a[8]=g*(l*r-n*p)-k*(h*r-j*p)+o*(h*n-j*l),a[9]=-(c*(l*r-n*p)-k*(d*r-f*p)+o*(d*n-f*l)),a[10]=c*(h*r-j*p)-g*(d*r-f*p)+o*(d*j-f*h),a[11]=-(c*(h*n-j*l)-g*(d*n-f*l)+k*(d*j-f*h)),a[12]=-(g*(l*q-m*p)-k*(h*q-i*p)+o*(h*m-i*l)),a[13]=c*(l*q-m*p)-k*(d*q-e*p)+o*(d*m-e*l),a[14]=-(c*(h*q-i*p)-g*(d*q-e*p)+o*(d*i-e*h)),a[15]=c*(h*m-i*l)-g*(d*m-e*l)+k*(d*i-e*h),a},b.SIMD.adjoint=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;return c=SIMD.Float32x4.load(b,0),d=SIMD.Float32x4.load(b,4),e=SIMD.Float32x4.load(b,8),f=SIMD.Float32x4.load(b,12),k=SIMD.Float32x4.shuffle(c,d,0,1,4,5),h=SIMD.Float32x4.shuffle(e,f,0,1,4,5),g=SIMD.Float32x4.shuffle(k,h,0,2,4,6),h=SIMD.Float32x4.shuffle(h,k,1,3,5,7),k=SIMD.Float32x4.shuffle(c,d,2,3,6,7),j=SIMD.Float32x4.shuffle(e,f,2,3,6,7),i=SIMD.Float32x4.shuffle(k,j,0,2,4,6),j=SIMD.Float32x4.shuffle(j,k,1,3,5,7),k=SIMD.Float32x4.mul(i,j),k=SIMD.Float32x4.swizzle(k,1,0,3,2),l=SIMD.Float32x4.mul(h,k),m=SIMD.Float32x4.mul(g,k),k=SIMD.Float32x4.swizzle(k,2,3,0,1),l=SIMD.Float32x4.sub(SIMD.Float32x4.mul(h,k),l),m=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,k),m),m=SIMD.Float32x4.swizzle(m,2,3,0,1),k=SIMD.Float32x4.mul(h,i),k=SIMD.Float32x4.swizzle(k,1,0,3,2),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(j,k),l),o=SIMD.Float32x4.mul(g,k),k=SIMD.Float32x4.swizzle(k,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(j,k)),o=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,k),o),o=SIMD.Float32x4.swizzle(o,2,3,0,1),k=SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,3,0,1),j),k=SIMD.Float32x4.swizzle(k,1,0,3,2),i=SIMD.Float32x4.swizzle(i,2,3,0,1),l=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,k),l),n=SIMD.Float32x4.mul(g,k),k=SIMD.Float32x4.swizzle(k,2,3,0,1),l=SIMD.Float32x4.sub(l,SIMD.Float32x4.mul(i,k)),n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,k),n),n=SIMD.Float32x4.swizzle(n,2,3,0,1),k=SIMD.Float32x4.mul(g,h),k=SIMD.Float32x4.swizzle(k,1,0,3,2),n=SIMD.Float32x4.add(SIMD.Float32x4.mul(j,k),n),o=SIMD.Float32x4.sub(SIMD.Float32x4.mul(i,k),o),k=SIMD.Float32x4.swizzle(k,2,3,0,1),n=SIMD.Float32x4.sub(SIMD.Float32x4.mul(j,k),n),o=SIMD.Float32x4.sub(o,SIMD.Float32x4.mul(i,k)),k=SIMD.Float32x4.mul(g,j),k=SIMD.Float32x4.swizzle(k,1,0,3,2),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(i,k)),n=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,k),n),k=SIMD.Float32x4.swizzle(k,2,3,0,1),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(i,k),m),n=SIMD.Float32x4.sub(n,SIMD.Float32x4.mul(h,k)),k=SIMD.Float32x4.mul(g,i),k=SIMD.Float32x4.swizzle(k,1,0,3,2),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(j,k),m),o=SIMD.Float32x4.sub(o,SIMD.Float32x4.mul(h,k)),k=SIMD.Float32x4.swizzle(k,2,3,0,1),m=SIMD.Float32x4.sub(m,SIMD.Float32x4.mul(j,k)),o=SIMD.Float32x4.add(SIMD.Float32x4.mul(h,k),o),SIMD.Float32x4.store(a,0,l),SIMD.Float32x4.store(a,4,m),SIMD.Float32x4.store(a,8,n),SIMD.Float32x4.store(a,12,o),a},b.adjoint=a.USE_SIMD?b.SIMD.adjoint:b.scalar.adjoint,b.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=b*g-c*f,s=b*h-d*f,t=b*i-e*f,u=c*h-d*g,v=c*i-e*g,w=d*i-e*h,x=j*o-k*n,y=j*p-l*n,z=j*q-m*n,A=k*p-l*o,B=k*q-m*o,C=l*q-m*p;return r*C-s*B+t*A+u*z-v*y+w*x},b.SIMD.multiply=function(a,b,c){var d=SIMD.Float32x4.load(b,0),e=SIMD.Float32x4.load(b,4),f=SIMD.Float32x4.load(b,8),g=SIMD.Float32x4.load(b,12),h=SIMD.Float32x4.load(c,0),i=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(h,3,3,3,3),g))));SIMD.Float32x4.store(a,0,i);var j=SIMD.Float32x4.load(c,4),k=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(j,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(j,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(j,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(j,3,3,3,3),g))));SIMD.Float32x4.store(a,4,k);var l=SIMD.Float32x4.load(c,8),m=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(l,3,3,3,3),g))));SIMD.Float32x4.store(a,8,m);var n=SIMD.Float32x4.load(c,12),o=SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,0,0,0,0),d),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,1,1,1,1),e),SIMD.Float32x4.add(SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,2,2,2,2),f),SIMD.Float32x4.mul(SIMD.Float32x4.swizzle(n,3,3,3,3),g))));return SIMD.Float32x4.store(a,12,o),a},b.scalar.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a},b.multiply=a.USE_SIMD?b.SIMD.multiply:b.scalar.multiply,b.mul=b.multiply,b.scalar.translate=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=c[0],q=c[1],r=c[2];return b===a?(a[12]=b[0]*p+b[4]*q+b[8]*r+b[12],a[13]=b[1]*p+b[5]*q+b[9]*r+b[13],a[14]=b[2]*p+b[6]*q+b[10]*r+b[14],a[15]=b[3]*p+b[7]*q+b[11]*r+b[15]):(d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=j,a[7]=k,a[8]=l,a[9]=m,a[10]=n,a[11]=o,a[12]=d*p+h*q+l*r+b[12],a[13]=e*p+i*q+m*r+b[13],a[14]=f*p+j*q+n*r+b[14],a[15]=g*p+k*q+o*r+b[15]),a},b.SIMD.translate=function(a,b,c){var d=SIMD.Float32x4.load(b,0),e=SIMD.Float32x4.load(b,4),f=SIMD.Float32x4.load(b,8),g=SIMD.Float32x4.load(b,12),h=SIMD.Float32x4(c[0],c[1],c[2],0);b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11]),d=SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(h,0,0,0,0)),e=SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(h,1,1,1,1)),f=SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(h,2,2,2,2));var i=SIMD.Float32x4.add(d,SIMD.Float32x4.add(e,SIMD.Float32x4.add(f,g)));return SIMD.Float32x4.store(a,12,i),a},b.translate=a.USE_SIMD?b.SIMD.translate:b.scalar.translate,b.scalar.scale=function(a,b,c){var d=c[0],e=c[1],f=c[2];return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=b[7]*e,a[8]=b[8]*f,a[9]=b[9]*f,a[10]=b[10]*f,a[11]=b[11]*f,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},b.SIMD.scale=function(a,b,c){var d,e,f,g=SIMD.Float32x4(c[0],c[1],c[2],0);return d=SIMD.Float32x4.load(b,0),SIMD.Float32x4.store(a,0,SIMD.Float32x4.mul(d,SIMD.Float32x4.swizzle(g,0,0,0,0))),e=SIMD.Float32x4.load(b,4),SIMD.Float32x4.store(a,4,SIMD.Float32x4.mul(e,SIMD.Float32x4.swizzle(g,1,1,1,1))),f=SIMD.Float32x4.load(b,8),SIMD.Float32x4.store(a,8,SIMD.Float32x4.mul(f,SIMD.Float32x4.swizzle(g,2,2,2,2))),a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},b.scale=a.USE_SIMD?b.SIMD.scale:b.scalar.scale,b.rotate=function(b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=e[0],E=e[1],F=e[2],G=Math.sqrt(D*D+E*E+F*F);return Math.abs(G)<a.EPSILON?null:(G=1/G,D*=G,E*=G,F*=G,f=Math.sin(d),g=Math.cos(d),h=1-g,i=c[0],j=c[1],k=c[2],l=c[3],m=c[4],n=c[5],o=c[6],p=c[7],q=c[8],r=c[9],s=c[10],t=c[11],u=D*D*h+g,v=E*D*h+F*f,w=F*D*h-E*f,x=D*E*h-F*f,y=E*E*h+g,z=F*E*h+D*f,A=D*F*h+E*f,B=E*F*h-D*f,C=F*F*h+g,b[0]=i*u+m*v+q*w,b[1]=j*u+n*v+r*w,b[2]=k*u+o*v+s*w,b[3]=l*u+p*v+t*w,b[4]=i*x+m*y+q*z,b[5]=j*x+n*y+r*z,b[6]=k*x+o*y+s*z,b[7]=l*x+p*y+t*z,b[8]=i*A+m*B+q*C,b[9]=j*A+n*B+r*C,b[10]=k*A+o*B+s*C,b[11]=l*A+p*B+t*C,c!==b&&(b[12]=c[12],b[13]=c[13],b[14]=c[14],b[15]=c[15]),b)},b.scalar.rotateX=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*e+j*d,a[5]=g*e+k*d,a[6]=h*e+l*d,a[7]=i*e+m*d,a[8]=j*e-f*d,a[9]=k*e-g*d,a[10]=l*e-h*d,a[11]=m*e-i*d,a},b.SIMD.rotateX=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c)),e=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var f=SIMD.Float32x4.load(b,4),g=SIMD.Float32x4.load(b,8);return SIMD.Float32x4.store(a,4,SIMD.Float32x4.add(SIMD.Float32x4.mul(f,e),SIMD.Float32x4.mul(g,d))),SIMD.Float32x4.store(a,8,SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,e),SIMD.Float32x4.mul(f,d))),a},b.rotateX=a.USE_SIMD?b.SIMD.rotateX:b.scalar.rotateX,b.scalar.rotateY=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e-j*d,a[1]=g*e-k*d,a[2]=h*e-l*d,a[3]=i*e-m*d,a[8]=f*d+j*e,a[9]=g*d+k*e,a[10]=h*d+l*e,a[11]=i*d+m*e,a},b.SIMD.rotateY=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c)),e=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var f=SIMD.Float32x4.load(b,0),g=SIMD.Float32x4.load(b,8);return SIMD.Float32x4.store(a,0,SIMD.Float32x4.sub(SIMD.Float32x4.mul(f,e),SIMD.Float32x4.mul(g,d))),SIMD.Float32x4.store(a,8,SIMD.Float32x4.add(SIMD.Float32x4.mul(f,d),SIMD.Float32x4.mul(g,e))),a},b.rotateY=a.USE_SIMD?b.SIMD.rotateY:b.scalar.rotateY,b.scalar.rotateZ=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e+j*d,a[1]=g*e+k*d,a[2]=h*e+l*d,a[3]=i*e+m*d,a[4]=j*e-f*d,a[5]=k*e-g*d,a[6]=l*e-h*d,a[7]=m*e-i*d,a},b.SIMD.rotateZ=function(a,b,c){var d=SIMD.Float32x4.splat(Math.sin(c)),e=SIMD.Float32x4.splat(Math.cos(c));b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]);var f=SIMD.Float32x4.load(b,0),g=SIMD.Float32x4.load(b,4);return SIMD.Float32x4.store(a,0,SIMD.Float32x4.add(SIMD.Float32x4.mul(f,e),SIMD.Float32x4.mul(g,d))),SIMD.Float32x4.store(a,4,SIMD.Float32x4.sub(SIMD.Float32x4.mul(g,e),SIMD.Float32x4.mul(f,d))),a},b.rotateZ=a.USE_SIMD?b.SIMD.rotateZ:b.scalar.rotateZ,b.fromTranslation=function(a,b){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=b[0],a[13]=b[1],a[14]=b[2],a[15]=1,a},b.fromScaling=function(a,b){return a[0]=b[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=b[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=b[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},b.fromRotation=function(b,c,d){var e,f,g,h=d[0],i=d[1],j=d[2],k=Math.sqrt(h*h+i*i+j*j);return Math.abs(k)<a.EPSILON?null:(k=1/k,h*=k,i*=k,j*=k,e=Math.sin(c),f=Math.cos(c),g=1-f,b[0]=h*h*g+f,b[1]=i*h*g+j*e,b[2]=j*h*g-i*e,b[3]=0,b[4]=h*i*g-j*e,b[5]=i*i*g+f,b[6]=j*i*g+h*e,b[7]=0,b[8]=h*j*g+i*e,b[9]=i*j*g-h*e,b[10]=j*j*g+f,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b)},b.fromXRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=d,a[6]=c,a[7]=0,a[8]=0,a[9]=-c,a[10]=d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},b.fromYRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=0,a[2]=-c,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=c,a[9]=0,a[10]=d,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},b.fromZRotation=function(a,b){var c=Math.sin(b),d=Math.cos(b);return a[0]=d,a[1]=c,a[2]=0,a[3]=0,a[4]=-c,a[5]=d,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},b.fromRotationTranslation=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=d+d,i=e+e,j=f+f,k=d*h,l=d*i,m=d*j,n=e*i,o=e*j,p=f*j,q=g*h,r=g*i,s=g*j;return a[0]=1-(n+p),a[1]=l+s,a[2]=m-r,a[3]=0,a[4]=l-s,a[5]=1-(k+p),a[6]=o+q,a[7]=0,a[8]=m+r,a[9]=o-q,a[10]=1-(k+n),a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a},b.getTranslation=function(a,b){return a[0]=b[12],a[1]=b[13],a[2]=b[14],a},b.getRotation=function(a,b){var c=b[0]+b[5]+b[10],d=0;return c>0?(d=2*Math.sqrt(c+1),a[3]=.25*d,a[0]=(b[6]-b[9])/d,a[1]=(b[8]-b[2])/d,a[2]=(b[1]-b[4])/d):b[0]>b[5]&b[0]>b[10]?(d=2*Math.sqrt(1+b[0]-b[5]-b[10]),a[3]=(b[6]-b[9])/d,a[0]=.25*d,a[1]=(b[1]+b[4])/d,a[2]=(b[8]+b[2])/d):b[5]>b[10]?(d=2*Math.sqrt(1+b[5]-b[0]-b[10]),a[3]=(b[8]-b[2])/d,a[0]=(b[1]+b[4])/d,a[1]=.25*d,a[2]=(b[6]+b[9])/d):(d=2*Math.sqrt(1+b[10]-b[0]-b[5]),a[3]=(b[1]-b[4])/d,a[0]=(b[8]+b[2])/d,a[1]=(b[6]+b[9])/d,a[2]=.25*d),a},b.fromRotationTranslationScale=function(a,b,c,d){var e=b[0],f=b[1],g=b[2],h=b[3],i=e+e,j=f+f,k=g+g,l=e*i,m=e*j,n=e*k,o=f*j,p=f*k,q=g*k,r=h*i,s=h*j,t=h*k,u=d[0],v=d[1],w=d[2];return a[0]=(1-(o+q))*u,a[1]=(m+t)*u,a[2]=(n-s)*u,a[3]=0,a[4]=(m-t)*v,a[5]=(1-(l+q))*v,a[6]=(p+r)*v,a[7]=0,a[8]=(n+s)*w,a[9]=(p-r)*w,a[10]=(1-(l+o))*w,a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a},b.fromRotationTranslationScaleOrigin=function(a,b,c,d,e){var f=b[0],g=b[1],h=b[2],i=b[3],j=f+f,k=g+g,l=h+h,m=f*j,n=f*k,o=f*l,p=g*k,q=g*l,r=h*l,s=i*j,t=i*k,u=i*l,v=d[0],w=d[1],x=d[2],y=e[0],z=e[1],A=e[2];return a[0]=(1-(p+r))*v,a[1]=(n+u)*v,a[2]=(o-t)*v,a[3]=0,a[4]=(n-u)*w,a[5]=(1-(m+r))*w,a[6]=(q+s)*w,a[7]=0,a[8]=(o+t)*x,a[9]=(q-s)*x,a[10]=(1-(m+p))*x,a[11]=0,a[12]=c[0]+y-(a[0]*y+a[4]*z+a[8]*A),a[13]=c[1]+z-(a[1]*y+a[5]*z+a[9]*A),a[14]=c[2]+A-(a[2]*y+a[6]*z+a[10]*A),a[15]=1,a},b.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,i=e+e,j=c*g,k=d*g,l=d*h,m=e*g,n=e*h,o=e*i,p=f*g,q=f*h,r=f*i;return a[0]=1-l-o,a[1]=k+r,a[2]=m-q,a[3]=0,a[4]=k-r,a[5]=1-j-o,a[6]=n+p,a[7]=0,a[8]=m+q,a[9]=n-p,a[10]=1-j-l,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},b.frustum=function(a,b,c,d,e,f,g){var h=1/(c-b),i=1/(e-d),j=1/(f-g);return a[0]=2*f*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*f*i,a[6]=0,a[7]=0,a[8]=(c+b)*h,a[9]=(e+d)*i,a[10]=(g+f)*j,a[11]=-1,a[12]=0,a[13]=0,a[14]=g*f*2*j,a[15]=0,a},b.perspective=function(a,b,c,d,e){var f=1/Math.tan(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a},b.perspectiveFromFieldOfView=function(a,b,c,d){var e=Math.tan(b.upDegrees*Math.PI/180),f=Math.tan(b.downDegrees*Math.PI/180),g=Math.tan(b.leftDegrees*Math.PI/180),h=Math.tan(b.rightDegrees*Math.PI/180),i=2/(g+h),j=2/(e+f);return a[0]=i,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=j,a[6]=0,a[7]=0,a[8]=-((g-h)*i*.5),a[9]=(e-f)*j*.5,a[10]=d/(c-d),a[11]=-1,a[12]=0,a[13]=0,a[14]=d*c/(c-d),a[15]=0,a},b.ortho=function(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a},b.lookAt=function(c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q=d[0],r=d[1],s=d[2],t=f[0],u=f[1],v=f[2],w=e[0],x=e[1],y=e[2];return Math.abs(q-w)<a.EPSILON&&Math.abs(r-x)<a.EPSILON&&Math.abs(s-y)<a.EPSILON?b.identity(c):(m=q-w,n=r-x,o=s-y,p=1/Math.sqrt(m*m+n*n+o*o),m*=p,n*=p,o*=p,g=u*o-v*n,h=v*m-t*o,i=t*n-u*m,p=Math.sqrt(g*g+h*h+i*i),p?(p=1/p,g*=p,h*=p,i*=p):(g=0,h=0,i=0),j=n*i-o*h,k=o*g-m*i,l=m*h-n*g,p=Math.sqrt(j*j+k*k+l*l),p?(p=1/p,j*=p,k*=p,l*=p):(j=0,k=0,l=0),c[0]=g,c[1]=j,c[2]=m,c[3]=0,c[4]=h,c[5]=k,c[6]=n,c[7]=0,c[8]=i,c[9]=l,c[10]=o,c[11]=0,c[12]=-(g*q+h*r+i*s),c[13]=-(j*q+k*r+l*s),c[14]=-(m*q+n*r+o*s),c[15]=1,c)},b.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"},b.frob=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))},b.add=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a[3]=b[3]+c[3],a[4]=b[4]+c[4],a[5]=b[5]+c[5],a[6]=b[6]+c[6],a[7]=b[7]+c[7],a[8]=b[8]+c[8],a[9]=b[9]+c[9],a[10]=b[10]+c[10],a[11]=b[11]+c[11],a[12]=b[12]+c[12],a[13]=b[13]+c[13],a[14]=b[14]+c[14],a[15]=b[15]+c[15],a},b.subtract=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a[3]=b[3]-c[3],a[4]=b[4]-c[4],a[5]=b[5]-c[5],a[6]=b[6]-c[6],a[7]=b[7]-c[7],a[8]=b[8]-c[8],a[9]=b[9]-c[9],a[10]=b[10]-c[10],a[11]=b[11]-c[11],a[12]=b[12]-c[12],a[13]=b[13]-c[13],a[14]=b[14]-c[14],a[15]=b[15]-c[15],a},b.sub=b.subtract,b.multiplyScalar=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a[4]=b[4]*c,a[5]=b[5]*c,a[6]=b[6]*c,a[7]=b[7]*c,a[8]=b[8]*c,a[9]=b[9]*c,a[10]=b[10]*c,a[11]=b[11]*c,a[12]=b[12]*c,a[13]=b[13]*c,a[14]=b[14]*c,a[15]=b[15]*c,a},b.multiplyScalarAndAdd=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a[3]=b[3]+c[3]*d,a[4]=b[4]+c[4]*d,a[5]=b[5]+c[5]*d,a[6]=b[6]+c[6]*d,a[7]=b[7]+c[7]*d,a[8]=b[8]+c[8]*d,a[9]=b[9]+c[9]*d,a[10]=b[10]+c[10]*d,a[11]=b[11]+c[11]*d,a[12]=b[12]+c[12]*d,a[13]=b[13]+c[13]*d,a[14]=b[14]+c[14]*d,a[15]=b[15]+c[15]*d,a},b.exactEquals=function(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]},b.equals=function(b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3],x=c[4],y=c[5],z=c[6],A=c[7],B=c[8],C=c[9],D=c[10],E=c[11],F=c[12],G=c[13],H=c[14],I=c[15];return Math.abs(d-t)<=a.EPSILON*Math.max(1,Math.abs(d),Math.abs(t))&&Math.abs(e-u)<=a.EPSILON*Math.max(1,Math.abs(e),Math.abs(u))&&Math.abs(f-v)<=a.EPSILON*Math.max(1,Math.abs(f),Math.abs(v))&&Math.abs(g-w)<=a.EPSILON*Math.max(1,Math.abs(g),Math.abs(w))&&Math.abs(h-x)<=a.EPSILON*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(i-y)<=a.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(j-z)<=a.EPSILON*Math.max(1,Math.abs(j),Math.abs(z))&&Math.abs(k-A)<=a.EPSILON*Math.max(1,Math.abs(k),Math.abs(A))&&Math.abs(l-B)<=a.EPSILON*Math.max(1,Math.abs(l),Math.abs(B))&&Math.abs(m-C)<=a.EPSILON*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(n-D)<=a.EPSILON*Math.max(1,Math.abs(n),Math.abs(D))&&Math.abs(o-E)<=a.EPSILON*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(p-F)<=a.EPSILON*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(q-G)<=a.EPSILON*Math.max(1,Math.abs(q),Math.abs(G))&&Math.abs(r-H)<=a.EPSILON*Math.max(1,Math.abs(r),Math.abs(H))&&Math.abs(s-I)<=a.EPSILON*Math.max(1,Math.abs(s),Math.abs(I))},b});