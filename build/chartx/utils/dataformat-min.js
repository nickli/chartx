define("chartx/utils/dataformat",["chartx/utils/tools"],function(a){return function(b,c){function d(a){for(var b={},c=f.data,d=0,e=c.length;e>d;d++)c[d]&&(b[c[d].field]=c[d].data[a]);return b}function e(a){var b;return _.each(f.data,function(c){c.field==a&&(b=c)}),b.data}var f={org:[],data:[],yAxis:{field:null,org:[]},xAxis:{field:[],org:[]},rAxis:{field:[],org:[]},getRowData:d,getFieldData:e};if(!b||0==b.length)return f;b.length>0&&!_.isArray(b[0])&&(b=a.parse2MatrixData(b));var g=b;f.org=g;var h=g[0]?g[0]:[];c?(c.yAxis&&(f.yAxis.field=c.yAxis.field),c.xAxis&&(f.xAxis.field=c.xAxis.field),c.rAxis&&(f.rAxis.field=c.rAxis.field)):(this.yAxis&&(f.yAxis.field=this.yAxis.field),this.xAxis&&(f.xAxis.field=this.xAxis.field),this.rAxis&&(f.rAxis.field=this.rAxis.field));for(var i=[],j=0,k=h.length;k>j;j++){var l={};l.field=h[j],l.index=j,l.data=[],i.push(l)}f.data=i;var m=function(a,b,c){for(var d=b,e=[],f=0,g=a.length;g>f;f++){var h=!1;if(_.isArray(a[f]))e.push(m(a[f],b,c));else{for(var i=0,j=d.length;j>i;i++)if(a[f]==d[i].field){h=!0,e.push(d[i].data);break}h||(a.splice(f,1),f--,g--)}}return e},n=f.xAxis.field;n&&""!=n&&(!_.isArray(n)||0!=n.length&&_.find(i,function(a){return _.indexOf(n,a.field)>=0?!0:!1}))?_.isString(n)&&(n=[n]):n=f.xAxis.field=[i[0].field];var o=f.yAxis.field;""==o||_.isArray(o)&&0==o.length?o=[]:o?_.isString(o)&&(o=[o]):o=_.difference(h,n),f.yAxis.field=o;for(var p=_.flatten(f.yAxis.field),j=1,k=g.length;k>j;j++)for(var q=0,r=g[j].length;r>q;q++){var s=g[j][q];s&&_.indexOf(p,g[0][q])>=0&&(s=isNaN(Number(s))?s:Number(s)),i[q].data.push(s)}f.xAxis.org=m(n,i),f.yAxis.org=m(o,i,"yAxis");var t=f.rAxis.field;_.isString(t)&&(t=[t]),f.rAxis.field=t;var u=_.flatten(f.rAxis.field);return u.length>0&&(f.rAxis.org=m(t,i)),f}});