define("layout/hierarchy",["./utils/rebind","./utils/arrays"],function(e,n,u){"use strict";n.__esModule=!0;var r=e("./utils/rebind"),l=e("./utils/arrays"),t=function(){var e=o,n=i,u=c;function r(l){var t,i=[l],c=[];for(l.depth=0;null!=(t=i.pop());)if(c.push(t),(v=n.call(r,t,t.depth))&&(o=v.length)){for(var o,v,f;--o>=0;)i.push(f=v[o]),f.parent=t,f.depth=t.depth+1;var h=+u.call(r,t,t.depth);h&&!isNaN(h)&&(t._value=h),u&&(t.value=0),t.children=v}else u&&(t.value=+u.call(r,t,t.depth)||0),delete t.children;return a(l,function(n){var r,l;e&&(r=n.children)&&r.sort(e),u&&(l=n.parent)&&(l.value+=n.value),n._value&&n._value>n.value&&(n.value=n._value),delete n._value}),c}return r.sort=function(n){return arguments.length?(e=n,r):e},r.children=function(e){return arguments.length?(n=e,r):n},r.value=function(e){return arguments.length?(u=e,r):u},r.revalue=function(e){return u&&(!function(e,n){var u=[e];for(;null!=(e=u.pop());)if(n(e),(l=e.children)&&(r=l.length))for(var r,l;--r>=0;)u.push(l[r])}(e,function(e){e.children&&(e.value=0)}),a(e,function(e){var n;e.children||(e.value=+u.call(r,e,e.depth)||0),(n=e.parent)&&(n.value+=e.value),e._value&&e._value>e.value&&(e.value=e._value),delete e._value})),e},r};function a(e,n){for(var u=[e],r=[];null!=(e=u.pop());)if(r.push(e),(t=e.children)&&(l=t.length))for(var l,t,a=-1;++a<l;)u.push(t[a]);for(;null!=(e=r.pop());)n(e)}function i(e){return e.children}function c(e){return e.value}function o(e,n){return n.value-e.value}function v(e){return l.default.merge(e.map(function(e){return(e.children||[]).map(function(n){return{source:e,target:n}})}))}t.layout_hierarchyRebind=function(e,n){return r.default(e,n,"sort","children","value"),e.nodes=e,e.links=v,e},n.default=t});