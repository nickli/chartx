var canvax=function(m){"use strict";var o=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")};function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t};function t(t,e){return t(e={exports:{}},e.exports),e.exports}var u=t(function(e){function i(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=i=function(t){return typeof t}:e.exports=i=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}e.exports=i});var s=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t};var h=function(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?s(t):e},c=t(function(e){function i(t){return e.exports=i=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},i(t)}e.exports=i}),i=t(function(i){function n(t,e){return i.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(t,e)}i.exports=n});var f=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i(t,e)},d={mainFrameRate:60,now:0,_pixelCtx:null,__emptyFunc:function(){},_devicePixelRatio:"undefined"!=typeof window?window.devicePixelRatio:1,_UID:0,getUID:function(){return this._UID++},createId:function(t){var e=t.charCodeAt(t.length-1);return 48<=e&&e<=57&&(t+="_"),t+d.getUID()},canvasSupport:function(){return!!document.createElement("canvas").getContext},initElement:function(t){return window.FlashCanvas&&FlashCanvas.initElement&&FlashCanvas.initElement(t),t},getCssOrderArr:function(t){var e,i,n,r;return"number"==typeof t?e=i=n=r=t:t instanceof Array?1===t.length?e=i=n=r=t[0]:2===t.length?(e=n=t[0],i=r=t[1]):3===t.length?(e=t[0],i=r=t[1],n=t[2]):(e=t[0],i=t[1],n=t[2],r=t[3]):e=i=n=r=0,[e,i,n,r]},isWebGLSupported:function(){var t={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var e=document.createElement("canvas"),i=e.getContext("webgl",t)||e.getContext("experimental-webgl",t);return!(!i||!i.getContextAttributes().stencil)}catch(t){return!1}},checkOpt:function(t){return t?t.context||(t.context={}):t={context:{}},t}};d._pixelCtx=d.initElement(m.$.createCanvas(1,1,"_pixelCanvas")).getContext("2d");function p(t,e,i,n,r,a){this.a=null!=t?t:1,this.b=null!=e?e:0,this.c=null!=i?i:0,this.d=null!=n?n:1,this.tx=null!=r?r:0,this.ty=null!=a?a:0,this.array=null}p.prototype={concat:function(t){var e=this.a,i=this.c,n=this.tx;return this.a=e*t.a+this.b*t.c,this.b=e*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d,this.tx=n*t.a+this.ty*t.c+t.tx,this.ty=n*t.b+this.ty*t.d+t.ty,this},concatTransform:function(t,e,i,n,r){var a=1,s=0;if(r%360){var h=r*Math.PI/180;a=Math.cos(h),s=Math.sin(h)}return this.concat(new p(a*i,s*i,-s*n,a*n,t,e)),this},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a,r=this.c,a=this.tx;if(0<t)this.a=n*e-this.b*i,this.b=n*i+this.b*e,this.c=r*e-this.d*i,this.d=r*i+this.d*e,this.tx=a*e-this.ty*i,this.ty=a*i+this.ty*e;else{var s=Math.sin(Math.abs(t)),h=Math.cos(Math.abs(t));this.a=n*h+this.b*s,this.b=-n*s+this.b*h,this.c=r*h+this.d*s,this.d=-r*s+h*this.d,this.tx=h*a+s*this.ty,this.ty=h*this.ty-s*a}return this},scale:function(t,e){return this.a*=t,this.d*=e,this.tx*=t,this.ty*=e,this},translate:function(t,e){return this.tx+=t,this.ty+=e,this},identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},invert:function(){var t=this.a,e=this.b,i=this.c,n=this.d,r=this.tx,a=t*n-e*i;return this.a=n/a,this.b=-e/a,this.c=-i/a,this.d=t/a,this.tx=(i*this.ty-n*r)/a,this.ty=-(t*this.ty-e*r)/a,this},clone:function(){return new p(this.a,this.b,this.c,this.d,this.tx,this.ty)},toArray:function(t,e){if(0==arguments.length)return isNaN(this.a)||isNaN(this.b)||isNaN(this.c)||isNaN(this.d)||isNaN(this.tx)||isNaN(this.ty)?null:[this.a,this.b,this.c,this.d,this.tx,this.ty];this.array||(this.array=new Float32Array(9));var i=e||this.array;return t?(i[0]=this.a,i[1]=this.b,i[2]=0,i[3]=this.c,i[4]=this.d,i[5]=0,i[6]=this.tx,i[7]=this.ty):(i[0]=this.a,i[1]=this.c,i[2]=this.tx,i[3]=this.b,i[4]=this.d,i[5]=this.ty,i[6]=0,i[7]=0),i[8]=1,i},mulVector:function(t){var e=this.a,i=this.c,n=this.tx,r=this.b,a=this.d,s=this.ty,h=[0,0];return h[0]=t[0]*e+t[1]*i+n,h[1]=t[0]*r+t[1]*a+s,h}};var e,r,v=function(){function a(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;if(o(this,a),1==arguments.length&&"object"==u(arguments[0])){var i=arguments[0];if("x"in i&&"y"in i)this.x=1*i.x,this.y=1*i.y;else{var n=0;for(var r in i){if(0!=n){this.y=1*i[r];break}this.x=1*i[r],n++}}}else this.x=1*t,this.y=1*e}return l(a,[{key:"toArray",value:function(){return[this.x,this.y]}}]),a}(),a=t(function(t,e){function i(){this._tweens={},this._tweensAddedDuringUpdate={}}i.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,e){var i=Object.keys(this._tweens);if(0===i.length)return!1;for(t=void 0!==t?t:h.now();0<i.length;){this._tweensAddedDuringUpdate={};for(var n=0;n<i.length;n++){var r=this._tweens[i[n]];r&&!1===r.update(t)&&(r._isPlaying=!1,e||delete this._tweens[i[n]])}i=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var n,h=new i;h.Group=i,h._nextId=0,h.nextId=function(){return h._nextId++},"undefined"==typeof window&&"undefined"!=typeof process?h.now=function(){var t=process.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?h.now=window.performance.now.bind(window.performance):void 0!==Date.now?h.now=Date.now:h.now=function(){return(new Date).getTime()},h.Tween=function(t,e){this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=h.Easing.Linear.None,this._interpolationFunction=h.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||h,this._id=h.nextId()},h.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(t,e){return this._valuesEnd=t,void 0!==e&&(this._duration=e),this},start:function(t){for(var e in this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==t?"string"==typeof t?h.now()+parseFloat(t):t:h.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(this._valuesStart[e]=this._object[e],this._valuesStart[e]instanceof Array==!1&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying&&(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens()),this},end:function(){return this.update(this._startTime+this._duration),this},stopChainedTweens:function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop()},group:function(t){return this._group=t,this},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var e,i,n;if(t<this._startTime)return!0;for(e in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),i=(t-this._startTime)/this._duration,i=0===this._duration||1<i?1:i,n=this._easingFunction(i),this._valuesEnd)if(void 0!==this._valuesStart[e]){var r=this._valuesStart[e]||0,a=this._valuesEnd[e];a instanceof Array?this._object[e]=this._interpolationFunction(a,n):("string"==typeof a&&(a="+"===a.charAt(0)||"-"===a.charAt(0)?r+parseFloat(a):parseFloat(a)),"number"==typeof a&&(this._object[e]=r+(a-r)*n))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object),1!==i)return!0;if(0<this._repeat){for(e in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var s=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=s}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var h=0,o=this._chainedTweens.length;h<o;h++)this._chainedTweens[h].start(this._startTime+this._duration);return!1}},h.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1}},Back:{In:function(t){return t*t*(2.70158*t-1.70158)},Out:function(t){return--t*t*(2.70158*t+1.70158)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((1+e)*t-e)*.5:.5*((t-=2)*t*((1+e)*t+e)+2)}},Bounce:{In:function(t){return 1-h.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*h.Easing.Bounce.In(2*t):.5*h.Easing.Bounce.Out(2*t-1)+.5}}},h.Interpolation={Linear:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n),a=h.Interpolation.Utils.Linear;return e<0?a(t[0],t[1],n):1<e?a(t[i],t[i-1],i-n):a(t[r],t[i<r+1?i:r+1],n-r)},Bezier:function(t,e){for(var i=0,n=t.length-1,r=Math.pow,a=h.Interpolation.Utils.Bernstein,s=0;s<=n;s++)i+=r(1-e,n-s)*r(e,s)*t[s]*a(n,s);return i},CatmullRom:function(t,e){var i=t.length-1,n=i*e,r=Math.floor(n),a=h.Interpolation.Utils.CatmullRom;return t[0]===t[i]?(e<0&&(r=Math.floor(n=i*(1+e))),a(t[(r-1+i)%i],t[r],t[(r+1)%i],t[(r+2)%i],n-r)):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-n)-t[0]):1<e?t[i]-(a(t[i],t[i],t[i-1],t[i-1],n-i)-t[i]):a(t[r?r-1:0],t[r],t[i<r+1?i:r+1],t[i<r+2?i:r+2],n-r)},Utils:{Linear:function(t,e,i){return(e-t)*i+t},Bernstein:function(t,e){var i=h.Interpolation.Utils.Factorial;return i(t)/i(e)/i(t-e)},Factorial:(n=[1],function(t){var e=1;if(n[t])return n[t];for(var i=t;1<i;i--)e*=i;return n[t]=e}),CatmullRom:function(t,e,i,n,r){var a=.5*(i-t),s=.5*(n-e),h=r*r;return(2*e-2*i+a+s)*(r*h)+(-3*e+3*i-2*a-s)*h+a*r+e}}},t.exports=h}),g=0;if("undefined"!=typeof window){e=window.requestAnimationFrame,r=window.cancelAnimationFrame;for(var y=["ms","moz","webkit","o"],_=0;_<y.length&&!window.requestAnimationFrame;++_)e=window.requestAnimationFrame=window[y[_]+"RequestAnimationFrame"],r=window.cancelAnimationFrame=window[y[_]+"CancelAnimationFrame"]||window[y[_]+"CancelRequestAnimationFrame"]}e=e||function(t){var e=(new Date).getTime(),i=Math.max(0,16-(e-g)),n=setTimeout(function(){t(e+i)},i);return g=e+i,n},r=r||function(t){clearTimeout(t)};var x=[],w=null;function k(t){if(t)return x.push(t),w=w||e(function(){a.update();var t=x;for(x=[],w=null;0<t.length;)t.shift().task()})}function b(t){for(var e=!1,i=0,n=x.length;i<n;i++)x[i].id===t.id&&(e=!0,x.splice(i,1),i--,n--);return 0==x.length&&(r(w),w=null),e}var T={registFrame:k,destroyFrame:b,registTween:function(t){var e=m._.extend({from:null,to:null,duration:500,onStart:function(){},onUpdate:function(){},onComplete:function(){},onStop:function(){},repeat:0,delay:0,easing:"Linear.None",desc:""},t);m.global.getAnimationEnabled()||(e.duration=0,e.delay=0);var i={},n="tween_"+d.getUID();if(e.id&&(n=n+"_"+e.id),e.from&&e.to){(i=new a.Tween(e.from).to(e.to,e.duration).onStart(function(){e.onStart(e.from)}).onUpdate(function(){e.onUpdate(e.from)}).onComplete(function(){b({id:n}),i._isCompleteed=!0,e.onComplete(e.from)}).onStop(function(){b({id:n}),i._isStoped=!0,e.onStop(e.from)}).repeat(e.repeat).delay(e.delay).easing(a.Easing[e.easing.split(".")[0]][e.easing.split(".")[1]])).id=n,i.start(),function t(){i._isCompleteed||i._isStoped?i=null:k({id:n,task:t,desc:e.desc,tween:i})}()}return i},destroyTween:function(t,e){t.stop()},Tween:a,taskList:x};var C=Object.defineProperty;try{C({},"_",{value:"x"});var S=Object.defineProperties}catch(t){"__defineGetter__"in Object&&(C=function(t,e,i){return"value"in i&&(t[e]=i.value),"get"in i&&t.__defineGetter__(e,i.get),"set"in i&&t.__defineSetter__(e,i.set),t},S=function(t,e){for(var i in e)e.hasOwnProperty(i)&&C(t,i,e[i]);return t})}var P=0,A=2,I={POLY:0,RECT:1,CIRC:2,ELIP:3},M=["x","y","scaleX","scaleY","rotation","scaleOrigin","rotateOrigin"],O=["lineWidth","strokeAlpha","strokeStyle","fillStyle","fillAlpha","globalAlpha"],L=function(t,e,i,n){var r=t[0],a=t[1],s=t[2],h=t[3],o=Math.max(n,3),l=0,c=r;return!(a+o<i&&h+o<i||i<a-o&&i<h-o||r+o<e&&s+o<e||e<r-o&&e<s-o)&&(r===s?Math.abs(e-r)<=o/2:((l=(a-h)/(r-s))*e-i+(c=(r*h-s*a)/(r-s)))*(l*e-i+c)/(l*l+1)<=o/2*o/2)};function D(t,e,i){for(var n=t.shape.points,r=t.lineWidth,a=!1,s=0;s<n.length&&!(a=L(n.slice(s,s+4),e,i,r));++s)s+=1;return a}var R={RESOLUTION:"undefined"!=typeof window?window.devicePixelRatio:1,TARGET_FPMS:.06,MIPMAP_TEXTURES:!0,FILTER_RESOLUTION:1,SPRITE_BATCH_SIZE:4096,RETINA_PREFIX:/@(.+)x/,RENDER_OPTIONS:{view:null,antialias:!0,forceFXAA:!1,autoResize:!1,transparent:!0,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},TRANSFORM_MODE:0,GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:0,SCALE_MODE:0,PRECISION:"mediump"},E=function(t){function n(t){var e;o(this,n),(e=h(this,c(n).call(this,t)))._transform=null,e.worldTransform=null,e._transformChange=!1,e._heartBeatNum=0,e.stage=null,e.parent=null,e.xyToInt=!("xyToInt"in t)||t.xyToInt,e.moveing=!1,e.clip=null,e.context=e._createContext(t),e.type=t.type||"DisplayObject",e.id=t.id||d.createId(e.type),e._trackList=[],e.init.apply(s(e),arguments),e._updateTransform(),e._tweens=[];var i=s(e);return e.on("destroy",function(){i.cleanAnimates()}),e}return f(n,t),l(n,[{key:"init",value:function(){}},{key:"clipTo",value:function(t){(this.clip=t).isClip=!0}},{key:"_createContext",value:function(t){var r=this,e=t.context||{},i={width:e.width||0,height:e.height||0,x:e.x||0,y:e.y||0,scaleX:e.scaleX||1,scaleY:e.scaleY||1,scaleOrigin:e.scaleOrigin||{x:0,y:0},rotation:e.rotation||0,rotateOrigin:e.rotateOrigin||{x:0,y:0},visible:e.visible||!0,globalAlpha:e.globalAlpha||1};return m._.extend(!0,i,t.context),r._notWatch=!1,r._noHeart=!1,i.$watch=function(t,e,i){var n=r;n.context&&("globalGalpha"==t&&(n._globalAlphaChange=!0),-1<m._.indexOf(M,t)&&(n._updateTransform(),n._transformChange=!0),n._notWatch||(n.$watch&&(n._notWatch=!0,n.$watch(t,e,i),n._notWatch=!1),n._noHeart||n.heartBeat({convertType:"context",shape:n,name:t,value:e,preValue:i})))},function h(e){var o=!0,l={},i={},n=["$watch","$model"],c={},r=n;function t(a,t){-1===m._.indexOf(n,a)&&(c[a]=t);var s=u(t);if(!(-1<m._.indexOf(r,a)))if("function"===s)r.push(a);else{var e=function(t){var e,i=c[a],n=i;if(!arguments.length)return!i||"object"!==s||i instanceof Array||i.$model||i.addColorStop||((i=h(i)).$watch=l.$watch,c[a]=i),i;var r=u(t);o||i!==t&&(!t||"object"!==r||t instanceof Array||t.addColorStop?i=t:e=(i=t.$model?t:h(t)).$model,c[a]=e||i,s!=r&&(s=r),l.$watch&&l.$watch.call(l,a,i,n))};i[a]={set:e,get:e,enumerable:!0}}}for(var a in e)t(a,e[a]);return l=S(l,i,r),m._.forEach(r,function(t){e[t]&&("function"==typeof e[t]?l[t]=function(){e[t].apply(this,arguments)}:l[t]=e[t])}),l.$model=c,l.hasOwnProperty=function(t){return t in l.$model},o=!1,l}(i)}},{key:"track",value:function(t){-1==m._.indexOf(this._trackList,t)&&this._trackList.push(t)}},{key:"untrack",value:function(t){var e=m._.indexOf(this._trackList,t);-1<e&&this._trackList.splice(e,1)}},{key:"clone",value:function(t){var e,i={id:this.id,context:m._.clone(this.context.$model),isClone:!0};return(e="text"==this.type?new this.constructor(this.text,i):new this.constructor(i)).id=i.id,this.children&&(e.children=this.children),this.graphics&&(e.graphics=this.graphics.clone()),t||(e.id=d.createId(e.type)),e}},{key:"heartBeat",value:function(t){var e=this.getStage();e&&(this._heartBeatNum++,e.heartBeat&&e.heartBeat(t))}},{key:"getCurrentWidth",value:function(){return Math.abs(this.context.$model.width*this.context.$model.scaleX)}},{key:"getCurrentHeight",value:function(){return Math.abs(this.context.$model.height*this.context.$model.scaleY)}},{key:"getStage",value:function(){if(this.stage)return this.stage;var t=this;if("stage"!=t.type){for(;t.parent&&"stage"!=(t=t.parent).type;);if("stage"!==t.type)return!1}return this.stage=t}},{key:"localToGlobal",value:function(t,e){t=t||new v(0,0);var i=this.getConcatenatedMatrix(e);if(null==i)return v(0,0);var n=new p(1,0,0,1,t.x,t.y);return n.concat(i),new v(n.tx,n.ty)}},{key:"globalToLocal",value:function(t,e){if(t=t||new v(0,0),"stage"==this.type)return t;var i=this.getConcatenatedMatrix(e);if(null==i)return new v(0,0);i.invert();var n=new p(1,0,0,1,t.x,t.y);return n.concat(i),new v(n.tx,n.ty)}},{key:"localToTarget",value:function(t,e){var i=localToGlobal(t);return e.globalToLocal(i)}},{key:"getConcatenatedMatrix",value:function(t){for(var e=new p,i=this;null!=i;i=i.parent)if(e.concat(i._transform),!i.parent||t&&i.parent&&i.parent==t||i.parent&&"stage"==i.parent.type)return e;return e}},{key:"setEventEnable",value:function(t){return!!m._.isBoolean(t)&&(this._eventEnabled=t,!0)}},{key:"getIndex",value:function(){if(this.parent)return m._.indexOf(this.parent.children,this)}},{key:"toBack",value:function(t){if(this.parent){var e=this.getIndex(),i=0;if(m._.isNumber(t)){if(0==t)return;i=e-t}var n=this.parent.children.splice(e,1)[0];i<0&&(i=0),this.parent.addChildAt(n,i)}}},{key:"toFront",value:function(t){if(this.parent){var e=this.getIndex(),i=this.parent.children.length,n=i;if(m._.isNumber(t)){if(0==t)return;n=e+t+1}var r=this.parent.children.splice(e,1)[0];i<n&&(n=i),this.parent.addChildAt(r,n-1)}}},{key:"_updateTransform",value:function(){var t=new p;t.identity();var e=this.context;if(1!==e.scaleX||1!==e.scaleY){var i=new v(e.scaleOrigin);t.translate(-i.x,-i.y),t.scale(e.scaleX,e.scaleY),t.translate(i.x,i.y)}var n=e.rotation;if(n){i=new v(e.rotateOrigin);t.translate(-i.x,-i.y),t.rotate(n%360*Math.PI/180),t.translate(i.x,i.y)}if(this.xyToInt&&!this.moveing){var r=parseInt(e.x),a=parseInt(e.y);parseInt(e.lineWidth,10)%2==1&&e.strokeStyle&&(r+=.5,a+=.5)}else r=e.x,a=e.y;return 0==r&&0==a||t.translate(r,a),this._transform=t}},{key:"setWorldTransform",value:function(){var t=new p;return t.concat(this._transform),this.parent&&t.concat(this.parent.worldTransform),this.worldTransform=t,this.worldTransform}},{key:"getChildInPoint",value:function(t){var e=!1,i=t.x,n=t.y;if(this.worldTransform){var r=this.worldTransform.clone().invert(),a=[i*R.RESOLUTION,n*R.RESOLUTION];i=(a=r.mulVector(a))[0],n=a[1]}if(this.graphics&&(e=this.containsPoint({x:i,y:n})),"text"!=this.type)return e;var s=this.getRect();return!(!s.width||!s.height)&&(e=i>=s.x&&i<=s.x+s.width&&(0<=s.height&&n>=s.y&&n<=s.y+s.height||s.height<0&&n<=s.y&&n>=s.y+s.height))}},{key:"containsPoint",value:function(t){for(var e=!1,i=0;i<this.graphics.graphicsData.length;++i){var n=this.graphics.graphicsData[i];if(n.shape){if(n.hasFill()&&n.shape.contains(t.x,t.y)&&(e=!0))break;if(n.hasLine()&&n.shape.points&&(e=D(n,t.x,t.y)))break}}return e}},{key:"animate",value:function(t,e,i){if(i=i||this.context){var n=t,r=null;for(var a in n)m._.isObject(n[a])?this.animate(n[a],m._.extend({},e),i[a]):isNaN(n[a])&&""!==n[a]&&null!==n[a]?(i[a]=n[a],delete n[a]):(r=r||{})[a]=i[a];if(r){(e=e||{}).from=r,e.to=n;var s,h=this,o=function(){};e.onUpdate&&(o=e.onUpdate),e.onUpdate=function(t){if(!i&&s)return T.destroyTween(s),void(s=null);for(var e in t)i[e]=t[e];o.apply(h,[t])};var l=function(){};return e.onComplete&&(l=e.onComplete),e.onComplete=function(t){l.apply(h,arguments),h._removeTween(s)},e.onStop=function(){h._removeTween(s)},e.desc="tweenType:DisplayObject.animate__id:"+this.id+"__objectType:"+this.type,s=T.registTween(e),this._tweens.push(s),s}}}},{key:"_removeTween",value:function(t){for(var e=0;e<this._tweens.length;e++)if(t==this._tweens[e]){this._tweens.splice(e,1);break}}},{key:"removeAnimate",value:function(t){t.stop(),this._removeTween(t)}},{key:"cleanAnimates",value:function(){this._cleanAnimates()}},{key:"_cleanAnimates",value:function(){for(;this._tweens.length;)this._tweens.shift().stop()}},{key:"remove",value:function(){this.parent&&(this.parent.removeChild(this),this.parent=null)}},{key:"destroy",value:function(){this._destroy()}},{key:"_destroy",value:function(){this.remove(),this.fire("destroy"),this.context=null,delete this.context}}]),n}(m.event.Dispatcher),$=function(){function s(t){var e;return o(this,s),(e=h(this,c(s).call(this,t))).children=[],e.mouseChildren=[],e._eventEnabled=!0,e}return f(s,E),l(s,[{key:"addChild",value:function(t,e){if(t)return-1!=this.getChildIndex(t)?t.parent=this:(t.parent&&t.parent.removeChild(t),void 0===e&&(e=this.children.length),this.children.splice(e,0,t),(t.parent=this).heartBeat&&this.heartBeat({convertType:"children",target:t,src:this}),this._afterAddChild&&this._afterAddChild(t)),t}},{key:"addChildAt",value:function(t,e){return this.addChild(t,e)}},{key:"removeChild",value:function(t){return this.removeChildAt(m._.indexOf(this.children,t))}},{key:"removeChildAt",value:function(t){if(t<0||t>this.children.length-1)return!1;var e=this.children[t];return null!=e&&(e.parent=null),this.children.splice(t,1),this.heartBeat&&this.heartBeat({convertType:"children",target:e,src:this}),this._afterDelChild&&this._afterDelChild(e,t),e}},{key:"removeChildById",value:function(t){for(var e=0,i=this.children.length;e<i;e++)if(this.children[e].id==t)return this.removeChildAt(e);return!1}},{key:"removeAllChildren",value:function(){for(;0<this.children.length;)this.removeChildAt(0)}},{key:"destroy",value:function(){for(var t=0,e=this.children.length;t<e;t++)this.getChildAt(t).destroy(),t--,e--;this._destroy()}},{key:"cleanAnimates",value:function(){for(var t=0,e=this.children.length;t<e;t++)this.getChildAt(t).cleanAnimates();this._cleanAnimates()}},{key:"getChildById",value:function(t,e){if(e)return null;for(var i=0,n=this.children.length;i<n;i++)if(this.children[i].id==t)return this.children[i];return null}},{key:"getChildAt",value:function(t){return t<0||t>this.children.length-1?null:this.children[t]}},{key:"getChildIndex",value:function(t){return m._.indexOf(this.children,t)}},{key:"setChildIndex",value:function(t,e){if(t.parent==this){var i=m._.indexOf(this.children,t);e!=i&&(this.children.splice(i,1),this.children.splice(e,0,t))}}},{key:"getNumChildren",value:function(){return this.children.length}},{key:"getObjectsUnderPoint",value:function(t,e){for(var i=[],n=this.children.length-1;0<=n;n--){var r=this.children[n];if(null!=r&&r.context.$model.visible)if(r instanceof s){if(!r._eventEnabled)continue;if(r.mouseChildren&&0<r.getNumChildren()){var a=r.getObjectsUnderPoint(t);0<a.length&&(i=i.concat(a))}}else{if(!r._eventEnabled&&!r.dragEnabled)continue;if(r.getChildInPoint(t)&&(i.push(r),null!=e&&!isNaN(e)&&i.length==e))return i}}return i}}]),s}(),F=function(){function i(t){var e;return o(this,i),t.type="stage",(e=h(this,c(i).call(this,t))).canvas=null,e.ctx=null,e.stageRending=!1,e._isReady=!1,e}return f(i,$),l(i,[{key:"initStage",value:function(t,e,i){this.canvas=t;var n=this.context;n.width=e,n.height=i,n.scaleX=d._devicePixelRatio,n.scaleY=d._devicePixelRatio,this._isReady=!0}},{key:"heartBeat",value:function(t){this._isReady&&((t=t||{}).stage=this).parent&&this.parent.heartBeat(t)}}]),i}(),B=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:P,e=1<arguments.length?arguments[1]:void 0,i=2<arguments.length?arguments[2]:void 0;if(o(this,r),this.type=t,this.app=e,i)for(var n in R.RENDER_OPTIONS)void 0===i[n]&&(i[n]=R.RENDER_OPTIONS[n]);else i=R.RENDER_OPTIONS;this.options=i,this.requestAid=null,this._heartBeat=!1,this._preRenderTime=0}return l(r,[{key:"startEnter",value:function(){var t=this;t.requestAid||(t.requestAid=T.registFrame({id:"enterFrame",task:function(){t.enterFrame.apply(t)}}))}},{key:"enterFrame",value:function(){var t=this;t.requestAid=null,d.now=(new Date).getTime(),t._heartBeat&&(this.app.children.length&&t.render(this.app),t._heartBeat=!1,t._preRenderTime=(new Date).getTime())}},{key:"_convertCanvax",value:function(e){m._.each(this.app.children,function(t){t.context[e.name]=e.value})}},{key:"heartBeat",value:function(t){var i=this;if(t){if("context"==t.convertType){var e=t.stage,n=t.shape;t.name,t.value,t.preValue;if("canvax"==n.type)i._convertCanvax(t);else if(i.app.convertStages[e.id]||(i.app.convertStages[e.id]={stage:e,convertShapes:{}}),n){if(i.app.convertStages[e.id].convertShapes[n.id])return;i.app.convertStages[e.id].convertShapes[n.id]={shape:n,convertType:t.convertType}}}if("children"==t.convertType){var r=t.target;!(e=t.src.getStage())&&"stage"!=r.type||(e=e||r,i.app.convertStages[e.id]||(i.app.convertStages[e.id]={stage:e,convertShapes:{}}))}if(!t.convertType){e=t.stage;i.app.convertStages[e.id]||(i.app.convertStages[e.id]={stage:e,convertShapes:{}})}}else m._.each(i.app.children,function(t,e){i.app.convertStages[t.id]={stage:t,convertShapes:{}}});i._heartBeat?i._heartBeat=!0:(i._heartBeat=!0,i.startEnter())}}]),r}(),N=function(){function e(t){o(this,e),this.renderer=t}return l(e,[{key:"render",value:function(t,e,i,n){this.renderer;for(var r=t.graphics.graphicsData,a=e.ctx,s=0;s<r.length;s++){var h=r[s],o=h.shape,l=h.fillStyle,c=h.strokeStyle,u=h.hasFill()&&h.fillAlpha&&!n,f=h.hasLine()&&h.strokeAlpha&&!n;if(a.lineWidth=h.lineWidth,h.type===I.POLY)a.beginPath(),this.renderPolygon(o.points,o.closed,a,n),u&&(a.globalAlpha=h.fillAlpha*i,a.fillStyle=l,a.fill()),f&&(a.globalAlpha=h.strokeAlpha*i,a.strokeStyle=c,a.stroke());else if(h.type===I.RECT)n&&a.rect(o.x,o.y,o.width,o.height),u&&(a.globalAlpha=h.fillAlpha*i,a.fillStyle=l,a.fillRect(o.x,o.y,o.width,o.height)),f&&(a.globalAlpha=h.strokeAlpha*i,a.strokeStyle=c,a.strokeRect(o.x,o.y,o.width,o.height));else if(h.type===I.CIRC)a.beginPath(),a.arc(o.x,o.y,o.radius,0,2*Math.PI),a.closePath(),u&&(a.globalAlpha=h.fillAlpha*i,a.fillStyle=l,a.fill()),f&&(a.globalAlpha=h.strokeAlpha*i,a.strokeStyle=c,a.stroke());else if(h.type===I.ELIP){var d=2*o.width,p=2*o.height,v=o.x-d/2,g=o.y-p/2;a.beginPath();var y=d/2*.5522848,_=p/2*.5522848,x=v+d,w=g+p,m=v+d/2,k=g+p/2;a.moveTo(v,k),a.bezierCurveTo(v,k-_,m-y,g,m,g),a.bezierCurveTo(m+y,g,x,k-_,x,k),a.bezierCurveTo(x,k+_,m+y,w,m,w),a.bezierCurveTo(m-y,w,v,k+_,v,k),a.closePath(),u&&(a.globalAlpha=h.fillAlpha*i,a.fillStyle=l,a.fill()),f&&(a.globalAlpha=h.strokeAlpha*i,a.strokeStyle=c,a.stroke())}}}},{key:"renderPolygon",value:function(t,e,i,n){i.moveTo(t[0],t[1]);for(var r=1;r<t.length/2;++r)i.lineTo(t[2*r],t[2*r+1]);(e||n)&&i.closePath()}}]),e}(),W=function(){function n(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};return o(this,n),(e=h(this,c(n).call(this,A,t,i))).CGR=new N(s(e)),e}return f(n,B),l(n,[{key:"render",value:function(t){var e=this;e.app=t,m._.each(m._.values(t.convertStages),function(t){e.renderStage(t.stage)}),t.convertStages={}}},{key:"renderStage",value:function(t){t.ctx||(t.ctx=t.canvas.getContext("2d")),t.stageRending=!0,t.setWorldTransform(),this._clear(t),this._render(t,t,t.context.globalAlpha),t.stageRending=!1}},{key:"_render",value:function(t,e,i){var n=t.ctx;if(n){var r=e.context.$model;if(e.worldTransform||e.fire("render"),(!e.worldTransform||e._transformChange||e.parent&&e.parent._transformChange)&&(e.setWorldTransform(),e.fire("transform"),e._transformChange=!0),i*=r.globalAlpha,r.visible&&!e.isClip){var a=e.worldTransform.toArray();if(a){n.setTransform.apply(n,a);var s=!1;if(e.clip&&e.clip.graphics){var h=e.clip;n.save(),s=!0,h.worldTransform&&!h._transformChange&&!h.parent._transformChange||(h.setWorldTransform(),h._transformChange=!0),n.setTransform.apply(n,h.worldTransform.toArray()),h.graphics.graphicsData.length||h._draw(h.graphics),this.CGR.render(h,t,i,s),h._transformChange=!1,n.clip()}if(e.graphics&&(e.graphics.graphicsData.length||e._draw(e.graphics),i&&(n.setLineDash([]),r.lineType&&"solid"!=r.lineType&&n.setLineDash(r.lineDash),this.CGR.render(e,t,i))),"text"==e.type&&e.render(n,i),e.children)for(var o=0,l=e.children.length;o<l;o++)this._render(t,e.children[o],i);e._transformChange=!1,s&&n.restore()}}}}},{key:"_clear",value:function(t){var e=t.ctx;e.setTransform.apply(e,t.worldTransform.toArray()),e.clearRect(0,0,this.app.width,this.app.height)}}]),n}();var j=function(){function a(t){var e,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};o(this,a),t.type="canvax",(e=h(this,c(a).call(this,t)))._cid=(new Date).getTime()+"_"+Math.floor(100*Math.random()),e.el=m.$.query(t.el),e.width=parseInt("width"in t||e.el.offsetWidth,10),e.height=parseInt("height"in t||e.el.offsetHeight,10);var n,r=m.$.createView(e.width,e.height,e._cid);return e.view=r.view,e.stageView=r.stageView,e.domView=r.domView,e.el.innerHTML="",e.el.appendChild(e.view),e.viewOffset=m.$.offset(e.view),e.lastGetRO=0,e.webGL=t.webGL,e.renderer=(n=s(e),new W(n,i)),e.event=null,e.convertStages={},e.context.$model.width=e.width,e.context.$model.height=e.height,e._bufferStage=null,e._creatHoverStage(),e.worldTransform=(new p).identity(),e}return f(a,$),l(a,[{key:"registEvent",value:function(t){return this.event=new m.event.Handler(this,t),this.event.init(),this.event}},{key:"destroy",value:function(){for(var t=0,e=this.children.length;t<e;t++){var i=this.children[t];i.destroy(),i.canvas=null,i.ctx=null,i=null,t--,e--}try{this.view.removeChild(this.stageView),this.view.removeChild(this.domView),this.el.removeChild(this.view)}catch(t){}this.el.innerHTML="",this.event=null,this._bufferStage=null}},{key:"resize",value:function(t){this.width=parseInt(t&&"width"in t||this.el.offsetWidth,10),this.height=parseInt(t&&"height"in t||this.el.offsetHeight,10),this.viewOffset=m.$.offset(this.view),this.context.$model.width=this.width,this.context.$model.height=this.height;var n=this;m._.each(this.children,function(t,e){var i;t.context.$model.width=n.width,t.context.$model.height=n.height,(i=t.canvas).style.width=n.width+"px",i.style.height=n.height+"px",i.setAttribute("width",n.width*d._devicePixelRatio),i.setAttribute("height",n.height*d._devicePixelRatio)}),this.stageView.style.width=this.width+"px",this.stageView.style.height=this.height+"px",this.domView.style.width=this.width+"px",this.domView.style.height=this.height+"px",this.heartBeat()}},{key:"getHoverStage",value:function(){return this._bufferStage}},{key:"_creatHoverStage",value:function(){this._bufferStage=new F({id:"activCanvas"+(new Date).getTime(),context:{width:this.context.$model.width,height:this.context.$model.height}}),this._bufferStage._eventEnabled=!1,this.addChild(this._bufferStage)}},{key:"updateViewOffset",value:function(){var t=(new Date).getTime();1e3<t-this.lastGetRO&&(this.viewOffset=m.$.offset(this.view),this.lastGetRO=t)}},{key:"_afterAddChild",value:function(t,e){var i;i=t.canvas?t.canvas:m.$.createCanvas(this.context.$model.width,this.context.$model.height,t.id),1==this.children.length?this.stageView.appendChild(i):1<this.children.length&&(void 0===e?this.stageView.insertBefore(i,this._bufferStage.canvas):e>=this.children.length-1?this.stageView.appendChild(i):this.stageView.insertBefore(i,this.children[e].canvas)),d.initElement(i),t.initStage(i,this.context.$model.width,this.context.$model.height)}},{key:"_afterDelChild",value:function(t){try{this.stageView.removeChild(t.canvas)}catch(t){}}},{key:"heartBeat",value:function(t){0<this.children.length&&this.renderer.heartBeat(t)}},{key:"toDataURL",value:function(){var t=m.$.createCanvas(this.width,this.height,"curr_base64_canvas"),e=t.getContext("2d");return m._.each(this.children,function(t){e.drawImage(t.canvas,0,0)}),t.toDataURL()}}]),a}(),U=function(){function e(t){return o(this,e),(t=d.checkOpt(t)).type="sprite",h(this,c(e).call(this,t))}return f(e,$),e}(),q=function(){function s(t,e,i,n,r,a){o(this,s),this.lineWidth=t,this.strokeStyle=e,this.strokeAlpha=i,this.fillStyle=n,this.fillAlpha=r,this.shape=a,this.type=a.type,this.holes=[],this.fill=!0,this.line=!0}return l(s,[{key:"clone",value:function(){var t=new s(this.lineWidth,this.strokeStyle,this.strokeAlpha,this.fillStyle,this.fillAlpha,this.shape);return t.fill=this.fill,t.line=this.line,t}},{key:"addHole",value:function(t){this.holes.push(t)}},{key:"synsStyle",value:function(t){this.line&&(this.lineWidth=t.lineWidth,this.strokeStyle=t.strokeStyle,this.strokeAlpha=t.strokeAlpha),this.fill&&(this.fillStyle=t.fillStyle,this.fillAlpha=t.fillAlpha)}},{key:"hasFill",value:function(){return this.fillStyle&&this.fill&&void 0!==this.shape.closed&&this.shape.closed}},{key:"hasLine",value:function(){return this.strokeStyle&&this.lineWidth&&this.line}},{key:"destroy",value:function(){this.shape=null,this.holes=null}}]),s}(),H={},V={},G=Array.prototype.join;function z(t,e,i,n,r,a,s){var h=G.call(arguments);if(H[h])return H[h];var o=Math.PI,l=s*o/180,c=Math.sin(l),u=Math.cos(l),f=0,d=0,p=-u*t*.5-c*e*.5,v=-u*e*.5+c*t*.5,g=(i=Math.abs(i))*i,y=(n=Math.abs(n))*n,_=v*v,x=p*p,w=g*y-g*_-y*x,m=0;if(w<0){var k=Math.sqrt(1-w/(g*y));i*=k,n*=k}else m=(r===a?-1:1)*Math.sqrt(w/(g*_+y*x));var b=m*i*v/n,T=-m*n*p/i,C=u*b-c*T+.5*t,S=c*b+u*T+.5*e,P=Q(1,0,(p-b)/i,(v-T)/n),A=Q((p-b)/i,(v-T)/n,(-p-b)/i,(-v-T)/n);0===a&&0<A?A-=2*o:1===a&&A<0&&(A+=2*o);for(var I=Math.ceil(Math.abs(A/o*2)),M=[],O=A/I,L=8/3*Math.sin(O/4)*Math.sin(O/4)/Math.sin(O/2),D=P+O,R=0;R<I;R++)M[R]=X(P,D,u,c,i,n,C,S,L,f,d),f=M[R][4],d=M[R][5],P=D,D+=O;return H[h]=M}function X(t,e,i,n,r,a,s,h,o,l,c){var u=G.call(arguments);if(V[u])return V[u];var f=Math.cos(t),d=Math.sin(t),p=Math.cos(e),v=Math.sin(e),g=i*r*p-n*a*v+s,y=n*r*p+i*a*v+h,_=l+o*(-i*r*d-n*a*f),x=c+o*(-n*r*d+i*a*f),w=g+o*(i*r*v+n*a*p),m=y+o*(n*r*v-i*a*p);return V[u]=[_,x,w,m,g,y],V[u]}function Q(t,e,i,n){var r=Math.atan2(e,t),a=Math.atan2(n,i);return r<=a?a-r:2*Math.PI-(r-a)}var Y=function(t,e,i,n){for(var r=n[0],a=n[1],s=n[2],h=n[3],o=n[4],l=[[],[],[],[]],c=z(n[5]-e,n[6]-i,r,a,h,o,s),u=0,f=c.length;u<f;u++)l[u][0]=c[u][0]+e,l[u][1]=c[u][1]+i,l[u][2]=c[u][2]+e,l[u][3]=c[u][3]+i,l[u][4]=c[u][4]+e,l[u][5]=c[u][5]+i,t.bezierCurveTo.apply(t,l[u])},Z=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;o(this,r),this.x=t,this.y=e,this.width=i,this.height=n,this.type=I.RECT,this.closed=!0}return l(r,[{key:"clone",value:function(){return new r(this.x,this.y,this.width,this.height)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}},{key:"contains",value:function(t,e){return!(this.height*e<0||this.width*t<0)&&(t>=this.x&&t<=this.x+this.width&&(0<=this.height&&e>=this.y&&e<=this.y+this.height||this.height<0&&e<=this.y&&e>=this.y+this.height))}}]),r}(),J=function(){function n(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;o(this,n),this.x=t,this.y=e,this.radius=i,this.type=I.CIRC,this.closed=!0}return l(n,[{key:"clone",value:function(){return new n(this.x,this.y,this.radius)}},{key:"contains",value:function(t,e){if(this.radius<=0)return!1;var i=this.radius*this.radius,n=this.x-t,r=this.y-e;return(n*=n)+(r*=r)<=i}},{key:"getBounds",value:function(){return new Z(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}}]),n}(),K=function(){function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0;o(this,r),this.x=t,this.y=e,this.width=i,this.height=n,this.type=I.ELIP,this.closed=!0}return l(r,[{key:"clone",value:function(){return new r(this.x,this.y,this.width,this.height)}},{key:"contains",value:function(t,e){if(this.width<=0||this.height<=0)return!1;var i=(t-this.x)/this.width,n=(e-this.y)/this.height;return(i*=i)+(n*=n)<=1}},{key:"getBounds",value:function(){return new Z(this.x-this.width,this.y-this.height,this.width,this.height)}}]),r}(),tt=function(){function h(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];o(this,h);var n=e[0];if(Array.isArray(n)&&(e=n),n&&"x"in n&&"y"in n){for(var r=[],a=0,s=e.length;a<s;a++)r.push(e[a].x,e[a].y);e=r}this.closed=!0,this.points=e,this.type=I.POLY}return l(h,[{key:"clone",value:function(){return new h(this.points.slice())}},{key:"close",value:function(){var t=this.points;t[0]===t[t.length-2]&&t[1]===t[t.length-1]||t.push(t[0],t[1]),this.closed=!0}},{key:"contains",value:function(t,e){return this._isInsidePolygon_WindingNumber(t,e)}},{key:"_isInsidePolygon_WindingNumber",value:function(t,e){for(var i,n=this.points,r=0,a=n[1]>e,s=3;s<n.length;s+=2)if((i=a)!=(a=n[s]>e)){var h=(i?1:0)-(a?1:0);0<h*((n[s-3]-t)*(n[s-0]-e)-(n[s-2]-e)*(n[s-1]-t))&&(r+=h)}return r}}]),h}();var et=function(){function i(t){o(this,i),this.lineWidth=1,this.strokeStyle=null,this.strokeAlpha=1,this.fillStyle=null,this.fillAlpha=1,this.graphicsData=[],this.currentPath=null,this.dirty=0,this.clearDirty=0,this._webGL={},this.worldAlpha=1,this.tint=16777215,this.Bound={x:0,y:0,width:0,height:0}}return l(i,[{key:"setStyle",value:function(t){var e=t.$model;this.lineWidth=e.lineWidth,this.strokeStyle=e.strokeStyle,this.strokeAlpha=e.strokeAlpha*e.globalAlpha,this.fillStyle=e.fillStyle,this.fillAlpha=e.fillAlpha*e.globalAlpha;var i=this;this.graphicsData.length&&m._.each(this.graphicsData,function(t,e){t.synsStyle(i)})}},{key:"clone",value:function(){for(var t=new i,e=t.dirty=0;e<this.graphicsData.length;++e)t.graphicsData.push(this.graphicsData[e].clone());return t.currentPath=t.graphicsData[t.graphicsData.length-1],t}},{key:"moveTo",value:function(t,e){var i=new tt([t,e]);return i.closed=!1,this.drawShape(i),this}},{key:"lineTo",value:function(t,e){return this.currentPath?(this.currentPath.shape.points.push(t,e),this.dirty++):this.moveTo(0,0),this}},{key:"quadraticCurveTo",value:function(t,e,i,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var r=this.currentPath.shape.points,a=0,s=0;0===r.length&&this.moveTo(0,0);for(var h=r[r.length-2],o=r[r.length-1],l=1;l<=20;++l){var c=l/20;a=h+(t-h)*c,s=o+(e-o)*c,r.push(a+(t+(i-t)*c-a)*c,s+(e+(n-e)*c-s)*c)}return this.dirty++,this}},{key:"bezierCurveTo",value:function(t,e,i,n,r,a){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var s=this.currentPath.shape.points,h=s[s.length-2],o=s[s.length-1];return s.length-=2,function(t,e,i,n,r,a,s,h,o){var l=8<arguments.length&&void 0!==o?o:[],c=0,u=0,f=0,d=0,p=0;l.push(t,e);for(var v=1,g=0;v<=20;++v)f=(u=(c=1-(g=v/20))*c)*c,p=(d=g*g)*g,l.push(f*t+3*u*g*i+3*c*d*r+p*s,f*e+3*u*g*n+3*c*d*a+p*h)}(h,o,t,e,i,n,r,a,s),this.dirty++,this}},{key:"arcTo",value:function(t,e,i,n,r){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(t,e):this.moveTo(t,e);var a=this.currentPath.shape.points,s=a[a.length-2],h=a[a.length-1]-e,o=s-t,l=n-e,c=i-t,u=Math.abs(h*c-o*l);if(u<1e-8||0===r)a[a.length-2]===t&&a[a.length-1]===e||a.push(t,e);else{var f=h*h+o*o,d=l*l+c*c,p=h*l+o*c,v=r*Math.sqrt(f)/u,g=r*Math.sqrt(d)/u,y=v*p/f,_=g*p/d,x=v*c+g*o,w=v*l+g*h,m=o*(g+y),k=h*(g+y),b=c*(v+_),T=l*(v+_),C=Math.atan2(k-w,m-x),S=Math.atan2(T-w,b-x);this.arc(x+t,w+e,r,C,S,c*h<o*l)}return this.dirty++,this}},{key:"arc",value:function(t,e,i,n,r,a){var s=5<arguments.length&&void 0!==a&&a;if(n===r)return this;!s&&r<=n?r+=2*Math.PI:s&&n<=r&&(n+=2*Math.PI);var h=r-n,o=48*Math.ceil(Math.abs(h)/(2*Math.PI));if(0==h)return this;var l=t+Math.cos(n)*i,c=e+Math.sin(n)*i,u=this.currentPath?this.currentPath.shape.points:null;u?u[u.length-2]===l&&u[u.length-1]===c||u.push(l,c):(this.moveTo(l,c),u=this.currentPath.shape.points);for(var f=h/(2*o),d=2*f,p=Math.cos(f),v=Math.sin(f),g=o-1,y=g%1/g,_=0;_<=g;++_){var x=f+n+d*(_+y*_),w=Math.cos(x),m=-Math.sin(x);u.push((p*w+v*m)*i+t,(p*-m+v*w)*i+e)}return this.dirty++,this}},{key:"drawRect",value:function(t,e,i,n){return this.drawShape(new Z(t,e,i,n)),this}},{key:"drawCircle",value:function(t,e,i){return this.drawShape(new J(t,e,i)),this}},{key:"drawEllipse",value:function(t,e,i,n){return this.drawShape(new K(t,e,i,n)),this}},{key:"drawPolygon",value:function(t){var e=t,i=!0;if(e instanceof tt&&(i=e.closed,e=e.points),!Array.isArray(e)){e=new Array(arguments.length);for(var n=0;n<e.length;++n)e[n]=arguments[n]}var r=new tt(e);return r.closed=i,this.drawShape(r),this}},{key:"clear",value:function(){return 0<this.graphicsData.length&&(this.dirty++,this.clearDirty++,this.graphicsData.length=0),this.currentPath=null,this}},{key:"drawShape",value:function(t){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.beginPath();var e=new q(this.lineWidth,this.strokeStyle,this.strokeAlpha,this.fillStyle,this.fillAlpha,t);return this.graphicsData.push(e),e.type===I.POLY&&(e.shape.closed=e.shape.closed,this.currentPath=e),this.dirty++,e}},{key:"beginPath",value:function(){this.currentPath=null}},{key:"closePath",value:function(){var t=this.currentPath;return t&&t.shape&&t.shape.close(),this}},{key:"updateLocalBounds",value:function(){var t=1/0,e=-1/0,i=1/0,n=-1/0;if(this.graphicsData.length)for(var r=0,a=0,s=0,h=0,o=0,l=0;l<this.graphicsData.length;l++){var c=this.graphicsData[l],u=c.type,f=c.lineWidth;if(r=c.shape,u===I.RECT||u===I.RREC)a=r.x-f/2,s=r.y-f/2,t=a<t?a:t,e=e<a+(h=r.width+f)?a+h:e,i=s<i?s:i,n=n<s+(o=r.height+f)?s+o:n;else if(u===I.CIRC)a=r.x,s=r.y,t=a-(h=r.radius+f/2)<t?a-h:t,e=e<a+h?a+h:e,i=s-(o=r.radius+f/2)<i?s-o:i,n=n<s+o?s+o:n;else if(u===I.ELIP)a=r.x,s=r.y,t=a-(h=r.width+f/2)<t?a-h:t,e=e<a+h?a+h:e,i=s-(o=r.height+f/2)<i?s-o:i,n=n<s+o?s+o:n;else for(var d=r.points,p=0,v=0,g=0,y=0,_=0,x=0,w=0,m=0,k=0;k+2<d.length;k+=2)a=d[k],s=d[k+1],p=d[k+2],v=d[k+3],g=Math.abs(p-a),y=Math.abs(v-s),o=f,(h=Math.sqrt(g*g+y*y))<1e-9||(t=(w=(p+a)/2)-(_=(o/h*y+g)/2)<t?w-_:t,e=e<w+_?w+_:e,i=(m=(v+s)/2)-(x=(o/h*g+y)/2)<i?m-x:i,n=n<m+x?m+x:n)}else n=i=e=t=0;return this.Bound={x:t,y:i,width:e-t,height:n-i},this}},{key:"getBound",value:function(){return this.updateLocalBounds().Bound}},{key:"destroy",value:function(){for(var t=0;t<this.graphicsData.length;++t)this.graphicsData[t].destroy();for(var e in this._webGL)for(var i=0;i<this._webGL[e].data.length;++i)this._webGL[e].data[i].destroy();this.graphicsData=null,this.currentPath=null,this._webGL=null}}]),i}(),it=function(){function r(t){var e;o(this,r);var i={cursor:(t=d.checkOpt(t)).context.cursor||"default",fillAlpha:t.context.fillAlpha||1,fillStyle:t.context.fillStyle||null,lineCap:t.context.lineCap||"round",lineJoin:t.context.lineJoin||"round",miterLimit:t.context.miterLimit||null,strokeAlpha:t.context.strokeAlpha||1,strokeStyle:t.context.strokeStyle||null,lineType:t.context.lineType||"solid",lineDash:t.context.lineDash||[6,3],lineWidth:t.context.lineWidth||null},n=m._.extend(!0,i,t.context);return t.context=n,void 0===t.id&&void 0!==t.type&&(t.id=d.createId(t.type)),(e=h(this,c(r).call(this,t)))._hoverClass=!1,e.hoverClone=!0,e.pointChkPriority=!0,e._eventEnabled=!1,e.dragEnabled=t.dragEnabled||!1,e._dragDuplicate=null,e.type=e.type||"shape",e.initCompProperty(t),e.isClone?e.graphics=null:(e.graphics=new et,e._draw(e.graphics)),e}return f(r,E),l(r,[{key:"_draw",value:function(t){0==t.graphicsData.length&&(t.setStyle(this.context),this.draw(t))}},{key:"draw",value:function(){}},{key:"clearGraphicsData",value:function(){this.graphics.clear()}},{key:"$watch",value:function(t,e,i){-1<m._.indexOf(O,t)&&this.graphics.setStyle(this.context),this.watch(t,e,i)}},{key:"initCompProperty",value:function(t){for(var e in t)"id"!=e&&"context"!=e&&(this[e]=t[e])}},{key:"getBound",value:function(){return this.graphics.updateLocalBounds().Bound}}]),r}(),nt=function(){function n(t,e){var i;return o(this,n),e.type="text",null==t&&(t=""),e.context=m._.extend({font:"",fontSize:13,fontWeight:"normal",fontFamily:"微软雅黑,sans-serif",textBaseline:"top",textAlign:"left",textDecoration:null,fillStyle:"blank",strokeStyle:null,lineWidth:0,lineHeight:1.2,backgroundColor:null,textBackgroundColor:null},e.context),(i=h(this,c(n).call(this,e)))._reNewline=/\r?\n/,i.fontProperts=["fontStyle","fontVariant","fontWeight","fontSize","fontFamily"],i.context.font=i._getFontDeclaration(),i.text=t.toString(),i.context.width=i.getTextWidth(),i.context.height=i.getTextHeight(),i}return f(n,E),l(n,[{key:"$watch",value:function(t,e){0<=m._.indexOf(this.fontProperts,t)&&(this.context[t]=e,this.context.font=this._getFontDeclaration(),this.context.width=this.getTextWidth(),this.context.height=this.getTextHeight())}},{key:"_setContextStyle",value:function(t,e,i){for(var n in e)"textBaseline"!=n&&n in t&&(e[n]||m._.isNumber(e[n]))&&("globalAlpha"==n?t.globalAlpha=i:t[n]=e[n])}},{key:"render",value:function(t,e){this._renderText(t,this._getTextLines(),e)}},{key:"resetText",value:function(t){this.text=t.toString(),this.heartBeat()}},{key:"getTextWidth",value:function(){var t=0;return d._pixelCtx&&(d._pixelCtx.save(),d._pixelCtx.font=this.context.$model.font,t=this._getTextWidth(d._pixelCtx,this._getTextLines()),d._pixelCtx.restore()),t}},{key:"getTextHeight",value:function(){return this._getTextHeight(d._pixelCtx,this._getTextLines())}},{key:"_getTextLines",value:function(){return this.text.split(this._reNewline)}},{key:"_renderText",value:function(t,e,i){t&&(t.save(),this._setContextStyle(t,this.context.$model,i),this._renderTextStroke(t,e),this._renderTextFill(t,e),t.restore())}},{key:"_getFontDeclaration",value:function(){var i=this,n=[];return m._.each(this.fontProperts,function(t){var e=i.context[t];"fontSize"==t&&(e=parseFloat(e)+"px"),e&&n.push(e)}),n.join(" ")}},{key:"_renderTextFill",value:function(t,e){if(this.context.$model.fillStyle){this._boundaries=[];for(var i=0,n=0,r=e.length;n<r;n++){i+=this._getHeightOfLine(t,n,e),this._renderTextLine("fillText",t,e[n],0,this._getTopOffset()+i,n)}}}},{key:"_renderTextStroke",value:function(t,e){if(t&&this.context.$model.strokeStyle&&this.context.$model.lineWidth){var i=0;t.save(),this.strokeDashArray&&(1&this.strokeDashArray.length&&this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray),supportsLineDash&&t.setLineDash(this.strokeDashArray)),t.beginPath();for(var n=0,r=e.length;n<r;n++){i+=this._getHeightOfLine(t,n,e),this._renderTextLine("strokeText",t,e[n],0,this._getTopOffset()+i,n)}t.closePath(),t.restore()}}},{key:"_renderTextLine",value:function(t,e,i,n,r,a){if(r-=this._getHeightOfLine()/4,"justify"===this.context.$model.textAlign){var s=e.measureText(i).width,h=this.context.$model.width;if(s<h)for(var o=i.split(/\s+/),l=(h-e.measureText(i.replace(/\s+/g,"")).width)/(o.length-1),c=0,u=0,f=o.length;u<f;u++)this._renderChars(t,e,o[u],n+c,r,a),c+=e.measureText(o[u]).width+l;else this._renderChars(t,e,i,n,r,a)}else this._renderChars(t,e,i,n,r,a)}},{key:"_renderChars",value:function(t,e,i,n,r){e[t](i,0,r)}},{key:"_getHeightOfLine",value:function(){return this.context.$model.fontSize*this.context.$model.lineHeight}},{key:"_getTextWidth",value:function(t,e){for(var i=t.measureText(e[0]||"|").width,n=1,r=e.length;n<r;n++){var a=t.measureText(e[n]).width;i<a&&(i=a)}return i}},{key:"_getTextHeight",value:function(t,e){return this.context.$model.fontSize*e.length*this.context.$model.lineHeight}},{key:"_getTopOffset",value:function(){var t=0;switch(this.context.$model.textBaseline){case"top":t=0;break;case"middle":t=-this.context.$model.height/2;break;case"bottom":t=-this.context.$model.height}return t}},{key:"getRect",value:function(){var t=this.context,e=0,i=0;return"center"==t.textAlign&&(e=-t.width/2),"right"==t.textAlign&&(e=-t.width),"middle"==t.textBaseline&&(i=-t.height/2),"bottom"==t.textBaseline&&(i=-t.height),{x:e,y:i,width:t.width,height:t.height}}}]),n}();function rt(t,e){var i=0,n=0;if(1==arguments.length&&m._.isObject(t)){var r=t;m._.isArray(r)?(i=r[0],n=r[1]):r.hasOwnProperty("x")&&r.hasOwnProperty("y")&&(i=r.x,n=r.y)}this._axes=[i,n]}function at(t,e,i,n,r,a,s){var h=.25*(i-t),o=.25*(n-e);return(2*(e-i)+h+o)*s+(-3*(e-i)-2*h-o)*a+h*r+e}rt.prototype={distance:function(t){var e=this._axes[0]-t._axes[0],i=this._axes[1]-t._axes[1];return Math.sqrt(e*e+i*i)}};var st={sin:{},cos:{}},ht=Math.PI/180;function ot(t,e){var i={points:t};m._.isFunction(e)&&(i.smoothFilter=e);var n=function(t){var e=t.points,i=t.isLoop,n=t.smoothFilter,r=e.length;if(1==r)return e;for(var a=[],s=0,h=new rt(e[0]),o=null,l=1;l<r;l++)o=new rt(e[l]),s+=h.distance(o),h=o;o=h=null;var c=s/6;for(c=c<r?r:c,l=0;l<c;l++){var u,f,d,p=l/(c-1)*(i?r:r-1),v=Math.floor(p),g=p-v,y=e[v%r];d=i?(u=e[(v-1+r)%r],f=e[(v+1)%r],e[(v+2)%r]):(u=e[0===v?v:v-1],f=e[r-2<v?r-1:v+1],e[r-3<v?r-1:v+2]);var _=g*g,x=g*_,w=[at(u[0],y[0],f[0],d[0],g,_,x),at(u[1],y[1],f[1],d[1],g,_,x)];m._.isFunction(n)&&n(w),a.push(w)}return a}(i);return t&&0<t.length&&n.push(t[t.length-1]),n}function lt(t){return!t||m._.isArray(t)&&2<=t.length&&(!m._.isNumber(t[0])||!m._.isNumber(t[1]))||"x"in t&&!m._.isNumber(t.x)||"y"in t&&!m._.isNumber(t.y)}var ct={PI:Math.PI,sin:function(t,e){return t=(e?t*ht:t).toFixed(4),void 0===st.sin[t]&&(st.sin[t]=Math.sin(t)),st.sin[t]},cos:function(t,e){return t=(e?t*ht:t).toFixed(4),void 0===st.cos[t]&&(st.cos[t]=Math.cos(t)),st.cos[t]},degreeToRadian:function(t){return t*ht},radianToDegree:function(t){return t/ht},degreeTo360:function(t){var e=(360+t%360)%360;return 0==e&&0!==t&&(e=360),e},getIsgonPointList:function(t,e){for(var i=[],n=2*Math.PI/t,r=-Math.PI/2,a=0,s=t;a<s;a++)i.push([e*Math.cos(r),e*Math.sin(r)]),r+=n;return i},getSmoothPointList:function(t,i){var n=[],r=t.length,a=[];return m._.each(t,function(t,e){lt(t)?(a.length&&(n=n.concat(ot(a,i)),a=[]),n.push(t)):a.push(t),e==r-1&&a.length&&(n=n.concat(ot(a,i)),a=[])}),n},isNotValibPoint:lt,isValibPoint:function(t){return!lt(t)}},ut=function(){function n(t){var e;o(this,n),t=d.checkOpt(t);var i=m._.extend(!0,{lineType:null,smooth:!1,pointList:[],smoothFilter:d.__emptyFunc},t.context);return!t.isClone&&i.smooth&&(i.pointList=ct.getSmoothPointList(i.pointList,i.smoothFilter)),t.context=i,t.type="brokenline",(e=h(this,c(n).call(this,t)))._pointList=i.pointList,e}return f(n,it),l(n,[{key:"watch",value:function(t,e){"pointList"!=t&&"smooth"!=t&&"lineType"!=t||("pointList"==t&&this.context.smooth&&(this.context.pointList=ct.getSmoothPointList(e,this.context.smoothFilter),this._pointList=e),"smooth"==t&&(this.context.pointList=e?ct.getSmoothPointList(this._pointList,this.context.smoothFilter):this._pointList),this.graphics.clear())}},{key:"draw",value:function(t){for(var e=this.context.pointList,i=!1,n=0,r=e.length;n<r;n++){var a=e[n];i=!!ct.isValibPoint(a)&&(i?t.lineTo(a[0],a[1]):t.moveTo(a[0],a[1]),!0)}return this}}]),n}(),ft=function(){function e(t){return o(this,e),t=m._.extend(!0,{type:"circle",xyToInt:!1,context:{r:0}},d.checkOpt(t)),h(this,c(e).call(this,t))}return f(e,it),l(e,[{key:"watch",value:function(t){"r"==t&&this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model.r;e<0&&(e=0),t.drawCircle(0,0,e)}}]),e}(),dt=function(){function i(t){o(this,i);var e=m._.extend(!0,{pointList:[],path:""},t.context);return t.context=e,t.__parsePathData=null,t.type="path",h(this,c(i).call(this,t))}return f(i,it),l(i,[{key:"watch",value:function(t){"path"==t&&this.graphics.clear()}},{key:"_parsePathData",value:function(t){if(this.__parsePathData)return this.__parsePathData;if(!t)return[];this.__parsePathData=[];var e=m._.compact(t.replace(/[Mm]/g,"\\r$&").split("\\r")),i=this;return m._.each(e,function(t){i.__parsePathData.push(i._parseChildPathData(t))}),this.__parsePathData}},{key:"_parseChildPathData",value:function(t){var e,i=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];for(i=(i=(i=(i=i.replace(/  /g," ")).replace(/ /g,",")).replace(/(\d)-/g,"$1,-")).replace(/,,/g,","),e=0;e<n.length;e++)i=i.replace(new RegExp(n[e],"g"),"|"+n[e]);var r=i.split("|"),a=[],s=0,h=0;for(e=1;e<r.length;e++){var o=r[e],l=o.charAt(0),c=(o=(o=o.slice(1)).replace(new RegExp("e,-","g"),"e-")).split(",");0<c.length&&""===c[0]&&c.shift();for(var u=0;u<c.length;u++)c[u]=parseFloat(c[u]);for(;0<c.length&&!isNaN(c[0]);){var f,d,p,v=null,g=[],y=s,_=h;switch(l){case"l":s+=c.shift(),h+=c.shift(),v="L",g.push(s,h);break;case"L":s=c.shift(),h=c.shift(),g.push(s,h);break;case"m":s+=c.shift(),h+=c.shift(),v="M",g.push(s,h),l="l";break;case"M":s=c.shift(),h=c.shift(),v="M",g.push(s,h),l="L";break;case"h":s+=c.shift(),v="L",g.push(s,h);break;case"H":s=c.shift(),v="L",g.push(s,h);break;case"v":h+=c.shift(),v="L",g.push(s,h);break;case"V":h=c.shift(),v="L",g.push(s,h);break;case"C":g.push(c.shift(),c.shift(),c.shift(),c.shift()),s=c.shift(),h=c.shift(),g.push(s,h);break;case"c":g.push(s+c.shift(),h+c.shift(),s+c.shift(),h+c.shift()),s+=c.shift(),h+=c.shift(),v="C",g.push(s,h);break;case"S":f=s,d=h,"C"===(p=a[a.length-1]).command&&(f=s+(s-p.points[2]),d=h+(h-p.points[3])),g.push(f,d,c.shift(),c.shift()),s=c.shift(),h=c.shift(),v="C",g.push(s,h);break;case"s":f=s,d=h,"C"===(p=a[a.length-1]).command&&(f=s+(s-p.points[2]),d=h+(h-p.points[3])),g.push(f,d,s+c.shift(),h+c.shift()),s+=c.shift(),h+=c.shift(),v="C",g.push(s,h);break;case"Q":g.push(c.shift(),c.shift()),s=c.shift(),h=c.shift(),g.push(s,h);break;case"q":g.push(s+c.shift(),h+c.shift()),s+=c.shift(),h+=c.shift(),v="Q",g.push(s,h);break;case"T":f=s,d=h,"Q"===(p=a[a.length-1]).command&&(f=s+(s-p.points[0]),d=h+(h-p.points[1])),s=c.shift(),h=c.shift(),v="Q",g.push(f,d,s,h);break;case"t":f=s,d=h,"Q"===(p=a[a.length-1]).command&&(f=s+(s-p.points[0]),d=h+(h-p.points[1])),s+=c.shift(),h+=c.shift(),v="Q",g.push(f,d,s,h);break;case"A":y=s,_=h,v="A",g=[c.shift(),c.shift(),c.shift(),c.shift(),c.shift(),s=c.shift(),h=c.shift(),y,_];break;case"a":y=s,_=h,v="A",g=[c.shift(),c.shift(),c.shift(),c.shift(),c.shift(),s+=c.shift(),h+=c.shift(),y,_]}a.push({command:v||l,points:g})}"z"!==l&&"Z"!==l||a.push({command:"z",points:[]})}return a}},{key:"draw",value:function(t){this.__parsePathData=null,this.context.$model.pointList=[];for(var e=this._parsePathData(this.context.$model.path),i=0,n=e.length;i<n;i++)for(var r=0,a=e[i].length;r<a;r++){var s=e[i][r].command,h=e[i][r].points;switch(s){case"L":t.lineTo(h[0],h[1]);break;case"M":t.moveTo(h[0],h[1]);break;case"C":t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"Q":t.quadraticCurveTo(h[0],h[1],h[2],h[3]);break;case"A":Y(t,h[7],h[8],h);break;case"z":t.closePath()}}return this}}]),i}(),pt=function(){function i(t){var e;o(this,i),t=m._.extend(!0,{type:"droplet",context:{hr:0,vr:0}},d.checkOpt(t));e=h(this,c(i).call(this,t));return e.context.$model.path=e.createPath(),e}return f(i,dt),l(i,[{key:"watch",value:function(t){"hr"!=t&&"vr"!=t||(this.context.$model.path=this.createPath())}},{key:"createPath",value:function(){var t=this.context.$model,e="M 0 "+t.hr+" C "+t.hr+" "+t.hr+" "+3*t.hr/2+" "+-t.hr/3+" 0 "+-t.vr;return e+=" C "+3*-t.hr/2+" "+-t.hr/3+" "+-t.hr+" "+t.hr+" 0 "+t.hr+"z"}}]),i}(),vt=function(){function e(t){return o(this,e),t=m._.extend(!0,{type:"ellipse",context:{hr:0,vr:0}},d.checkOpt(t)),h(this,c(e).call(this,t))}return f(e,it),l(e,[{key:"watch",value:function(t){"hr"!=t&&"vr"!=t||this.graphics.clear()}},{key:"draw",value:function(t){t.drawEllipse(0,0,2*this.context.$model.hr,2*this.context.$model.vr)}}]),e}(),gt=function(){function n(t){o(this,n);var e=m._.extend(!0,{lineType:null,smooth:!1,pointList:[],smoothFilter:d.__emptyFunc},t.context);if(!t.isClone){e.pointList[0];var i=e.pointList.slice(-1)[0];e.smooth&&(e.pointList.unshift(i),e.pointList=ct.getSmoothPointList(e.pointList))}return t.context=e,t.type="polygon",h(this,c(n).call(this,t))}return f(n,it),l(n,[{key:"watch",value:function(t){"pointList"!=t&&"smooth"!=t&&"lineType"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.pointList;if(!(e.length<2)){t.moveTo(e[0][0],e[0][1]);for(var i=1,n=e.length;i<n;i++)t.lineTo(e[i][0],e[i][1]);t.closePath()}}}]),n}(),yt=function(){function i(t){o(this,i);var e=m._.extend(!0,{pointList:[],r:0,n:0},t.context);return e.pointList=ct.getIsgonPointList(e.n,e.r),t.context=e,t.type="isogon",h(this,c(i).call(this,t))}return f(i,gt),l(i,[{key:"watch",value:function(t){"r"!=t&&"n"!=t||(this.context.$model.pointList=ct.getIsgonPointList(this.context.$model.n,this.context.$model.r)),"pointList"!=t&&"smooth"!=t&&"lineType"!=t||this.graphics.clear()}}]),i}(),_t=function(){function i(t){o(this,i);var e=m._.extend(!0,{start:{x:0,y:0},end:{x:0,y:0}},t.context);return t.context=e,t.type="line",h(this,c(i).call(this,t))}return f(i,it),l(i,[{key:"watch",value:function(t){"x"!=t&&"y"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model;return t.moveTo(e.start.x,e.start.y),t.lineTo(e.end.x,e.end.y),this}}]),i}(),xt=function(){function i(t){o(this,i);var e=m._.extend(!0,{width:0,height:0,radius:[]},t.context);return t.context=e,t.type="rect",h(this,c(i).call(this,t))}return f(i,it),l(i,[{key:"watch",value:function(t){"width"!=t&&"height"!=t&&"radius"!=t||this.graphics.clear()}},{key:"_buildRadiusPath",value:function(t){var e=this.context.$model,i=e.width,n=e.height,r=d.getCssOrderArr(e.radius),a=t,s=1;0<=n&&(s=-1),a.moveTo(parseInt(0+r[0]),parseInt(n)),a.lineTo(parseInt(0+i-r[1]),parseInt(n)),0!==r[1]&&a.quadraticCurveTo(0+i,n,parseInt(0+i),parseInt(n+r[1]*s)),a.lineTo(parseInt(0+i),parseInt(0-r[2]*s)),0!==r[2]&&a.quadraticCurveTo(0+i,0,parseInt(0+i-r[2]),parseInt(0)),a.lineTo(parseInt(0+r[3]),parseInt(0)),0!==r[3]&&a.quadraticCurveTo(0,0,parseInt(0),parseInt(0-r[3]*s)),a.lineTo(parseInt(0),parseInt(0+n+r[0]*s)),0!==r[0]&&a.quadraticCurveTo(0,0+n,parseInt(0+r[0]),parseInt(0+n))}},{key:"draw",value:function(t){var e=this.context.$model;e.radius.length?this._buildRadiusPath(t):t.drawRect(0,0,e.width,e.height),t.closePath()}}]),i}(),wt=function(){function i(t){o(this,i);var e=m._.extend(!0,{pointList:[],r0:0,r:0,startAngle:0,endAngle:0,clockwise:!1},t.context);return t.context=e,t.regAngle=[],t.isRing=!1,t.type="sector",h(this,c(i).call(this,t))}return f(i,it),l(i,[{key:"watch",value:function(t){"r0"!=t&&"r"!=t&&"startAngle"!=t&&"endAngle"!=t&&"clockwise"!=t||(this.isRing=!1,this.graphics.clear())}},{key:"draw",value:function(t){var e=this.context.$model,i=void 0===e.r0?0:e.r0,n=e.r,r=ct.degreeTo360(e.startAngle),a=ct.degreeTo360(e.endAngle);e.startAngle!=e.endAngle&&Math.abs(e.startAngle-e.endAngle)%360==0&&(this.isRing=!0,r=0,a=360),r=ct.degreeToRadian(r),a=ct.degreeToRadian(a);var s=t;this.isRing?0==e.r0?s.drawCircle(0,0,e.r):(e.fillStyle&&e.fillAlpha&&(s.beginPath(),s.arc(0,0,n,r,a,e.clockwise),0==e.r0?s.lineTo(0,0):s.arc(0,0,i,a,r,!e.clockwise),s.closePath(),s.currentPath.lineWidth=0,s.currentPath.strokeStyle=null,s.currentPath.strokeAlpha=0,s.currentPath.line=!1),e.lineWidth&&e.strokeStyle&&e.strokeAlpha&&(s.beginPath(),s.arc(0,0,n,r,a,e.clockwise),s.closePath(),s.currentPath.fillStyle=null,s.currentPath.fill=!1,s.beginPath(),s.arc(0,0,i,a,r,!e.clockwise),s.closePath(),s.currentPath.fillStyle=null,s.currentPath.fill=!1)):(s.beginPath(),s.arc(0,0,n,r,a,e.clockwise),0==e.r0?s.lineTo(0,0):s.arc(0,0,i,a,r,!e.clockwise),s.closePath())}}]),i}(),mt=function(){function i(t){o(this,i);var e=m._.extend(!0,{control:{x:0,y:0},point:{x:0,y:0},angle:null,theta:30,headlen:6,lineWidth:1,strokeStyle:"#666",fillStyle:null},t.context);return t.context=e,t.type="arrow",h(this,c(i).call(this,t))}return f(i,it),l(i,[{key:"watch",value:function(t){"x"!=t&&"y"!=t&&"theta"!=t&&"headlen"!=t&&"angle"!=t||this.graphics.clear()}},{key:"draw",value:function(t){var e=this.context.$model,i=e.control.x,n=e.control.y,r=e.point.x,a=e.point.y,s=null!=e.angle?e.angle-180:180*Math.atan2(n-a,i-r)/Math.PI,h=(s+e.theta)*Math.PI/180,o=(s-e.theta)*Math.PI/180,l=e.headlen*Math.cos(h),c=e.headlen*Math.sin(h),u=e.headlen*Math.cos(o),f=e.headlen*Math.sin(o),d=r+l,p=a+c;return t.moveTo(d,p),t.lineTo(r,a),t.lineTo(r+u,a+f),e.fillStyle&&(t.lineTo(d,p),t.closePath()),this}}]),i}(),kt={version:"2.0.67",App:j};return kt.Display={DisplayObject:E,DisplayObjectContainer:$,Stage:F,Sprite:U,Shape:it,Point:v,Text:nt},kt.Shapes={BrokenLine:ut,Circle:ft,Droplet:pt,Ellipse:vt,Isogon:yt,Line:_t,Path:dt,Polygon:gt,Rect:xt,Sector:wt,Arrow:mt},kt.AnimationFrame=T,kt.utils=d,kt}(mmvis);