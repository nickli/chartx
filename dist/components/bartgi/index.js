"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_possibleConstructorReturn2=_interopRequireDefault(require("@babel/runtime/helpers/possibleConstructorReturn")),_getPrototypeOf2=_interopRequireDefault(require("@babel/runtime/helpers/getPrototypeOf")),_assertThisInitialized2=_interopRequireDefault(require("@babel/runtime/helpers/assertThisInitialized")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_inherits2=_interopRequireDefault(require("@babel/runtime/helpers/inherits")),_component=_interopRequireDefault(require("../component")),_canvax=_interopRequireDefault(require("canvax")),_mmvis=require("mmvis"),Line=_canvax.default.Shapes.Line,barTgi=function(e){function i(e,t){var a;return(0,_classCallCheck2.default)(this,i),(a=(0,_possibleConstructorReturn2.default)(this,(0,_getPrototypeOf2.default)(i).call(this,e,t))).name="barTgi",a.data=null,a.barDatas=null,a._yAxis=null,a.sprite=null,a.pos={x:0,y:0},_mmvis._.extend(!0,(0,_assertThisInitialized2.default)(a),(0,_mmvis.getDefaultProps)(i.defaultProps()),e),a._yAxis=a.app.getComponent({name:"coord"})._yAxis["left"==a.yAxisAlign?0:1],a.sprite=new _canvax.default.Display.Sprite,a.app.graphsSprite.addChild(a.sprite),a}return(0,_inherits2.default)(i,e),(0,_createClass2.default)(i,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},barField:{detail:"这个bartgi组件对应的bar Graph 的field",default:null},yAxisAlign:{detail:"这个bartgi组件回到到哪个y轴",default:"left"},standardVal:{detail:"tgi标准线",default:100},line:{detail:"bar对应的tgi线配置",propertys:{lineWidth:{detail:"线宽",default:3},strokeStyle:{detail:"线颜色",default:function(e){return e>=this.standardVal?"#43cbb5":"#ff6060"}}}}}}}]),(0,_createClass2.default)(i,[{key:"reset",value:function(e){_mmvis._.extend(!0,this,e),this.barDatas=null,this.data=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var l=this,e=this.app.getComponent({name:"coord"});this.pos={x:e.origin.x,y:e.origin.y},this.setPosition(),_mmvis._.each(l.app.getComponents({name:"graphs"}),function(e){if("bar"==e.type&&e.data[l.barField])return l.barDatas=e.data[l.barField],!1}),this.data=_mmvis._.flatten(l.app.dataFrame.getDataOrg(l.field)),this.barDatas&&_mmvis._.each(this.data,function(e,t){var a=-l._yAxis.getPosOfVal(e),i=l.barDatas[t],r=new Line({context:{start:{x:i.x,y:a},end:{x:i.x+i.width,y:a},lineWidth:2,strokeStyle:l._getProp(l.line.strokeStyle,e,t)}});l.sprite.addChild(r)})}},{key:"_getProp",value:function(e,t,a){var i=e;return _mmvis._.isFunction(e)&&(i=e.apply(this,[t,a])),i}}]),i}(_component.default);_mmvis.global.registerComponent(barTgi,"barTgi");var _default2=barTgi;exports.default=_default2;