"use strict";!function(t,e){if("function"==typeof define&&define.amd)define(["exports","../component","canvax","mmvis"],e);else if("undefined"!=typeof exports)e(exports,require("../component"),require("canvax"),require("mmvis"));else{var n={};e(n,t.component,t.canvax,t.mmvis),t.undefined=n}}(void 0,function(t,e,n,i){Object.defineProperty(t,"__esModule",{value:!0});var r=o(e),a=o(n);function o(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function p(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=a.default.Shapes.Line,y=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(b,r.default),p(b,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},barField:{detail:"这个bartgi组件对应的bar Graph 的field",default:null},yAxisAlign:{detail:"这个bartgi组件回到到哪个y轴",default:"left"},standardVal:{detail:"tgi标准线",default:100},line:{detail:"bar对应的tgi线配置",propertys:{lineWidth:{detail:"线宽",default:3},strokeStyle:{detail:"线颜色",default:function(t){return t>=this.standardVal?"#43cbb5":"#ff6060"}}}}}}}]),p(b,[{key:"reset",value:function(t){i._.extend(!0,this,t),this.barDatas=null,this.data=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var a=this,t=this.app.getComponent({name:"coord"});this.pos={x:t.origin.x,y:t.origin.y},this.setPosition(),i._.each(a.app.getComponents({name:"graphs"}),function(t){if("bar"==t.type&&t.data[a.barField])return a.barDatas=t.data[a.barField],!1}),this.data=i._.flatten(a.app.dataFrame.getDataOrg(a.field)),this.barDatas&&i._.each(this.data,function(t,e){var n=-a._yAxis.getPosOfVal(t),r=a.barDatas[e],i=new c({context:{start:{x:r.x,y:n},end:{x:r.x+r.width,y:n},lineWidth:2,strokeStyle:a._getProp(a.line.strokeStyle,t,e)}});a.sprite.addChild(i)})}},{key:"_getProp",value:function(t,e,n){var r=t;return i._.isFunction(t)&&(r=t.apply(this,[e,n])),r}}]),b);function b(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),(n=function(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?s(t):e}(this,u(b).call(this,t,e))).name="barTgi",n.data=null,n.barDatas=null,n._yAxis=null,n.sprite=null,n.pos={x:0,y:0},i._.extend(!0,s(n),(0,i.getDefaultProps)(b.defaultProps()),t),n._yAxis=n.app.getComponent({name:"coord"})._yAxis["left"==n.yAxisAlign?0:1],n.sprite=new a.default.Display.Sprite,n.app.graphsSprite.addChild(n.sprite),n}i.global.registerComponent(y,"barTgi"),t.default=y});