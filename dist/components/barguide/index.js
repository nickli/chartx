"use strict";!function(e,t){if("function"==typeof define&&define.amd)define(["exports","../component","canvax","mmvis"],t);else if("undefined"!=typeof exports)t(exports,require("../component"),require("canvax"),require("mmvis"));else{var n={};t(n,e.component,e.canvax,e.mmvis),e.undefined=n}}(void 0,function(e,t,n,u){Object.defineProperty(e,"__esModule",{value:!0});var i=l(t),f=l(n);function l(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function s(e,t,n){return t&&d(e.prototype,t),n&&d(e,n),e}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(y,i.default),s(y,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},barField:{detail:"这个guide对应的bar Graph 的field",default:null},yAxisAlign:{detail:"这个guide组件回到到哪个y轴",default:"left"},node:{detail:"单个节点配置",propertys:{shapeType:{detail:"节点绘制的图形类型",default:"circle"},lineWidth:{detail:"图表描边线宽",default:3},radius:{detail:"图形半径",default:6},fillStyle:{detail:"填充色",default:"#19dea1"},strokeStyle:{detail:"描边色",default:"#fff"}}},label:{detail:"文本配置",propertys:{fontSize:{detail:"字体大小",default:12},fontColor:{detail:"字体颜色",default:"#19dea1"},verticalAlign:{detail:"垂直对齐方式",default:"bottom"},textAlign:{detail:"水平对齐方式",default:"center"},strokeStyle:{detail:"文本描边颜色",default:"#fff"},lineWidth:{detail:"文本描边线宽",default:0},format:{detail:"文本格式处理函数",default:null}}}}}}]),s(y,[{key:"reset",value:function(e){u._.extend(!0,this,e),this.barDatas=null,this.data=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var o=this,e=this.app.getComponent({name:"coord"});this.pos={x:e.origin.x,y:e.origin.y},this.setPosition(),u._.each(o.app.getComponents({name:"graphs"}),function(e){if("bar"==e.type&&e.data[o.barField])return o.barDatas=e.data[o.barField],!1}),this.data=u._.flatten(o.app.dataFrame.getDataOrg(o.field)),this.barDatas&&u._.each(this.data,function(e,t){var n=-o._yAxis.getPosOfVal(e),i=o.barDatas[t],l=new f.default.Shapes.Circle({context:{x:i.x+i.width/2,y:n,r:o.node.radius,fillStyle:o.node.fillStyle,strokeStyle:o.node.strokeStyle,lineWidth:o.node.lineWidth}}),a=e;u._.isFunction(o.label.format)&&(a=o.label.format(e,i));var r=new f.default.Display.Text(a,{context:{x:i.x+i.width/2,y:n-o.node.radius-1,fillStyle:o.label.fontColor,lineWidth:o.label.lineWidth,strokeStyle:o.label.strokeStyle,fontSize:o.label.fontSize,textAlign:o.label.textAlign,textBaseline:o.label.verticalAlign}});o.sprite.addChild(l),o.sprite.addChild(r)})}},{key:"_getProp",value:function(e,t,n){var i=e;return u._.isFunction(e)&&(i=e.apply(this,[t,n])),i}}]),y);function y(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),(n=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?o(e):t}(this,r(y).call(this,e,t))).name="barGuide",n.data=null,n.barDatas=null,n._yAxis=null,n.sprite=null,u._.extend(!0,o(n),(0,u.getDefaultProps)(y.defaultProps()),e),n._yAxis=n.app.getComponent({name:"coord"})._yAxis["left"==n.yAxisAlign?0:1],n.sprite=new f.default.Display.Sprite,n.app.graphsSprite.addChild(n.sprite),n}u.global.registerComponent(c,"barGuide"),e.default=c});