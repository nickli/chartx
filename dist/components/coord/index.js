"use strict";!function(e,t){if("function"==typeof define&&define.amd)define(["exports","../component","canvax","mmvis"],t);else if("undefined"!=typeof exports)t(exports,require("../component"),require("canvax"),require("mmvis"));else{var n={};t(n,e.component,e.canvax,e.mmvis),e.undefined=n}}(void 0,function(e,t,n,f){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=o(t),r=o(n);function o(e){return e&&e.__esModule?e:{default:e}}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function c(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(y,i.default),c(y,null,[{key:"defaultProps",value:function(){return{type:{detail:"坐标系组件",documentation:"坐标系组件，可选值有'rect'（二维直角坐标系）,'polar'（二维极坐标系）,'box'（三维直角坐标系） ",insertText:"type: ",default:"",values:["rect","polar","box","polar3d"]},width:{detail:"坐标系width",default:0},height:{detail:"坐标系height",default:0},origin:{detail:"坐标系原点",propertys:{x:{detail:"原点x位置",default:0},y:{detail:"原点x位置",default:0}}}}}}]),c(y,[{key:"setFieldsMap",value:function(e){var o=this,a=0,u=e.type||"yAxis",t=[];return f._.each(this.getAxiss(e),function(e){e.field&&(t=t.concat(e.field))}),function e(t){f._.isString(t)&&(t=[t]);for(var n=f._.clone(t),i=0,r=t.length;i<r;i++)f._.isString(t[i])&&(n[i]={field:t[i],enabled:!0,color:o.app.getTheme(a),ind:a++},n[i][u]=o.getAxis({type:u,field:t[i]})),f._.isArray(t[i])&&(n[i]=e(t[i]));return n}(t)}},{key:"setFieldEnabled",value:function(i){!function n(e){f._.each(e,function(e,t){f._.isArray(e)?n(e):e.field&&e.field==i&&(e.enabled=!e.enabled)})}(this.fieldsMap)}},{key:"getFieldMapOf",value:function(i){var r=null;return function n(e){f._.each(e,function(e,t){if(f._.isArray(e))n(e);else if(e.field&&e.field==i)return r=e,!1})}(this.fieldsMap),r}},{key:"getEnabledFieldsOf",value:function(i){var r=[],o=i?i.type:"yAxis";return f._.each(this.fieldsMap,function(e,t){if(f._.isArray(e)){var n=[];f._.each(e,function(e,t){e[o]===i&&e.field&&e.enabled&&n.push(e.field)}),n.length&&r.push(n)}else e[o]===i&&e.field&&e.enabled&&r.push(e.field)}),r}},{key:"filterEnabledFields",value:function(e){var n=this,i=[];return f._.isArray(e)||(e=[e]),f._.each(e,function(e){if(f._.isArray(e)){var t=[];f._.each(e,function(e){n.getFieldMapOf(e).enabled&&t.push(e)}),t.length&&i.push(t)}else n.getFieldMapOf(e).enabled&&i.push(e)}),i}},{key:"getAxisDataFrame",value:function(e){return{field:e,org:this.dataFrame.getDataOrg(e,function(e){return null==e||""==e?e:isNaN(Number(e))?e:Number(e)})}}},{key:"hide",value:function(e){this.changeFieldEnabled(e)}},{key:"show",value:function(e){this.changeFieldEnabled(e)}},{key:"getSizeAndOrigin",value:function(){return{width:this.width,height:this.height,origin:this.origin}}},{key:"getPoint",value:function(){}},{key:"getAxisOriginPoint",value:function(){}},{key:"getOriginPos",value:function(){}},{key:"getAxis",value:function(e){return this.getAxiss(e)[0]}},{key:"getAxiss",value:function(a){var u=[],l=0;for(var e in a)l++;return f._.each(this._axiss,function(e){var t=0;for(var n in a)if("field"==n){var i=f._.flatten([e[n]]),r=f._.flatten([a[n]]),o=!0;f._.each(r,function(e){-1==f._.indexOf(i,e)&&(o=!1)}),o&&t++}else JSON.stringify(e[n])==JSON.stringify(a[n])&&t++;l==t&&u.push(e)}),u}}]),y);function y(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,y),n=function(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?l(e):t}(this,u(y).call(this,e,t)),f._.extend(!0,l(n),(0,f.getDefaultProps)(y.defaultProps())),n.name="coord",n._opt=e,n.app=t,n.dataFrame=n.app.dataFrame,n.sprite=new r.default.Display.Sprite({name:"coord_"+e.type}),n.app.coordSprite.addChild(n.sprite),n.fieldsMap=null,n.induce=null,n._axiss=[],n}e.default=p});