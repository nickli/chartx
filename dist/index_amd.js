define(["mmvis","canvax"],function(i,n){"use strict";i=i&&i.hasOwnProperty("default")?i.default:i,n=n&&n.hasOwnProperty("default")?n.default:n;var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function d(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function t(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function e(t,e){return t(e={exports:{}},e.exports),e.exports}t(e(function(t,e){!function(t,e,c){Object.defineProperty(t,"__esModule",{value:!0});var n,a=(n=e)&&n.__esModule?n:{default:n};function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u,d,f=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(h,c.event.Dispatcher),u=h,(d=[{key:"init",value:function(){var r=this,e=this._opt;for(var i in this.padding=this._getPadding(),c._.each(this.__highModules,function(i){if(e[i]){var t=c._.flatten([e[i]]);"theme"==i&&(t=[t]),c._.each(t,function(t){if(("coord"!=i||t.type)&&("graphs"!=i||t.field||t.keyField)){var e=r.componentModules.get(i,t.type);if(e){var n=new e(t,r);r.components.push(n)}}})}}),this._opt)if(-1==c._.indexOf(this.__highModules,i)){var t=this._opt[i];c._.isArray(t)||(t=[t]),c._.each(t,function(t){var e=r.componentModules.get(i,t.type);if(e){var n=new e(t,r);r.components.push(n)}})}}},{key:"draw",value:function(t){var n=this;t=t||{};var e=this.getComponent({name:"coord"});e&&e.horizontal&&this._drawBeginHorizontal();var i=this.width-this.padding.left-this.padding.right,r=this.height-this.padding.top-this.padding.bottom,a={x:this.padding.left,y:this.padding.top};if(e&&(e.draw(t),i=e.width,r=e.height,a=e.origin),0!=this.dataFrame.length){var o=this.getComponents({name:"graphs"}),l=o.length,s=0;t=c._.extend(t,{width:i,height:r,origin:a}),c._.each(o,function(e){e.on("complete",function(t){++s==l&&n.fire("complete"),e.inited=!0}),e.draw(t)});for(var u=0,d=this.components.length;u<d;u++){var f=this.components[u];-1==c._.indexOf(this.__highModules,f.name)&&f.draw(t)}this._bindEvent(),e&&e.horizontal&&this._drawEndHorizontal()}else n.fire("complete")}},{key:"_drawBeginHorizontal",value:function(){var t=this.padding,e=t.top;t.top=t.right,t.right=t.bottom,t.bottom=t.left,t.left=e}},{key:"_drawEndHorizontal",value:function(){var t=this.graphsSprite.context;t.x+=(this.width-this.height)/2,t.y+=(this.height-this.width)/2,t.rotation=90,t.rotateOrigin={x:this.height/2,y:this.width/2},this._horizontalGraphsText()}},{key:"_horizontalGraphsText",value:function(){c._.each(this.getComponents({name:"graphs"}),function(t){!function e(t){if(t.children&&c._.each(t.children,function(t){e(t)}),"text"==t.type&&!t.__horizontal){var n=t.context;n.width,n.height,n.rotation=n.rotation-90,t.__horizontal=!0}}(t.sprite)})}},{key:"_getPadding",value:function(){var t=20;this._opt.coord&&"padding"in this._opt.coord&&(c._.isObject(this._opt.coord.padding)||(t=this._opt.coord.padding));var e={top:t,right:t,bottom:t,left:t};return this._opt.coord&&"padding"in this._opt.coord&&c._.isObject(this._opt.coord.padding)&&(e=c._.extend(e,this._opt.coord.padding)),e}},{key:"getTheme",value:function(t){var e=c.global.getGlobalTheme(),n=this.getComponent({name:"theme"});return n&&(e=n.get()),null!=t?e[t%e.length]||"#ccc":e}},{key:"setCoord_Graphs_Sp",value:function(){this.coordSprite=new a.default.Display.Sprite({id:"coordSprite"}),this.stage.addChild(this.coordSprite),this.graphsSprite=new a.default.Display.Sprite({id:"graphsSprite"}),this.stage.addChild(this.graphsSprite)}},{key:"destroy",value:function(){this.clean(),this.el&&(this.el.removeAttribute("chart_id"),this.el.removeAttribute("chartx_version"),this.canvax.destroy(),this.el=null),this._destroy&&this._destroy(),this.fire("destroy")}},{key:"clean",value:function(){for(var t=0,e=this.canvax.children.length;t<e;t++)for(var n=this.canvax.getChildAt(t),i=0,r=n.children.length;i<r;i++)n.getChildAt(i).destroy(),i--,r--;this.setCoord_Graphs_Sp(),this.components=[],this.canvax.domView.innerHTML=""}},{key:"resize",value:function(){var t=parseInt(this.el.offsetWidth),e=parseInt(this.el.offsetHeight);t==this.width&&e==this.height||(this.width=t,this.height=e,this.canvax.resize(),this.inited=!1,this.clean(),this.init(),this.draw({resize:!0}),this.inited=!0)}},{key:"reset",value:function(t,e){t&&(this._opt=t),e&&(this._data=e),this.dataFrame=this.initData(this._data,t),this.clean(),this.init(),this.draw()}},{key:"resetData",value:function(t,e){var n=this;this._data=t;var i=this.dataFrame.org.length;if(this.dataFrame.resetData(t),!i)return this.clean(),this.init(),void this.draw(this._opt);var r=this.getComponent({name:"coord"});r&&r.resetData(this.dataFrame,e),c._.each(this.getComponents({name:"graphs"}),function(t){t.resetData(n.dataFrame,e)}),this.componentsReset(e),r&&r.horizontal&&this._horizontalGraphsText(),this.fire("resetData")}},{key:"initData",value:function(){return c.dataFrame.apply(this,arguments)}},{key:"componentsReset",value:function(n){var i=this;c._.each(this.components,function(t,e){-1==c._.indexOf(i.__highModules,t.name)&&(n&&n.comp&&n.comp.__cid==t.__cid||t.reset&&t.reset(i[t.type]||{},i.dataFrame))})}},{key:"getComponentById",value:function(e){var n;return c._.each(this.components,function(t){if(t.id&&t.id==e)return n=t,!1}),n}},{key:"getComponent",value:function(t){return this.getComponents(t)[0]}},{key:"getComponents",value:function(i,t){var r=[],a=0;for(var e in t=t||this.components,i)a++;return a?(c._.each(t,function(t){var e=0;for(var n in i)JSON.stringify(t[n])==JSON.stringify(i[n])&&e++;a==e&&r.push(t)}),r):t}},{key:"getGraph",value:function(t){return this.getGraphs(t)[0]}},{key:"getGraphs",value:function(t){return this.getComponents(t,this.getComponents({name:"graphs"}))}},{key:"getGraphById",value:function(e){var n;return c._.each(this.getComponents({name:"graphs"}),function(t){if(t.id==e)return n=t,!1}),n}},{key:"getCoord",value:function(t){return this.getComponent(c._.extend(!0,{name:"coord"},t))}},{key:"getLegendData",value:function(){var i=this,r=[];if(c._.each(this.getComponents({name:"graphs"}),function(t){c._.each(t.getLegendData(),function(e){if(!c._.find(r,function(t){return t.name==e.name})){var t=c._.extend(!0,{},e);t.color=e.fillStyle||e.color||e.style,r.push(t)}})}),r.length)return r;var t=i.getComponent({name:"coord"});return c._.each(c._.flatten(t.fieldsMap),function(e,t){var n=!1;c._.each(i._opt.graphs,function(t){if(-1<c._.indexOf(c._.flatten([t.field]),e.field))return!(n=!0)}),n&&r.push({enabled:e.enabled,name:e.field,field:e.field,ind:e.ind,color:e.color,yAxis:e.yAxis})}),r}},{key:"show",value:function(e,n){var t=this.getComponent({name:"coord"});t&&t.show(e,n),c._.each(this.getComponents({name:"graphs"}),function(t){t.show(e,n)}),this.componentsReset(n)}},{key:"hide",value:function(e,n){var t=this.getComponent({name:"coord"});t&&t.hide(e,n),c._.each(this.getComponents({name:"graphs"}),function(t){t.hide(e,n)}),this.componentsReset(n)}},{key:"_bindEvent",value:function(){var i=this;this.on(c.event.types.get(),function(e){e.eventInfo&&c._.each(this.getGraphs(),function(t){t.triggerEvent(e)});var t=i.getComponent({name:"tips"}),n=i.getComponent({name:"coord"});t&&(i._setGraphsTipsInfo.apply(i,[e]),"mouseover"!=e.type&&"mousedown"!=e.type||(t.show(e),i._tipsPointerAtAllGraphs(e)),"mousemove"==e.type&&(t.move(e),i._tipsPointerAtAllGraphs(e)),"mouseout"!=e.type||e.toTarget&&n&&n.induce&&n.induce.containsPoint(n.induce.globalToLocal(e.target.localToGlobal(e.point)))||(t.hide(e),i._tipsPointerHideAtAllGraphs(e)))})}},{key:"_setGraphsTipsInfo",value:function(e){e.eventInfo||(e.eventInfo={});var t=this.getComponent({name:"coord"});if(t&&(e.eventInfo=t.getTipsInfoHandler(e)),"tipsEnabled"in e.eventInfo||(e.eventInfo.tipsEnabled=!0),!e.eventInfo.nodes||!e.eventInfo.nodes.length){var n=[],i=e.eventInfo.iNode;c._.each(this.getComponents({name:"graphs"}),function(t){n=n.concat(t.getNodesAt(i,e))}),e.eventInfo.nodes=n}}},{key:"_tipsPointerAtAllGraphs",value:function(e){c._.each(this.getComponents({name:"graphs"}),function(t){t.tipsPointerOf(e)})}},{key:"_tipsPointerHideAtAllGraphs",value:function(e){c._.each(this.getComponents({name:"graphs"}),function(t){t.tipsPointerHideOf(e)})}}])&&r(u.prototype,d),h);function h(t,e,n,i){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(r=o(this,l(h).call(this))).componentModules=i,r._node=t,r._data=e,r._opt=n,r.dataFrame=r.initData(e,n),r.el=c.$.query(t),r.width=parseInt(r.el.offsetWidth),r.height=parseInt(r.el.offsetHeight),r.padding=null,r.canvax=new a.default.App({el:r.el,webGL:!1}),r.canvax.registEvent(),r.id="chartx_"+r.canvax.id,r.el.setAttribute("chart_id",r.id),r.el.setAttribute("chartx_version","2.0"),r.stage=new a.default.Display.Stage({id:"main-chart-stage"}),r.canvax.addChild(r.stage),r.setCoord_Graphs_Sp(),r.__highModules=["theme","coord","graphs"],r.components=[],r.inited=!1,r.init(),r}c.global.registerComponent(f,"chart"),t.default=f}(e,n,i)}));var a=e(function(t,e){!function(t,e,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,r=(n=e)&&n.__esModule?n:{default:n};function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(c,i.event.Dispatcher),u(c,null,[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启该组件",default:!1}}}},{key:"_isComponentRoot",value:function(){return!0}}]),u(c,[{key:"init",value:function(){}},{key:"draw",value:function(){}},{key:"destroy",value:function(){}},{key:"reset",value:function(){}},{key:"setPosition",value:function(t){(t=t||this.pos).x&&(this.sprite.context.x=t.x),t.y&&(this.sprite.context.y=t.y)}},{key:"layout",value:function(){}}]),c);function c(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),n=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?l(t):e}(this,o(c).call(this,t,e)),i._.extend(!0,l(n),(0,i.getDefaultProps)(c.defaultProps()),t),n.name="component",n.type=null,n._opt=t,n.app=e,n.width=0,n.height=0,n.pos={x:0,y:0},n.margin={top:0,right:0,bottom:0,left:0},n.__cid=r.default.utils.createId("comp_"),n}t.default=f}(e,n,i)});t(a);var o=e(function(t,e){!function(t,e,n,u){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(e),r=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,i.default),f(p,null,[{key:"defaultProps",value:function(){return{type:{detail:"坐标系组件",documentation:"坐标系组件，可选值有'rect'（二维直角坐标系）,'polar'（二维极坐标系）,'box'（三维直角坐标系） ",insertText:"type: ",default:"",values:["rect","polar","box","polar3d"]},width:{detail:"坐标系width",default:0},height:{detail:"坐标系height",default:0},origin:{detail:"坐标系原点",propertys:{x:{detail:"原点x位置",default:0},y:{detail:"原点x位置",default:0}}}}}}]),f(p,[{key:"setFieldsMap",value:function(t){var a=this,o=0,l=t.type||"yAxis",e=[];return u._.each(this.getAxiss(t),function(t){t.field&&(e=e.concat(t.field))}),function t(e){u._.isString(e)&&(e=[e]);for(var n=u._.clone(e),i=0,r=e.length;i<r;i++)u._.isString(e[i])&&(n[i]={field:e[i],enabled:!0,color:a.app.getTheme(o),ind:o++},n[i][l]=a.getAxis({type:l,field:e[i]})),u._.isArray(e[i])&&(n[i]=t(e[i]));return n}(e)}},{key:"setFieldEnabled",value:function(i){!function n(t){u._.each(t,function(t,e){u._.isArray(t)?n(t):t.field&&t.field==i&&(t.enabled=!t.enabled)})}(this.fieldsMap)}},{key:"getFieldMapOf",value:function(i){var r=null;return function n(t){u._.each(t,function(t,e){if(u._.isArray(t))n(t);else if(t.field&&t.field==i)return r=t,!1})}(this.fieldsMap),r}},{key:"getEnabledFieldsOf",value:function(i){var r=[],a=i?i.type:"yAxis";return u._.each(this.fieldsMap,function(t,e){if(u._.isArray(t)){var n=[];u._.each(t,function(t,e){t[a]===i&&t.field&&t.enabled&&n.push(t.field)}),n.length&&r.push(n)}else t[a]===i&&t.field&&t.enabled&&r.push(t.field)}),r}},{key:"filterEnabledFields",value:function(t){var n=this,i=[];return u._.isArray(t)||(t=[t]),u._.each(t,function(t){if(u._.isArray(t)){var e=[];u._.each(t,function(t){n.getFieldMapOf(t).enabled&&e.push(t)}),e.length&&i.push(e)}else n.getFieldMapOf(t).enabled&&i.push(t)}),i}},{key:"getAxisDataFrame",value:function(t){return{field:t,org:this.dataFrame.getDataOrg(t,function(t){return null==t||""==t?t:isNaN(Number(t))?t:Number(t)})}}},{key:"hide",value:function(t){this.changeFieldEnabled(t)}},{key:"show",value:function(t){this.changeFieldEnabled(t)}},{key:"getSizeAndOrigin",value:function(){return{width:this.width,height:this.height,origin:this.origin}}},{key:"getPoint",value:function(){}},{key:"getAxisOriginPoint",value:function(){}},{key:"getOriginPos",value:function(){}},{key:"getAxis",value:function(t){return this.getAxiss(t)[0]}},{key:"getAxiss",value:function(o){var l=[],s=0;for(var t in o)s++;return u._.each(this._axiss,function(t){var e=0;for(var n in o)if("field"==n){var i=u._.flatten([t[n]]),r=u._.flatten([o[n]]),a=!0;u._.each(r,function(t){-1==u._.indexOf(i,t)&&(a=!1)}),a&&e++}else JSON.stringify(t[n])==JSON.stringify(o[n])&&e++;s==e&&l.push(t)}),l}}]),p);function p(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?s(t):e}(this,l(p).call(this,t,e)),u._.extend(!0,s(n),(0,u.getDefaultProps)(p.defaultProps())),n.name="coord",n._opt=t,n.app=e,n.dataFrame=n.app.dataFrame,n.sprite=new r.default.Display.Sprite({name:"coord_"+t.type}),n.app.coordSprite.addChild(n.sprite),n.fieldsMap=null,n.induce=null,n._axiss=[],n}t.default=h}(e,a,n,i)});t(o);var l=e(function(t,e){var n,s;n=e,s=i,Object.defineProperty(n,"__esModule",{value:!0}),n.numAddSymbol=function(t,e){var n=Number(t),i=e||",";if(!n)return String(t);if(1e3<=n){var r=parseInt(n/1e3);return String(t.toString().replace(r,r+i))}return String(t)},n.getDisMinATArr=function(t,e){for(var n=0,i=Math.abs(t-e[0]),r=1,a=e.length;r<a;r++)i>Math.abs(t-e[r])&&(i=Math.abs(t-e[r]),n=r);return n},n.getPath=function(t){var e="",n={x:0,y:0};e=s._.isArray(t[0])?(n.x=t[0][0],n.y=t[0][1],"M"+t[0][0]+" "+t[0][1]):(n=t[0],"M"+t[0].x+" "+t[0].y);for(var i=1,r=t.length;i<r;i++){var a,o=0,l=t[i];a=s._.isArray(l)?(o=l[0],l[1]):(o=l.x,l.y),o==n.x&&a==n.y?e+=" z":e+=" L"+o+" "+a}return e}});t(l);var u=e(function(t,e){!function(t,r){function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function n(t,e){return(n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n(t,e)}(u,r.axis),e(u,null,[{key:"defaultProps",value:function(){return{field:{detail:"轴字段配置",documentation:"目前x轴的field只支持单维度设置，也就是说只支持一条x轴",default:[]},layoutType:{detail:"布局方式",default:"rule"},width:{detail:"轴宽",default:0},height:{detail:"轴高",default:0},enabled:{detail:"是否显示轴",default:!0},animation:{detail:"是否开启动画",default:!0},title:{detail:"轴名称",propertys:{shapeType:"text",textAlign:{detail:"水平对齐方式",default:"center"},textBaseline:{detail:"基线对齐方式",default:"middle"},strokeStyle:{detail:"文本描边颜色",default:null},lineHeight:{detail:"行高",default:0},text:{detail:"轴名称的内容",default:""},fontColor:{detail:"颜色",default:"#999"},fontSize:{detail:"字体大小",default:12}}},tickLine:{detail:"刻度线",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"刻度线宽",default:1},lineLength:{detail:"刻度线长度",default:4},distance:{detail:"和前面一个元素的距离",default:2},strokeStyle:{detail:"描边颜色",default:"#cccccc"}}},axisLine:{detail:"轴线配置",propertys:{enabled:{detail:"是否有轴线",default:!0},position:{detail:"轴线的位置",documentation:'default在align的位置（left，right），可选 "center" 和 具体的值',default:"default"},lineWidth:{detail:"轴线宽度",default:1},strokeStyle:{detail:"轴线的颜色",default:"#cccccc"}}},label:{detail:"刻度文本",propertys:{enabled:{detail:"是否显示刻度文本",default:!0},fontColor:{detail:"文本颜色",default:"#999"},fontSize:{detail:"字体大小",default:12},rotation:{detail:"旋转角度",default:0},format:{detail:"label文本的格式化处理函数",default:null},distance:{detail:"和轴线之间的间距",default:2},textAlign:{detail:"水平方向对齐方式",default:"center"},lineHeight:{detail:"文本的行高",default:1},evade:{detail:"是否开启逃避算法,目前的逃避只是隐藏",default:!0}}},filter:{detail:"过滤函数",documentation:"可以用来过滤哪些yaxis 的 节点是否显示已经颜色之类的",default:null},trimLayout:{detail:"自定义的显示规则函数",documentation:"如果用户有手动的 trimLayout ，那么就全部visible为true，然后调用用户自己的过滤程序",default:null}}}}]),e(u,[{key:"drawWaterLine",value:function(t){"proportion"==this.layoutType&&t>=this._min&&t<=this._max||(this.dataSection=[],this.setWaterLine(t),this._initHandle(),this.draw())}}]),u);function u(t,e,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?l(t):e}(this,o(u).call(this,t,e)),r._.extend(!0,l(i),(0,r.getDefaultProps)(u.defaultProps())),i}t.default=s}(e,i)});t(u);var f=e(function(t,e){!function(t,e,n,_,i){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var v=a(e),r=a(i);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var x=v.default.Shapes.Line,c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(h,r.default),d(h,null,[{key:"defaultProps",value:function(){return{}}}]),d(h,[{key:"init",value:function(t){this._setField(),this._initHandle(t),this.sprite=new v.default.Display.Sprite({id:"xAxisSprite_"+(new Date).getTime()}),this.rulesSprite=new v.default.Display.Sprite({id:"xRulesSprite_"+(new Date).getTime()}),this.sprite.addChild(this.rulesSprite)}},{key:"_initHandle",value:function(t){var i=this;t&&(!t.isH||t.label&&void 0!==t.label.rotaion||(this.label.rotation=90)),this.setDataSection(),i._formatTextSection=[],i._textElements=[],_._.each(i.dataSection,function(t,e){i._formatTextSection[e]=i._getFormatText(t,e);var n=new v.default.Display.Text(i._formatTextSection[e],{context:{fontSize:i.label.fontSize}});i._textElements[e]=n}),0!=this.label.rotation&&(this.label.textAlign="right"),this._getTitle(),this._setXAxisHeight()}},{key:"_setField",value:function(t){t&&(this.field=t),this.field=_._.flatten([this.field])[0]}},{key:"draw",value:function(t){t&&_._.extend(!0,this,t),this.setAxisLength(this.width),this._trimXAxis(),this._widget(t),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"resetData",value:function(t){this._setField(t.field),this.resetDataOrg(t.org),this._initHandle(),this.draw()}},{key:"setX",value:function(t){this.sprite.context.x=t,this.pos.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t,this.pos.y=t}},{key:"_getTitle",value:function(){this.title.text&&(this._title?this._title.resetText(this.title.text):this._title=new v.default.Display.Text(this.title.text,{context:{fontSize:this.title.fontSize,textAlign:this.title.textAlign,textBaseline:this.title.textBaseline,fillStyle:this.title.fontColor,strokeStyle:this.title.strokeStyle,lineWidth:this.title.lineWidth,rotation:this.isH?-180:0}}))}},{key:"_setXAxisHeight",value:function(){var s=this;if(s.enabled){var u=0;this.label.enabled&&_._.each(s.dataSection,function(t,e){var n=s._textElements[e],i=n.getTextWidth(),r=n.getTextHeight(),a=r;if(s.label.rotation)if(90==s.label.rotation)a=i;else{var o=Math.sin(Math.abs(s.label.rotation)*Math.PI/180),l=Math.cos(Math.abs(s.label.rotation)*Math.PI/180);a=parseInt(o*i),parseInt(l*i)}u=Math.max(u,a)}),this.height=u+this.tickLine.lineLength+this.tickLine.distance+this.label.distance,this._title&&(this.height+=this._title.getTextHeight())}else s.height=0}},{key:"getNodeInfoOfX",value:function(t){var e=this.getIndexOfPos(t),n=this.getValOfInd(e),i=this.getPosOf({ind:e,val:n});return this._getNodeInfo(e,n,i)}},{key:"getNodeInfoOfVal",value:function(t){var e=this.getIndexOfVal(t),n=this.getPosOf({ind:e,val:t});return this._getNodeInfo(e,t,n)}},{key:"_getNodeInfo",value:function(t,e,n){return{ind:t,value:e,text:this._getFormatText(e,t),x:n,field:this.field,layoutType:this.layoutType}}},{key:"_trimXAxis",value:function(){for(var t=[],e=this.dataSection,n=0,i=e.length;n<i;n++){var r=this._formatTextSection[n],a=this._textElements[n],o={ind:n,value:e[n],text:r,x:this.getPosOf({val:e[n],ind:n}),textWidth:a.getTextWidth(),field:this.field,visible:null};t.push(o)}return this.layoutData=t,this._trimLayoutData(),t}},{key:"_getFormatText",value:function(t){var e=t;return _._.isFunction(this.label.format)&&(e=this.label.format.apply(this,arguments)),_._.isNumber(e)&&"proportion"==this.layoutType&&(e=(0,n.numAddSymbol)(e)),e}},{key:"_widget",value:function(t){var e=this;if(t=t||{},e.enabled){for(var n=e.layoutData,i=0,r=0,a=n.length;r<a;r++){_._.isFunction(e.filter)&&e.filter({layoutData:n,index:r});var o=n[r];if(o.visible){var l=o.x,s=e.tickLine.lineLength+e.tickLine.distance+e.label.distance,u=e.rulesSprite.getChildAt(i),d={x:o._text_x||o.x,y:s,fillStyle:this.label.fontColor,fontSize:this.label.fontSize,rotation:-Math.abs(this.label.rotation),textAlign:this.label.textAlign,lineHeight:this.label.lineHeight,textBaseline:this.label.rotation?"middle":"top",globalAlpha:1};this.label.rotation&&90!=this.label.rotation&&(d.x+=5,d.y+=3);var f={x:l,y:this.tickLine.distance,end:{x:0,y:this.tickLine.lineLength},lineWidth:this.tickLine.lineWidth,strokeStyle:this.tickLine.strokeStyle},c=300,h=i*Math.min(1e3/n.length,25);e.animation&&!t.resize||(h=c=0),u?(u._tickLine&&e.tickLine.enabled&&u._tickLine.animate(f,{duration:c,id:u._tickLine.id}),u._txt&&e.label.enabled&&(u._txt.animate(d,{duration:c,id:u._txt.id}),u._txt.resetText(o.text))):(u=new v.default.Display.Sprite({id:"xNode"+i}),e.tickLine.enabled&&(u._tickLine=new x({id:"xAxis_tickline_"+i,context:f}),u.addChild(u._tickLine)),e.label.enabled&&(u._txt=new v.default.Display.Text(o.text,{id:"xAxis_txt_"+i,context:d}),u.addChild(u._txt),e.animation&&!t.resize&&(u._txt.context.y+=20,u._txt.context.globalAlpha=0,u._txt.animate({y:d.y,globalAlpha:1},{duration:500,delay:h,id:u._txt.id}))),e.rulesSprite.addChild(u)),i++}}if(this.rulesSprite.children.length>=i){a=i;for(var p=this.rulesSprite.children.length;a<p;a++)this.rulesSprite.getChildAt(a).remove(),a--,p--}if(this.axisLine.enabled){var y={start:{x:0,y:0},end:{x:this.width,y:0},lineWidth:this.axisLine.lineWidth,strokeStyle:this.axisLine.strokeStyle};if(this._axisLine)this._axisLine.animate(y);else{var g=new x({context:y});this.sprite.addChild(g),this._axisLine=g}}this._title&&(this._title.context.y=this.height-this._title.getTextHeight()/2,this._title.context.x=this.width/2,this.sprite.addChild(this._title))}else e.height=0}},{key:"_trimLayoutData",value:function(){var t=this.layoutData.length;this.enabled&&t&&("proportion"==this.layoutType&&this._checkOver(),"peak"==this.layoutType&&this._checkOver(),"rule"==this.layoutType&&this._checkOver())}},{key:"_getRootPR",value:function(){var t=0;return this._coord.app&&(t=this._coord.app.padding.right),t}},{key:"_checkOver",value:function(){var u=this,d=u.layoutData,f=d.length,c=u.label.textAlign;if(this.label.evade&&!u.trimLayout)!function t(e){var n=d[e];if(void 0!==n){n.visible=!0;for(var i=e;i<f-1;i++){var r=d[i+1],a=r.textWidth,o=n.textWidth;u.label.rotation&&(a=Math.min(a,22),o=Math.min(o,22));var l=r.x,s=n.x+o;if("center"==c&&(l=r.x-a/2,s=n.x+o/2),"right"==c&&(l=r.x-a,s=n.x),i==f-2&&l+a>u.width+u._getRootPR()&&("center"==c&&r.x+a/2>u.width&&(l=u.width-a,r._text_x=u.width-a/2+u._getRootPR()),"left"==c&&r.x+a>u.width&&(l=u.width-a,r._text_x=u.width-a)),!(l-s<1)){t(i+1);break}if(i==f-2)return r.visible=!0,void(n.visible=!1);r.visible=!1}}}(0);else{var t;_._.each(d,function(t){t.visible=!0}),u.trimLayout&&u.trimLayout(d);for(var e=f-1;0<=e&&!t;e--)d[e].visible&&(t=d[e]);t&&("center"==c&&t.x+t.textWidth/2>u.width&&(t._text_x=u.width-t.textWidth/2+u._getRootPR()),"left"==c&&t.x+t.textWidth>u.width&&(t._text_x=u.width-t.textWidth))}}}]),h);function h(t,e,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(i=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?s(t):e}(this,l(h).call(this,t,e.org))).type="xAxis",i._coord=n||{},i._title=null,i._axisLine=null,i._formatTextSection=[],i._textElements=[],i.pos={x:0,y:0},i.layoutData=[],i.sprite=null,i.isH=!1,_._.extend(!0,s(i),(0,_.getDefaultProps)(h.defaultProps()),t),i.init(t),i}t.default=c}(e,n,l,i,u)});t(f);var c=e(function(t,e){!function(t,e,s,m,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var w=r(e),i=r(n);function r(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var S=w.default.Shapes.Line,c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(h,i.default),d(h,null,[{key:"defaultProps",value:function(){return{align:{detail:"左右轴设置",default:"left"},layoutType:{detail:"布局方式",default:"proportion"}}}}]),d(h,[{key:"init",value:function(t){this._setField(),this._initHandle(t),this.sprite=new w.default.Display.Sprite({id:"yAxisSprite_"+(new Date).getTime()}),this.rulesSprite=new w.default.Display.Sprite({id:"yRulesSprite_"+(new Date).getTime()}),this.sprite.addChild(this.rulesSprite)}},{key:"_initHandle",value:function(t){t&&(!t.isH||t.label&&void 0!==t.label.rotaion||(this.label.rotation=90),t.label&&t.label.textAlign||(this.label.textAlign="left"==this.align?"right":"left")),this.setDataSection(),this._getTitle(),this._setYaxisWidth()}},{key:"_setField",value:function(t){t&&(this.field=t),m._.isArray(this.field)||(this.field=[this.field])}},{key:"draw",value:function(t){m._.extend(!0,this,t||{}),this.height=parseInt(this.yMaxHeight-this._getYAxisDisLine()),this.setAxisLength(this.height),this.sprite.cleanAnimates(),this._trimYAxis(),this._widget(t),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"resetData",value:function(t){this._setField(t.field),this.resetDataOrg(t.org),this._initHandle(),this.draw()}},{key:"setX",value:function(t){this.sprite.context.x=t,this.pos.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t,this.pos.y=t}},{key:"_getTitle",value:function(){if(this.title.text)if(this._title)this._title.resetText(this.title.text);else{var t=0;"left"==this.align?t=-90:(t=90,this.isH&&(t=270)),this._title=new w.default.Display.Text(this.title.text,{context:{fontSize:this.title.fontSize,textAlign:this.title.textAlign,textBaseline:this.title.textBaseline,fillStyle:this.title.fontColor,strokeStyle:this.title.strokeStyle,lineWidth:this.title.lineWidth,rotation:t}})}}},{key:"_setYaxisWidth",value:function(){}},{key:"_trimYAxis",value:function(){for(var t=[],e=0,n=this.dataSection.length;e<n;e++){var i={value:this.dataSection[e],y:-Math.abs(this.getPosOf({val:this.dataSection[e],ind:e})),visible:!0,text:""},r=i.value;m._.isFunction(this.label.format)&&(r=this.label.format.apply(this,[r,e])),null==r&&"proportion"==this.layoutType&&(r=(0,s.numAddSymbol)(i.value)),i.text=r,t.push(i)}for(var a=0,o=0,l=t.length;o<l;o++)0!=o&&(0==a?t[o].text==t[a].text?t[o].visible=!1:a=o:(t[o].text==t[a].text&&(t[a].visible=!1),a=o));this.layoutData=t,this.trimLayout&&this.trimLayout(t)}},{key:"_getYAxisDisLine",value:function(){var t=0;return t=0<(t=0+this.yMaxHeight%this.dataSection.length)?0:t}},{key:"resetWidth",value:function(t){this.width=t,"left"==this.align&&(this.rulesSprite.context.x=this.width)}},{key:"_widget",value:function(t){var e=this;if(t=t||{},e.enabled){for(var n=this.layoutData,i=0,r=e.maxW=0,a=n.length;r<a;r++){m._.isFunction(e.filter)&&e.filter({layoutData:n,index:r});var o=n[r];if(o.visible){var l=o.y,s=e.label.textAlign,u=l+(0==r?-3:0)+(r==n.length-1?3:0);90!=e.label.rotation&&-90!=e.label.rotation||(s="center",r==n.length-1&&(u=l-2,s="right"),0==r&&(u=l));var d=16;o.value==e.origin&&(d=0),o.value<e.origin&&(d=-16);var f,c,h=0;if(e.tickLine.enabled&&(f={x:h="left"==e.align?-e.tickLine.lineLength-e.tickLine.distance:e.tickLine.distance,y:l,end:{x:e.tickLine.lineLength,y:0},lineWidth:e.tickLine.lineWidth,strokeStyle:e._getStyle(e.tickLine.strokeStyle)}),e.label.enabled){var p="left"==e.align?h-e.label.distance:h+e.tickLine.lineLength+e.label.distance;this.isH&&(p+=4*("left"==e.align?-1:1)),c={x:p,y:u,fillStyle:e._getStyle(e.label.fontColor),fontSize:e.label.fontSize,rotation:-Math.abs(e.label.rotation),textAlign:s,textBaseline:"middle",lineHeight:e.label.lineHeight,globalAlpha:1}}var y=300;e.animation&&!t.resize||(y=0);var g=this.rulesSprite.getChildAt(i);g?(g._tickLine&&e.tickLine.enabled&&g._tickLine.animate(f,{duration:y,id:g._tickLine.id}),g._txt&&e.label.enabled&&(g._txt.animate(c,{duration:y,id:g._txt.id}),g._txt.resetText(o.text))):(g=new w.default.Display.Sprite({id:"_node"+i}),e.tickLine.enabled&&(g._tickLine=new S({id:"yAxis_tickline_"+i,context:f}),g.addChild(g._tickLine)),e.label.enabled&&(g._txt=new w.default.Display.Text(o.text,{id:"yAxis_txt_"+i,context:c}),g.addChild(g._txt),90==e.label.rotation||-90==e.label.rotation?e.maxW=Math.max(e.maxW,g._txt.getTextHeight()):e.maxW=Math.max(e.maxW,g._txt.getTextWidth()),e.animation&&!t.resize&&(g._txt.context.y=l+d,g._txt.context.globalAlpha=0,g._txt.animate({y:c.y,globalAlpha:1},{duration:300,id:g._txt.id}))),e.rulesSprite.addChild(g)),i++}}if(e.rulesSprite.children.length>=i){a=i;for(var _=e.rulesSprite.children.length;a<_;a++)e.rulesSprite.getChildAt(a).remove(),a--,_--}e.width||"width"in e._opt||(e.width=parseInt(e.maxW+e.label.distance),e.tickLine.enabled&&(e.width+=parseInt(e.tickLine.lineLength+e.tickLine.distance)),e._title&&(e.width+=e._title.getTextHeight()));var v=0;if("left"==e.align&&(e.rulesSprite.context.x=e.width,v=e.width),e.axisLine.enabled){var x={start:{x:v,y:0},end:{x:v,y:-e.height},lineWidth:e.axisLine.lineWidth,strokeStyle:e._getStyle(e.axisLine.strokeStyle)};if(this._axisLine)this._axisLine.animate(x);else{var b=new S({context:x});this.sprite.addChild(b),this._axisLine=b}}this._title&&(this._title.context.y=-this.height/2,this._title.context.x=this._title.getTextHeight()/2,"right"==this.align&&(this._title.context.x=this.width-this._title.getTextHeight()/2),this.sprite.addChild(this._title))}else e.width=0}},{key:"_getStyle",value:function(t){var e=t;return m._.isFunction(t)&&(e=t.call(this,this)),t||(e="#999"),e}}]),h);function h(t,e,n){var i;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(i=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?l(t):e}(this,o(h).call(this,t,e.org))).type="yAxis",i._coord=n||{},i._title=null,i._axisLine=null,i.maxW=0,i.pos={x:0,y:0},i.yMaxHeight=0,i.layoutData=[],i.sprite=null,i.isH=!1,m._.extend(!0,l(i),(0,m.getDefaultProps)(h.defaultProps()),t),i.init(t),i}t.default=c}(e,n,l,i,u)});t(c);var h=e(function(t,e){!function(t,e,c){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,a=(n=e)&&n.__esModule?n:{default:n};function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=a.default.Shapes.Line,p=a.default.Shapes.Rect,d=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(f,c.event.Dispatcher),s(f,null,[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启grid绘制",default:!0},line:{detail:"网格线条配置",propertys:{xDimension:{detail:"一维方向的网格线",propertys:{enabled:{detail:"是否开启",default:!0},data:[],lineType:{detail:"线的样式，虚线或者实现",default:"solid"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#f0f0f0"}}},yDimension:{detail:"二维方向的网格线",propertys:{enabled:{detail:"是否开启",default:!1},data:[],lineType:{detail:"线的样式，虚线或者实现",default:"solid"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#f0f0f0"}}}}},fill:{detail:"背景色配置",propertys:{xDimension:{detail:"以为方向的背景色块，x方向",propertys:{enabled:{detail:"是否开启",default:!1},splitVals:{detail:"从x轴上面用来分割区块的vals",default:null},fillStyle:{detail:"背景颜色",default:null},alpha:{detail:"背景透明度",default:null}}},yDimension:{detail:"以为方向的背景色块，y方向",propertys:{enabled:{detail:"是否开启",default:!1},splitVals:{detail:"从x轴上面用来分割区块的vals",default:null},fillStyle:{detail:"背景颜色",default:null},alpha:{detail:"背景透明度",default:null}}}}}}}}]),s(f,[{key:"init",value:function(t){c._.extend(!0,this,t),this.sprite=new a.default.Display.Sprite}},{key:"setX",value:function(t){this.sprite.context.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t}},{key:"draw",value:function(t){c._.extend(!0,this,t),this._widget(),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"clean",value:function(){this.sprite.removeAllChildren()}},{key:"reset",value:function(t){this.sprite.removeAllChildren(),this.draw(t)}},{key:"_widget",value:function(){var u=this;if(this.enabled){var t,d=u._coord._yAxis[0],f=u._coord._xAxis;this.fillSp=new a.default.Display.Sprite,this.sprite.addChild(this.fillSp),c._.each([u.fill.xDimension,u.fill.yDimension],function(r,a){var t=a?d:f,e=[];if(r.enabled){r.splitVals?(e=[t.dataSection[0]].concat(c._.flatten([r.splitVals]))).push(t.dataSection.slice(-1)[0]):e=t.dataSection;var n=[];if(2<=e.length){for(var i=[],o=0,l=e.length;o<l;o++){var s=t.getPosOf({val:e[o]});if(i.length){if(1==i.length){if(s-i[0]<1)continue;i.push(s),n.push(i),i=[i[1]]}}else i.push(s)}c._.each(n,function(t,e){var n={fillStyle:u.getProp(r.fillStyle,e,"#000"),fillAlpha:u.getProp(r.alpha,e,e%2*.02)};a?(n.x=0,n.y=-t[0],n.width=u.width,n.height=-(t[1]-t[0])):(n.x=t[0],n.y=0,n.width=t[1]-t[0],n.height=-u.height);var i=new p({context:n});u.fillSp.addChild(i)})}}}),u.xAxisSp=new a.default.Display.Sprite,u.sprite.addChild(u.xAxisSp),u.yAxisSp=new a.default.Display.Sprite,u.sprite.addChild(u.yAxisSp);for(var e=0,n=(t=d.layoutData).length;e<n;e++)if((r=t[e]).visible){var i=new h({id:"back_line_"+e,context:{y:r.y,lineType:u.getProp(u.line.xDimension.lineType,e,"solid"),lineWidth:u.getProp(u.line.xDimension.lineWidth,e,1),strokeStyle:u.getProp(u.line.xDimension.strokeStyle,e,"#f0f0f0"),visible:!0}});u.line.xDimension.enabled&&(u.xAxisSp.addChild(i),i.context.start.x=0,i.context.end.x=u.width)}for(e=0,n=(t=f.layoutData).length;e<n;e++){var r=t[e];i=new h({context:{x:r.x,start:{x:0,y:0},end:{x:0,y:-u.height},lineType:u.getProp(u.line.yDimension.lineType,e,"solid"),lineWidth:u.getProp(u.line.yDimension.lineWidth,e,1),strokeStyle:u.getProp(u.line.yDimension.strokeStyle,e,"#f0f0f0"),visible:!0}}),u.line.yDimension.enabled&&u.yAxisSp.addChild(i)}}}},{key:"getProp",value:function(t,e,n){var i=n;return null!=t&&null!=t&&((c._.isString(t)||c._.isNumber(t))&&(i=t),c._.isFunction(t)&&(i=t.apply(this,[e,n])),c._.isArray(t)&&(i=t[e])),i}}]),f);function f(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),n=function(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?o(t):e}(this,r(f).call(this,t,e)),c._.extend(!0,o(n),(0,c.getDefaultProps)(f.defaultProps())),n.width=0,n.height=0,n._coord=e,n.pos={x:0,y:0},n.sprite=null,n.xAxisSp=null,n.yAxisSp=null,n.init(t),n}t.default=d}(e,n,i)});t(h),t(e(function(t,e){!function(t,e,n,i,r,a,f){Object.defineProperty(t,"__esModule",{value:!0});var o=c(e),l=c(n),s=c(i),u=c(r),d=c(a);function c(t){return t&&t.__esModule?t:{default:t}}function h(t){return(h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function y(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function g(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _(t,e,n){return e&&g(t.prototype,e),n&&g(t,n),t}function v(t,e){return(v=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var x=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&v(t,e)}(b,o.default),_(b,null,[{key:"defaultProps",value:function(){return{horizontal:{detail:"横向翻转坐标系",documentation:"横向翻转坐标系",insertText:"horizontal: ",default:!1,values:[!0,!1]},_props:{xAxis:s.default,yAxis:u.default,grid:d.default}}}}]),_(b,[{key:"setDefaultOpt",value:function(t,e){var n={field:this.dataFrame.fields[0],xAxis:{layoutType:"rule",posParseToInt:!1},grid:{}};if(f._.extend(!0,n,t),n.yAxis){var i=[];f._.each(f._.flatten([n.yAxis]),function(t){i.push(f._.clone(t))}),n.yAxis=i}else n.yAxis=[];for(var r=f._.flatten([e._opt.graphs]),a=0;a<r.length;a++){var o=r[a];if("bar"==o.type&&(n.xAxis.layoutType="peak"),o.field){var l="left";"right"==o.yAxisAlign&&(l="right");var s=null;(s=f._.find(n.yAxis,function(t,e){return t.align==l||!t.align&&e==("left"==l?0:1)}))?s.align||(s.align=l):(s={align:l,field:[]},n.yAxis.push(s)),s.field?f._.isArray(s.field)||(s.field=[s.field]):s.field=[],f._.isArray(o.field)?s.field=s.field.concat(o.field):s.field.push(o.field)}}var u=[],d=[];return f._.each(n.yAxis,function(t,e){t.align||(t.align=e?"right":"left"),"left"==t.align?u.push(t):d.push(t)}),n.yAxis=u.concat(d),n.horizontal&&(n.xAxis.isH=!0,f._.each(n.yAxis,function(t){t.isH=!0})),"enabled"in n&&(f._.extend(!0,n.xAxis,{enabled:n.enabled}),f._.each(n.yAxis,function(t){f._.extend(!0,t,{enabled:n.enabled})}),n.grid.enabled=n.enabled),"animation"in n&&(f._.extend(!0,n.xAxis,{animation:n.animation}),f._.each(n.yAxis,function(t){f._.extend(!0,t,{animation:n.animation})}),n.grid.animation=n.animation),n}},{key:"init",value:function(){this._initModules(),this.fieldsMap=this.setFieldsMap({type:"yAxis"})}},{key:"resetData",value:function(t){var n=this;this.dataFrame=t;var e=this.getAxisDataFrame(this.xAxis.field);this._xAxis.resetData(e),f._.each(this._yAxis,function(t){var e=n.getAxisDataFrame(t.field);t.resetData(e)}),this._resetXY_axisLine_pos(),this._yAxisLeft||this._yAxisRight,this._grid.reset({animation:!1})}},{key:"draw",value:function(t){t=t||{};var e=this.app.padding,n=t.height||this.app.height,i=t.width||this.app.width;if(this.horizontal){var r=i;i=n,n=r}var a=n-this._xAxis.height-e.bottom,o=0,l=0;this._yAxisLeft&&(this._yAxisLeft.draw({pos:{x:e.left,y:a},yMaxHeight:a-e.top,resize:t.resize}),o=this._yAxisLeft.width),this._yAxisRight&&(this._yAxisRight.draw({pos:{x:0,y:a},yMaxHeight:a-e.top,resize:t.resize}),l=this._yAxisRight.width),this._xAxis.draw({pos:{x:e.left+o,y:a},width:i-o-e.left-l-e.right,resize:t.resize}),this._yAxisRight&&this._yAxisRight.setX(o+e.left+this._xAxis.width),this._grid.draw({width:this._xAxis.width,height:this._yAxis[0].height,pos:{x:o+e.left,y:a},resize:t.resize}),this.width=this._xAxis.width,this.height=this._yAxis[0].height,this.origin.x=o+e.left,this.origin.y=a,this._initInduce(),this._resetXY_axisLine_pos(),this.horizontal&&this._horizontal({w:i,h:n})}},{key:"_resetXY_axisLine_pos",value:function(){var t,n=this;this._xAxis.enabled&&("center"==this._xAxis.axisLine.position&&(t=-this._yAxis[0].height/2),"center"==this._xAxis.axisLine.position&&(t=-this._yAxis[0].height/2),f._.isNumber(this._xAxis.axisLine.position)&&(t=-this._yAxis[0].getPosOfVal(this._xAxis.axisLine.position)),void 0!==t&&(this._xAxis._axisLine.context.y=t)),f._.each(this._yAxis,function(t){var e;t.enabled&&("center"==t.axisLine.position&&(e=n._xAxis.width/2),f._.isNumber(t.axisLine.position)&&(e=n._xAxis.getPosOfVal(t.axisLine.position)),void 0!==e&&(t._axisLine.context.x=e))})}},{key:"getSizeAndOrigin",value:function(){var t={width:this.width,height:this.height,origin:this.origin};if(this.horizontal){var e=this.app.padding,n=e.bottom,i=e.right;t={width:this._yAxis[0].height,height:this._xAxis.width,origin:{x:this._xAxis.height+n,y:this._yAxis[0].height+i}}}return t}},{key:"_initModules",value:function(){this._grid=new d.default(this.grid,this),this.sprite.addChild(this._grid.sprite);var t=this.getAxisDataFrame(this.xAxis.field);this._xAxis=new s.default(this.xAxis,t,this),this._axiss.push(this._xAxis),this.sprite.addChild(this._xAxis.sprite);var e,n,i,r,a=this.yAxis;f._.isArray(a)||(a=[a]),(e=f._.find(a,function(t){return"left"==t.align}))&&(i=this.getAxisDataFrame(e.field),this._yAxisLeft=new u.default(e,i,this),this._yAxisLeft.axis=e,this.sprite.addChild(this._yAxisLeft.sprite),this._yAxis.push(this._yAxisLeft),this._axiss.push(this._yAxisLeft)),(n=f._.find(a,function(t){return"right"==t.align}))&&(r=this.getAxisDataFrame(n.field),this._yAxisRight=new u.default(n,r,this),this._yAxisRight.axis=n,this.sprite.addChild(this._yAxisRight.sprite),this._yAxis.push(this._yAxisRight),this._axiss.push(this._yAxisRight))}},{key:"_horizontal",value:function(t){var n=t.h,i=t.w;f._.each([this.sprite.context],function(t){t.x+=(n-i)/2,t.y+=(i-n)/2;var e={x:i/2,y:n/2};t.rotation=90,t.rotateOrigin=e})}},{key:"changeFieldEnabled",value:function(t){this.setFieldEnabled(t);var e=this.getFieldMapOf(t),n=e.yAxis||e.rAxis,i=this.getEnabledFieldsOf(n);n.resetData(this.getAxisDataFrame(i)),this._resetXY_axisLine_pos(),this._grid.reset({animation:!1})}},{key:"_initInduce",value:function(){var e=this;e.induce=new l.default.Shapes.Rect({id:"induce",context:{x:e.origin.x,y:e.origin.y-e.height,width:e.width,height:e.height,fillStyle:"#000000",globalAlpha:0,cursor:"pointer"}}),e.sprite.getChildById("induce")||e.sprite.addChild(e.induce),e.induce.on(f.event.types.get(),function(t){e.fire(t.type,t),e.app.fire(t.type,t)})}},{key:"getTipsInfoHandler",value:function(t){var e=t.point.x;t.target!==this.induce&&(e=this.induce.globalToLocal(t.target.localToGlobal(t.point)).x);var n=this._xAxis.getNodeInfoOfX(e),i={xAxis:n,dimension_1:n,title:n.text,iNode:n.ind,nodes:[]};return t.eventInfo&&(f._.extend(!0,i,t.eventInfo),i.xAxis&&(t.eventInfo.xAxis=n)),i}},{key:"getPoint",value:function(t){var e={x:0,y:void 0},n={type:"yAxis",field:t.field},i=this.getAxis({type:"xAxis"}),r=this.getAxis(n),a=t.iNode||0,o=t.value;"x"in o||(o.x=f._.flatten(i.dataOrg)[a]),e.x=i.getPosOf({ind:a,val:o.x});var l=o.y;return isNaN(l)||null==l||""===l?e.y=void 0:e.y=-r.getPosOfVal(l),{pos:e,value:o}}},{key:"getAxisOriginPoint",value:function(t){var e=this.getAxis(t);return{pos:-e.originPos,value:e.origin}}},{key:"getOriginPos",value:function(t){var e={type:"yAxis",field:t.field},n=this.getAxis({type:"xAxis"}),i=this.getAxis(e);return{x:n.originPos,y:-i.originPos}}}]),b);function b(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),n=function(t,e){return!e||"object"!==h(e)&&"function"!=typeof e?y(t):e}(this,p(b).call(this,t,e)),f._.extend(!0,y(n),(0,f.getDefaultProps)(b.defaultProps()),n.setDefaultOpt(t,e)),n.type="rect",n._xAxis=null,n._yAxis=[],n._yAxisLeft=null,n._yAxisRight=null,n._grid=null,n.init(t),n}f.global.registerComponent(x,"coord","rect"),t.default=x}(e,o,n,f,c,h,i)}));var p=e(function(t,e){!function(t,e,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=e)&&n.__esModule?n:{default:n};function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=i.default.Shapes.Line,c=i.default.Shapes.Circle,h=i.default.Shapes.Polygon,p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(y,s.event.Dispatcher),u(y,null,[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启grid",default:!1},ring:{detail:"环背景线",propertys:{shapeType:{detail:"线的图形样式，默认poly，可选circle",default:"poly"},lineType:{detail:"线条样式，sold实线，dashed虚线",default:"sold"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#e5e5e5"},fillStyle:{detail:"环填充色,支持函数配置",default:null},fillAlpha:{detail:"环填充的透明度",default:.5}}},ray:{detail:"射线",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"线颜色",default:"#e5e5e5"}}}}}}]),u(y,[{key:"init",value:function(){this.sprite=new i.default.Display.Sprite}},{key:"setX",value:function(t){this.sprite.context.x=t}},{key:"setY",value:function(t){this.sprite.context.y=t}},{key:"draw",value:function(t){s._.extend(!0,this,t),this._widget(),this.setX(this.pos.x),this.setY(this.pos.y)}},{key:"clean",value:function(){this.sprite.removeAllChildren()}},{key:"reset",value:function(){}},{key:"_widget",value:function(){var l=this;s._.each(this.dataSection,function(t,e){if(t){var n,i=l.app.getROfNum(t),r=l.app.getPointsOfR(i),a={lineWidth:l.ring.lineWidth,strokeStyle:l._getStyle(l.ring.strokeStyle,e-1),fillStyle:l._getStyle(l.ring.fillStyle,e-1),fillAlpha:l.ring.fillAlpha},o=c;n="circle"==l.ring.shapeType?(a.r=i,new o({context:a})):(a.pointList=[],s._.each(r,function(t,e){e<r.length&&a.pointList.push([t.x,t.y])}),new(o=h)({context:a})),l.sprite.addChildAt(n,0),e==l.dataSection.length-1&&(a.fillAlpha=0,a.fillStyle="#ffffff",l.induce=new o({context:a}),l.sprite.addChild(l.induce)),s._.each(r,function(t){var e=new f({context:{end:t,lineWidth:l.ring.lineWidth,strokeStyle:l.ring.strokeStyle}});l.sprite.addChild(e)})}})}},{key:"_getStyle",value:function(t,e){return s._.isArray(t)?t[e%t.length]:t}}]),y);function y(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(n=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?o(t):e}(this,a(y).call(this,t,e))).width=0,n.height=0,n.app=e,n.pos={x:0,y:0},n.dataSection=[],n.sprite=null,n.induce=null,s._.extend(!0,o(n),(0,s.getDefaultProps)(y.defaultProps()),t),n.init(t),n}t.default=p}(e,n,i)});t(p),t(e(function(t,e){!function(t,e,n,i,S){Object.defineProperty(t,"__esModule",{value:!0});var r=o(e),s=o(n),a=o(i);function o(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(y,r.default),c(y,null,[{key:"defaultProps",value:function(){return{allAngle:{detail:"坐标系总角度",documentation:"",default:360,values:[0,360]},startAngle:{detail:"坐标系起始角度",documentation:"",default:0,values:[0,360]},radius:{detail:"坐标系的最大半径",documentation:"默认自动计算view的高宽，如果squareRange==true，则会取Math.min(width,height)",default:"auto",values:null},aAxis:{detail:"角度轴",documentation:"类似直角坐标系中的x轴",propertys:{data:[],angleList:[],layoutData:[],field:{detail:"数据字段",documentation:"",default:""},layoutType:{detail:"布局类型",documentation:"",default:"proportion"},beginAngle:{detail:"起始角度",documentation:"",default:-90},enabled:{detail:"是否显示",documentation:"",default:!1},label:{detail:"文本配置",documentation:"",propertys:{enabled:{detail:"是否显示",documentation:"",default:!0},format:{detail:"label的格式化处理函数",documentation:"",default:null},fontColor:{detail:"label颜色",documentation:"",default:"#666"}}}}},rAxis:{detail:"半径维度轴",documentation:"类似直角坐标系中的y轴维度",propertys:{field:{detail:"数据字段",documentation:"",default:""},dataSection:{detail:"轴的显示数据",documentation:"默认根据源数据中自动计算，用户也可以手动指定",default:!1},enabled:{detail:"是否显示",documentation:"",default:!1}}}}}}]),c(y,[{key:"setDefaultOpt",value:function(t,e){var n={rAxis:{field:[]},aAxis:{},grid:{}};S._.extend(!0,n,t),S._.isArray(n.rAxis.field)||(n.rAxis.field=[n.rAxis.field]);var i=S._.flatten([e._opt.graphs]),r=[];return S._.each(i,function(t){if(t.field){var e=t.field;S._.isArray(e)||(e=[e]),r=r.concat(e)}}),n.rAxis.field=n.rAxis.field.concat(r),t.aAxis&&t.aAxis.field?n.aAxis.enabled=!0:n.grid.enabled=!1,n}},{key:"init",value:function(){this._initModules(),this.fieldsMap=this.setFieldsMap({type:"rAxis"})}},{key:"_initModules",value:function(){this.grid.enabled&&(this._grid=new a.default(this.grid,this),this.sprite.addChild(this._grid.sprite)),this.aAxis.enabled&&this.grid.enabled&&(this._aAxisScaleSp=new s.default.Display.Sprite({id:"aAxisScaleSp"}),this.sprite.addChild(this._aAxisScaleSp)),this._axiss.push({type:"rAxis",field:this.rAxis.field})}},{key:"draw",value:function(){this._computeAttr(),this.rAxis.dataSection=this._getRDataSection(),this.aAxis.data=this.app.dataFrame.getFieldData(this.aAxis.field),this._setAAxisAngleList(),this.grid.enabled&&(this._grid.draw({pos:this.origin,width:this.width,height:this.height,dataSection:this.rAxis.dataSection},this),this.aAxis.enabled&&this._drawAAxis(),this._initInduce())}},{key:"resetData",value:function(){}},{key:"changeFieldEnabled",value:function(t){this.setFieldEnabled(t),this.rAxis.dataSection=this._getRDataSection(),this.aAxis.data=this.app.dataFrame.getFieldData(this.aAxis.field),this.grid.enabled&&this._grid.reset({dataSection:this.rAxis.dataSection},this)}},{key:"_getRDataSection",value:function(){var e=this;if(this._opt.rAxis&&this._opt.rAxis.dataSection)return this._opt.rAxis.dataSection;var n=[];return S._.each(S._.flatten([e.rAxis.field]),function(t){n=n.concat(e.app.dataFrame.getFieldData(t))}),n.push(0),S.dataSection.section(n,3)}},{key:"_computeAttr",value:function(){var t,e,n=this.app.padding,i=this.app.width,r=this.app.height;"width"in this._opt||(this.width=i-n.left-n.right),"height"in this._opt||(this.height=r-n.top-n.bottom);for(var a=this.width,o=this.height,l=0,s=0,u=0,d=0,f=[this.startAngle],c=0,h=parseInt((this.startAngle+this.allAngle)/90)-parseInt(this.startAngle/90);c<=h;c++){var p=90*parseInt(this.startAngle/90)+90*c;-1==S._.indexOf(f,p)&&p>f.slice(-1)[0]&&f.push(p)}var y=this.startAngle+this.allAngle;-1==S._.indexOf(f,y)&&f.push(y),S._.each(f,function(t){t%=360;var e=Math.sin(t*Math.PI/180);180==t&&(e=0);var n=Math.cos(t*Math.PI/180);270!=t&&90!=t||(n=0),l=Math.min(l,e),s=Math.max(s,e),u=Math.min(u,n),d=Math.max(d,n)}),e=(Math.abs(u)+Math.abs(d))/(Math.abs(l)+Math.abs(s));var g=Math.min(a,o);if(1==e)a=o=g;else{var _=o*e;a<_?o=a/e:a=_}var v=n.left+(this.width-a)/2,x=n.top+(this.height-o)/2;this.origin={x:v+a*(u/(u-d)),y:x+o*(l/(l-s))};var b={top:this.origin.y-x,right:v+a-this.origin.x,bottom:x+o-this.origin.y,left:this.origin.x-v},m=[],w=[["right","bottom"],["bottom","left"],["left","top"],["top","right"]];S._.each(f,function(t){t%=360;var e=parseInt(t/90),n=w[e];t%90==0&&(n=[["right","bottom","left","top"][e]]);var i=Math.sin(t*Math.PI/180);180==t&&(i=0);var r=Math.cos(t*Math.PI/180);270!=t&&90!=t||(r=0),S._.each(n,function(t){var e;"top"!=t&&"bottom"!=t||i&&(e=Math.abs(b[t]/i)),"right"!=t&&"left"!=t||r&&(e=Math.abs(b[t]/r)),m.push(e)})}),t=S._.min(m),this.aAxis.label.enabled&&(t-=20),this.radius=t}},{key:"getMaxDisToViewOfOrigin",value:function(){var t=this.origin,e=this.app.padding,n=this.app.width,i=this.app.height,r=n-e.left-e.right,a=i-e.top-e.bottom,o=[t.x-e.left,r+e.left-t.x,t.y-e.top,a+e.top-t.y];return S._.max(o)}},{key:"getRadiansAtR",value:function(t,e,n){var r=this;null==e&&(e=this.width),null==n&&(n=this.height);var i,a,o=[],l=this.app.padding,s={x:this.origin.x-l.left-(this.width-e)/2,y:this.origin.y-l.top-(this.height-n)/2},u=s.y;u<t&&(i=Math.sqrt(Math.pow(t,2)-Math.pow(u,2)),o=o.concat(this._filterPointsInRect([{x:-i,y:-u},{x:i,y:-u}],s,e,n)));var d=e-s.x;d<t&&(a=Math.sqrt(Math.pow(t,2)-Math.pow(d,2)),o=o.concat(this._filterPointsInRect([{x:d,y:-a},{x:d,y:a}],s,e,n)));var f=n-s.y;f<t&&(i=Math.sqrt(Math.pow(t,2)-Math.pow(f,2)),o=o.concat(this._filterPointsInRect([{x:i,y:f},{x:-i,y:f}],s,e,n)));var c=s.x;c<t&&(a=Math.sqrt(Math.pow(t,2)-Math.pow(c,2)),o=o.concat(this._filterPointsInRect([{x:-c,y:a},{x:-c,y:-a}],s,e,n)));var h=[];0==o.length?h.push([{point:{x:t,y:0},radian:0},{point:{x:t,y:0},radian:2*Math.PI}]):S._.each(o,function(t,e){var n=e==o.length-1?0:e+1,i=o.slice(n,n+1)[0];h.push([{point:t,radian:r.getRadianInPoint(t)},{point:i,radian:r.getRadianInPoint(i)}])});for(var p=0,y=h.length;p<y;p++)this._checkArcInRect(h[p],t,s,e,n)||(h.splice(p,1),p--,y--);return h}},{key:"_filterPointsInRect",value:function(t,e,n,i){for(var r=0,a=t.length;r<a;r++)this._checkPointInRect(t[r],e,n,i)||(t.splice(r,1),r--,a--);return t}},{key:"_checkPointInRect",value:function(t,e,n,i){var r=t.x+e.x,a=t.y+e.y;return!(r<0||n<r||a<0||i<a)}},{key:"_checkArcInRect",value:function(t,e,n,i,r){var a=t[0],o=t[1],l=o.radian-a.radian;o.radian<a.radian&&(l=2*Math.PI+o.radian-a.radian);var s=(a.radian+l/2)%(2*Math.PI);return this._checkPointInRect(this.getPointInRadianOfR(s,e),n,i,r)}},{key:"getRadianInPoint",value:function(t){var e=2*Math.PI;return(Math.atan2(t.y,t.x)+e)%e}},{key:"getPointInRadianOfR",value:function(t,e){var n=Math.PI,i=Math.cos(t)*e;t!=n/2&&t!=3*n/2||(i=0);var r=Math.sin(t)*e;return t%n==0&&(r=0),{x:i,y:r}}},{key:"getROfNum",value:function(t){var e=S._.max(this.rAxis.dataSection);return this.radius*((t-0)/(e-0))}},{key:"getPointsOfR",value:function(i){var r=this,a=[];return S._.each(r.aAxis.angleList,function(t){var e=Math.PI*t/180,n=r.getPointInRadianOfR(e,i);a.push(n)}),a}},{key:"_setAAxisAngleList",value:function(){var n=this;n.aAxis.angleList=[];var t=this.aAxis.data;if("proportion"==this.aAxis.layoutType){t=[];for(var e=0,i=this.aAxis.data.length;e<i;e++)t.push(e)}var r=this.allAngle,a=S._.max(t);"proportion"==this.aAxis.layoutType&&a++,S._.each(t,function(t){var e=(r*((t-0)/(a-0))+n.aAxis.beginAngle+r)%r;n.aAxis.angleList.push(e)})}},{key:"_drawAAxis",value:function(){var o=this,t=o.getROfNum(S._.max(this.rAxis.dataSection)),l=o.getPointsOfR(t+3);o._aAxisScaleSp.context.x=this.origin.x,o._aAxisScaleSp.context.y=this.origin.y,S._.each(this.aAxis.data,function(t,e){var n=l[e],i=S._.isFunction(o.aAxis.label.format)?o.aAxis.label.format(t):t,r={value:t,text:i,iNode:e,field:o.aAxis.field};if(o._getProp(o.aAxis.label.enabled,r)){var a={x:n.x,y:n.y,fillStyle:o._getProp(o.aAxis.label.fontColor,r)};S._.extend(a,o._getTextAlignForPoint(Math.atan2(n.y,n.x))),o._aAxisScaleSp.addChild(new s.default.Display.Text(i,{context:a})),o.aAxis.layoutData.push(i)}})}},{key:"_getTextAlignForPoint",value:function(t){var e="center",n="bottom";return t>-Math.PI/2&&t<0&&(e="left",n="bottom"),0==t&&(e="left",n="middle"),0<t&&t<Math.PI/2&&(e="left",n="top"),t==Math.PI/2&&(e="center",n="top"),t>Math.PI/2&&t<Math.PI&&(e="right",n="top"),t!=Math.PI&&t!=-Math.PI||(e="right",n="middle"),t>-Math.PI&&t<-Math.PI/2&&(e="right",n="bottom"),{textAlign:e,textBaseline:n}}},{key:"getAxisNodeOf",value:function(t){var e=this.getAAxisIndOf(t);if(void 0!==e)return{ind:e,value:this.aAxis.data[e],text:this.aAxis.layoutData[e],angle:this.aAxis.angleList[e]}}},{key:"getAAxisIndOf",value:function(t){var r=this;if(void 0!==t.aAxisInd)return t.aAxisInd;if(r.aAxis.angleList.length){var e=t.point,a=(180*r.getRadianInPoint(e)/Math.PI-r.aAxis.beginAngle)%r.allAngle,o=(Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2)),0),l=r.aAxis.angleList.length;return S._.each(r.aAxis.angleList,function(t,e){t=(t-r.aAxis.beginAngle)%r.allAngle;var n=e+1,i=(r.aAxis.angleList[n]-r.aAxis.beginAngle)%r.allAngle;if(e==l-1&&(n=0,i=r.allAngle),t<=a&&a<=i)return o=a-t<i-a?e:n,!1}),o}}},{key:"_initInduce",value:function(){var e=this;e.induce=this._grid.induce,e.induce&&e.induce.on(S.event.types.get(),function(t){e.fire(t.type,t),e.app.fire(t.type,t)})}},{key:"getTipsInfoHandler",value:function(t){var e=this.getAxisNodeOf(t),n={nodes:[]};return e&&(n.aAxis=e,n.title=e.text,n.iNode=e.ind),t.eventInfo&&(n=S._.extend(n,t.eventInfo)),n}},{key:"getPoint",value:function(){}},{key:"getSizeAndOrigin",value:function(){}},{key:"_getProp",value:function(t,e,n){var i=t;return S._.isFunction(t)&&(i=t.apply(this,[e])),!i&&n&&(i=n),i}}]),y);function y(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(n=function(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?d(t):e}(this,u(y).call(this,t,e))).type="polar",S._.extend(!0,d(n),(0,S.getDefaultProps)(y.defaultProps()),n.setDefaultOpt(t,e)),n.init(t),n}S.global.registerComponent(p,"coord","polar"),t.default=p}(e,o,n,p,i)}));var y=e(function(t,e){!function(t,e,n,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=a(e),r=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=r.default.AnimationFrame,p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(y,i.default),f(y,null,[{key:"defaultProps",value:function(){return{type:{detail:"绘图组件",default:"",insertText:"type: ",values:["bar","line","pie","scat"]},animation:{detail:"是否开启入场动画",default:!0},aniDuration:{detail:"动画时长",default:500}}}}]),f(y,[{key:"tipsPointerOf",value:function(){}},{key:"tipsPointerHideOf",value:function(){}},{key:"focusAt",value:function(){}},{key:"unfocusAt",value:function(){}},{key:"selectAt",value:function(){}},{key:"unselectAt",value:function(){}},{key:"getSelectedList",value:function(){return[]}},{key:"getSelectedRowList",value:function(){return[]}},{key:"hide",value:function(){}},{key:"show",value:function(){}},{key:"getLegendData",value:function(){}},{key:"triggerEvent",value:function(t){var e=(t.eventInfo.trigger||this)["on"+t.type];e&&o._.isFunction(e)&&(t.eventInfo&&t.eventInfo.nodes&&t.eventInfo.nodes.length?1==t.eventInfo.nodes.length?e.apply(this,[t,t.eventInfo.nodes[0]]):e.apply(this,[t,t.eventInfo.nodes]):e.apply(this,arguments))}},{key:"grow",value:function(e,t){t=t||{};var n=this,i=this.aniDuration;this.animation||(i=0);var r=0,a=1;"from"in t&&(r=t.from),"to"in t&&(a=t.to),this._growTween=h.registTween({from:{process:r},to:{process:a},duration:i,onUpdate:function(t){o._.isFunction(e)&&e(t.process)},onComplete:function(){this._growTween=null,n.fire("complete")}})}}]),y);function y(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),n=function(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?u(t):e}(this,s(y).call(this,t,e)),o._.extend(!0,u(n),(0,o.getDefaultProps)(y.defaultProps())),n.name="graphs",n._opt=t||{},n.app=e,n.ctx=e.stage.canvas.getContext("2d"),n.dataFrame=e.dataFrame,n.data=null,n.width=0,n.height=0,n.origin={x:0,y:0},n.inited=!1,n.sprite=new r.default.Display.Sprite({name:"graphs_"+t.type}),n.app.graphsSprite.addChild(n.sprite),n._growTween=null;var i=u(n);return n.sprite.on("destroy",function(){i._growTween&&(h.destroyTween(i._growTween),i._growTween=null)}),n}t.default=p}(e,a,n,i)});t(y),t(e(function(t,e){!function(t,e,I,n,D){Object.defineProperty(t,"__esModule",{value:!0});var T=r(e),i=r(n);function r(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=T.default.AnimationFrame,L=T.default.Shapes.Rect,c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(h,i.default),u(h,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段设置",documentation:"支持二维数组格式的设置，一维方向就是横向分组，二维方向就是纵向的堆叠",default:null},yAxisAlign:{detail:"绘制在哪根y轴上面",default:"left"},absolute:{detail:"是否脱离graphs的位置计算",documentation:"                    trimGraphs的时候是否需要和其他的 bar graphs一起并排计算，                    true的话这个就会和别的重叠,                    和css中得absolute概念一致，脱离文档流的绝对定位",default:!1},proportion:{detail:"比例柱状图",default:!1},node:{detail:"单个数据对应的图形设置",propertys:{width:{detail:"bar的宽度",default:0},maxWidth:{detail:"最大width",default:50},minWidth:{detail:"最小width",default:1},minHeight:{detail:"最小height",default:0},radius:{detail:"叶子节点的圆角半径",default:3},fillStyle:{detail:"bar填充色",default:null},fillAlpha:{detail:"bar透明度",default:.95},xDis:{detail:"单分组内bar之间的间隔",default:null},filter:{detail:"bar过滤处理器",default:null}}},label:{detail:"文本设置",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本颜色",default:null,documentation:"如果有设置text.fontColor那么优先使用fontColor"},fontSize:{detail:"文本字体大小",default:12},format:{detail:"文本格式化处理函数",default:null},lineWidth:{detail:"文本描边线宽",default:0},strokeStyle:{detail:"文本描边颜色",default:null},rotation:{detail:"旋转角度",default:0},textAlign:{detail:"水平对齐方式",documentation:"left center right",default:"center"},verticalAlign:{detail:"垂直基线对齐方式",documentation:"top middle bottom",default:"bottom"},position:{detail:"文本布局位置",documentation:"top,topRight,right,rightBottom,bottom,bottomLeft,left,leftTop,center",default:"top"},offsetX:{detail:"x偏移量",default:0},offsetY:{detail:"y偏移量",default:0}}},select:{detail:"分组选中",documentation:"                    分组的选中，不是选中具体的某个node，这里的选中靠groupRegion来表现出来,                    目前只有在第一个graphs bar 上配置有效",propertys:{enabled:{detail:"是否开启",default:!1},inds:{detail:"选中的分组索引集合",documentation:"选中的列的索引集合,注意，这里的ind不是当前视图的ind，而是加上了dataFrame.range.start的全局ind",default:[]},width:{detail:"选中态背景宽度",default:1},alpha:{detail:"选中态背景透明度",default:.2},fillStyle:{detail:"选中态背景填充色",default:null},triggerEventType:{detail:"触发选中效果的事件",default:"click"}}}}}}]),u(h,[{key:"init",value:function(){this.barsSp=new T.default.Display.Sprite({id:"barsSp"}),this.txtsSp=new T.default.Display.Sprite({id:"txtsSp",context:{}})}},{key:"getNodesAt",value:function(i){var r=this.data,a=[];return D._.each(this.enabledField,function(t,e){if(D._.isArray(t))D._.each(t,function(t,e){var n=r[t]?r[t][i]:null;n&&a.push(n)});else{var n=r[t]?r[t][i]:null;n&&a.push(n)}}),a}},{key:"_getTargetField",value:function(t,e,n,i){if(D._.isString(i))return i;if(D._.isArray(i)){var r=i[t];if(D._.isString(r))return r;if(D._.isArray(r))return r[e]}}},{key:"_getColor",value:function(t,e){var n=e.field,i=D._.flatten([this.field]),r=this.app.getComponent({name:"coord"}).getFieldMapOf(n);if(D._.isFunction(t)&&(t=t.apply(this,[e])),D._.isString(t)&&(t=t),D._.isArray(t)&&(t=D._.flatten(t)[D._.indexOf(i,n)]),t&&t.lineargradient&&t.lineargradient.length)if(0!=e.rectHeight){var a=this.ctx.createLinearGradient(e.x,e.fromY+e.rectHeight,e.x,e.fromY);D._.each(t.lineargradient,function(t){a.addColorStop(t.position,t.color)}),t=a}else t=t.lineargradient[parseInt(t.lineargradient.length/2)].color;return null==t&&(t=r.color),t}},{key:"_getBarWidth",value:function(t,e){return this.node.width?D._.isFunction(this.node.width)?this.node._width=this.node.width(t):this.node._width=this.node.width:(this.node._width=e-Math.max(1,.2*e),1==this.node._width&&3<t&&(this.node._width=t-2)),this.node._width<1&&(this.node._width=1),this.node._width=parseInt(this.node._width),this.node._width>this.node.maxWidth&&(this.node._width=this.node.maxWidth),this.node._width}},{key:"show",value:function(){this.draw()}},{key:"hide",value:function(i){D._.each(this.barsSp.children,function(t,e){var n=t.getChildById("bar_"+e+"_"+i);n&&n.destroy()}),D._.each(this.txtsSp.children,function(t,e){var n=t.getChildById("text_"+e+"_"+i);n&&n.destroy()}),this.draw()}},{key:"resetData",value:function(t){this.dataFrame=t,this.draw()}},{key:"clean",value:function(){this.data={},this.barsSp.removeAllChildren(),this.label.enabled&&this.txtsSp.removeAllChildren()}},{key:"draw",value:function(t){t=t||{},D._.extend(!0,this,t);var A=this,O=A.animation&&!t.resize;if(this.data=this._trimGraphs(),0==this.enabledField.length||0==this._dataLen)return A._preDataLen=0,void this.clean();var P=A._preDataLen,C=this.enabledField.length,j=0,E=A.node._count=0,M=A.app.getComponents({name:"graphs",type:"bar"});D._.each(M,function(t,e){t==A&&(E=e)}),D._.each(this.enabledField,function(t,e){var n=(t=D._.flatten([t])).length;if(0!=n){j=A.width/A._dataLen,A._barsLen=A._dataLen*C;for(var i=0;i<A._dataLen;i++){var r=null;if(0==e){if(i<=P-1?r=A.barsSp.getChildById("barGroup_"+i):(r=new T.default.Display.Sprite({id:"barGroup_"+i}),A.barsSp.addChild(r),r.iNode=i),!E){var a,o=j*A.select.width;1<A.select.width&&(o=A.select.width),i<=P-1?((a=r.getChildById("group_region_"+i)).context.width=o,a.context.x=j*i+(j-o)/2,a.context.globalAlpha=-1<D._.indexOf(A.select.inds,A.dataFrame.range.start+i)?A.select.alpha:0):(a=new L({id:"group_region_"+i,pointChkPriority:!1,hoverClone:!1,xyToInt:!1,context:{x:j*i+(j-o)/2,y:-A.height,width:o,height:A.height,fillStyle:A._getGroupRegionStyle(i),globalAlpha:-1<D._.indexOf(A.select.inds,A.dataFrame.range.start+i)?A.select.alpha:0}}),r.addChild(a),a.iNode=i,a.on(D.event.types.get(),function(t){t.eventInfo={iNode:this.iNode},k.bind(this)(t),A.app.fire(t.type,t)}))}}else r=A.barsSp.getChildById("barGroup_"+i);var l=null;0==e?i<=P-1?l=A.txtsSp.getChildById("txtGroup_"+i):(l=new T.default.Display.Sprite({id:"txtGroup_"+i}),A.txtsSp.addChild(l),l.iGroup=e):l=A.txtsSp.getChildById("txtGroup_"+i);for(var s=0;s<n;s++){A.node._count++;var u=A.data[t[s]][i];u.iGroup=e,u.iNode=i,u.iLay=s;var d=u.y-u.fromY;isNaN(u.value)?d=0:Math.abs(d)<A.node.minHeight&&(d=A.node.minHeight),u.rectHeight=d;var f=A._getColor(A.node.fillStyle,u);if((u.color=f)instanceof CanvasGradient&&A.node.fillStyle.lineargradient){var c=A.node.fillStyle.lineargradient[parseInt(A.node.fillStyle.lineargradient.length/2)];c&&(u.color=c.color)}var h={x:Math.round(u.x),y:u.fromY,width:A.node._width,height:d,fillStyle:f,fillAlpha:A.node.fillAlpha,scaleY:-1};u.width=h.width;var p={x:h.x,y:u.yOriginPoint.pos,width:h.width,height:h.height,fillStyle:h.fillStyle,fillAlpha:A.node.fillAlpha,scaleY:0};if(A.node.radius&&u.isLeaf&&!A.proportion){var y=Math.min(A.node._width/2,Math.abs(d));y=Math.min(y,A.node.radius),p.radius=[y,y,0,0]}O||(delete p.scaleY,p.y=h.y);var g=null,_="bar_"+i+"_"+u.field;if(i<=P-1&&(g=r.getChildById(_)),g?g.context.fillStyle=f:((g=new L({id:_,context:p})).field=u.field,r.addChild(g),g.on(D.event.types.get(),function(t){t.eventInfo={trigger:A.node,nodes:[this.nodeData]},k.bind(this)(t),A.app.fire(t.type,t)})),g.finalPos=h,g.iGroup=e,g.iNode=i,g.iLay=s,(g.nodeData=u).nodeElement=g,A.node.filter&&A.node.filter.apply(g,[u,A]),A.label.enabled){var v=u.value;if(D._.isFunction(A.label.format)){var x=A.label.format(v,u);void 0===x&&null===x||(v=x)}if(null==v||""===v)continue;D._.isNumber(v)&&(v=(0,I.numAddSymbol)(v));var b={fillStyle:A.label.fontColor||h.fillStyle,fontSize:A.label.fontSize,lineWidth:A.label.lineWidth,strokeStyle:A.label.strokeStyle||h.fillStyle,textBaseline:A.label.verticalAlign,rotation:A.label.rotation},m=A._getTextPos(h,u);b.x=m.x,b.y=m.y,b.textAlign=A._getTextAlign(h,u);var w=null,S="text_"+i+"_"+u.field;i<=P-1&&(w=l.getChildById(S)),w?(w.resetText(v),w.context.x=b.x,w.context.y=b.y):((w=new T.default.Display.Text(v,{id:S,context:b})).field=u.field,l.addChild(w))}}}}function k(t){if(A.select.enabled&&t.type==A.select.triggerEventType){var e=A.dataFrame.range.start+this.iNode;-1<D._.indexOf(A.select.inds,e)?D._.each(M,function(t){t.unselectAt(e)}):D._.each(M,function(t){t.selectAt(e)})}}}),this.sprite.addChild(this.barsSp),this.label.enabled&&this.sprite.addChild(this.txtsSp),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.grow(function(){A.fire("complete")},{delay:0,duration:300,animate:O}),A._preDataLen=A._dataLen}},{key:"setEnabledField",value:function(){this.enabledField=this.app.getComponent({name:"coord"}).filterEnabledFields(this.field)}},{key:"_getGroupRegionStyle",value:function(t){var e=this,n=e.select.fillStyle;return D._.isArray(e.select.fillStyle)&&(n=e.select.fillStyle[t]),D._.isFunction(e.select.fillStyle)&&(n=e.select.fillStyle.apply(this,[{iNode:t,rowData:e.dataFrame.getRowDataAt(t)}])),null==n?e.select._fillStyle:n}},{key:"_trimGraphs",value:function(){var y=this,g=this.app.getComponent({name:"coord"});this.setEnabledField(),this.data={};var e=[],n=0,i=0,r=!1;this.absolute?(e=[this],n=this.enabledField.length):D._.each(y.app.getComponents({name:"graphs",type:"bar"}),function(t){t.absolute||(t===y&&(r=!0),r?t.setEnabledField():i+=t.enabledField.length,n+=t.enabledField.length,e.push(t))});var _=g.getAxis({type:"xAxis"}).getCellLength(),t=_/(n+1),v=this._getBarWidth(_,t),x=t-v;null!=this.node.xDis&&(x=this.node.xDis);var b=(_-v*n-x*(n-1))/2;i&&(b+=(x+v)*i);var a=this.dataFrame.getDataOrg(this.enabledField),o=y.getGraphSelectOpt();return!y.select.inds.length&&o&&o.inds&&o.inds.length&&(y.select.inds=D._.clone(o.inds)),D._.each(a,function(c,h){var p=[];D._.each(c,function(t,f){p[f]=[],y._dataLen=t.length,D._.each(t,function(t,n){var i=t;y.proportion&&(i=0,D._.each(c,function(t,e){i+=t[n]}));var e=y._getTargetField(h,f,n,y.enabledField),r=g.getPoint({iNode:n,field:e,value:{y:t}}),a=r.pos.x,o=a-_/2+b+(v+x)*h,l=0;l=y.proportion?-t/i*g.height:r.pos.y,isNaN(l)&&(l=0);var d=g.getAxisOriginPoint({field:e}),s=function t(e,n,i,r,a){var o=e[n-1];if(!o)return d.pos;var l=o[i].y,s=o[i].value,u=d.value;return u<=r?u<=s?(o[i].isLeaf=!1,l):t(e,n-1,i,r):s<u?(o[i].isLeaf=!1,l):t(e,n-1,i,r)}(p,f,n,t);l+=s-d.pos;var u={type:"bar",value:t,vInd:f,vCount:i,field:e,fromX:o,fromY:s,x:o,y:l,width:v,yOriginPoint:d,isLeaf:!0,xAxis:g.getAxis({type:"xAxis"}).getNodeInfoOfX(a),iNode:n,rowData:y.dataFrame.getRowDataAt(n),color:null,selected:!1};y.data[u.field]||(y.data[u.field]=p[f]),-1<D._.indexOf(y.select.inds,n)&&(u.selected=!0),p[f].push(u)})})}),y.data}},{key:"_getTextAlign",value:function(t,e){var n=this.label.textAlign;return e.value<e.yOriginPoint.value&&("left"==n?n="right":"right"==n&&(n="left")),n}},{key:"_getTextPos",value:function(t,e){var n={x:0,y:0},i=t.x,r=t.y,a=!0;switch(t.y>=e.y&&(a=!1),this.label.position){case"top":i=t.x+t.width/2,r=t.y+t.height,a&&(r+=16);break;case"topRight":i=t.x+t.width,r=t.y+t.height,a&&(r+=16);break;case"right":i=t.x+t.width,r=t.y+t.height/2;break;case"rightBottom":i=t.x+t.width,r=t.y;break;case"bottom":i=t.x+t.width/2,r=t.y;break;case"bottomLeft":i=t.x,r=t.y;break;case"left":i=t.x,r=t.y+t.height/2;break;case"leftTop":i=t.x,r=t.y+t.height,a&&(r+=16);break;case"center":i=t.x+t.width/2,r=t.y+t.height/2}i-=this.label.offsetX;var o=1;return e.value<e.yOriginPoint.value&&(o=-1),r-=o*this.label.offsetY,n.x=i,n.y=r,n}},{key:"grow",value:function(l,t){var s=this;if(s._preDataLen>s._dataLen)for(var e=s._dataLen,n=s._preDataLen;e<n;e++)s.barsSp.getChildAt(e).destroy(),s.label.enabled&&s.txtsSp.getChildAt(e).destroy(),e--,n--;if(t.animate){var u=D._.extend({delay:Math.min(1e3/this._barsLen,80),easing:"Linear.None",duration:500},t),d=0;D._.each(s.enabledField,function(t,e){var n=(t=D._.flatten([t])).length;if(0!=n)for(var i=0;i<s._dataLen;i++)for(var r=0;r<n;r++){var a=s.data[t[r]][i],o=s.barsSp.getChildById("barGroup_"+i).getChildById("bar_"+i+"_"+a.field);0==u.duration?(o.context.scaleY=1,o.context.y=1*o.finalPos.y,o.context.x=o.finalPos.x,o.context.width=o.finalPos.width,o.context.height=o.finalPos.height):(o._tweenObj&&f.destroyTween(o._tweenObj),o._tweenObj=o.animate({scaleY:1,y:1*o.finalPos.y,x:o.finalPos.x,width:o.finalPos.width,height:o.finalPos.height},{duration:u.duration,easing:u.easing,delay:i*u.delay,onUpdate:function(){},onComplete:function(t){t.width<3&&this.context&&(this.context.radius=0),++d===s.node._count&&l&&l(s)},id:o.id}))}})}else l&&l(s)}},{key:"selectAt",value:function(t){var i=this;if(!(-1<D._.indexOf(this.select.inds,t))){this.select.inds.push(t);var r=t-this.dataFrame.range.start;D._.each(this.data,function(t,e){var n=t[r];n.selected=!0,i.setNodeElementStyle(n)});var e=this.barsSp.getChildById("barGroup_"+r);if(e){var n=e.getChildById("group_region_"+r);n&&(n.context.globalAlpha=this.select.alpha)}}}},{key:"unselectAt",value:function(t){var i=this;if(-1!=D._.indexOf(this.select.inds,t)){var e=D._.indexOf(this.select.inds,t);this.select.inds.splice(e,1);var r=t-this.dataFrame.range.start;D._.each(this.data,function(t,e){var n=t[r];n.selected=!1,i.setNodeElementStyle(n)});var n=this.barsSp.getChildById("barGroup_"+r);if(n){var a=n.getChildById("group_region_"+r);a&&(a.context.globalAlpha=0)}}}},{key:"getSelectedRowList",value:function(){var e=[],n=this;return D._.each(n.select.inds,function(t){e.push(n.dataFrame.jsonOrg[t])}),e}},{key:"setNodeElementStyle",value:function(t){var e=this._getColor(this.node.fillStyle,t);t.nodeElement.context.fillStyle=e}},{key:"getGraphSelectOpt",value:function(){var e=this._opt.select;if(!e){var t=this.app.getComponents({name:"graphs",type:"bar"});D._.each(t,function(t){if(e)return!1;!e&&t._opt.select&&(e=t.select)})}return e}}]),h);function h(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(n=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?l(t):e}(this,o(h).call(this,t,e))).type="bar",n.enabledField=null,n.node={_width:0,_count:0},n.select={_fillStyle:"#092848"},n._barsLen=0,n.txtsSp=null,D._.extend(!0,l(n),(0,D.getDefaultProps)(h.defaultProps()),t),n.init(),n}D.global.registerComponent(c,"graphs","bar"),t.default=c}(e,n,l,y,i)}));var g=e(function(t,e){!function(t,e,o,g){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,_=(n=e)&&n.__esModule?n:{default:n};function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var l=_.default.AnimationFrame,f=_.default.Shapes.BrokenLine,v=_.default.Shapes.Circle,x=_.default.Shapes.Isogon,b=_.default.Shapes.Path,c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}(h,g.event.Dispatcher),r(h,null,[{key:"defaultProps",value:function(){return{line:{detail:"线配置",propertys:{enabled:{detail:"是否开启",default:!0},strokeStyle:{detail:"线的颜色",default:void 0},lineWidth:{detail:"线的宽度",default:2},lineType:{detail:"线的样式",default:"solid"},smooth:{detail:"是否平滑处理",default:!0}}},node:{detail:"单个数据节点配置，对应线上的小icon图形",propertys:{enabled:{detail:"是否开启",default:!0},shapeType:{detail:"节点icon的图形类型，默认circle",documentation:'可选有"isogon"(正多边形)，"path"（自定义path路径，待实现）',default:"circle"},isogonPointNum:{detail:'shapeType为"isogon"时有效，描述正多边形的边数',default:3},path:{detail:"shapeType为path的时候，描述图形的path路径",default:null},corner:{detail:"拐角才有节点",default:!1},radius:{detail:"节点半径",default:3},fillStyle:{detail:"节点图形的背景色",default:"#ffffff"},strokeStyle:{detail:"节点图形的描边色，默认和line.strokeStyle保持一致",default:null},lineWidth:{detail:"节点图形边宽大小",default:2},visible:{detail:"节点是否显示,支持函数",default:!0}}},label:{detail:"文本配置",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本颜色",default:null},strokeStyle:{detail:"文本描边色",default:null},fontSize:{detail:"文本字体大小",default:12},format:{detail:"文本格式化处理函数",default:null}}},area:{detail:"面积区域配置",propertys:{enabled:{detail:"是否开启",default:!0},fillStyle:{detail:"面积背景色",default:null},alpha:{detail:"面积透明度",default:.2}}}}}}]),r(h,[{key:"init",value:function(){this.sprite=new _.default.Display.Sprite}},{key:"draw",value:function(t,e){g._.extend(!0,this,t),this.data=e,this._widget(t)}},{key:"destroy",value:function(){var t=this;t.sprite.animate({globalAlpha:0},{duration:300,onComplete:function(){t.sprite.remove()}})}},{key:"_getColor",value:function(t,e){var n=this._getProp(t,e);return null==n&&(n=this._getLineStrokeStyle(),t&&t.lineargradient&&(n=t.lineargradient[parseInt(t.lineargradient.length/2)].color),n&&g._.isString(n)||(n=this.fieldMap.color)),n}},{key:"_getProp",value:function(t,e){if(g._.isArray(t))return t[this.iGroup];if(g._.isFunction(t)){var n=[];return null!=e&&n.push(this.data[e]),t.apply(this,n)}return t}},{key:"getNodeInfoAt",value:function(t,e){var n=this.data[t];if(e&&e.eventInfo&&e.eventInfo.dimension_1&&"proportion"==e.eventInfo.dimension_1.layoutType)for(var i,r=0,a=this.data.length;r<a;r++){var o=this.data[r],l=Math.abs(o.x-t);(null==i||l<i)&&(i=l,n=o)}return n}},{key:"resetData",value:function(t,e){var n=this;t&&(this.data=t),n._pointList=this._getPointList(this.data);var i={left:0,right:n._pointList.length-n._currPointList.length};e&&g._.extend(i,e.params),i.left&&(0<i.left&&(this._currPointList=this._pointList.slice(0,i.left).concat(this._currPointList)),i.left<0&&this._currPointList.splice(0,Math.abs(i.left))),i.right&&(0<i.right&&(this._currPointList=this._currPointList.concat(this._pointList.slice(-i.right))),i.right<0&&this._currPointList.splice(this._currPointList.length-Math.abs(i.right))),n._createNodes(),n._createTexts(),n._grow()}},{key:"_grow",value:function(t){var a=this;function r(t){a._bline.context.pointList=g._.clone(t),a._bline.context.strokeStyle=a._getLineStrokeStyle(t),a._area.context.path=a._fillLine(a._bline),a._area.context.fillStyle=a._getFillStyle();var r=0;g._.each(t,function(t,e){if(g._.isNumber(t[1])){if(a._nodes){var n=a._nodes.getChildAt(r);n&&(n.context.x=t[0],n.context.y=t[1])}if(a._labels){var i=a._labels.getChildAt(r);i&&(i.context.x=t[0],i.context.y=t[1]-3,a._checkTextPos(i,e))}r++}})}a.data.length?(this._growTween=l.registTween({from:a._getPointPosStr(a._currPointList),to:a._getPointPosStr(a._pointList),desc:a.field,onUpdate:function(t){for(var e in t){var n=parseInt(e.split("_")[2]),i=parseInt(e.split("_")[1]);a._currPointList[n]&&(a._currPointList[n][i]=t[e])}r(a._currPointList)},onComplete:function(){a.sprite._removeTween(a._growTween),a._growTween=null,r(a._pointList),t&&t(a)}}),this.sprite._tweens.push(this._growTween)):t&&t(a)}},{key:"_getPointPosStr",value:function(t){var n={};return g._.each(t,function(t,e){t&&(n["p_1_"+e]=t[1],n["p_0_"+e]=t[0])}),n}},{key:"_getPointList",value:function(t){for(var e=[],n=0,i=t.length;n<i;n++){var r=t[n];e.push([r.x,r.y])}return e}},{key:"_widget",value:function(t){var e=this;if(t=t||{},e._pointList=this._getPointList(e.data),0!=e._pointList.length){var n=[];if(t.animation)for(var i=this._getFirstNode(),r=i?i.y:void 0,a=0,o=e.data.length;a<o;a++){var l=e.data[a];n.push([l.x,g._.isNumber(l.y)?r:l.y])}else n=e._pointList;var s={pointList:e._currPointList=n,lineWidth:e.line.lineWidth,y:e.y,strokeStyle:e._getLineStrokeStyle(n),smooth:e.line.smooth,lineType:e._getProp(e.line.lineType),smoothFilter:function(t){0<t[1]?t[1]=0:Math.abs(t[1])>e.h&&(t[1]=-e.h)},lineCap:"round"},u=new f({context:s});u.on(g.event.types.get(),function(t){t.eventInfo={trigger:e.line,nodes:[]},e._graphs.app.fire(t.type,t)}),this.line.enabled||(u.context.visible=!1),e.sprite.addChild(u),e._bline=u;var d=new b({context:{path:e._fillLine(u),fillStyle:e._getFillStyle(),globalAlpha:g._.isArray(e.area.alpha)?1:e.area.alpha}});d.on(g.event.types.get(),function(t){t.eventInfo={trigger:e.area,nodes:[]},e._graphs.app.fire(t.type,t)}),this.area.enabled||(d.context.visible=!1),e.sprite.addChild(d),e._area=d,e._createNodes(),e._createTexts()}}},{key:"_getFirstNode",value:function(){for(var t=null,e=0,n=this.data.length;e<n;e++){var i=this.data[e];if(g._.isNumber(i.y)&&(null!==t&&"right"!=this._yAxis.align||(t=i),"right"!==this._yAxis.align&&null!==t))break}return t}},{key:"_getFillStyle",value:function(){var t=this,e=null,n=t._getProp(t.area.fillStyle)||t._getLineStrokeStyle(null,"fillStyle");if(g._.isArray(t.area.alpha)&&!(n instanceof CanvasGradient)){t.area.alpha.length=2,null==t.area.alpha[0]&&(t.area.alpha[0]=0),null==t.area.alpha[1]&&(t.area.alpha[1]=0);var i=g._.min(t._bline.context.pointList,function(t){return t[1]});if(void 0===i[0]||void 0===i[1])return null;e=t.ctx.createLinearGradient(i[0],i[1],i[0],0);var r=g.color.colorRgb(n),a=r.replace(")",", "+t._getProp(t.area.alpha[0])+")").replace("RGB","RGBA");e.addColorStop(0,a);var o=r.replace(")",", "+t.area.alpha[1]+")").replace("RGB","RGBA");e.addColorStop(1,o),n=e}return n}},{key:"_getLineStrokeStyle",value:function(t,e){var n;if(!this._opt.line||!this._opt.line.strokeStyle)return this.line.strokeStyle;if(this._opt.line.strokeStyle.lineargradient){t=t||this._bline.context.pointList;var i=g._.min(t,function(t){return t[1]}),r=g._.max(t,function(t){return t[1]});return"fillStyle"==e&&(r=[0,0]),void 0===i[0]||void 0===i[1]||void 0===r[1]?null:(n=this.ctx.createLinearGradient(i[0],i[1],i[0],r[1]),g._.each(this._opt.line.strokeStyle.lineargradient,function(t,e){n.addColorStop(t.position,t.color)}),n)}return n=this._getColor(this._opt.line.strokeStyle)}},{key:"_createNodes",value:function(){var t=this,e=t._currPointList;this._nodes||(this._nodes=new _.default.Display.Sprite({}),this.sprite.addChild(this._nodes));for(var n=0,i=0,r=e.length;i<r;i++){var a=t._getColor(t.node.strokeStyle||t.line.strokeStyle,i);if(t.data[i].color=a,t.node.enabled){var o=t._currPointList[i];if(o&&g._.isNumber(o[1])){var l={x:o[0],y:o[1],r:t._getProp(t.node.radius,i),lineWidth:t._getProp(t.node.lineWidth,i)||2,strokeStyle:a,fillStyle:t._getProp(t.node.fillStyle,i),visible:!!t._getProp(t.node.visible,i)},s=v,u=t._getProp(t.node.shapeType,i);"isogon"==u&&(s=x,l.n=t._getProp(t.node.isogonPointNum,i)),"path"==u&&(s=b,l.path=t._getProp(t.node.path,i));var d=t._nodes.children[n];if(d?d.type==u?g._.extend(d.context,l):(d.destroy(),d=new s({context:l}),t._nodes.addChildAt(d,n)):(d=new s({context:l}),t._nodes.addChild(d)),t.node.corner){var f=t._pointList[i][1],c=t._pointList[i-1],h=t._pointList[i+1];c&&h&&f==c[1]&&f==h[1]&&(d.context.visible=!1)}n++}}}if(t._nodes.children.length>n)for(var p=n,y=t._nodes.children.length;p<y;p++)t._nodes.children[p].destroy(),p--,y--}},{key:"_createTexts",value:function(){var t=this,e=t._currPointList;if(t.label.enabled){this._labels||(this._labels=new _.default.Display.Sprite({}),this.sprite.addChild(this._labels));for(var n=0,i=0,r=e.length;i<r;i++){var a=e[i];if(a&&g._.isNumber(a[1])){var o={x:a[0],y:a[1]-3,fontSize:this.label.fontSize,textAlign:"center",textBaseline:"bottom",fillStyle:t._getColor(t.label.fontColor,i),lineWidth:1,strokeStyle:"#ffffff"},l=t.data[i].value;if(g._.isFunction(t.label.format)&&(l=t.label.format(l,t.data[i])||l),null!=l&&null!=l){var s=this._labels.children[n];s?(s.resetText(l),g._.extend(s.context,o)):(s=new _.default.Display.Text(l,{context:o}),t._labels.addChild(s),t._checkTextPos(s,i)),n++}}}if(t._labels.children.length>n)for(var u=n,d=t._labels.children.length;u<d;u++)t._labels.children[u].destroy(),u--,d--}}},{key:"_checkTextPos",value:function(t,e){var n=this._currPointList,i=n[e-1],r=n[e+1];i&&r&&i[1]<t.context.y&&r[1]<t.context.y&&(t.context.y+=7,t.context.textBaseline="top")}},{key:"_fillLine",value:function(t){var n=g._.clone(t.context.pointList),e="",i=-this._yAxis.originPos,r=null;function a(){r.push([r[r.length-1][0],i],[r[0][0],i],[r[0][0],r[0][1]]),e+=(0,o.getPath)(r),r=null}return g._.each(n,function(t,e){g._.isNumber(t[1])?(null===r&&(r=[]),r.push(t)):r&&r.length&&a(),e==n.length-1&&g._.isNumber(t[1])&&a()}),e}},{key:"getNodeInfoOfX",value:function(r){for(var t=this,e=0,n=this.data.length;e<n;e++)if(null!==this.data[e].value&&Math.abs(this.data[e].x-r)<=1)return this.data[e];function a(t,e){var n={x:t,y:0};return n.y=e[0][1]+(e[1][1]-e[0][1])/(e[1][0]-e[0][0])*(t-e[0][0]),n}var o;return this._bline&&function t(e){if(!(r<e[0][0]||r>e.slice(-1)[0][0])){var n=parseInt(e.length/2);if(Math.abs(e[n][0]-r)<=1)o={x:e[n][0],y:e[n][1]};else{var i=[];if(r>e[n][0]){if(r<e[n+1][0])return void(o=a(r,[e[n],e[n+1]]));i=e.slice(n+1)}else{if(r>e[n-1][0])return void(o=a(r,[e[n-1],e[n]]));i=e.slice(0,n)}t(i)}}}(this._bline.context.pointList),o&&null!=o.y?{type:"line",iGroup:t.iGroup,iNode:-1,field:t.field,value:this._yAxis.getValOfPos(-o.y),x:o.x,y:o.y,rowData:null,color:t._getProp(t.node.strokeStyle)||t._getLineStrokeStyle()}:null}}]),h);function h(t,e,n,i,r,a,o){var l;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(l=function(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?d(t):e}(this,u(h).call(this)))._graphs=o,l._opt=n,l.fieldMap=t,l.field=null,l.iGroup=e,l._yAxis=t.yAxis,l.ctx=i,l.w=a,l.h=r,l.y=0,l.line={strokeStyle:t.color},l.data=[],l.sprite=null,l._pointList=[],l._currPointList=[],l._bline=null,g._.extend(!0,d(l),(0,g.getDefaultProps)(h.defaultProps()),n),l.field=t.field,l.init(n),l}t.default=c}(e,n,l,i)});t(g),t(e(function(t,e){!function(t,e,n,c){Object.defineProperty(t,"__esModule",{value:!0});var h=i(e);function i(t){return t&&t.__esModule?t:{default:t}}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(f,i(n).default),s(f,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置，支持二维数组格式",default:null},yAxisAlign:{detail:"绘制在哪根y轴上面",default:"left"},_props:[h.default]}}}]),s(f,[{key:"init",value:function(){}},{key:"draw",value:function(t){return t=t||{},this.width=t.width,this.height=t.height,c._.extend(!0,this.origin,t.origin),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.data=this._trimGraphs(),this._setGroupsForYfield(this.data,null,t),this.animation&&!t.resize?this.grow():this.fire("complete"),this}},{key:"resetData",value:function(t,e){var n=this;t&&(n.dataFrame=t,n.data=n._trimGraphs()),c._.each(n.groups,function(t){t.resetData(n.data[t.field].data,e)})}},{key:"setEnabledField",value:function(){this.enabledField=this.app.getComponent({name:"coord"}).filterEnabledFields(this.field)}},{key:"_trimGraphs",value:function(){var u=this,d=this.app.getComponent({name:"coord"}),f={};return u.setEnabledField(),c._.each(c._.flatten(u.enabledField),function(t,e){var n=u.app.getComponent({name:"coord"}).getFieldMapOf(t),i=u.dataFrame.getFieldData(t);if(i){for(var r=[],a=0,o=i.length;a<o;a++){var l=d.getPoint({iNode:a,field:t,value:{y:i[a]}}),s={type:"line",iGroup:e,iNode:a,field:t,value:i[a],x:l.pos.x,y:l.pos.y,rowData:u.dataFrame.getRowDataAt(a),color:n.color};r.push(s)}f[t]={yAxis:n.yAxis,field:t,data:r}}}),f}},{key:"grow",value:function(n){var i=0,r=this.groups.length,a=this;return c._.each(this.groups,function(t,e){t._grow(function(){i++,n&&n(t),i==r&&a.fire("complete")})}),this}},{key:"show",value:function(t){var n=this;-1!=c._.indexOf(c._.flatten([n.field]),t)&&(this.data=this._trimGraphs(),this._setGroupsForYfield(this.data,t),c._.each(this.groups,function(t,e){t.resetData(n.data[t.field].data)}))}},{key:"hide",value:function(t){var n=this,e=n.getGroupIndex(t);!this.groups.length||e<0||(this.groups.splice(e,1)[0].destroy(),this.data=this._trimGraphs(),c._.each(this.groups,function(t,e){t.resetData(n.data[t.field].data)}))}},{key:"getGroupIndex",value:function(t){for(var e=-1,n=0,i=this.groups.length;n<i;n++)if(this.groups[n].field===t){e=n;break}return e}},{key:"getGroup",value:function(t){return this.groups[this.getGroupIndex(t)]}},{key:"_setGroupsForYfield",value:function(t,s,u){var d=this;u=u||{},s=s&&c._.flatten([s]);var f=c._.flatten([this.field]);c._.each(t,function(t,e){if(!s||-1!=c._.indexOf(s,e)){var n=d.app.getComponent({name:"coord"}).getFieldMapOf(e),i=c._.indexOf(f,e),r=new h.default(n,i,d._opt,d.ctx,d.height,d.width,d);r.draw({animation:d.animation&&!u.resize},t.data);for(var a=!1,o=0,l=d.groups.length;o<l;o++)if(i<d.groups[o].iGroup){d.groups.splice(o,0,r),a=!0,d.sprite.addChildAt(r.sprite,o);break}a||(d.groups.push(r),d.sprite.addChild(r.sprite))}})}},{key:"getNodesAt",value:function(n,i){var r=[];return c._.each(this.groups,function(t){var e=t.getNodeInfoAt(n,i);e&&r.push(e)}),r}},{key:"getNodesOfPos",value:function(n){var i=[];return c._.each(this.groups,function(t){var e=t.getNodeInfoOfX(n);e&&i.push(e)}),i}}]),f);function f(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(n=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?o(t):e}(this,a(f).call(this,t,e))).type="line",n.enabledField=null,n.groups=[],c._.extend(!0,o(n),(0,c.getDefaultProps)(f.defaultProps()),t),n.init(),n}c.global.registerComponent(d,"graphs","line"),t.default=d}(e,g,y,i)}));var _=e(function(t,e){function d(t,e,n,i,r,a){var o=(a-e)*(n-t)-(i-e)*(r-t);return 0<o||!(o<0)}var n;n=e,Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e){var n=t[0][0],i=t[0][1],r=t[1][0],a=t[1][1],o=e[0][0],l=e[0][1],s=e[1][0],u=e[1][1];return d(n,i,o,l,s,u)!==d(r,a,o,l,s,u)&&d(n,i,r,a,o,l)!==d(n,i,r,a,s,u)}});t(_);var v=e(function(t,e){function n(t,e){this._cells=[],this._cellSize=e,this._reverseCellSize=1/e;for(var n=0;n<t.length;n++){var i=t[n],r=this.coordToCellNum(i[0]),a=this.coordToCellNum(i[1]);if(this._cells[r])this._cells[r][a]?this._cells[r][a].push(i):this._cells[r][a]=[i];else{var o=[];o[a]=[i],this._cells[r]=o}}}var i;i=e,Object.defineProperty(i,"__esModule",{value:!0}),n.prototype={cellPoints:function(t,e){return void 0!==this._cells[t]&&void 0!==this._cells[t][e]?this._cells[t][e]:[]},rangePoints:function(t){for(var e=this.coordToCellNum(t[0]),n=this.coordToCellNum(t[1]),i=this.coordToCellNum(t[2]),r=this.coordToCellNum(t[3]),a=[],o=e;o<=i;o++)for(var l=n;l<=r;l++)Array.prototype.push.apply(a,this.cellPoints(o,l));return a},removePoint:function(t){for(var e,n=this.coordToCellNum(t[0]),i=this.coordToCellNum(t[1]),r=this._cells[n][i],a=0;a<r.length;a++)if(r[a][0]===t[0]&&r[a][1]===t[1]){e=a;break}return r.splice(e,1),r},trunc:Math.trunc||function(t){return t-t%1},coordToCellNum:function(t){return this.trunc(t*this._reverseCellSize)},extendBbox:function(t,e){return[t[0]-e*this._cellSize,t[1]-e*this._cellSize,t[2]+e*this._cellSize,t[3]+e*this._cellSize]}},i.default=function(t,e){return new n(t,e)}});t(v);var x=e(function(t,e){var n;n=e,Object.defineProperty(n,"__esModule",{value:!0}),n.default={toXy:function(t,e){return void 0===e?t.slice():t.map(function(t){return new Function("pt","return [pt"+e[0]+",pt"+e[1]+"];")(t)})},fromXy:function(t,e){return void 0===e?t.slice():t.map(function(t){return new Function("pt","const o = {}; o"+e[0]+"= pt[0]; o"+e[1]+"= pt[1]; return o;")(t)})}}});t(x);var b=e(function(t,e){function r(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}var n;n=e,Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(i){var t=function(t){for(var e=[],n=0;n<t.length;n++){for(;2<=e.length&&r(e[e.length-2],e[e.length-1],t[n])<=0;)e.pop();e.push(t[n])}return e.pop(),e}(i),e=function(){for(var t=i.reverse(),e=[],n=0;n<t.length;n++){for(;2<=e.length&&r(e[e.length-2],e[e.length-1],t[n])<=0;)e.pop();e.push(t[n])}return e.pop(),e}().concat(t);return e.push(i[0]),e}});t(b);var m=e(function(t,e){!function(t,e,n,i,r){Object.defineProperty(t,"__esModule",{value:!0});var a=o(e),f=o(n),c=o(i),h=o(r);function o(t){return t&&t.__esModule?t:{default:t}}function g(t,e){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function u(t,e,n){var i=[e[0]-t[0],e[1]-t[1]],r=[n[0]-t[0],n[1]-t[1]],a=g(t,e),o=g(t,n);return(i[0]*r[0]+i[1]*r[1])/Math.sqrt(a*o)}function d(t,e){for(var n=0;n<e.length-1;n++){var i=[e[n],e[n+1]];if(!(t[0][0]===i[0][0]&&t[0][1]===i[0][1]||t[0][0]===i[1][0]&&t[0][1]===i[1][1])&&(0,a.default)(t,i))return!0}return!1}function _(t,e,n){for(var i,r,a=null,o=p,l=p,s=0;s<e.length;s++)i=u(t[0],t[1],e[s]),r=u(t[1],t[0],e[s]),o<i&&l<r&&!d([t[0],e[s]],n)&&!d([t[1],e[s]],n)&&(o=i,l=r,a=e[s]);return a}var p=Math.cos(90/(180/Math.PI));t.default=function(t,e,n){var i=e||20,r=function(t){for(var e=[t[0]],n=t[0],i=1;i<t.length;i++){var r=t[i];n[0]===r[0]&&n[1]===r[1]||e.push(r),n=r}return e}(function(t){return t.sort(function(t,e){return t[0]-e[0]||t[1]-e[1]})}(c.default.toXy(t,n)));if(r.length<4)return r.concat([r[0]]);var a=function(t){for(var e=1/0,n=1/0,i=-1/0,r=-1/0,a=t.length-1;0<=a;a--)t[a][0]<e&&(e=t[a][0]),t[a][1]<n&&(n=t[a][1]),t[a][0]>i&&(i=t[a][0]),t[a][1]>r&&(r=t[a][1]);return[i-e,r-n]}(r),o=[.6*a[0],.6*a[1]],l=(0,h.default)(r),s=r.filter(function(t){return l.indexOf(t)<0}),u=Math.ceil(1/(r.length/(a[0]*a[1]))),d=function t(e,n,i,r,a){for(var o,l=!1,s=0;s<e.length-1;s++){var u=[e[s],e[s+1]],d=u[0][0]+","+u[0][1]+","+u[1][0]+","+u[1][1];if(!(g(u[0],u[1])<n||a.has(d))){for(var f=0,c=(o=u,[Math.min(o[0][0],o[1][0]),Math.min(o[0][1],o[1][1]),Math.max(o[0][0],o[1][0]),Math.max(o[0][1],o[1][1])]),h=void 0,p=void 0,y=void 0;h=(c=r.extendBbox(c,f))[2]-c[0],p=c[3]-c[1],f++,null===(y=_(u,r.rangePoints(c),e))&&(i[0]>h||i[1]>p););h>=i[0]&&p>=i[1]&&a.add(d),null!==y&&(e.splice(s+1,0,y),r.removePoint(y),l=!0)}}return l?t(e,n,i,r,a):e}(l,Math.pow(i,2),o,(0,f.default)(s,u),new Set);return n?c.default.fromXy(d,n):d}}(e,_,v,x,b)});t(m),t(e(function(t,e){!function(t,e,n,g,i){Object.defineProperty(t,"__esModule",{value:!0});var _=a(e),r=a(n),v=a(i);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var x=_.default.Shapes.Circle,b=_.default.Shapes.Rect,m=_.default.Shapes.Line,w=_.default.Shapes.Polygon,c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(h,r.default),d(h,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},groupField:{detail:"分组字段",default:null,documentation:"分组字段，如果area配置enabled为true，那么需要groupField来构建几个area"},dataFilter:{detail:"散点过滤数据",default:null,documentation:"数据过滤器，可以和groupField实现交叉过滤"},aniOrigin:{detail:"节点动画的原点",default:"default",documentation:"可选的还有center（坐标正中）、origin（坐标原点）"},node:{detail:"单数据节点图形设置",propertys:{dataKey:{detail:"元素的数据id，默认索引匹配",default:"__index__"},shapeType:{detail:"图形类型",default:"circle",documentation:"节点的现状可以是圆 ，也可以是rect，也可以是三角形，后面两种后面实现"},maxRadius:{detail:"节点最大半径",default:25},minRadius:{detail:"节点最小半径",default:5},radius:{detail:"半径",default:null},radiusScale:{detail:"半径缩放比例",documentation:"在计算好真实半径后缩放，主要用在,缩略图中，比如datazoom的缩略图",default:1},normalRadius:{detail:"默认半径",default:15},fillStyle:{detail:"节点景色",default:null},fillAlpha:{detail:"节点透明度",default:.8},strokeStyle:{detail:"节点描边颜色",default:null},lineWidth:{detail:"节点描边线宽",default:0},strokeAlpha:{detail:"节点描边透明度",default:1},focus:{detail:"节点hover态设置",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"hover后的边框大小",default:6},strokeAlpha:{detail:"hover后的边框透明度",default:.2},fillAlpha:{detail:"hover后的背景透明度",default:.8}}},select:{detail:"节点选中态设置",propertys:{enabled:{detail:"是否开启",default:!1},lineWidth:{detail:"选中后的边框大小",default:8},strokeAlpha:{detail:"选中后的边框透明度",default:.4},fillAlpha:{detail:"选中后的背景透明度",default:1}}}}},line:{detail:"每个节点和指标轴线的连线",propertys:{enabled:{detail:"是否开启",default:!1},lineWidth:{detail:"连线宽",default:1},strokeStyle:{detail:"连线颜色",default:"#ccc"},lineType:{detail:"连线类型",default:"dashed"}}},area:{detail:"散点集合组成的面",propertys:{enabled:{detail:"是否开启",default:!1},concavity:{detail:"凹凸系数，默认80，越大越凸",default:88},quantile:{detail:"散点用来计入面积的分位数",default:8},fillStyle:{detail:"散点集合面的背景色",default:null},fillAlpha:{detail:"散点集合面的透明度",default:.15},strokeStyle:{detail:"散点集合面的描边颜色",default:null},lineWidth:{detail:"散点集合面的描边线宽",default:0},strokeAlpha:{detail:"散点集合面的描边透明度",default:.5}}},label:{detail:"文本设置",propertys:{enabled:{detail:"是否开启",default:!0},field:{detail:"获取label的字段",default:null},format:{detail:"label格式化处理函数",default:function(t){return t}},fontSize:{detail:"label字体大小",default:13},fontColor:{detail:"字体颜色",default:"#888"},strokeStyle:{detail:"字体描边颜色",default:"#ffffff"},lineWidth:{detail:"描边大小",default:0},textAlign:{detail:"水平对齐方式",default:"center"},verticalAlign:{detail:"垂直基线对齐方式",default:"middle"},position:{detail:"文本布局位置",documentation:"auto(目前等于center，还未实现),center,top,right,bottom,left",default:"center"},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0}}}}}}]),d(h,[{key:"init",value:function(){this._shapesp=new _.default.Display.Sprite({id:"scat_shapesp"}),this._textsp=new _.default.Display.Sprite({id:"textsp"}),this._linesp=new _.default.Display.Sprite({id:"textsp"}),this._areasp=new _.default.Display.Sprite({id:"areasp"}),this.sprite.addChild(this._areasp),this.sprite.addChild(this._linesp),this.sprite.addChild(this._shapesp),this.sprite.addChild(this._textsp)}},{key:"draw",value:function(t){t=t||{},g._.extend(!0,this,t),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y;var e=this;return!this.animation||t.resize||e.inited?this.fire("complete"):this.grow(function(){e.fire("complete")}),this}},{key:"resetData",value:function(t){this.dataFrame=t,this.data=this._trimGraphs(),this._widget(),this.grow()}},{key:"getNodesAt",value:function(){return[]}},{key:"_trimGraphs",value:function(){var t=[];this._groupData={};var e=this.app.getComponent({name:"coord"}),n=this.dataFrame.length;this._rData=null,this._rMaxValue=null,this._rMinValue=null;for(var i=0;i<n;i++){var r=this.dataFrame.getRowDataAt(i),a=e.getFieldMapOf(this.field),o=e.getPoint({iNode:i,field:this.field,value:{y:r[this.field]}});if(null!=o.pos.x&&null!=o.pos.y){var l={type:"scat",rowData:r,x:o.pos.x,y:o.pos.y,value:o.value,field:this.field,fieldColor:a.color,iNode:i,focused:!1,selected:!1,radius:null,fillStyle:null,color:null,strokeStyle:null,strokeAlpha:1,lineWidth:0,shapeType:null,label:null,fillAlpha:1,nodeElement:null};if(this._setR(l),this._setFillStyle(l),this._setFillAlpha(l),this._setStrokeStyle(l),this._setLineWidth(l),this._setStrokeAlpha(l),this._setNodeType(l),this._setText(l),!this.dataFilter||!g._.isFunction(this.dataFilter)||this.dataFilter.apply(this,[l])){if(this.groupField){var s=r[this.groupField];s&&(this._groupData[s]||(this._groupData[s]=[]),this._groupData[s].push(l))}else this._groupData.all||(this._groupData.all=[]),this._groupData.all.push(l);t.push(l)}}}return t}},{key:"_setR",value:function(t){var e=this.node.normalRadius,n=t.rowData;if(null!=this.node.radius){if(g._.isString(this.node.radius)&&n[this.node.radius]){this._rData||this._rMaxValue||this._rMinValue||(this._rData=this.dataFrame.getFieldData(this.node.radius),this._rMaxValue=g._.max(this._rData),this._rMinValue=g._.min(this._rData));var i=n[this.node.radius];e=this._rMaxValue==this._rMinValue?this.node.minRadius+(this.node.maxRadius-this.node.minRadius)/2:this.node.minRadius+(i-this._rMinValue)/(this._rMaxValue-this._rMinValue)*(this.node.maxRadius-this.node.minRadius)}g._.isFunction(this.node.radius)&&(e=this.node.radius(n)),isNaN(parseInt(this.node.radius))||(e=parseInt(this.node.radius))}return e=Math.max(e*this.node.radiusScale,2),t.radius=e,this}},{key:"_setText",value:function(t){null!=this.label.field&&g._.isString(this.label.field)&&t.rowData[this.label.field]&&(t.label=this.label.format(t.rowData[this.label.field],t))}},{key:"_setFillStyle",value:function(t){return t.color=t.fillStyle=this._getStyle(this.node.fillStyle,t),this}},{key:"_setFillAlpha",value:function(t){return t.fillAlpha=this._getProp(this.node.fillAlpha,t),this}},{key:"_setStrokeAlpha",value:function(t){return t.strokeAlpha=this._getProp(this.node.strokeAlpha,t),this}},{key:"_setStrokeStyle",value:function(t){return t.strokeStyle=this._getStyle(this.node.strokeStyle||this.node.fillStyle,t),this}},{key:"_getProp",value:function(t,e){var n=t;return g._.isArray(t)&&(n=t[e.iGroup]),g._.isFunction(t)&&(n=t.apply(this,[e])),n}},{key:"_getStyle",value:function(t,e){var n=t;return g._.isArray(t)&&(n=t[e.iGroup]),g._.isFunction(t)&&(n=t.apply(this,[e])),n=n||e.fieldColor}},{key:"_setLineWidth",value:function(t){return t.lineWidth=this._getProp(this.node.lineWidth,t),this}},{key:"_setNodeType",value:function(t){var e=this.node.shapeType;return g._.isArray(e)&&(e=e[t.iGroup]),g._.isFunction(e)&&(e=e(t)),e=e||"circle",t.shapeType=e,this}},{key:"_widget",value:function(){var t=this,u=this;if(g._.each(g._.flatten([u._shapesp.children,u._textsp.children,u._linesp.children]),function(t){t.__used=!1}),g._.each(u.data,function(t,e){var n=u._getNodeElement(t,e);n||(t.__isNew=!0);var i=u._getNodeContext(t),r="circle"==t.shapeType?x:b;if(n?n.animate(i):(n=new r({id:"shape_"+e,hoverClone:!1,context:i}),u._shapesp.addChild(n),n.on(g.event.types.get(),function(t){t.eventInfo={title:null,trigger:u.node,nodes:[this.nodeData]},this.nodeData.label&&(t.eventInfo.title=this.nodeData.label),"mouseover"==t.type&&u.focusAt(this.nodeData.iNode),"mouseout"==t.type&&(this.nodeData.selected||u.unfocusAt(this.nodeData.iNode)),u.app.fire(t.type,t)})),n.__used=!0,n.nodeData=t,n.iNode=e,t.nodeElement=n,u.line.enabled){var a=n.lineElement,o={start:{x:i.x,y:i.y+i.r},end:{x:i.x,y:0},lineWidth:u.line.lineWidth,strokeStyle:u.line.strokeStyle,lineType:u.line.lineType};a?a.animate(o):(a=new m({context:o}),u._linesp.addChild(a)),a.__used=!0,n.lineElement=a}if(t.label&&u.label.enabled){var l=n.labelElement,s={};l?(l.resetText(t.label),s=u._getTextContext(l,i),l.animate(s)):(l=new _.default.Display.Text(t.label,{id:"scat_text_"+e,context:{}}),s=u._getTextContext(l,i),g._.extend(l.context,s),u._textsp.addChild(l)),l.__used=!0,(n.labelElement=l).nodeElement=n}}),u.area.enabled){u._areasp.removeAllChildren();var e=0,n=function(){r=t._groupData[i],a={name:i,iGroup:e,data:r},o=[],g._.each(r,function(t){o=o.concat(function(t,e){if(!e||1==e)return[[t.x,t.y]];for(var n=[],i=0;i<e;i++){var r=360/(e-1)*i,a=t.radius+3,o=t.x+Math.cos(2*Math.PI/360*r)*a,l=t.y+Math.sin(2*Math.PI/360*r)*a;n.push([o,l])}return n}(t,u.area.quantile))}),l=(0,v.default)(o,u.area.concavity),s=u.app.getTheme(e),d=u._getStyle(u.area.fillStyle,a)||s,f=u._getProp(u.area.fillAlpha,a),c=u._getStyle(u.area.strokeStyle,a)||s,h=u._getProp(u.area.lineWidth,a),p=u._getProp(u.area.strokeAlpha,a),y=new w({context:{pointList:l,fillStyle:d,fillAlpha:f,strokeStyle:c,lineWidth:h,strokeAlpha:p,smooth:!1}}),u._areasp.addChild(y),e++};for(var i in this._groupData){var r,a,o,l,s,d,f,c,h,p,y;n()}}g._.each(g._.flatten([u._shapesp.children,u._textsp.children,u._linesp.children]),function(t){t.__used||t.animate({globalAlpha:0,r:0},{onComplete:function(){t.destroy()}})})}},{key:"_getNodeElement",value:function(t,e){var n,i=this.node.dataKey;if(i){g._.isString(i)&&(i=i.split(","));for(var r=0,a=this._shapesp.children.length;r<a;r++){for(var o=this._shapesp.children[r],l=!0,s=0,u=i.length;s<u;s++){var d=i[s];if(o.nodeData.rowData[d]!=t.rowData[d]){l=!1;break}}if(l&&i.length){n=o;break}}}else n=this._shapesp.getChildAt(e);return n}},{key:"_getTextPosition",value:function(t,e){var n=0,i=0;switch(this.label.position){case"center":n=e.x,i=e.y;break;case"top":n=e.x,i=e.y-e.r;break;case"right":n=e.x+e.r,i=e.y;break;case"bottom":n=e.x,i=e.y+e.r;break;case"left":n=e.x-e.r,i=e.y;break;case"auto":n=e.x,i=e.y,t.getTextWidth()>2*e.r&&(i=e.y+e.r+.5*t.getTextHeight())}return{x:n+this.label.offsetX,y:i+this.label.offsetY}}},{key:"_getTextContext",value:function(t,e){var n=this._getTextPosition(t,e),i=this.label.fontSize;t.getTextWidth()>2*e.r&&(i-=2);var r={x:n.x,y:n.y,fillStyle:this.label.fontColor||e.fillStyle,fontSize:i,strokeStyle:this.label.strokeStyle||e.fillStyle,lineWidth:this.label.lineWidth,textAlign:this.label.textAlign,textBaseline:this.label.verticalAlign};return this.animation&&!this.inited&&this._setCtxAniOrigin(r),r}},{key:"_setCtxAniOrigin",value:function(t){if("default"==this.aniOrigin&&(t.y=0),"origin"==this.aniOrigin){var e=this.app.getComponent({name:"coord"}).getOriginPos({field:this.field});t.x=e.x,t.y=e.y}"center"==this.aniOrigin&&(t.x=this.width/2,t.y=-this.height/2)}},{key:"_getNodeContext",value:function(t){if("circle"==t.shapeType)return this._getCircleContext(t)}},{key:"_getCircleContext",value:function(t){var e={x:t.x,y:t.y,r:t.radius,fillStyle:t.fillStyle,strokeStyle:t.strokeStyle,strokeAlpha:t.strokeAlpha,lineWidth:t.lineWidth,fillAlpha:t.fillAlpha,cursor:"pointer"};return!this.animation||this.inited&&!t.__isNew||(this._setCtxAniOrigin(e),e.r=1),e}},{key:"grow",value:function(e){var n=0,i=this.data.length-1,r=this;g._.each(this.data,function(t){t.__isNew&&r._growNode(t,function(){n+=1,delete t.__isNew,n==i&&e&&e()})})}},{key:"_growNode",value:function(t,e){var n=this;t.nodeElement.animate({x:t.x,y:t.y,r:t.radius},{onUpdate:function(t){if(this.labelElement&&this.labelElement.context){var e=n._getTextPosition(this.labelElement,t);this.labelElement.context.x=e.x,this.labelElement.context.y=e.y}this.lineElement&&this.lineElement.context&&(this.lineElement.context.start.y=t.y+t.r)},delay:Math.round(300*Math.random()),onComplete:function(){e&&e()}})}},{key:"focusAt",value:function(t){var e=this.data[t];if(this.node.focus.enabled&&!e.focused){var n=e.nodeElement.context;n.lineWidth=this.node.focus.lineWidth,n.strokeAlpha=this.node.focus.strokeAlpha,n.fillAlpha=this.node.focus.fillAlpha,e.focused=!0}}},{key:"unfocusAt",value:function(t){var e=this.data[t];if(this.node.focus.enabled&&e.focused){var n=e.nodeElement.context;n.lineWidth=e.lineWidth,n.strokeAlpha=e.strokeAlpha,n.fillAlpha=e.fillAlpha,n.strokeStyle=e.strokeStyle,e.focused=!1}}},{key:"selectAt",value:function(t){var e=this.data[t];if(this.node.select.enabled&&!e.selected){var n=e.nodeElement.context;n.lineWidth=this.node.select.lineWidth,n.strokeAlpha=this.node.select.strokeAlpha,n.fillAlpha=this.node.select.fillAlpha,e.selected=!0}}},{key:"unselectAt",value:function(t){var e=this.data[t];if(this.node.select.enabled&&e.selected){var n=e.nodeElement.context;e.focused?(n.lineWidth=this.node.focus.lineWidth,n.strokeAlpha=this.node.focus.strokeAlpha,n.fillAlpha=this.node.focus.fillAlpha):(n.lineWidth=e.lineWidth,n.strokeAlpha=e.strokeAlpha,n.fillAlpha=e.fillAlpha),e.selected=!1}}},{key:"getNodesOfPos",value:function(){return[]}}]),h);function h(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?s(t):e}(this,l(h).call(this,t,e))).type="scat",n._rData=null,n._rMaxValue=null,n._rMinValue=null,n._groupData={},g._.extend(!0,s(n),(0,g.getDefaultProps)(h.defaultProps()),t),n.init(),n}g.global.registerComponent(c,"graphs","scat"),t.default=c}(e,n,y,i,m)}));var w=e(function(t,e){!function(t,e,o){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,i=(n=e)&&n.__esModule?n:{default:n};function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d,f,c=i.default.Shapes.Sector,T=i.default.Shapes.Path,h=i.default.AnimationFrame,p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(y,o.event.Dispatcher),d=y,(f=[{key:"init",value:function(){this.sprite=new i.default.Display.Sprite,this.sectorsSp=new i.default.Display.Sprite,this.sprite.addChild(this.sectorsSp),this.selectedSp=new i.default.Display.Sprite,this.sprite.addChild(this.selectedSp),this._graphs.label.enabled&&(this.textSp=new i.default.Display.Sprite)}},{key:"draw",value:function(t){o._.extend(!0,this,t),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this._widget()}},{key:"resetData",value:function(t){var e=this;this.data=t,e.destroyLabel();for(var n=0,i=0;i<e.sectors.length;i++){var r=e.sectors[i],a=this.data.list[i];r.animate({r:a.outRadius,startAngle:a.startAngle,endAngle:a.endAngle},{duration:280,onComplete:function(){++n==e.sectors.length&&e._graphs.label.enabled&&e._startWidgetLabel()}})}}},{key:"_widget",value:function(){var e=this,t=e.data.list,n=e.data.total;if(0<t.length&&0<n){e.textSp&&e.sprite.addChild(e.textSp);for(var i=0;i<t.length;i++){var r=t[i],a=new c({hoverClone:!1,xyToInt:!1,context:{x:r.focused?r.outOffsetx:0,y:r.focused?r.outOffsety:0,r0:r.innerRadius,r:r.outRadius,startAngle:r.startAngle,endAngle:r.endAngle,fillStyle:r.fillStyle,cursor:"pointer"},id:"sector"+i});(a.nodeData=r).focusEnabled&&a.hover(function(t){e.focusOf(this.nodeData)},function(t){this.nodeData.selected||e.unfocusOf(this.nodeData)}),a.on(o.event.types.get(),function(t){t.eventInfo={trigger:e._graphs.node,nodes:[this.nodeData]},e._graphs.app.fire(t.type,t)}),e.sectorsSp.addChildAt(a,0),e.sectors.push(a)}e._graphs.label.enabled&&e._startWidgetLabel()}}},{key:"focusOf",value:function(t,e){t.focused||(this.sectors[t.iNode].animate({x:t.outOffsetx,y:t.outOffsety},{duration:100,onComplete:function(){e&&e()}}),t.focused=!0)}},{key:"unfocusOf",value:function(t,e){t.focused&&(this.sectors[t.iNode].animate({x:0,y:0},{duration:100,onComplete:function(){e&&e()}}),t.focused=!1)}},{key:"selectOf",value:function(t){var e=this;if(this.sectors.length&&t.selectEnabled){var n=this.sectors[t.iNode];t.selected||(t.focused?this.addCheckedSec(n):(t._focusTigger="select",this.focusOf(t,function(){e.addCheckedSec(n)})),t.selected=!0)}}},{key:"unselectOf",value:function(t){var e=this.sectors[t.iNode];if(t.selected&&t.selectEnabled){var n=this;n.cancelCheckedSec(e,function(){"select"==t._focusTigger&&n.unfocusOf(t)}),t.selected=!1}}},{key:"addCheckedSec",value:function(t,e){var n=t.context,i=t.nodeData;if(n){var r=new c({xyToInt:!1,context:{x:n.x,y:n.y,r0:n.r-1,r:n.r+i.selectedR,startAngle:n.startAngle,endAngle:n.startAngle,fillStyle:n.fillStyle,globalAlpha:i.selectedAlpha},id:"selected_"+t.id});t._selectedSec=r,this.selectedSp.addChild(r),this.completed?r.animate({endAngle:n.endAngle},{duration:this._getAngleTime(n),onComplete:function(){e&&e()}}):r.context.endAngle=n.endAngle}}},{key:"cancelCheckedSec",value:function(t,e){var n=t._selectedSec;n.animate({startAngle:n.context.endAngle-.5},{duration:this._getAngleTime(t.context),onComplete:function(){delete t._selectedSec,n.destroy(),e&&e()}})}},{key:"_getAngleTime",value:function(t){return Math.abs(t.startAngle-t.endAngle)/360*500}},{key:"grow",value:function(t){var d=this;o._.each(d.sectors,function(t,e){t.context&&(t.context.r0=0,t.context.r=0,t.context.startAngle=d._graphs.startAngle,t.context.endAngle=d._graphs.startAngle)}),d._hideGrowLabel();var e=h.registTween({from:{process:0},to:{process:1},duration:500,onUpdate:function(t){for(var e=0;e<d.sectors.length;e++){var n=d.sectors[e],i=n.nodeData,r=n.context,a=i.startAngle,o=i.endAngle,l=i.outRadius,s=i.innerRadius;if(r){if(r.r=l*t.process,r.r0=s*t.process,0==e)r.startAngle=a,r.endAngle=a+(o-a)*t.process;else{var u=function(t){var e=t-1,n=d.sectors[e].context;return 0==e?n?n.endAngle:0:n?n.endAngle:arguments.callee(e)}(e);r.startAngle=u,r.endAngle=r.startAngle+(o-a)*t.process}n._selectedSec&&(n._selectedSec.context.r0=r.r-1,n._selectedSec.context.r=r.r+i.selectedR,n._selectedSec.context.startAngle=r.startAngle,n._selectedSec.context.endAngle=r.endAngle)}}},onComplete:function(){d.sprite._removeTween(e),d._showGrowLabel(),d.completed=!0,t&&t()}});d.sprite._tweens.push(e)}},{key:"_widgetLabel",value:function(t,e,n,i,r,a){var o,l,s,u,d,f,c,h,p,y,g,_,v=this,x=0,b=v.data.list,m=2==t||3==t,w=3==t||4==t,S=m?n:i;0<e.length&&e.sort(function(t,e){return w?b[t].edgey-b[e].edgey:b[e].edgey-b[t].edgey});for(var k=0;k<e.length;k++){o=e[k];var A=b[o],O=A.outRadius+A.moveDis;if(!(!A.enabled||A.y<S||x>=v.textMaxCount)){x++,s=A.edgey,u=Math.abs(A.edgex),d=s-l,0!=k&&(Math.abs(d)<15||w&&d<0||!w&&0<d)&&(s=w?l+15:l-15,0<O-Math.abs(s)&&(u=Math.sqrt(Math.pow(O,2)-Math.pow(s,2))),(m&&-u>A.edgex||!m&&u<A.edgex)&&(u=Math.abs(A.edgex))),r&&(y=m?a.left:a.right,g=e.length-k,_=w?y-15*g:y+15*g,(w&&_<s||!w&&s<_)&&(s=_)),l=s,r||(m?a.left=l:a.right=l);var P=m?-u-5:u+5,C=P+v.origin.x,j=s+v.origin.y;if(C>v._graphs.app.width||j<0||j>v._graphs.app.height)return;var E="M"+A.centerx+","+A.centery;E+="Q"+A.outx+","+A.outy+","+P+","+s;var M=new T({context:{lineType:"solid",path:E,lineWidth:1,strokeStyle:A.fillStyle}}),I=A.labelText,D=document.createElement("div");switch(D.style.cssText=" ;position:absolute;left:-1000px;top:-1000px;color:"+A.fillStyle,D.innerHTML=I,v.domContainer.appendChild(D),f=D.offsetWidth,c=D.offsetHeight,h=m?-u:u,p=s,t){case 1:h+=5,p-=c/2;break;case 2:case 3:h-=f+5,p-=c/2;break;case 4:h+=5,p-=c/2}D.style.left=h+v.origin.x+"px",D.style.top=p+v.origin.y+"px",v.textSp.addChild(M),v.textList.push({width:f,height:c,x:h+v.origin.x,y:p+v.origin.y,data:A,textTxt:I,textEle:D})}}}},{key:"_startWidgetLabel",value:function(){for(var t,e,n=this,i=n.data.list,r=0,a=0,o=[],l=[{indexs:[],count:0},{indexs:[],count:0},{indexs:[],count:0},{indexs:[],count:0}],s={right:{startQuadrant:4,endQuadrant:1,clockwise:!0,indexs:[]},left:{startQuadrant:3,endQuadrant:2,clockwise:!1,indexs:[]}},u=0;u<i.length;u++){var d=i[u].quadrant;l[d-1].indexs.push(u),l[d-1].count++}1<l[0].count&&l[0].indexs.reverse(),1<l[2].count&&l[2].indexs.reverse(),l[0].count>l[3].count&&(s.right.startQuadrant=1,s.right.endQuadrant=4,s.right.clockwise=!1),l[1].count>l[2].count&&(s.left.startQuadrant=2,s.left.endQuadrant=3,s.left.clockwise=!0),s.right.indexs=l[s.right.startQuadrant-1].indexs.concat(l[s.right.endQuadrant-1].indexs),s.left.indexs=l[s.left.startQuadrant-1].indexs.concat(l[s.left.endQuadrant-1].indexs),s.right.indexs.length>n.textMaxCount&&((e=s.right.indexs.slice(0)).sort(function(t,e){return i[e].y-i[t].y}),t=e.slice(n.textMaxCount),i[t[0]].percentage,r=i[t[0]].y),s.left.indexs.length>n.textMaxCount&&((e=s.left.indexs.slice(0)).sort(function(t,e){return i[e].y-i[t].y}),t=e.slice(n.textMaxCount),i[t[0]].percentage,a=i[t[0]].y),o.push(s.right.startQuadrant),o.push(s.right.endQuadrant),o.push(s.left.startQuadrant),o.push(s.left.endQuadrant);var f={};for(u=0;u<o.length;u++){var c=1==u||3==u;n._widgetLabel(o[u],l[o[u]-1].indexs,a,r,c,f)}}},{key:"destroyLabel",value:function(){var e=this;this.textSp&&this.textSp.removeAllChildren(),o._.each(this.textList,function(t){e.domContainer.removeChild(t.textEle)}),this.textList=[]}},{key:"_showGrowLabel",value:function(){this.textSp&&this.textSp.context&&(this.textSp.context.globalAlpha=1,o._.each(this.textList,function(t){t.textEle.style.visibility="visible"}))}},{key:"_hideGrowLabel",value:function(){this.textSp&&this.textSp.context&&(this.textSp.context.globalAlpha=0,o._.each(this.textList,function(t){t.textEle.style.visibility="hidden"}))}}])&&a(d.prototype,f),y);function y(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(n=l(this,s(y).call(this))).width=0,n.height=0,n.origin={x:0,y:0},n._graphs=t,n.domContainer=t.app.canvax.domView,n.data=e,n.sprite=null,n.textSp=null,n.sectorsSp=null,n.selectedSp=null,n.init(),n.sectors=[],n.textMaxCount=15,n.textList=[],n.completed=!1,n}t.default=p}(e,n,i)});t(w),t(e(function(t,e){!function(t,e,n,b){Object.defineProperty(t,"__esModule",{value:!0});var i=r(e);function r(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(h,r(n).default),d(h,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},groupField:{detail:"分组字段",default:null,documentation:"groupField主要是给legend用的， 所有在legend中需要显示的分组数据，都用groupField"},sort:{detail:"排序，默认不排序，可以配置为asc,desc",default:null},startAngle:{detail:"起始角度",default:-90},allAngle:{detail:"全部角度",default:360},node:{detail:"单个节点（扇形）配置",propertys:{radius:{detail:"半径",default:null,documentation:"每个扇形单元的半径，也可以配置一个字段，就成了丁格尔玫瑰图"},innerRadius:{detail:"内径",default:0},outRadius:{detail:"外径",default:null},minRadius:{detail:"最小的半径厚度",default:10,documentation:"outRadius - innerRadius ， 也就是radius的最小值"},moveDis:{detail:"hover偏移量",default:15,documentation:"要预留moveDis位置来hover sector 的时候外扩"},fillStyle:{detail:"单个图形背景色",default:null},focus:{detail:"图形的hover设置",propertys:{enabled:{detail:"是否开启",default:!0}}},select:{detail:"图形的选中效果",propertys:{enabled:{detail:"是否开启",default:!0},radius:{detail:"选中效果图形的半径厚度",default:5},alpha:{detail:"选中效果图形的透明度",default:.7}}}}},label:{detail:"label",propertys:{field:{detail:"获取label的字段",default:null},enabled:{detail:"是否开启",default:!1},format:{detail:"label的格式化函数，支持html",default:null}}}}}}]),d(h,[{key:"init",value:function(){this.data=this._dataHandle()}},{key:"_computerProps",value:function(){var t=this.width,e=this.height;if(!this.node.outRadius){var n=Math.min(t,e)/2;this.label.enabled&&(n-=this.node.moveDis),this.node.outRadius=parseInt(n)}null!==this.node.radius&&b._.isNumber(this.node.radius)&&(this.node.radius=Math.max(this.node.radius,this.node.minRadius),this.node.innerRadius=this.node.outRadius-this.node.radius),this.node.outRadius-this.node.innerRadius<this.node.minRadius&&(this.node.innerRadius=this.node.outRadius-this.node.minRadius),this.node.innerRadius<0&&(this.node.innerRadius=0)}},{key:"draw",value:function(t){t=t||{},b._.extend(!0,this,t),this._computerProps(),this._pie=new i.default(this,this._trimGraphs(this.data)),this._pie.draw(t);var e=this;this.animation&&!t.resize?this._pie.grow(function(){e.fire("complete")}):this.fire("complete"),this.sprite.addChild(this._pie.sprite)}},{key:"show",value:function(t){this._setEnabled(t,!0)}},{key:"hide",value:function(t){this._setEnabled(t,!1)}},{key:"_setEnabled",value:function(e,n){b._.each(this.data,function(t){if(t.label===e)return t.enabled=n,!1}),this._pie.resetData(this._trimGraphs(this.data))}},{key:"_dataHandle",value:function(){for(var n=this,t=[],e=n.dataFrame,i=0,r=e.length;i<r;i++){var a=e.getRowDataAt(i),o={type:"pie",rowData:a,focused:!1,focusEnabled:n.node.focus.enabled,selected:!1,selectEnabled:n.node.select.enabled,selectedR:n.node.select.radius,selectedAlpha:n.node.select.alpha,enabled:!0,fillStyle:null,color:null,value:a[n.field],label:a[n.groupField||n.label.field||n.field],labelText:null,iNode:i},l=n._getColor(n.node.fillStyle,o);o.fillStyle=o.color=l,t.push(o)}return t.length&&n.sort&&(t.sort(function(t,e){return"asc"==n.sort?t.value-e.value:e.value-t.value}),b._.each(t,function(t,e){t.iNode=e})),t}},{key:"_trimGraphs",value:function(t){var n=this,e=0;n.currentAngle=0+n.startAngle%360;var i=n.allAngle+n.startAngle%n.allAngle,r=0,a=0;if(t.length){for(var o=0;o<t.length;o++)if(t[o].enabled&&(e+=t[o].value,n.node.radius&&b._.isString(n.node.radius)&&n.node.radius in t[o].rowData)){var l=Number(t[o].rowData[n.node.radius]);r=Math.max(r,l),a=Math.min(a,l)}if(0<e)for(var s=0;s<t.length;s++){var u=t[s].value/e;t[s].enabled||(u=0);var d=+(100*u).toFixed(2),f=n.allAngle*u,c=n.currentAngle+f>i?i:n.currentAngle+f,h=Math.cos((n.currentAngle+f/2)/180*Math.PI),p=Math.sin((n.currentAngle+f/2)/180*Math.PI),y=n.currentAngle+f/2;h=h.toFixed(5),p=p.toFixed(5);var g=function(t){i<=t&&(t=i),t%=n.allAngle;var e=parseInt(t/90);if(0<=t)switch(e){case 0:return 1;case 1:return 2;case 2:return 3;case 3:case 4:return 4}else if(t<0)switch(e){case 0:return 4;case-1:return 3;case-2:return 2;case-3:case-4:return 1}}(y),_=n.node.outRadius;if(n.node.radius&&b._.isString(n.node.radius)&&n.node.radius in t[s].rowData){var v=Number(t[s].rowData[n.node.radius]);_=parseInt((n.node.outRadius-n.node.innerRadius)*((v-a)/(r-a))+n.node.innerRadius)}var x=n.node.moveDis;b._.extend(t[s],{outRadius:_,innerRadius:n.node.innerRadius,startAngle:n.currentAngle,endAngle:c,midAngle:y,moveDis:x,outOffsetx:.7*x*h,outOffsety:.7*x*p,centerx:_*h,centery:_*p,outx:(_+x)*h,outy:(_+x)*p,edgex:(_+x)*h,edgey:(_+x)*p,orginPercentage:u,percentage:d,quadrant:g,labelDirection:1==g||4==g?1:0,iNode:s}),t[s].labelText=n._getLabelText(t[s]),n.currentAngle+=f,n.currentAngle>i&&(n.currentAngle=i)}}return{list:t,total:e}}},{key:"_getColor",value:function(t,e){var n=e.iNode,i=t;return b._.isArray(t)&&(i=t[n]),b._.isFunction(t)&&(i=s.apply(this,[e])),i=i||this.app.getTheme(n)}},{key:"_getLabelText",value:function(t){var e;if(this.label.enabled)if(this.label.format)b._.isFunction(this.label.format)&&(e=this.label.format(t.label,t));else{var n=this.label.field||this.groupField;e=n?t.rowData[n]+"："+t.percentage+"%":t.percentage+"%"}return e}},{key:"getList",value:function(){return this.data}},{key:"getLegendData",value:function(){var e=[];return b._.each(this.data,function(t){e.push({name:t.label,color:t.fillStyle,enabled:t.enabled})}),e}},{key:"tipsPointerOf",value:function(){}},{key:"tipsPointerHideOf",value:function(){}},{key:"focusAt",value:function(t){var e=this._pie.data.list[t];this.node.focus.enabled&&this._pie.focusOf(e)}},{key:"unfocusAt",value:function(t){var e=this._pie.data.list[t];e.node.focus.enabled&&this._pie.unfocusOf(e)}},{key:"selectAt",value:function(t){var e=this._pie.data.list[t];this.node.select.enabled&&this._pie.selectOf(e)}},{key:"unselectAt",value:function(t){var e=this._pie.data.list[t];this.node.select.enabled&&this._pie.unselectOf(e)}}]),h);function h(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(n=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?l(t):e}(this,o(h).call(this,t,e))).type="pie",b._.extend(!0,l(n),(0,b.getDefaultProps)(h.defaultProps()),t),n.init(),n}b.global.registerComponent(c,"graphs","pie"),t.default=c}(e,w,y,i)})),t(e(function(t,e){!function(t,e,n,c){Object.defineProperty(t,"__esModule",{value:!0});var i=a(e),r=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=i.default.Shapes.Polygon,p=i.default.Shapes.Circle,y=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(g,r.default),d(g,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},line:{detail:"线配置",propertys:{enabled:{detail:"是否显示",default:!0},lineWidth:{detail:"线宽",default:2},strokeStyle:{detail:"线颜色",default:null}}},area:{detail:"面积区域配置",propertys:{enabled:{detail:"是否显示",default:!0},fillStyle:{detail:"面积背景色",default:null},fillAlpha:{detail:"面积透明度",default:.1}}},node:{detail:"线上面的单数据节点图形配置",propertys:{enabled:{detail:"是否显示",default:!0},strokeStyle:{detail:"边框色",default:"#ffffff"},radius:{detail:"半径",default:4},lineWidth:{detail:"边框大小",default:1}}}}}}]),d(g,[{key:"init",value:function(){}},{key:"draw",value:function(t){t=t||{},c._.extend(!0,this,t),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.fire("complete")}},{key:"_widget",value:function(){var u=this,d=this.app.getComponent({name:"coord"}),f=0;c._.each(this.data,function(t,e){var n={},i=[];c._.each(t,function(t,e){i.push([t.point.x,t.point.y])});var r=d.getFieldMapOf(e),a=u._getStyle(u.line.strokeStyle,f,r.color,r),o={pointList:i,cursor:"pointer"};u.line.enabled&&(o.lineWidth=u.line.lineWidth,o.strokeStyle=a),u.area.enabled&&(o.fillStyle=u._getStyle(u.area.fillStyle,f,r.color,r),o.fillAlpha=u._getStyle(u.area.fillAlpha,f,1,r));var l=new h({hoverClone:!1,context:o});if(n.area=l,u.sprite.addChild(l),l.__hoverFillAlpha=l.context.fillAlpha+.2,l.__fillAlpha=l.context.fillAlpha,l.on(c.event.types.get(),function(t){"mouseover"==t.type&&(this.context.fillAlpha=this.__hoverFillAlpha),"mouseout"==t.type&&(this.context.fillAlpha=this.__fillAlpha),u.app.fire(t.type,t)}),u.node.enabled){var s=[];c._.each(t,function(t,e){i.push([t.point.x,t.point.y]);var n=new p({context:{cursor:"pointer",x:t.point.x,y:t.point.y,r:u.node.radius,lineWidth:u.node.lineWidth,strokeStyle:u.node.strokeStyle,fillStyle:a}});u.sprite.addChild(n),n.iNode=e,n.nodeData=t,n._strokeStyle=a,n.on(c.event.types.get(),function(t){t.aAxisInd=this.iNode,t.eventInfo={trigger:u.node,nodes:[this.nodeData]},u.app.fire(t.type,t)}),s.push(n)}),n.nodes=s}u.groups[e]=n,f++})}},{key:"tipsPointerOf",value:function(t){var i=this;i.tipsPointerHideOf(t),t.eventInfo&&t.eventInfo.nodes&&c._.each(t.eventInfo.nodes,function(n){i.data[n.field]&&c._.each(i.data[n.field],function(t,e){n.iNode==e&&i.focusOf(t)})})}},{key:"tipsPointerHideOf",value:function(){var n=this;c._.each(n.data,function(t,e){c._.each(t,function(t){n.unfocusOf(t)})})}},{key:"focusOf",value:function(t){if(!t.focused){var e=this.groups[t.field].nodes[t.iNode];e.context.r+=1,e.context.fillStyle=this.node.strokeStyle,e.context.strokeStyle=e._strokeStyle,t.focused=!0}}},{key:"unfocusOf",value:function(t){if(t.focused){var e=this.groups[t.field].nodes[t.iNode];e.context.r-=1,e.context.fillStyle=e._strokeStyle,e.context.strokeStyle=this.node.strokeStyle,t.focused=!1}}},{key:"hide",value:function(t){var e=this.app.getComponent({name:"coord"});this.enabledField=e.filterEnabledFields(this.field);var n=this.groups[t];n&&(n.area.context.visible=!1,c._.each(n.nodes,function(t){t.context.visible=!1}))}},{key:"show",value:function(t){var e=this.app.getComponent({name:"coord"});this.enabledField=e.filterEnabledFields(this.field);var n=this.groups[t];n&&(n.area.context.visible=!0,c._.each(n.nodes,function(t){t.context.visible=!0}))}},{key:"_trimGraphs",value:function(){var s=this,u=this.app.getComponent({name:"coord"});this.enabledField=u.filterEnabledFields(this.field);var t={};return c._.each(this.enabledField,function(r){var a=s.dataFrame.getFieldData(r),o=u.getFieldMapOf(r),l=[];c._.each(u.aAxis.angleList,function(t,e){var n=Math.PI*t/180,i=u.getPointInRadianOfR(n,u.getROfNum(a[e]));l.push({type:"radar",field:r,iNode:e,rowData:s.dataFrame.getRowDataAt(e),focused:!1,value:a[e],point:i,color:o.color})}),t[r]=l}),t}},{key:"_getStyle",value:function(t,e,n,i){var r=n;return(c._.isString(t)||c._.isNumber(t))&&(r=t),c._.isArray(t)&&(r=t[e]),c._.isFunction(t)&&(r=t(e,i)),null==r&&(r=n),r}},{key:"getNodesAt",value:function(i){var r=this.data,a=[];return c._.each(this.enabledField,function(t,e){if(c._.isArray(t))c._.each(t,function(t,e){var n=r[t][i];n&&a.push(n)});else{var n=r[t][i];n&&a.push(n)}}),a}}]),g);function g(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,g),(n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?s(t):e}(this,l(g).call(this,t,e))).type="radar",n.enabledField=null,n.groups={},c._.extend(!0,s(n),(0,c.getDefaultProps)(g.defaultProps()),t),n.init(),n}c.global.registerComponent(y,"graphs","radar"),t.default=y}(e,n,y,i)}));var S=e(function(t,e){!function(t){Object.defineProperty(t,"__esModule",{value:!0});var a={value:function(){}};function e(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i)throw new Error("illegal type: "+t);i[t]=[]}return new r(i)}function r(t){this._=t}function l(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function s(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=a,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}r.prototype=e.prototype={constructor:r,on:function(t,e){var n,i=this._,r=function(t,i){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(0<=n&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!i.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})}(t+"",i),a=-1,o=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=r[a]).type)i[n]=s(i[n],t.name,e);else if(null==e)for(n in i)i[n]=s(i[n],t.name,null);return this}for(;++a<o;)if((n=(t=r[a]).type)&&(n=l(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new r(t)},call:function(t,e){if(0<(n=arguments.length-2))for(var n,i,r=new Array(n),a=0;a<n;++a)r[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(i=this._[t]).length;a<n;++a)i[a].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,a=i.length;r<a;++r)i[r].value.apply(e,n)}},t.default=e}(e)});t(S);var k=e(function(t,e){!function(t,e){Object.defineProperty(t,"__esModule",{value:!0});var n,i=(n=e)&&n.__esModule?n:{default:n},P=Math.PI/180,C=64,j=2048;function r(t){return t.text}function a(){return"serif"}function o(){return"normal"}function l(t){return Math.sqrt(t.value)}function s(){return 30*(~~(6*Math.random())-3)}function w(){return 1}function S(t,e,n,i){if(!e.sprite){var r=t.context,a=t.ratio;r.clearRect(0,0,(C<<5)/a,j/a);var o=0,l=0,s=0,u=n.length;for(--i;++i<u;){e=n[i],r.save(),r.font=e.style+" "+e.weight+" "+~~((e.size+1)/a)+"px "+e.font;var d=r.measureText(e.text+"m").width*a,f=e.size<<1;if(e.rotate){var c=Math.sin(e.rotate*P),h=Math.cos(e.rotate*P),p=d*h,y=d*c,g=f*h,_=f*c;d=Math.max(Math.abs(p+_),Math.abs(p-_))+31>>5<<5,f=~~Math.max(Math.abs(y+g),Math.abs(y-g))}else d=d+31>>5<<5;if(s<f&&(s=f),C<<5<=o+d&&(l+=s,s=o=0),j<=l+f)break;r.translate((o+(d>>1))/a,(l+(f>>1))/a),e.rotate&&r.rotate(e.rotate*P),r.fillText(e.text,0,0),e.padding&&(r.lineWidth=2*e.padding,r.strokeText(e.text,0,0)),r.restore(),e.width=d,e.height=f,e.xoff=o,e.yoff=l,e.x1=d>>1,e.y1=f>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,o+=d}for(var v=r.getImageData(0,0,(C<<5)/a,j/a).data,x=[];0<=--i;)if((e=n[i]).hasText){for(var b=(d=e.width)>>5,m=(f=e.y1-e.y0,0);m<f*b;m++)x[m]=0;if(null==(o=e.xoff))return;l=e.yoff;for(var w=0,S=-1,k=0;k<f;k++){for(m=0;m<d;m++){var A=b*k+(m>>5),O=v[(l+k)*(C<<5)+(o+m)<<2]?1<<31-m%32:0;x[A]|=O,w|=O}w?S=k:(e.y0++,f--,k--,l++)}e.y1=e.y0+S,e.sprite=x.slice(0,(e.y1-e.y0)*b)}}}function E(t,e,n){n>>=5;for(var i,r=t.sprite,a=t.width>>5,o=t.x-(a<<4),l=127&o,s=32-l,u=t.y1-t.y0,d=(t.y+t.y0)*n+(o>>5),f=0;f<u;f++){for(var c=i=0;c<=a;c++)if((i<<s|(c<a?(i=r[f*a+c])>>>l:0))&e[d+c])return!0;d+=n}return!1}function k(t,e){var n=t[0],i=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>i.x&&(i.x=e.x+e.x1),e.y+e.y1>i.y&&(i.y=e.y+e.y1)}function M(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function I(){return document.createElement("canvas")}function D(t){return"function"==typeof t?t:function(){return t}}var T={archimedean:M,rectangular:function(t){var n=4*t[0]/t[1],i=0,r=0;return function(t){var e=t<0?-1:1;switch(Math.sqrt(1+4*e*t)-e&3){case 0:i+=n;break;case 1:r+=4;break;case 2:i-=n;break;default:r-=4}return[i,r]}}};t.default=function(){var A=[256,256],u=r,d=a,f=l,c=o,h=o,p=s,y=w,O=M,e=[],g=1/0,_=(0,i.default)("word","end"),v=null,P=Math.random,x={},b=I;function m(t,e,n){A[0],A[1];for(var i,r,a,o,l,s=e.x,u=e.y,d=Math.sqrt(A[0]*A[0]+A[1]*A[1]),f=O(A),c=P()<.5?1:-1,h=-c;(i=f(h+=c))&&(r=~~i[0],a=~~i[1],!(Math.min(Math.abs(r),Math.abs(a))>=d));)if(e.x=s+r,e.y=u+a,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>A[0]||e.y+e.y1>A[1]||n&&E(e,t,A[0])||n&&(l=n,!((o=e).x+o.x1>l[0].x&&o.x+o.x0<l[1].x&&o.y+o.y1>l[0].y&&o.y+o.y0<l[1].y)))){for(var p,y=e.sprite,g=e.width>>5,_=A[0]>>5,v=e.x-(g<<4),x=127&v,b=32-x,m=e.y1-e.y0,w=(e.y+e.y0)*_+(v>>5),S=0;S<m;S++){for(var k=p=0;k<=g;k++)t[w+k]|=p<<b|(k<g?(p=y[S*g+k])>>>x:0);w+=_}return delete e.sprite,!0}return!1}return x.canvas=function(t){return arguments.length?(b=D(t),x):b},x.start=function(){var n=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(C<<5)/e,t.height=j/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(b()),i=function(t){var e=[],n=-1;for(;++n<t;)e[n]=0;return e}((A[0]>>5)*A[1]),r=null,a=e.length,o=-1,l=[],s=e.map(function(t,e){return t.text=u.call(this,t,e),t.font=d.call(this,t,e),t.style=c.call(this,t,e),t.weight=h.call(this,t,e),t.rotate=p.call(this,t,e),t.size=~~f.call(this,t,e),t.padding=y.call(this,t,e),t}).sort(function(t,e){return e.size-t.size});return v&&clearInterval(v),v=setInterval(t,0),t(),x;function t(){for(var t=Date.now();Date.now()-t<g&&++o<a&&v;){var e=s[o];e.x=A[0]*(P()+.5)>>1,e.y=A[1]*(P()+.5)>>1,S(n,e,s,o),e.hasText&&m(i,e,r)&&(l.push(e),_.call("word",x,e),r?k(r,e):r=[{x:e.x+e.x0,y:e.y+e.y0},{x:e.x+e.x1,y:e.y+e.y1}],e.x-=A[0]>>1,e.y-=A[1]>>1)}a<=o&&(x.stop(),_.call("end",x,l,r))}},x.stop=function(){return v&&(clearInterval(v),v=null),x},x.timeInterval=function(t){return arguments.length?(g=null==t?1/0:t,x):g},x.words=function(t){return arguments.length?(e=t,x):e},x.size=function(t){return arguments.length?(A=[+t[0],+t[1]],x):A},x.font=function(t){return arguments.length?(d=D(t),x):d},x.fontStyle=function(t){return arguments.length?(c=D(t),x):c},x.fontWeight=function(t){return arguments.length?(h=D(t),x):h},x.rotate=function(t){return arguments.length?(p=D(t),x):p},x.text=function(t){return arguments.length?(u=D(t),x):u},x.spiral=function(t){return arguments.length?(O=T[t]||t,x):O},x.fontSize=function(t){return arguments.length?(f=D(t),x):f},x.padding=function(t){return arguments.length?(y=D(t),x):y},x.random=function(t){return arguments.length?(P=t,x):P},x.on=function(){var t=_.on.apply(_,arguments);return t===_?x:t},x}}(e,S)});t(k),t(e(function(t,e){!function(t,e,n,i,r){Object.defineProperty(t,"__esModule",{value:!0});var a=s(e),o=s(n),l=s(i);function s(t){return t&&t.__esModule?t:{default:t}}function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=a.default.Display.Text,g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(_,o.default),h(_,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},node:{detail:"节点文字配置",propertys:{fontFamily:{detail:"字体设置",default:"Impact"},fontColor:{detail:"文字颜色",default:"#999"},fontSize:{detail:"文本字体大小",default:function(){return this.minFontSize+Math.random()*this.maxFontSize}},maxFontSize:{detail:"文本最大字体大小",default:30},minFontSize:{detail:"文本最小字体大小",default:16},fontWeight:{detail:"fontWeight",default:"normal"},format:{detail:"文本格式化处理函数",default:null},padding:{detail:"文本间距",default:10},rotation:{detail:"文本旋转角度",default:function(){return 30*(~~(6*Math.random())-3)}},strokeStyle:{detail:"文本描边颜色",default:null},select:{detail:"文本选中效果",propertys:{enabled:{detail:"是否开启选中",default:!0},lineWidth:{detail:"选中后的文本描边宽",default:2},strokeStyle:{detail:"选中后的文本描边色",default:"#666"}}},focus:{detail:"文本hover效果",propertys:{enabled:{detail:"是否开启hover效果",default:!0}}}}}}}}]),h(_,[{key:"init",value:function(){}},{key:"draw",value:function(t){t=t||{},r._.extend(!0,this,t),this._drawGraphs(),this.sprite.context.x=this.width/2,this.sprite.context.y=this.height/2,this.fire("complete")}},{key:"getDaraFrameIndOfVal",value:function(t){var e=this,n=this.dataFrame,i=r._.find(n.data,function(t){return t.field==e.field});return r._.indexOf(i.data,t)}},{key:"_getFontSize",value:function(t,e){var n=this.node.minFontSize;return r._.isFunction(this.node.fontSize)&&(n=this.node.fontSize(t)),r._.isString(this.node.fontSize)&&this.node.fontSize in t&&(e=Number(t[this.node.fontSize]),isNaN(e)||(n=this.node.minFontSize+(this.node.maxFontSize-this.node.minFontSize)/(this.node._maxFontSizeVal-this.node._minFontSizeVal)*(e-this.node._minFontSizeVal))),r._.isNumber(this.node.fontSize)&&(n=this.node.fontSize),n}},{key:"_getRotate",value:function(t,e){var n=this.node.rotation;return r._.isFunction(this.node.rotation)&&(n=this.node.rotation(t,e)||0),n}},{key:"_getFontColor",value:function(t){var e;return r._.isString(this.node.fontColor)&&(e=this.node.fontColor),r._.isFunction(this.node.fontColor)&&(e=this.node.fontColor(t)),null==e&&(e="#ccc"),e}},{key:"_drawGraphs",value:function(){var a=this;r._.isString(this.node.fontSize)&&r._.each(a.dataFrame.getFieldData(this.node.fontSize),function(t){a.node._maxFontSizeVal=Math.max(a.node._maxFontSizeVal,t),a.node._minFontSizeVal=Math.min(a.node._minFontSizeVal,t)}),(0,l.default)().size([a.width,a.height]).words(a.dataFrame.getFieldData(a.field).map(function(t,e){var n=a.app.dataFrame.getRowDataAt(a.getDaraFrameIndOfVal(t)),i={type:"cloud",rowData:n,field:a.field,value:t,text:null,size:a._getFontSize(n,t),iNode:e,color:null};i.fontColor=a._getFontColor(i);var r=t;return a.node.format&&(r=a.node.format(t,i)),i.text=r||t,i})).padding(a.node.padding).rotate(function(t,e){return a._getRotate(t,e)}).font(a.node.fontFamily).fontSize(function(t){return t.size}).on("end",function(i,t){a.data=i,a.sprite.removeAllChildren(),r._.each(i,function(t,e){t.iNode=e,t.dataLen=i.length,t.focused=!1,t.selected=!1;var n=new y(t.text,{context:{x:t.x,y:t.y,fontSize:t.size,fontFamily:t.font,rotation:t.rotate,textBaseline:"middle",textAlign:"center",cursor:"pointer",fontWeight:a.node.fontWeight,fillStyle:t.fontColor}});a.sprite.addChild(n),a.node.focus.enabled&&n.hover(function(t){a.focusAt(this.nodeData.iNode)},function(t){this.nodeData.selected||a.unfocusAt(this.nodeData.iNode)}),((n.nodeData=t)._node=n).on(r.event.types.get(),function(t){t.eventInfo={trigger:a.node,title:null,nodes:[this.nodeData]},this.nodeData.text&&(t.eventInfo.title=this.nodeData.text),a.app.fire(t.type,t)})})}).start()}},{key:"focusAt",value:function(t){var e=this.data[t];this.node.focus.enabled&&!e.focused&&(e._node.context.fontSize+=3,e.focused=!0)}},{key:"unfocusAt",value:function(t){var e=this.data[t];this.node.focus.enabled&&e.focused&&(e._node.context.fontSize-=3,e.focused=!1)}},{key:"selectAt",value:function(t){var e=this.data[t];if(this.node.select.enabled&&!e.selected){var n=e._node.context;n.lineWidth=this.node.select.lineWidth,n.strokeAlpha=this.node.select.strokeAlpha,n.strokeStyle=this.node.select.strokeStyle,e.selected=!0}}},{key:"unselectAt",value:function(t){var e=this.data[t];this.node.select.enabled&&e.selected&&(e._node.context.strokeStyle=this.node.strokeStyle,e.selected=!1)}}]),_);function _(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,_),(n=function(t,e){return!e||"object"!==u(e)&&"function"!=typeof e?f(t):e}(this,d(_).call(this,t,e))).type="cloud";var i=f(n);return n.node={_maxFontSizeVal:0,_minFontSizeVal:null},r._.extend(!0,f(n),(0,r.getDefaultProps)(_.defaultProps()),t),n.node.fontColor=function(t){return i.app.getTheme(t.iNode)},n.init(),n}r.global.registerComponent(g,"graphs","cloud"),t.default=g}(e,n,y,k,i)}));var A=e(function(t,e){!function(t,e,C){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,j=(n=e)&&n.__esModule?n:{default:n};function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}var E=j.default.Shapes.Circle,a=(r(o,null,[{key:"defaultProps",value:function(){return{sort:{detail:"排序",default:"desc"},sortField:{detail:"用来排序的字段",default:"null"},node:{detail:"单个数据节点图形配置",propertys:{maxRadius:{detail:"最大半径",default:30},minRadius:{detail:"最小半径",default:5},radius:{detail:"半径",default:15,documentation:'也可以是个function,也可以配置{field:"pv"}来设置字段， 自动计算r'},lineWidth:{detail:"描边线宽",default:1},strokeStyle:{detail:"描边颜色",default:"#ffffff"},fillStyle:{detail:"图形填充色",default:"#f2fbfb"},strokeAlpha:{detail:"边框透明度",default:.6},focus:{detail:"hover态设置",propertys:{enabled:{detail:"是否开启",default:!0},strokeAlpha:{detail:"hover时候边框透明度",default:.7},lineWidth:{detail:"hover时候边框大小",default:2},strokeStyle:{detail:"hover时候边框颜色",default:"#fff"}}},select:{detail:"选中态设置",propertys:{enabled:{detail:"是否开启",default:!1},strokeAlpha:{detail:"选中时候边框透明度",default:1},lineWidth:{detail:"选中时候边框大小",default:2},strokeStyle:{detail:"选中时候边框颜色",default:"#fff"},triggerEventType:{detail:"触发事件",default:"click"}}}}},label:{detail:"文本设置",propertys:{enabled:{detail:"是否开启",default:!0},fontColor:{detail:"文本颜色",default:"#666666"},fontSize:{detail:"文本字体大小",default:13},textAlign:{detail:"水平对齐方式",default:"center"},verticalAlign:{detail:"基线对齐方式",default:"middle"},position:{detail:"文本布局位置",default:"center"},offsetX:{detail:"x方向偏移量",default:0},offsetY:{detail:"y方向偏移量",default:0}}}}}}]),r(o,[{key:"init",value:function(){var t=this.app.getComponent({name:"coord"});this.sprite=new j.default.Display.Sprite({id:"group_"+this.iGroup,context:{x:t.origin.x,y:t.origin.y}}),this._trimGraphs(),this.draw()}},{key:"_trimGraphs",value:function(){var i=this,t=this.app.getComponent({name:"coord"}).getMaxDisToViewOfOrigin();(t-this.rRange.to)/(2*this.pit.radius)<this.groupLen-1-this.iGroup&&(this.rRange.to=t-(this.groupLen-1-this.iGroup)*this.pit.radius*2),this.rRange.to-this.rRange.start<2*this.pit.radius&&(this.rRange.to=this.rRange.start+2*this.pit.radius),this.maxRingNum||(this.maxRingNum=parseInt((this.rRange.to-this.rRange.start)/(2*this.pit.radius),10),this.ringNum=this.maxRingNum),this.rRange.to=this.rRange.start+this.ringNum*this.pit.radius*2;for(var e=[],n=this.dataFrame.length,r=0;r<n;r++){var a=this.dataFrame.getRowDataAt(r),o={type:"planet",groupLen:this.groupLen,iGroup:i.iGroup,iNode:r,nodeElement:null,labelElement:null,rowData:a,iRing:null,iPlanet:null,fillStyle:null,color:null,strokeStyle:null,pit:null,ringInd:-1,field:i.field,label:a[i.field],focused:!1,selected:!!~C._.indexOf(this.selectInds,a.__index__)};e.push(o)}i.sortField&&(e=e.sort(function(t,e){var n=i.sortField;return"desc"==i.sort?e.rowData[n]-t.rowData[n]:t.rowData[n]-e.rowData[n]}),C._.each(e,function(t,e){t.iNode=e})),this._rings=this["_setRings_"+this.layoutType+"Range"](e),this.planets=e}},{key:"_setRings_radianRange",value:function(n){for(var s=this,i=[],t=this.app.getComponent({name:"coord"}),e=0,r=this.ringNum;e<r;e++){var a=e*this.pit.radius*2+this.pit.radius+this.rRange.start;s._graphs.center.enabled||(a=e*this.pit.radius*2+this.rRange.start);var o=t.getRadiansAtR(a,s.width,s.height);Math.atan(this.pit.radius/a),i.push({arcs:o,pits:[],planets:[],radius:a,max:0})}var u=0;C._.each(i,function(a,t){var o=2*Math.asin(s.pit.radius/a.radius);0==a.radius&&(o=2*Math.PI);var l=0;C._.each(a.arcs,function(t){var e=s._getDiffRadian(t[0].radian,t[1].radian);if(o<=e){var n=parseInt(e/o,10);l+=n;for(var i=0;i<n;i++){var r={hasRadish:!1,start:(t[0].radian+o*i+2*Math.PI)%(2*Math.PI)};r.middle=(r.start+o/2+2*Math.PI)%(2*Math.PI),r.to=(r.start+o+2*Math.PI)%(2*Math.PI),a.pits.push(r)}}}),a.max=l,u+=l,a.pits=C._.shuffle(a.pits)});var l=0;return C._.each(i,function(r,t){if(l>=n.length)return!1;var e=Math.ceil(r.max/u*n.length);e=Math.min(r.max,e),r.planets=n.slice(l,l+e),t==i.length-1&&(r.planets=n.slice(l)),l+=e,C._.each(r.planets,function(t,e){if(!(e>=r.pits.length)){var n=C._.filter(r.pits,function(t){return!t.hasRadish}),i=n[parseInt(Math.random()*n.length)];i.hasRadish=!0,t.pit=i}})}),i}},{key:"_getDiffRadian",value:function(t,e){var n=e-t;return e<t&&(n=(e+2*Math.PI-t)%(2*Math.PI)),n}},{key:"_setRings_indexRange",value:function(){}},{key:"_setRings_valRange",value:function(){}},{key:"draw",value:function(){var O=this,P=this.app.getComponent({name:"coord"});C._.each(this._rings,function(w,S){var k={rotation:0};1==w.arcs.length&&0==w.arcs[0][0].radian&&w.arcs[0][1].radian==2*Math.PI&&(k.rotation=parseInt(360*Math.random()));var A=new j.default.Display.Sprite({context:k});C._.each(w.planets,function(t,e){if(t.pit){var n=P.getPointInRadianOfR(t.pit.middle,w.radius),i=O._getRProp(O.node.radius,S,e,t),r=O.node.maxRadius-i,a=parseInt(Math.random()*r),o=parseInt(360*Math.random())*Math.PI/180;0!=a&&(n.x+=Math.sin(o)*a,n.y+=Math.cos(o)*a);var l=O.node;t.selected&&(l=O.node.select);var s=O._getProp(O.node.fillStyle,t),u=O._getProp(l.strokeStyle,t),d=O._getProp(l.strokeAlpha,t),f=O._getProp(l.lineWidth,t),c={x:n.x,y:n.y,r:i,fillStyle:s,lineWidth:f,strokeStyle:u,strokeAlpha:d,cursor:"pointer"};t.color=t.fillStyle=s,t.strokeStyle=u,t.iRing=S,t.iPlanet=e;var h=new E({hoverClone:!1,context:c});if(h.on(C.event.types.get(),function(t){t.eventInfo={title:null,trigger:O.node,nodes:[this.nodeData]},this.nodeData.label&&(t.eventInfo.title=this.nodeData.label),O.node.focus.enabled&&("mouseover"==t.type&&O.focusAt(this.nodeData),"mouseout"==t.type&&O.unfocusAt(this.nodeData)),O.node.select.enabled&&t.type==O.node.select.triggerEventType&&(this.nodeData.selected?O.unselectAt(this.nodeData):O.selectAt(this.nodeData)),O.app.fire(t.type,t)}),((h.nodeData=t).nodeElement=h).ringInd=S,h.planetIndInRing=e,A.addChild(h),O._graphs.animation){var p=h.context.r,y=h.context.globalAlpha;h.context.r=1,h.context.globalAlpha=.1,h.animate({r:p,globalAlpha:y},{delay:Math.round(1500*Math.random()),onComplete:function(){h.labelElement&&(h.labelElement.context.visible=!0);var t=h.clone();A.addChildAt(t,0),t.animate({r:p+10,globalAlpha:0},{onComplete:function(){t.destroy()}})}})}var g={x:n.x,y:n.y,fontSize:O.label.fontSize,textAlign:O.label.textAlign,textBaseline:O.label.verticalAlign,fillStyle:O.label.fontColor,rotation:-k.rotation,rotateOrigin:{x:0,y:0}},_=new j.default.Display.Text(t.label,{context:g}),v=_.getTextWidth(),x=_.getTextHeight();if(2*i<v&&(g.fontSize=O.label.fontSize-3),C._.isFunction(O.label.position)){var b=O.label.position({node:h,circleR:i,circleCenter:{x:n.x,y:n.y},textWidth:v,textHeight:x});g.rotation=-k.rotation,g.rotateOrigin={x:-(b.x-g.x),y:-(b.y-g.y)},g.x=b.x,g.y=b.y}"auto"==O.label.position&&2*i<v&&m(),"bottom"==O.label.position&&m(),g.x+=O.label.offsetX,g.y+=O.label.offsetY,_=new j.default.Display.Text(t.label,{context:g}),((h.labelElement=_).nodeData=t).labelElement=_,O._graphs.animation&&(_.context.visible=!1),A.addChild(_)}function m(){g.y=n.y+i+3,g.rotation=-k.rotation,g.rotateOrigin={x:0,y:-(i+.7*x)}}}),O.sprite.addChild(A)})}},{key:"_getRProp",value:function(e,t,n,i){var r=this;if(C._.isString(e)&&-1<C._.indexOf(r.dataFrame.fields,e)){null==this.__rValMax&&null==this.__rValMax&&(this.__rValMax=0,this.__rValMin=0,C._.each(r.planets,function(t){r.__rValMax=Math.max(r.__rValMax,t.rowData[e]),r.__rValMin=Math.min(r.__rValMin,t.rowData[e])}));var a=i.rowData[e];return r.node.minRadius+(a-this.__rValMin)/(this.__rValMax-this.__rValMin)*(r.node.maxRadius-r.node.minRadius)}return r._getProp(e,i)}},{key:"_getProp",value:function(t,e){var n=this.iGroup;return C._.isFunction(t)?t.apply(this,[e,n]):t}},{key:"getPlanetAt",value:function(e){var n=e;return C._.isNumber(e)&&C._.each(this.planets,function(t){if(t.rowData.__index__==e)return n=t,!1}),n}},{key:"selectAt",value:function(t){if(this.node.select.enabled){var e=this.getPlanetAt(t);e.selected=!0,e.nodeElement&&(e.nodeElement.context.lineWidth=this._getProp(this.node.select.lineWidth,e),e.nodeElement.context.strokeStyle=this._getProp(this.node.select.strokeStyle,e),e.nodeElement.context.strokeAlpha=this._getProp(this.node.select.strokeAlpha,e));for(var n=0;n<this.selectInds.length;n++)if(t===this.selectInds[n]){this.selectInds.splice(n--,1);break}}}},{key:"unselectAt",value:function(t){if(this.node.select.enabled){var e=this.getPlanetAt(t);e.selected=!1,e.nodeElement&&(e.nodeElement.context.lineWidth=this._getProp(this.node.lineWidth,e),e.nodeElement.context.strokeAlpha=this._getProp(this.node.strokeAlpha,e)),this.selectInds.push(t)}}},{key:"getSelectedNodes",value:function(){return C._.filter(this.planets,function(t){return t.selected})}},{key:"focusAt",value:function(t){if(this.node.focus.enabled){var e=this.getPlanetAt(t);e.selected||(e.focused=!0,e.nodeElement&&(e.nodeElement.context.lineWidth=this._getProp(this.node.focus.lineWidth,e),e.nodeElement.context.strokeStyle=this._getProp(this.node.focus.strokeStyle,e),e.nodeElement.context.strokeAlpha=this._getProp(this.node.focus.strokeAlpha,e)))}}},{key:"unfocusAt",value:function(t){if(this.node.focus.enabled){var e=this.getPlanetAt(t);e.selected||(e.focused=!1,e.nodeElement&&(e.nodeElement.context.lineWidth=this._getProp(this.node.lineWidth,e),e.nodeElement.context.strokeAlpha=this._getProp(this.node.strokeAlpha,e)))}}}]),o);function o(t,e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),this._opt=t,this.dataFrame=e,this._graphs=n,this.app=n.app,this.field=null,this.iGroup=0,this.groupLen=1,this.rRange={start:0,to:0},this.width=0,this.height=0,this.selectInds=[],this.layoutType="radian",this.pit={radius:30},this.planets=[],this.maxRingNum=0,this.ringNum=0,C._.extend(!0,this,(0,C.getDefaultProps)(o.defaultProps()),t),this.node.maxRadius>this.pit.radius&&(this.pit.radius=this.node.maxRadius),this.init()}t.default=a}(e,n,i)});t(A),t(e(function(t,e){!function(t,e,n,i,s){Object.defineProperty(t,"__esModule",{value:!0});var u=a(e),r=a(n),d=a(i);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=u.default.Display.Text,g=u.default.Shapes.Circle,_=u.default.Shapes.Line,v=u.default.Shapes.Rect,x=u.default.Shapes.Sector,b=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(m,r.default),h(m,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段设置",default:null},center:{detail:"中心点设置",propertys:{enabled:{detail:"是否显示中心",default:!0},text:{detail:"中心区域文本",default:"center"},radius:{detail:"中心圆半径",default:30},fillStyle:{detail:"中心背景色",default:"#70629e"},fontSize:{detail:"中心字体大小",default:15},fontColor:{detail:"中心字体颜色",default:"#ffffff"},margin:{detail:"中区区域和外围可绘图区域距离",default:20},cursor:{detail:"中心节点的鼠标手势",default:"default"}}},selectInds:{detail:"选中的数据索引",default:[]},grid:{detail:"星系图自己的grid",propertys:{rings:{detail:"环配置",propertys:{fillStyle:{detail:"背景色",default:null},strokeStyle:{detail:"环线色",default:null},lineWidth:{detail:"环线宽",default:1},count:{detail:"分几环",default:3}}},rays:{detail:"射线配置",propertys:{count:{detail:"射线数量",default:0},globalAlpha:{detail:"线透明度",default:.4},strokeStyle:{detail:"线色",default:"#10519D"},lineWidth:{detail:"线宽",default:1}}}}},bewrite:{detail:"planet的趋势描述",propertys:{enabled:{detail:"是否开启趋势描述",default:!1},text:{detail:"描述文本",default:null},fontColor:{detail:"fontColor",default:"#999"},fontSize:{detail:"fontSize",default:12}}},scan:{detail:"扫描效果",propertys:{enabled:{detail:"是否开启扫描效果",default:!1},fillStyle:{detail:"扫描效果颜色",default:null},alpha:{detail:"起始透明度",default:.6},angle:{detail:"扫描效果的覆盖角度",default:90},r:{detail:"扫描效果覆盖的半径",default:null},repeat:{detail:"扫描次数",default:3}}},_props:[d.default]}}}]),h(m,[{key:"init",value:function(){this.gridSp=new u.default.Display.Sprite({id:"gridSp"}),this.groupSp=new u.default.Display.Sprite({id:"groupSp"}),this.scanSp=new u.default.Display.Sprite({id:"scanSp"}),this.centerSp=new u.default.Display.Sprite({id:"centerSp"}),this.sprite.addChild(this.gridSp),this.sprite.addChild(this.groupSp),this.sprite.addChild(this.scanSp),this.sprite.addChild(this.centerSp)}},{key:"draw",value:function(t){t=t||{},s._.extend(!0,this,t),this._dataGroupHandle(),this._drawGroups(),this._drawBack(),this._drawBewrite(),this._drawCenter(),this._drawScan(),this.fire("complete")}},{key:"_getMaxR",value:function(){var t;try{t=this.graphs.group.circle.maxRadius}catch(t){}return null==t&&(t=30),t}},{key:"_drawGroups",value:function(){var r=this,a=this.center.radius+this.center.margin,o=r.app.getComponent({name:"coord"}).getMaxDisToViewOfOrigin()-r.center.radius-r.center.margin,l=this._getMaxR();s._.each(this.groupDataFrames,function(t,e){var n=a+o*(t.length/r.dataFrame.length),i=new d.default(s._.extend(!0,{iGroup:e,groupLen:r.groupDataFrames.length,rRange:{start:a,to:n},width:r.width-2*l,height:r.height-2*l,selectInds:r.selectInds},r._opt),t,r);a=i.rRange.to,r._ringGroups.push(i),r.grid.rings._section.push({radius:i.rRange.to})}),s._.each(r._ringGroups,function(t){r.sprite.addChild(t.sprite)})}},{key:"_drawCenter",value:function(){var e=this;this.center.enabled&&(this._center=new g({hoverClone:!1,context:{x:this.origin.x,y:this.origin.y,fillStyle:this.center.fillStyle,r:this.center.radius,cursor:this.center.cursor}}),this._centerTxt=new y(this.center.text,{context:{x:this.origin.x,y:this.origin.y,fontSize:this.center.fontSize,textAlign:"center",textBaseline:"middle",fillStyle:this.center.fontColor}}),this._center.on(s.event.types.get(),function(t){t.eventInfo={title:e.center.text,trigger:e.center,nodes:[e.center]},e.center.onclick&&("mousedown"==t.type&&(e._center.context.r+=2),"mouseup"==t.type&&(e._center.context.r-=2)),e.app.fire(t.type,t)}),this.centerSp.addChild(this._center),this.centerSp.addChild(this._centerTxt))}},{key:"_drawBack",value:function(){var t=this,e=this.app.getComponent({name:"coord"});if(1==t.grid.rings._section.length){var n=(t.grid.rings._section[0].radius-t.center.radius)/t.grid.rings.count;t.grid.rings._section=[];for(var i=0;i<t.grid.rings.count;i++)t.grid.rings._section.push({radius:t.center.radius+n*(i+1)})}else t.grid.rings.count=t.grid.rings._section.length;for(i=t.grid.rings._section.length-1;0<=i;i--){var r=t.grid.rings._section[i];t.gridSp.addChild(new g({context:{x:e.origin.x,y:e.origin.y,r:r.radius,lineWidth:t._getBackProp(t.grid.rings.lineWidth,i),strokeStyle:t._getBackProp(t.grid.rings.strokeStyle,i),fillStyle:t._getBackProp(t.grid.rings.fillStyle,i)}}))}if(1<t.grid.rays.count){var a=e.origin.x,o=e.origin.y,l=360/t.grid.rays.count,s=e.getMaxDisToViewOfOrigin();t.grid.rings._section.length&&(s=t.grid.rings._section.slice(-1)[0].radius),i=0;for(var u=t.grid.rays.count;i<u;i++){var d=l*i/180*Math.PI,f=a+s*Math.cos(d),c=o+s*Math.sin(d);t.gridSp.addChild(new _({context:{start:{x:a,y:o},end:{x:f,y:c},lineWidth:t._getBackProp(t.grid.rays.lineWidth,i),strokeStyle:t._getBackProp(t.grid.rays.strokeStyle,i),globalAlpha:t.grid.rays.globalAlpha}}))}}var h=new v({name:"clipRect",context:{x:e.origin.x-t.app.width/2,y:e.origin.y-t.height/2,width:t.app.width,height:t.height}});t.gridSp.clipTo(h),t.sprite.addChild(h)}},{key:"_getBackProp",value:function(t,e){var n=null;return s._.isFunction(t)&&(n=t.apply(this,[{scaleInd:e,count:this.grid.rings._section.length,groups:this._ringGroups,graphs:this}])),(s._.isString(t)||s._.isNumber(t))&&(n=t),s._.isArray(t)&&(n=t[e]),n}},{key:"_drawBewrite",value:function(){var r=this;if(r.bewrite.enabled){var t,a,e,n,i=function(t,e,n,i){n.context.x=t*r.center.radius+20*t,o.addChild(n),o.addChild(new _({context:{lineType:"dashed",start:{x:n.context.x,y:0},end:{x:t*(e?l/2-a/2:l),y:0},lineWidth:1,strokeStyle:"#ccc"}})),e&&(e.context.x=t*(l/2),o.addChild(e),o.addChild(new _({context:{lineType:"dashed",start:{x:t*(l/2+a/2),y:0},end:{x:t*l,y:0},lineWidth:1,strokeStyle:"#ccc"}}))),i.context.x=t*l,o.addChild(i)};r.bewrite.text&&(t=new u.default.Display.Text(r.bewrite.text,{context:{fillStyle:r.bewrite.fontColor,fontSize:r.bewrite.fontSize,textBaseline:"middle",textAlign:"center"}}),a=t.getTextWidth()),e=new u.default.Display.Text("强",{context:{fillStyle:r.bewrite.fontColor,fontSize:r.bewrite.fontSize,textBaseline:"middle",textAlign:"center"}}),n=new u.default.Display.Text("弱",{context:{fillStyle:r.bewrite.fontColor,fontSize:r.bewrite.fontSize,textBaseline:"middle",textAlign:"center"}});var o=new u.default.Display.Sprite({context:{x:this.origin.x,y:this.origin.y}});r.sprite.addChild(o);var l=r.width/2;i(1,t.clone(),e.clone(),n.clone()),i(-1,t.clone(),e.clone(),n.clone())}}},{key:"scan",value:function(){var e=this;this._scanAnim&&this._scanAnim.stop();var t=e._getScanSp();360==e.__scanIngCurOration&&(t.context.rotation=0),e._scanAnim=t.animate({rotation:360,globalAlpha:1},{duration:(360-e.__scanIngCurOration)/360*1e3,onUpdate:function(t){e.__scanIngCurOration=t.rotation},onComplete:function(){t.context.rotation=0,e._scanAnim=t.animate({rotation:360},{duration:1e3,repeat:1e3,onUpdate:function(t){e.__scanIngCurOration=t.rotation}})}})}},{key:"_drawScan",value:function(t){var e=this;if(e.scan.enabled){var n=e._getScanSp();360==e.__scanIngCurOration&&(n.context.rotation=0),e._scanAnim&&e._scanAnim.stop(),e._scanAnim=n.animate({rotation:360,globalAlpha:1},{duration:(360-e.__scanIngCurOration)/360*1e3,onUpdate:function(t){e.__scanIngCurOration=t.rotation},onComplete:function(){n.context.rotation=0,e._scanAnim=n.animate({rotation:360},{duration:1e3,repeat:e.scan.repeat-2,onUpdate:function(t){e.__scanIngCurOration=t.rotation},onComplete:function(){n.context.rotation=0,e._scanAnim=n.animate({rotation:360,globalAlpha:0},{duration:1e3,onUpdate:function(t){e.__scanIngCurOration=t.rotation},onComplete:function(){n.destroy(),e.__scanSp=null,delete e.__scanSp,e.__scanIngCurOration=0,t&&t()}})}})}})}}},{key:"_getScanSp",value:function(){var t=this,e=t.__scanSp;if(!e){e=new u.default.Display.Sprite({context:{x:this.origin.x,y:this.origin.y,globalAlpha:0,rotation:t.__scanIngCurOration}}),t.scanSp.addChild(e),t.__scanSp=e;for(var n=t.scan.r||t.height/2-10,i=t.scan.fillStyle||t.center.fillStyle,r=t.scan.angle,a=0,o=r;a<o;a++){var l=new x({context:{r:n,fillStyle:i,clockwise:!0,startAngle:360-a,endAngle:359-a,globalAlpha:t.scan.alpha-t.scan.alpha/r*a}});e.addChild(l)}var s=new _({context:{end:{x:n,y:0},lineWidth:1,strokeStyle:i}});e.addChild(s)}return e}},{key:"_dataGroupHandle",value:function(){var n=s._.indexOf(this.dataFrame.fields,this.groupField);if(0<=n){var i=this.dataFrame.org[0],r={};for(var t in s._.each(this.dataFrame.org,function(t,e){e&&(r[t[n]]||(r[t[n]]=[s._.clone(i)]),r[t[n]].push(t))}),r)this.groupDataFrames.push((0,s.dataFrame)(r[t]))}else this.groupDataFrames.push(this.dataFrame)}},{key:"show",value:function(t,e){this.getAgreeNodeData(e,function(t){t.nodeElement&&(t.nodeElement.context.visible=!0),t.labelElement&&(t.labelElement.context.visible=!0)})}},{key:"hide",value:function(t,e){this.getAgreeNodeData(e,function(t){t.nodeElement&&(t.nodeElement.context.visible=!1),t.labelElement&&(t.labelElement.context.visible=!1)})}},{key:"getAgreeNodeData",value:function(i,r){s._.each(this._ringGroups,function(t){s._.each(t._rings,function(t,e){s._.each(t.planets,function(t,e){var n=t.rowData;i.params.name==n[i.params.field]&&r&&r(t)})})})}},{key:"getLayoutNodes",value:function(){var e=[];return s._.each(this._ringGroups,function(t){s._.each(t.planets,function(t){t.pit&&e.push(t)})}),e}},{key:"getInvalidNodes",value:function(){var e=[];return s._.each(this._ringGroups,function(t){s._.each(t.planets,function(t){t.pit||e.push(t)})}),e}},{key:"selectAt",value:function(e){s._.each(this._ringGroups,function(t){t.selectAt(e)})}},{key:"selectAll",value:function(){var e=this;s._.each(e.dataFrame.getFieldData("__index__"),function(t){e.selectAt(t)})}},{key:"unselectAt",value:function(e){s._.each(this._ringGroups,function(t){t.unselectAt(e)})}},{key:"unselectAll",value:function(){var e=this;s._.each(e.dataFrame.getFieldData("__index__"),function(t){e.unselectAt(t)})}},{key:"getSelectedNodes",value:function(){var e=[];return s._.each(this._ringGroups,function(t){e=e.concat(t.getSelectedNodes())}),e}},{key:"getSelectedRowList",value:function(){var n=[];return s._.each(this._ringGroups,function(t){var e=[];s._.each(t.getSelectedNodes(),function(t){e.push(t.rowData)}),n=n.concat(e)}),n}},{key:"getNodesAt",value:function(){}},{key:"resetData",value:function(t){this.clean(),this.dataFrame=t,this._dataGroupHandle(),this._drawGroups(),this._drawScan()}},{key:"clean",value:function(){this.groupDataFrames=[],s._.each(this._ringGroups,function(t){t.sprite.destroy()}),this._ringGroups=[]}}]),m);function m(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,m),(n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?f(t):e}(this,l(m).call(this,t,e))).type="planet",n.groupDataFrames=[],n.groupField=null,n._ringGroups=[],n.grid={rings:{_section:[]}},s._.extend(!0,f(n),(0,s.getDefaultProps)(m.defaultProps()),t),0!=n.center.radius&&n.center.enabled||(n.center.radius=0,n.center.margin=0,n.center.enabled=!1),n.__scanIngCurOration=0,n.init(),n}s.global.registerComponent(b,"graphs","planet"),t.default=b}(e,n,y,A,i)})),t(e(function(t,e){!function(t,e,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var r=l(e),a=l(n);function l(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=r.default.Display.Text,y=r.default.Shapes.Polygon,g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(_,a.default),c(_,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},sort:{detail:"排序规则",default:null},maxNodeWidth:{detail:"最大的元素宽",default:null},minNodeWidth:{detail:"最小的元素宽",default:0},minVal:{detail:"漏斗的塔尖",default:0},node:{detail:"单个元素图形配置",propertys:{height:{detail:"高",default:0,documentation:"漏斗单元高，如果options没有设定， 就会被自动计算为 this.height/dataOrg.length"}}},label:{detail:"文本配置",propertys:{enabled:{detail:"是否开启文本",default:!0},textAlign:{detail:"文本布局位置(left,center,right)",default:"center"},textBaseline:{detail:"文本基线对齐方式",default:"middle"},format:{detail:"文本格式化处理函数",default:function(t){return(0,i.numAddSymbol)(t)}},fontSize:{detail:"文本字体大小",default:13},fontColor:{detail:"文本颜色",default:"#ffffff",documentation:"align为center的时候的颜色，align为其他属性时候取node的颜色"}}}}}}]),c(_,[{key:"init",value:function(){}},{key:"_computerAttr",value:function(){this.field&&(this.dataOrg=this.dataFrame.getFieldData(this.field)),this._maxVal=o._.max(this.dataOrg),this._minVal=o._.min(this.dataOrg),this.maxNodeWidth||(this.maxNodeWidth=.7*this.width),this.node.height||(this.node.height=this.height/this.dataOrg.length)}},{key:"draw",value:function(t){t=t||{},o._.extend(!0,this,t),this.animation&&t.resize,this._computerAttr(),this.data=this._trimGraphs(),this._drawGraphs(),this.sprite.context.x=this.origin.x+this.width/2,this.sprite.context.y=this.origin.y}},{key:"_trimGraphs",value:function(){if(this.field){var i=this,r=[];return o._.each(this.dataOrg,function(t,e){var n={type:"funnel",field:i.field,rowData:i.dataFrame.getRowDataAt(e),value:t,width:i._getNodeWidth(t),color:i.app.getTheme(e),cursor:"pointer",label:"",middlePoint:null,iNode:-1,points:[]};r.push(n)}),this.sort&&(r=r.sort(function(t,e){return"desc"==i.sort?e.value-t.value:t.value-e.value})),o._.each(r,function(t,e){t.iNode=e,t.label=i.label.format(t.value,t)}),o._.each(r,function(t,e){t.points=i._getPoints(t,r[e+1],r[e-1]),t.middlePoint={x:0,y:(t.iNode+.5)*i.node.height}}),r}}},{key:"_getNodeWidth",value:function(t){var e=this.minNodeWidth+(this.maxNodeWidth-this.minNodeWidth)/(this._maxVal-this.minVal)*(t-this.minVal);return parseInt(e)}},{key:"_getPoints",value:function(t,e,n){var i=[],r=t.iNode*this.node.height,a=r+this.node.height;if("asc"!==this.sort){i.push([-t.width/2,r]),i.push([t.width/2,r]);var o=this.minNodeWidth;e&&(o=e.width),i.push([o/2,a]),i.push([-o/2,a])}else{var l=this.minNodeWidth;n&&(l=n.width),i.push([-l/2,r]),i.push([l/2,r]),i.push([t.width/2,a]),i.push([-t.width/2,a])}return i}},{key:"_drawGraphs",value:function(){var a=this;o._.each(this.data,function(t){var e=new y({context:{pointList:t.points,fillStyle:t.color,cursor:t.cursor}});a.sprite.addChild(e),e.nodeData=t,e.on(o.event.types.get(),function(t){t.eventInfo={trigger:a.node,title:a.field,nodes:[this.nodeData]},a.app.fire(t.type,t)});var n="center",i={x:t.middlePoint.x,y:t.middlePoint.y};"left"==a.label.textAlign&&(i.x=t.points[0][0]-(t.points[0][0]-t.points[3][0])/2,i.x-=15,n="right"),"right"==a.label.textAlign&&(i.x=t.points[1][0]-(t.points[1][0]-t.points[2][0])/2,i.x+=15,n="left");var r=new p(t.label,{context:{x:i.x,y:i.y,fontSize:a.label.fontSize,fillStyle:"center"==a.label.textAlign?a.label.fontColor:t.color,textAlign:n,textBaseline:a.label.textBaseline}});a.sprite.addChild(r)})}}]),_);function _(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,_),(n=function(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?d(t):e}(this,u(_).call(this,t,e))).type="funnel",n.dataOrg=[],n.data=[],n._maxVal=null,n._minVal=null,o._.extend(!0,d(n),(0,o.getDefaultProps)(_.defaultProps()),t),n.init(),n}o.global.registerComponent(g,"graphs","funnel"),t.default=g}(e,n,y,l,i)}));var O=e(function(t,e){function n(t){for(var e=new Array(t),n=0;n<t;++n)e[n]=0;return e}function y(t,e){for(var n=0,i=0;i<t.length;++i)n+=t[i]*e[i];return n}function p(t){return Math.sqrt(y(t,t))}function g(t,e,n){for(var i=0;i<e.length;++i)t[i]=e[i]*n}function C(t,e,n,i,r){for(var a=0;a<t.length;++a)t[a]=e*n[a]+i*r[a]}function _(r,a,o,l,s,u,d){var f=o.fx,c=y(o.fxprime,a),h=f,t=f,p=c,e=0;function n(t,e,n){for(var i=0;i<16;++i)if(s=(t+e)/2,C(l.x,1,o.x,s,a),h=l.fx=r(l.x,l.fxprime),p=y(l.fxprime,a),f+u*s*c<h||n<=h)e=s;else{if(Math.abs(p)<=-d*c)return s;0<=p*(e-t)&&(e=t),t=s,n=h}return 0}s=s||1,u=u||1e-6,d=d||.1;for(var i=0;i<10;++i){if(C(l.x,1,o.x,s,a),h=l.fx=r(l.x,l.fxprime),p=y(l.fxprime,a),f+u*s*c<h||i&&t<=h)return n(e,s,t);if(Math.abs(p)<=-d*c)return s;if(0<=p)return n(s,e,h);t=h,e=s,s*=2}return s}var i;(i=e).bisect=function(t,e,n,i){var r=(i=i||{}).maxIterations||100,a=i.tolerance||1e-10,o=t(e),l=t(n),s=n-e;if(0<o*l)throw"Initial bisect points must have opposite signs";if(0===o)return e;if(0===l)return n;for(var u=0;u<r;++u){var d=e+(s/=2),f=t(d);if(0<=f*o&&(e=d),Math.abs(s)<a||0===f)return d}return e+s},i.nelderMead=function(t,e,n){var i,r=(n=n||{}).maxIterations||200*e.length,a=n.nonZeroDelta||1.05,o=n.zeroDelta||.001,l=n.minErrorDelta||1e-6,s=n.minErrorDelta||1e-5,u=void 0!==n.rho?n.rho:1,d=void 0!==n.chi?n.chi:2,f=void 0!==n.psi?n.psi:-.5,c=void 0!==n.sigma?n.sigma:.5,h=e.length,p=new Array(h+1);p[0]=e,p[0].fx=t(e);for(var y=p[0].id=0;y<h;++y){var g=e.slice();g[y]=g[y]?g[y]*a:o,p[y+1]=g,p[y+1].fx=t(g),p[y+1].id=y+1}function _(t){for(var e=0;e<t.length;e++)p[h][e]=t[e];p[h].fx=t.fx}for(var v=function(t,e){return t.fx-e.fx},x=e.slice(),b=e.slice(),m=e.slice(),w=e.slice(),S=0;S<r;++S){if(p.sort(v),n.history){var k=p.map(function(t){var e=t.slice();return e.fx=t.fx,e.id=t.id,e});k.sort(function(t,e){return t.id-e.id}),n.history.push({x:p[0].slice(),fx:p[0].fx,simplex:k})}for(y=i=0;y<h;++y)i=Math.max(i,Math.abs(p[0][y]-p[1][y]));if(Math.abs(p[0].fx-p[h].fx)<l&&i<s)break;for(y=0;y<h;++y){for(var A=x[y]=0;A<h;++A)x[y]+=p[A][y];x[y]/=h}var O=p[h];if(C(b,1+u,x,-u,O),b.fx=t(b),b.fx<p[0].fx)C(w,1+d,x,-d,O),w.fx=t(w),w.fx<b.fx?_(w):_(b);else if(b.fx>=p[h-1].fx){var P=!1;if(b.fx>O.fx?(C(m,1+f,x,-f,O),m.fx=t(m),m.fx<O.fx?_(m):P=!0):(C(m,1-f*u,x,f*u,O),m.fx=t(m),m.fx<b.fx?_(m):P=!0),P){if(1<=c)break;for(y=1;y<p.length;++y)C(p[y],1-c,p[0],c,p[y]),p[y].fx=t(p[y])}}else _(b)}return p.sort(v),{fx:p[0].fx,x:p[0]}},i.conjugateGradient=function(t,e,n){var i,r,a,o={x:e.slice(),fx:0,fxprime:e.slice()},l={x:e.slice(),fx:0,fxprime:e.slice()},s=e.slice(),u=1;a=(n=n||{}).maxIterations||20*e.length,o.fx=t(o.x,o.fxprime),g(i=o.fxprime.slice(),o.fxprime,-1);for(var d=0;d<a;++d){if(u=_(t,i,o,l,u),n.history&&n.history.push({x:o.x.slice(),fx:o.fx,fxprime:o.fxprime.slice(),alpha:u}),u){C(s,1,l.fxprime,-1,o.fxprime);var f=y(o.fxprime,o.fxprime),c=Math.max(0,y(s,l.fxprime)/f);C(i,c,i,-1,l.fxprime),r=o,o=l,l=r}else g(i,o.fxprime,-1);if(p(o.fxprime)<=1e-5)break}n.history&&n.history.push({x:o.x.slice(),fx:o.fx,fxprime:o.fxprime.slice(),alpha:u});return o},i.gradientDescent=function(t,e,n){for(var i=(n=n||{}).maxIterations||100*e.length,r=n.learnRate||.001,a={x:e.slice(),fx:0,fxprime:e.slice()},o=0;o<i&&(a.fx=t(a.x,a.fxprime),n.history&&n.history.push({x:a.x.slice(),fx:a.fx,fxprime:a.fxprime.slice()}),C(a.x,1,a.x,-r,a.fxprime),!(p(a.fxprime)<=1e-5));++o);return a},i.gradientDescentLineSearch=function(t,e,n){n=n||{};var i,r={x:e.slice(),fx:0,fxprime:e.slice()},a={x:e.slice(),fx:0,fxprime:e.slice()},o=n.maxIterations||100*e.length,l=n.learnRate||1,s=e.slice(),u=n.c1||.001,d=n.c2||.1,f=[];if(n.history){var c=t;t=function(t,e){return f.push(t.slice()),c(t,e)}}r.fx=t(r.x,r.fxprime);for(var h=0;h<o&&(g(s,r.fxprime,-1),l=_(t,s,r,a,l,u,d),n.history&&(n.history.push({x:r.x.slice(),fx:r.fx,fxprime:r.fxprime.slice(),functionCalls:f,learnRate:l,alpha:l}),f=[]),i=r,r=a,a=i,!(0===l||p(r.fxprime)<1e-5));++h);return r},i.zeros=n,i.zerosM=function(t,e){return n(t).map(function(){return n(e)})},i.norm2=p,i.weightedSum=C,i.scale=g}),P=e(function(t,e){!function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.intersectionArea=function(e,t){var n,i=function(t){for(var e=[],n=0;n<t.length;++n)for(var i=n+1;i<t.length;++i)for(var r=P(t[n],t[i]),a=0;a<r.length;++a){var o=r[a];o.parentIndex=[n,i],e.push(o)}return e}(e),r=i.filter(function(t){return k(t,e)}),a=0,o=0,l=[];if(1<r.length){var s=C(r);for(n=0;n<r.length;++n){var u=r[n];u.angle=Math.atan2(u.x-s.x,u.y-s.y)}r.sort(function(t,e){return e.angle-t.angle});var d=r[r.length-1];for(n=0;n<r.length;++n){var f=r[n];o+=(d.x+f.x)*(f.y-d.y);for(var c={x:(f.x+d.x)/2,y:(f.y+d.y)/2},h=null,p=0;p<f.parentIndex.length;++p)if(-1<d.parentIndex.indexOf(f.parentIndex[p])){var y=e[f.parentIndex[p]],g=Math.atan2(f.x-y.x,f.y-y.y),_=Math.atan2(d.x-y.x,d.y-y.y),v=_-g;v<0&&(v+=2*Math.PI);var x=_-v/2,b=O(c,{x:y.x+y.radius*Math.sin(x),y:y.y+y.radius*Math.cos(x)});b>2*y.radius&&(b=2*y.radius),(null===h||h.width>b)&&(h={circle:y,width:b,p1:f,p2:d})}null!==h&&(l.push(h),a+=A(h.circle.radius,h.width),d=f)}}else{var m=e[0];for(n=1;n<e.length;++n)e[n].radius<m.radius&&(m=e[n]);var w=!1;for(n=0;n<e.length;++n)if(O(e[n],m)>Math.abs(m.radius-e[n].radius)){w=!0;break}w?a=o=0:(a=m.radius*m.radius*Math.PI,l.push({circle:m,p1:{x:m.x,y:m.y+m.radius},p2:{x:m.x-S,y:m.y+m.radius},width:2*m.radius}))}o/=2,t&&(t.area=a+o,t.arcArea=a,t.polygonArea=o,t.arcs=l,t.innerPoints=r,t.intersectionPoints=i);return a+o},t.containedInCircles=k,t.circleArea=A,t.distance=O,t.circleOverlap=function(t,e,n){if(t+e<=n)return 0;if(n<=Math.abs(t-e))return Math.PI*Math.min(t,e)*Math.min(t,e);var i=e-(n*n-t*t+e*e)/(2*n);return A(t,t-(n*n-e*e+t*t)/(2*n))+A(e,i)},t.circleCircleIntersection=P,t.getCenter=C;var S=1e-10;function k(t,e){for(var n=0;n<e.length;++n)if(O(t,e[n])>e[n].radius+S)return!1;return!0}function A(t,e){return t*t*Math.acos(1-e/t)-(t-e)*Math.sqrt(e*(2*t-e))}function O(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))}function P(t,e){var n=O(t,e),i=t.radius,r=e.radius;if(i+r<=n||n<=Math.abs(i-r))return[];var a=(i*i-r*r+n*n)/(2*n),o=Math.sqrt(i*i-a*a),l=t.x+a*(e.x-t.x)/n,s=t.y+a*(e.y-t.y)/n,u=-(e.y-t.y)*(o/n),d=-(e.x-t.x)*(o/n);return[{x:l+u,y:s-d},{x:l-u,y:s+d}]}function C(t){for(var e={x:0,y:0},n=0;n<t.length;++n)e.x+=t[n].x,e.y+=t[n].y;return e.x/=t.length,e.y/=t.length,e}}(e)});t(P);var C=e(function(t,e){!function(t,v,I){Object.defineProperty(t,"__esModule",{value:!0}),t.venn=function(r,t){(t=t||{}).maxIterations=t.maxIterations||500;var e=t.initialLayout||d,a=t.lossFunction||L;r=function(t){t=t.slice();var e,n,i,r,a=[],o={};for(e=0;e<t.length;++e){var l=t[e];1==l.sets.length?a.push(l.sets[0]):2==l.sets.length&&(i=l.sets[0],r=l.sets[1],o[[i,r]]=!0,o[[r,i]]=!0)}for(a.sort(function(t,e){return e<t}),e=0;e<a.length;++e)for(i=a[e],n=e+1;n<a.length;++n)r=a[n],[i,r]in o||t.push({sets:[i,r],size:0});return t}(r);var n,o=e(r,t),i=[],l=[];for(n in o)o.hasOwnProperty(n)&&(i.push(o[n].x),i.push(o[n].y),l.push(n));for(var s=(0,v.nelderMead)(function(t){for(var e={},n=0;n<l.length;++n){var i=l[n];e[i]={x:t[2*n],y:t[2*n+1],radius:o[i].radius}}return a(e,r)},i,t).x,u=0;u<l.length;++u)n=l[u],o[n].x=s[2*u],o[n].y=s[2*u+1];return o},t.distanceFromIntersectArea=T,t.getDistanceMatrices=x,t.bestInitialLayout=d,t.constrainedMDSLayout=a,t.greedyLayout=o,t.lossFunction=L,t.disjointCluster=y,t.normalizeSolution=function(t,e,n){null===e&&(e=Math.PI/2);var i,r,s=[];for(r in t)if(t.hasOwnProperty(r)){var a=t[r];s.push({x:a.x,y:a.y,radius:a.radius,setid:r})}var o=y(s);for(i=0;i<o.length;++i){p(o[i],e,n);var l=b(o[i]);o[i].size=(l.xRange.max-l.xRange.min)*(l.yRange.max-l.yRange.min),o[i].bounds=l}o.sort(function(t,e){return e.size-t.size});var u=(s=o[0]).bounds,d=(u.xRange.max-u.xRange.min)/50;function f(t,e,n){if(t){var i,r,a,o=t.bounds;e?i=u.xRange.max-o.xRange.min+d:(i=u.xRange.max-o.xRange.max,(a=(o.xRange.max-o.xRange.min)/2-(u.xRange.max-u.xRange.min)/2)<0&&(i+=a)),n?r=u.yRange.max-o.yRange.min+d:(r=u.yRange.max-o.yRange.max,(a=(o.yRange.max-o.yRange.min)/2-(u.yRange.max-u.yRange.min)/2)<0&&(r+=a));for(var l=0;l<t.length;++l)t[l].x+=i,t[l].y+=r,s.push(t[l])}}var c=1;for(;c<o.length;)f(o[c],!0,!1),f(o[c+1],!1,!0),f(o[c+2],!0,!0),c+=3,u=b(s);var h={};for(i=0;i<s.length;++i)h[s[i].setid]=s[i];return h},t.scaleSolution=function(t,e,n,i){var r=[],a=[];for(var o in t)t.hasOwnProperty(o)&&(a.push(o),r.push(t[o]));e-=2*i,n-=2*i;var l=b(r),s=l.xRange,u=l.yRange;if(s.max==s.min||u.max==u.min)return console.log("not scaling solution: zero size detected"),t;for(var d=e/(s.max-s.min),f=n/(u.max-u.min),c=Math.min(f,d),h=(e-(s.max-s.min)*c)/2,p=(n-(u.max-u.min)*c)/2,y={},g=0;g<r.length;++g){var _=r[g];y[a[g]]={radius:c*_.radius,x:i+h+(_.x-s.min)*c,y:i+p+(_.y-u.min)*c}}return y};var D=1e-10;function T(e,n,i){return Math.min(e,n)*Math.min(e,n)*Math.PI<=i+D?Math.abs(e-n):(0,v.bisect)(function(t){return(0,I.circleOverlap)(e,n,t)-i},0,e+n)}function x(t,a,o){var l=(0,v.zerosM)(a.length,a.length),s=(0,v.zerosM)(a.length,a.length);return t.filter(function(t){return 2==t.sets.length}).map(function(t){var e=o[t.sets[0]],n=o[t.sets[1]],i=T(Math.sqrt(a[e].size/Math.PI),Math.sqrt(a[n].size/Math.PI),t.size);l[e][n]=l[n][e]=i;var r=0;t.size+1e-10>=Math.min(a[e].size,a[n].size)?r=1:t.size<=1e-10&&(r=-1),s[e][n]=s[n][e]=r}),{distances:l,constraints:s}}function d(t,e){var n=o(t,e),i=e.lossFunction||L;if(8<=t.length){var r=a(t,e);i(r,t)+1e-8<i(n,t)&&(n=r)}return n}function a(t,e){var n,i=(e=e||{}).restarts||10,r=[],a={};for(n=0;n<t.length;++n){var o=t[n];1==o.sets.length&&(a[o.sets[0]]=r.length,r.push(o))}var l=x(t,r,a),s=l.distances,u=l.constraints,d=(0,v.norm2)(s.map(v.norm2))/s.length;s=s.map(function(t){return t.map(function(t){return t/d})});function f(t,e){return function(t,e,n,i){var r,a=0;for(r=0;r<e.length;++r)e[r]=0;for(r=0;r<n.length;++r)for(var o=t[2*r],l=t[2*r+1],s=r+1;s<n.length;++s){var u=t[2*s],d=t[2*s+1],f=n[r][s],c=i[r][s],h=(u-o)*(u-o)+(d-l)*(d-l),p=Math.sqrt(h),y=h-f*f;0<c&&p<=f||c<0&&f<=p||(a+=2*y*y,e[2*r]+=4*y*(o-u),e[2*r+1]+=4*y*(l-d),e[2*s]+=4*y*(u-o),e[2*s+1]+=4*y*(d-l))}return a}(t,e,s,u)}var c,h;for(n=0;n<i;++n){var p=(0,v.zeros)(2*s.length).map(Math.random);h=(0,v.conjugateGradient)(f,p,e),(!c||h.fx<c.fx)&&(c=h)}var y=c.x,g={};for(n=0;n<r.length;++n){var _=r[n];g[_.sets[0]]={x:y[2*n]*d,y:y[2*n+1]*d,radius:Math.sqrt(_.size/Math.PI)}}if(e.history)for(n=0;n<e.history.length;++n)(0,v.scale)(e.history[n].x,d);return g}function o(t,e){for(var n,i=e&&e.lossFunction?e.lossFunction:L,r={},a={},o=0;o<t.length;++o){var l=t[o];1==l.sets.length&&(n=l.sets[0],r[n]={x:1e10,y:1e10,rowid:r.length,size:l.size,radius:Math.sqrt(l.size/Math.PI)},a[n]=[])}for(t=t.filter(function(t){return 2==t.sets.length}),o=0;o<t.length;++o){var s=t[o],u=s.hasOwnProperty("weight")?s.weight:1,d=s.sets[0],f=s.sets[1];s.size+D>=Math.min(r[d].size,r[f].size)&&(u=0),a[d].push({set:f,size:s.size,weight:u}),a[f].push({set:d,size:s.size,weight:u})}var c=[];for(n in a)if(a.hasOwnProperty(n)){var h=0;for(o=0;o<a[n].length;++o)h+=a[n][o].size*a[n][o].weight;c.push({set:n,size:h})}function p(t,e){return e.size-t.size}c.sort(p);var y={};function g(t){return t.set in y}function _(t,e){r[e].x=t.x,r[e].y=t.y,y[e]=!0}for(_({x:0,y:0},c[0].set),o=1;o<c.length;++o){var v=c[o].set,x=a[v].filter(g);if(n=r[v],x.sort(p),0===x.length)throw"ERROR: missing pairwise overlap information";for(var b=[],m=0;m<x.length;++m){var w=r[x[m].set],S=T(n.radius,w.radius,x[m].size);b.push({x:w.x+S,y:w.y}),b.push({x:w.x-S,y:w.y}),b.push({y:w.y+S,x:w.x}),b.push({y:w.y-S,x:w.x});for(var k=m+1;k<x.length;++k)for(var A=r[x[k].set],O=T(n.radius,A.radius,x[k].size),P=(0,I.circleCircleIntersection)({x:w.x,y:w.y,radius:S},{x:A.x,y:A.y,radius:O}),C=0;C<P.length;++C)b.push(P[C])}var j=1e50,E=b[0];for(m=0;m<b.length;++m){r[v].x=b[m].x,r[v].y=b[m].y;var M=i(r,t);M<j&&(j=M,E=b[m])}_(E,v)}return r}function L(e,t){var n=0;for(var i=0;i<t.length;++i){var r,a=t[i];if(1!=a.sets.length){if(2==a.sets.length){var o=e[a.sets[0]],l=e[a.sets[1]];r=(0,I.circleOverlap)(o.radius,l.radius,(0,I.distance)(o,l))}else r=(0,I.intersectionArea)(a.sets.map(function(t){return e[t]}));n+=(a.hasOwnProperty("weight")?a.weight:1)*(r-a.size)*(r-a.size)}}return n}function p(t,e,n){var i;if(null===n?t.sort(function(t,e){return e.radius-t.radius}):t.sort(n),0<t.length){var r=t[0].x,a=t[0].y;for(i=0;i<t.length;++i)t[i].x-=r,t[i].y-=a}2==t.length&&(0,I.distance)(t[0],t[1])<Math.abs(t[1].radius-t[0].radius)&&(t[1].x=t[0].x+t[0].radius-t[1].radius-1e-10,t[1].y=t[0].y);if(1<t.length){var o,l,s=Math.atan2(t[1].x,t[1].y)-e,u=Math.cos(s),d=Math.sin(s);for(i=0;i<t.length;++i)o=t[i].x,l=t[i].y,t[i].x=u*o-d*l,t[i].y=d*o+u*l}if(2<t.length){for(var f=Math.atan2(t[2].x,t[2].y)-e;f<0;)f+=2*Math.PI;for(;f>2*Math.PI;)f-=2*Math.PI;if(f>Math.PI){var c=t[1].y/(1e-10+t[1].x);for(i=0;i<t.length;++i){var h=(t[i].x+c*t[i].y)/(1+c*c);t[i].x=2*h-t[i].x,t[i].y=2*h*c-t[i].y}}}}function y(t){function e(t){return t.parent!==t&&(t.parent=e(t.parent)),t.parent}t.map(function(t){t.parent=t});for(var n=0;n<t.length;++n)for(var i=n+1;i<t.length;++i){var r=t[n].radius+t[i].radius;(0,I.distance)(t[n],t[i])+1e-10<r&&(a=t[i],o=t[n],l=void 0,l=e(a),s=e(o),l.parent=s)}var a,o,l,s,u,d={};for(n=0;n<t.length;++n)(u=e(t[n]).parent.setid)in d||(d[u]=[]),d[u].push(t[n]);t.map(function(t){delete t.parent});var f=[];for(u in d)d.hasOwnProperty(u)&&f.push(d[u]);return f}function b(t){function e(e){return{max:Math.max.apply(null,t.map(function(t){return t[e]+t.radius})),min:Math.min.apply(null,t.map(function(t){return t[e]-t.radius}))}}return{xRange:e("x"),yRange:e("y")}}}(e,O,P)});t(C),t(e(function(t,e){!function(t,e,n,d,y,c,g){Object.defineProperty(t,"__esModule",{value:!0});var i=a(e),r=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _=i.default.Display.Text,v=i.default.Shapes.Path,x=i.default.Shapes.Circle,p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(b,r.default),f(b,null,[{key:"defaultProps",value:function(){return{keyField:{detail:"key字段",default:"name"},valueField:{detail:"value字段",default:"value"},node:{detail:"单个节点配置",propertys:{strokeStyle:{detail:"边框颜色",default:null},lineWidth:{detail:"边框大小",default:2},strokeAlpha:{detail:"边框透明度",default:0},fillStyle:{detail:"背景色",default:null},fillAlpha:{detail:"背景透明度",default:.25},focus:{detail:"hover设置",propertys:{enabled:{detail:"是否开启",default:!0},strokeAlpha:{detail:"边框透明度",default:.3}}},select:{detail:"选中设置",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"描边宽度",default:2},strokeStyle:{detail:"描边颜色",default:"#666666"}}}}},label:{detail:"文本设置",propertys:{field:{detail:"获取文本的字段",default:null},fontSize:{detail:"字体大小",default:14},fontColor:{detail:"文本颜色",default:null},fontWeight:{detail:"fontWeight",default:"normal"},showInter:{detail:"是否显示相交部分的文本",default:!0}}}}}}]),f(b,[{key:"init",value:function(){this.venn_circles=new i.default.Display.Sprite({id:"venn_circles"}),this.sprite.addChild(this.venn_circles),this.venn_paths=new i.default.Display.Sprite({id:"venn_paths"}),this.sprite.addChild(this.venn_paths),this.venn_labels=new i.default.Display.Sprite({id:"venn_labels"}),this.sprite.addChild(this.venn_labels)}},{key:"draw",value:function(t){t=t||{},g._.extend(!0,this,t),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.app.padding.left,this.sprite.context.y=this.app.padding.top,this.fire("complete")}},{key:"resetData",value:function(t){this.dataFrame=t,this.data=this._trimGraphs(),this._widget()}},{key:"_trimGraphs",value:function(){var i=this,t=i._vennData(),e=d.venn,n=d.lossFunction,r=Math.PI/2,a={},o={};if(this._dataCircleLen=0,this._dataLabelLen=0,(this._dataPathLen=0)<t.length){var l=e(t,{lossFunction:n});l=(0,d.normalizeSolution)(l,r,null),a=(0,d.scaleSolution)(l,this.width,this.height,0),o=function(t,e){for(var n={},i=function(t){var e={},n=[];for(var i in t)n.push(i),e[i]=[];for(var r=0;r<n.length;r++)for(var a=t[n[r]],o=r+1;o<n.length;++o){var l=t[n[o]],s=(0,y.distance)(a,l);s+l.radius<=a.radius+1e-10?e[n[o]].push(n[r]):s+a.radius<=l.radius+1e-10&&e[n[r]].push(n[o])}return e}(t),r=0;r<e.length;++r){for(var a=e[r].sets,o={},l={},s=0;s<a.length;++s){o[a[s]]=!0;for(var u=i[a[s]],d=0;d<u.length;++d)l[u[d]]=!0}var f=[],c=[];for(var h in t)h in o?f.push(t[h]):h in l||c.push(t[h]);var p=m(f,c);(n[a]=p).disjoint&&0<e[r].size&&console.log("WARNING: area "+a+" not represented on screen")}return n}(a,t)}var s=0,u=0;return g._.each(t,function(t,e){if(t.label&&(1<t.sets.length&&!i.label.showInter||(t.labelPosition=o[t.nodeId],i._dataLabelLen++)),1<t.sets.length){var n=function(t){var e={};(0,y.intersectionArea)(t,e);var n=e.arcs;if(0===n.length)return"M 0 0";if(1==n.length){var i=n[0].circle;return function(t,e,n){var i=[];return i.push("\nM",t,e),i.push("\nm",-n,0),i.push("\na",n,n,0,1,0,2*n,0),i.push("\na",n,n,0,1,0,2*-n,0),i.join(" ")}(i.x,i.y,i.radius)}for(var r=["\nM",n[0].p2.x,n[0].p2.y],a=0;a<n.length;++a){var o=n[a],l=o.circle.radius,s=o.width>l;r.push("\nA",l,l,0,s?1:0,1,o.p1.x,o.p1.y)}return r.join(" ")+" z"}(t.sets.map(function(t){return a[t]}));t.shape={type:"path",path:n,pathInd:u++},i._dataPathLen++}else 1==t.sets.length&&(t.shape=g._.extend({type:"circle",circleInd:s++},a[t.nodeId]),i._dataCircleLen++)}),t}},{key:"_vennData",value:function(){for(var t=[],e=0,n=this.dataFrame.length;e<n;e++){var i=this.dataFrame.getRowDataAt(e),r={type:"venn",iNode:e,nodeId:null,rowData:i,sets:null,size:null,value:null,fillStyle:null,strokeStyle:null,label:null,labelPosition:null};for(var a in i){var o=i[a];a==this.keyField?(g._.isArray(o)||(o=o.split(/[,|]/)),r.sets=o,r.nodeId=o.join()):a==this.valueField?(r.size=o,r.value=o):a==this.label.field&&(r.label=o)}t.push(r)}return t}},{key:"_getStyle",value:function(t,e,n,i){var r;return g._.isString(t)&&(r=t),g._.isFunction(t)&&(r=t(n)),r||null==e||(r=this.app.getTheme(e)),r||null==i||(r=i),r}},{key:"_widget",value:function(){var c=this;if(c.venn_circles.children.length>c._dataCircleLen)for(var t=c._dataCircleLen;t<c.venn_circles.children.length;t++)c.venn_circles.getChildAt(t--).destroy();if(c.venn_paths.children.length>c._dataPathLen)for(t=c._dataPathLen;t<c.venn_paths.children.length;t++)c.venn_paths.getChildAt(t--).destroy();if(c.venn_labels.children.length>c._dataLabelLen)for(t=c._dataLabelLen;t<c.venn_labels.children.length;t++)c.venn_labels.getChildAt(t--).destroy();var h=0,p=0,y=0;g._.each(this.data,function(t,e){var n,i=t.shape,r=!0;if(i){var a;if("circle"==i.type){var o=c._getStyle(c.node.fillStyle,i.circleInd,t),l=c._getStyle(c.node.strokeStyle,i.circleInd,t);t.fillStyle=o,t.strokeStyle=l,a={x:i.x,y:i.y,r:i.radius,fillStyle:o,fillAlpha:c.node.fillAlpha,lineWidth:c.node.lineWidth,strokeStyle:l,strokeAlpha:c.node.strokeAlpha},(n=c.venn_circles.getChildAt(h++))?(r=!1,n.animate(a)):(n=new x({pointChkPriority:!1,hoverClone:!1,context:a}),c.venn_circles.addChild(n))}"path"==t.shape.type&&(a={path:i.path,fillStyle:"#ffffff",fillAlpha:0,lineWidth:c.node.lineWidth,strokeStyle:"#ffffff",strokeAlpha:0},(n=c.venn_paths.getChildAt(p++))?(r=!1,n.context.path=i.path):(n=new v({pointChkPriority:!1,context:a}),c.venn_paths.addChild(n))),(n.nodeData=t)._node=n,c.node.focus.enabled&&n.hover(function(t){c.focusAt(this.nodeData.iNode)},function(t){this.nodeData.selected||c.unfocusAt(this.nodeData.iNode)}),r&&n.on(g.event.types.get(),function(t){t.eventInfo={trigger:c.node,title:null,nodes:[this.nodeData]},c.app.fire(t.type,t)})}if(t.label&&c.label.enabled){var s=c._getStyle(c.label.fontColor,i.circleInd,t,"#999"),u=c.label.fontSize;if(1<t.sets.length&&(c.label.showInter?u-=2:u=0),u){var d={x:t.labelPosition.x,y:t.labelPosition.y,fontSize:u,textBaseline:"middle",textAlign:"center",fontWeight:c.label.fontWeight,fillStyle:s},f=c.venn_labels.getChildAt(y++);f?(f.resetText(t.label),f.animate(d)):(f=new _(t.label,{context:d}),c.venn_labels.addChild(f))}}})}},{key:"focusAt",value:function(t){var e=this.data[t];if(this.node.focus.enabled&&!e.focused){var n=e._node.context;1<e.sets.length?n.strokeAlpha=1:n.strokeAlpha=this.node.focus.strokeAlpha,e.focused=!0}}},{key:"unfocusAt",value:function(t){var e=this.data[t];this.node.focus.enabled&&e.focused&&(e._node.context.strokeAlpha=this.node.strokeAlpha,e.focused=!1)}},{key:"selectAt",value:function(t){var e=this.data[t];if(this.node.select.enabled&&!e.selected){var n=e._node.context;n.lineWidth=this.node.select.lineWidth,n.strokeAlpha=this.node.select.strokeAlpha,n.strokeStyle=this.node.select.strokeStyle,e.selected=!0}}},{key:"unselectAt",value:function(t){var e=this.data[t];this.node.select.enabled&&e.selected&&(e._node.context.strokeStyle=this.node.strokeStyle,e.selected=!1)}}]),b);function b(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,b),(n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?s(t):e}(this,l(b).call(this,t,e))).type="venn",n.vennData=null,g._.extend(!0,s(n),(0,g.getDefaultProps)(b.defaultProps()),t),n._dataCircleLen=0,n._dataLabelLen=0,n._dataPathLen=0,n.init(),n}function m(e,n){var t,i=[];for(t=0;t<e.length;++t){var r=e[t];i.push({x:r.x,y:r.y}),i.push({x:r.x+r.radius/2,y:r.y}),i.push({x:r.x-r.radius/2,y:r.y}),i.push({x:r.x,y:r.y+r.radius/2}),i.push({x:r.x,y:r.y-r.radius/2})}var a=i[0],o=w(i[0],e,n);for(t=1;t<i.length;++t){var l=w(i[t],e,n);o<=l&&(a=i[t],o=l)}var s=(0,c.nelderMead)(function(t){return-1*w({x:t[0],y:t[1]},e,n)},[a.x,a.y],{maxIterations:500,minErrorDelta:1e-10}).x,u={x:s[0],y:s[1]},d=!0;for(t=0;t<e.length;++t)if((0,y.distance)(u,e[t])>e[t].radius){d=!1;break}for(t=0;t<n.length;++t)if((0,y.distance)(u,n[t])<n[t].radius){d=!1;break}if(!d)if(1==e.length)u={x:e[0].x,y:e[0].y};else{var f={};(0,y.intersectionArea)(e,f),u=0===f.arcs.length?{x:0,y:-1e3,disjoint:!0}:1==f.arcs.length?{x:f.arcs[0].circle.x,y:f.arcs[0].circle.y}:n.length?m(e,[]):(0,y.getCenter)(f.arcs.map(function(t){return t.p1}))}return u}function w(t,e,n){var i,r,a=e[0].radius-(0,y.distance)(e[0],t);for(i=1;i<e.length;++i)(r=e[i].radius-(0,y.distance)(e[i],t))<=a&&(a=r);for(i=0;i<n.length;++i)(r=(0,y.distance)(n[i],t)-n[i].radius)<=a&&(a=r);return a}g.global.registerComponent(p,"graphs","venn"),t.default=p}(e,n,y,C,P,O,i)}));var j=e(function(t,e){function a(e,n,i){return function(){var t=i.apply(n,arguments);return t===n?e:t}}var n;n=e,Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(t,e){for(var n,i=1,r=arguments.length;++i<r;)t[n=arguments[i]]=a(t,e,e[n]);return t}});t(j);var E=e(function(t,e){var n;n=e,Object.defineProperty(n,"__esModule",{value:!0}),n.default={merge:function(t){for(var e,n,i,r=t.length,a=-1,o=0;++a<r;)o+=t[a].length;for(n=new Array(o);0<=--r;)for(e=(i=t[r]).length;0<=--e;)n[--o]=i[e];return n}}});t(E);var M=e(function(t,e){!function(t,e,n){Object.defineProperty(t,"__esModule",{value:!0});var i=a(e),r=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function c(){var s=h,u=o,d=l;function f(t){var e,n=[t],i=[];for(t.depth=0;null!=(e=n.pop());)if(i.push(e),(a=u.call(f,e,e.depth))&&(r=a.length)){for(var r,a,o;0<=--r;)n.push(o=a[r]),o.parent=e,o.depth=e.depth+1;if(d){var l=+d.call(f,e,e.depth);l&&!isNaN(l)&&(e._value=l)}d&&(e.value=0),e.children=a}else d&&(e.value=+d.call(f,e,e.depth)||0),delete e.children;return c.layout_hierarchyVisitAfter(t,function(t){var e,n;s&&(e=t.children)&&e.sort(s),d&&(n=t.parent)&&(n.value+=t.value),t._value&&t._value>t.value&&(t.value=t._value),delete t._value}),i}return f.sort=function(t){return arguments.length?(s=t,f):s},f.children=function(t){return arguments.length?(u=t,f):u},f.value=function(t){return arguments.length?(d=t,f):d},f.revalue=function(t){return d&&(c.layout_hierarchyVisitBefore(t,function(t){t.children&&(t.value=0)}),c.layout_hierarchyVisitAfter(t,function(t){var e;t.children||(t.value=+d.call(f,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value),t._value&&t._value>t.value&&(t.value=t._value),delete t._value})),t},f}function o(t){return t.children}function l(t){return t.value}function h(t,e){return e.value-t.value}function s(t){return r.default.merge(t.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}c.layout_hierarchyRebind=function(t,e){return(0,i.default)(t,e,"sort","children","value"),(t.nodes=t).links=s,t},c.layout_hierarchyVisitBefore=function(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(r=t.children)&&(i=r.length))for(var i,r;0<=--i;)n.push(r[i])},c.layout_hierarchyVisitAfter=function(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(a=t.children)&&(r=a.length))for(var r,a,o=-1;++o<r;)n.push(a[o]);for(;null!=(t=i.pop());)e(t)},t.default=c}(e,j,E)});t(M);var I=e(function(t,e){!function(t,e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var i=(0,a.default)(),r=[1,1];function e(t,e){var n=i.call(this,t,e);return function t(e,n,i,r){var a=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,a&&(o=a.length)){var o,l,s,u=-1;for(i=e.value?i/e.value:0;++u<o;)t(l=a[u],n,s=l.value*i,r),n+=s}}(n[0],0,r[0],r[1]/function t(e){var n=e.children,i=0;if(n&&(r=n.length))for(var r,a=-1;++a<r;)i=Math.max(i,t(n[a]));return 1+i}(n[0])),n}return e.size=function(t){return arguments.length?(r=t,e):r},a.default.layout_hierarchyRebind(e,i)};var n,a=(n=e)&&n.__esModule?n:{default:n}}(e,M)});t(I),t(e(function(t,e){!function(t,e,n,i,f){Object.defineProperty(t,"__esModule",{value:!0});var r=l(e),a=l(n),o=l(i);function l(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=r.default.Shapes.Sector,g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(_,a.default),h(_,null,[{key:"defaultProps",value:function(){return{keyField:{detail:"key字段",default:"name"},valueField:{detail:"value字段",default:"value"},parentField:{detail:"parent字段",default:"parent"},node:{detail:"单个节点图形设置",propertys:{strokeStyle:{detail:"描边色",default:"#ffffff"},lineWidth:{detail:"描边线宽",default:1},strokeAlpha:{detail:"描边边框透明度",default:1},fillStyle:{detail:"背景色",default:null},fillAlpha:{detail:"背景透明度",default:1},blurAlpha:{detail:"非激活状态透明度",documentation:"比如选中其中一项，其他不先关的要降低透明度",default:.4}}}}}}]),h(_,[{key:"init",value:function(){}},{key:"draw",value:function(t){t=t||{},f._.extend(!0,this,t),this.data=this._trimGraphs(),this.dataGroup=this._getDataGroupOfDepth(),this._widget(),this.sprite.context.x=this.width/2+this.origin.x,this.sprite.context.y=this.height/2+this.origin.y,this.fire("complete")}},{key:"_trimGraphs",value:function(){var e=this,t=parseInt(Math.min(this.width,this.height)/2),n=(0,o.default)().sort(null).size([2*Math.PI,t*t]).value(function(t){return t[e.valueField]}),i=this._tansTreeData();return this.data=n(i,0),this.data}},{key:"_getDataGroupOfDepth",value:function(){var e={};f._.each(this.data,function(t){e[t.depth]=[]}),f._.each(this.data,function(t){e[t.depth].push(t)});var t=[];for(var n in e)t.push(e[n]);return t}},{key:"_tansTreeData",value:function(){var t=this.dataFrame,e={},s=t.getFieldData(this.keyField),u=t.getFieldData(this.valueField),d=t.getFieldData(this.parentField);return function i(r,t,e){for(var n=t?t.name:void 0,a=e||0;a<d.length;a++){var o=d[a];if(o||0===o||(o=void 0),n===o){r.name=s[a],r.iNode=a;var l=u[a];!l&&0!==l||(r.value=l),f._.each(d,function(t,e){if(t===r.name){r.children||(r.children=[]);var n={};i(n,r,e),r.children.push(n)}});break}}}(e),e}},{key:"_widget",value:function(){var l=this;f._.each(this.dataGroup,function(a,o){f._.each(a,function(e,t){if(e.depth){var n=Math.sqrt(e.y+e.dy),i={r0:Math.sqrt(e.y),r:Math.sqrt(e.y)+2,startAngle:180*e.x/Math.PI,endAngle:180*(e.x+e.dx)/Math.PI,fillStyle:e.color||l.app.getTheme(e.iNode),strokeStyle:l.node.strokeStyle,lineWidth:l.node.lineWidth,globalAlpha:0},r=new y({id:"sector_"+o+"_"+t,context:i});(r.layoutData=e).sector=r,e.group=a,l.sprite.addChild(r),r.hover(function(t){l._focus(e,a)},function(t){l._unfocus(e,a)}),r.on(f.event.types.get(),function(t){t.eventInfo={trigger:l.node,iNode:e.iNode},l.app.fire(t.type,t)}),o<=1?(r.context.r=n,r.context.globalAlpha=1):setTimeout(function(){r.context&&(r.context.globalAlpha=1,r.animate({r:n},{duration:350}))},350*(o-1))}})})}},{key:"getNodesAt",value:function(e){var t=[];if(void 0!==e){var n=f._.find(this.data,function(t){return t.iNode==e});n.type="sunburst",n&&t.push(n)}return t}},{key:"_focus",value:function(e,t){var n=this;f._.each(t,function(t){t!==e&&(t.sector.context.globalAlpha=n.node.blurAlpha,n._focusChildren(t,function(t){t.sector.context.globalAlpha=n.node.blurAlpha}))}),n._focusParent(e)}},{key:"_unfocus",value:function(){f._.each(this.data,function(t){t.sector&&(t.sector.context.globalAlpha=1)})}},{key:"_focusChildren",value:function(t,e){var n=this;t.children&&t.children.length&&f._.each(t.children,function(t){e(t),n._focusChildren(t,e)})}},{key:"_focusParent",value:function(e){var n=this;e.parent&&e.parent.sector&&e.parent.group&&f._.each(e.parent.group,function(t){t===e.parent?(t.sector.context.globalAlpha=1,n._focusParent(e.parent)):t.sector.context.globalAlpha=n.node.blurAlpha})}}]),_);function _(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,_),(n=function(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?d(t):e}(this,u(_).call(this,t,e))).type="sunburst",f._.extend(!0,d(n),(0,f.getDefaultProps)(_.defaultProps()),t),n.data=[],n.dataGroup=[],n.init(),n}f.global.registerComponent(g,"graphs","sunburst"),t.default=g}(e,n,y,I,i)}));var D=e(function(t,e){var n,x;n=e,x=i,Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(){var e={},a=24,l=8,s=[1,1],u=[],d=function(t,e){return t.y-e.y},f=[];function c(t,e){var n,i=0,r=t.length,a=-1;if(1===arguments.length)for(;++a<r;)isNaN(n=+t[a])||(i+=n);else for(;++a<r;)isNaN(n=+e.call(t,t[a],a))||(i+=n);return i}e.nodeWidth=function(t){return arguments.length?(a=+t,e):a},e.nodeSort=function(t){return arguments.length?(d=t,e):d},e.nodePadding=function(t){return arguments.length?(l=+t,e):l},e.nodes=function(t){return arguments.length?(u=t,e):u},e.links=function(t){return arguments.length?(f=t,e):f},e.size=function(t){return arguments.length?(s=t,e):s},e.layout=function(t){return u.forEach(function(t){t.sourceLinks=[],t.targetLinks=[]}),f.forEach(function(t){var e=t.source,n=t.target;"number"==typeof e&&(e=t.source=u[t.source]),"number"==typeof n&&(n=t.target=u[t.target]),e.sourceLinks.push(t),n.targetLinks.push(t)}),u.forEach(function(t){t.value=Math.max(c(t.sourceLinks,v),c(t.targetLinks,v))}),function(){for(var e,n,i,t=u,r=0;t.length;)e=[],t.forEach(function(t){t.x=r,t.dx=a,t.sourceLinks.forEach(function(t){e.indexOf(t.target)<0&&e.push(t.target)})}),t=e,++r;i=r,u.forEach(function(t){t.sourceLinks.length||(t.x=i-1)}),n=(s[0]-a)/(r-1),u.forEach(function(t){t.x*=n})}(),function(t){var n,e=h().key(function(t){return t.x}).sortKeys(p).entries(u).map(function(t){return t.values});n=function(t,e){var n,i,r=-1,a=t.length;if(1===arguments.length){for(;++r<a&&(null==(n=t[r])||n!=n);)n=void 0;for(;++r<a;)null!=(i=t[r])&&i<n&&(n=i)}else{for(;++r<a&&(null==(n=e.call(t,t[r],r))||n!=n);)n=void 0;for(;++r<a;)null!=(i=e.call(t,t[r],r))&&i<n&&(n=i)}return n}(e,function(t){return(s[1]-(t.length-1)*l)/c(t,v)}),e.forEach(function(t){t.forEach(function(t,e){t.y=e,t.dy=t.value*n})}),f.forEach(function(t){t.dy=t.value*n}),o();for(var i=1;0<t;--t)a(i*=.99),o(),r(i),o();function r(n){function i(t){return _(t.source)*t.value}e.forEach(function(t,e){t.forEach(function(t){if(t.targetLinks.length){var e=c(t.targetLinks,i)/c(t.targetLinks,v);t.y+=(e-_(t))*n}})})}function a(n){function i(t){return _(t.target)*t.value}e.slice().reverse().forEach(function(t){t.forEach(function(t){if(t.sourceLinks.length){var e=c(t.sourceLinks,i)/c(t.sourceLinks,v);t.y+=(e-_(t))*n}})})}function o(){e.forEach(function(t){var e,n,i,r=0,a=t.length;for(d&&t.sort(d),i=0;i<a;++i)0<(n=r-(e=t[i]).y)&&(e.y+=n),r=e.y+e.dy+l;if(0<(n=r-l-s[1]))for(r=e.y-=n,i=a-2;0<=i;--i)0<(n=(e=t[i]).y+e.dy+l-r)&&(e.y-=n),r=e.y})}}(t),y(),e},e.relayout=function(){return y(),e},e.link=function(){var c=.5;function e(t){var e,n,i=t.source.x+t.source.dx,r=t.target.x,a=(e=+(e=i),n=+(n=r),function(t){return e*(1-t)+n*t}),o=a(c),l=a(1-c),s=t.source.y+t.sy,u=t.target.y+t.ty,d=t.dy;d<1&&(d=1);var f="M"+i+","+s+"C"+o+","+s+" "+l+","+u+" "+r+","+u;return f+="v"+d,(f+="C"+l+","+(u+d)+" "+o+","+(s+d)+" "+i+","+(s+d))+"v"+-d+"z"}return e.curvature=function(t){return arguments.length?(c=+t,e):c},e};var h=function(){var f,c,h={},p=[],e=[];function y(n,t,i){if(i>=p.length)return c?c.call(h,t):f?t.sort(f):t;for(var e,r,a,o,l=-1,s=t.length,u=p[i++],d=new g;++l<s;)(o=d.get(e=u(r=t[l])))?o.push(r):d.set(e,[r]);return a=n?(r=n(),function(t,e){r.set(t,y(n,e,i))}):(r={},function(t,e){r[t]=y(n,e,i)}),d.forEach(a),r}return h.map=function(t,e){return y(e,t,0)},h.entries=function(t){return function n(t,i){if(i>=p.length)return t;var r=[],a=e[i++];return t.forEach(function(t,e){r.push({key:t,values:n(e,i)})}),a?r.sort(function(t,e){return a(t.key,e.key)}):r}(y(n,t,0),0)},h.key=function(t){return p.push(t),h},h.sortKeys=function(t){return e[p.length-1]=t,h},h.sortValues=function(t){return f=t,h},h.rollup=function(t){return c=t,h},h},n=function(t,e){var n=new g;if(t instanceof g)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var i,r=-1,a=t.length;if(1===arguments.length)for(;++r<a;)n.set(r,t[r]);else for(;++r<a;)n.set(e.call(t,i=t[r],r),i)}else for(var o in t)n.set(o,t[o]);return n};function g(){this._=Object.create(null)}var i="\0";function r(t){return"__proto__"==(t+="")||t[0]===i?i+t:t}function o(t){return(t+="")[0]===i?t.slice(1):t}function p(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}function y(){function e(t,e){return t.source.y-e.source.y}function n(t,e){return t.target.y-e.target.y}u.forEach(function(t){t.sourceLinks.sort(n),t.targetLinks.sort(e)}),u.forEach(function(t){var e=0,n=0;t.sourceLinks.forEach(function(t){t.sy=e,e+=t.dy}),t.targetLinks.forEach(function(t){t.ty=n,n+=t.dy})})}function _(t){return t.y+t.dy/2}function v(t){return t.value}return function(t,e){if(Object.defineProperty)for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1});else x._.extend(t.prototype,e)}(g,{has:function(t){return r(t)in this._},get:function(t){return this._[r(t)]},set:function(t,e){return this._[r(t)]=e},remove:function(t){return(t=r(t))in this._&&delete this._[t]},keys:function(){var t=[];for(var e in this._)t.push(o(e));return t},values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:o(e),value:this._[e]});return t},size:function(){var t=0;for(var e in this._)++t;return t},empty:function(){for(var t in this._)return!1;return!0},forEach:function(t){for(var e in this._)t.call(this,o(e),this._[e])}}),e}});t(D),t(e(function(t,e){!function(t,e,n,i,u){Object.defineProperty(t,"__esModule",{value:!0});var l=a(e),r=a(n),d=a(i);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=l.default.Shapes.Path,g=l.default.Shapes.Rect,_=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(v,r.default),h(v,null,[{key:"defaultProps",value:function(){return{keyField:{detail:"key字段",default:null},valueField:{detail:"value字段",default:"value"},parentField:{detail:"parent字段",default:null},node:{detail:"node",propertys:{width:{detail:"节点宽",default:18},padding:{detail:"节点间距",default:10},sort:{detail:"节点排序字段",default:function(t,e){return t.y-e.y}},fillStyle:{detail:"节点背景色",default:null}}},line:{detail:"线设置",propertys:{strokeStyle:{detail:"线颜色",default:"blue"},alpha:{detail:"线透明度",default:.3},focus:{detail:"图形的hover设置",propertys:{enabled:{detail:"是否开启",default:!0}}}}},label:{detail:"文本设置",propertys:{fontColor:{detail:"文本颜色",default:"#666666"},fontSize:{detail:"文本字体大小",default:12},textAlign:{detail:"水平对齐方式",default:"left"},verticalAlign:{detail:"垂直对齐方式",default:"middle"},format:{detail:"文本格式函数",default:null}}}}}}]),h(v,[{key:"init",value:function(){this._links=new l.default.Display.Sprite,this._nodes=new l.default.Display.Sprite,this._labels=new l.default.Display.Sprite,this.sprite.addChild(this._links),this.sprite.addChild(this._nodes),this.sprite.addChild(this._labels)}},{key:"draw",value:function(t){t=t||{},u._.extend(!0,this,t),this.data=this._trimGraphs(),this._widget(),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this.fire("complete")}},{key:"_trimGraphs",value:function(){var i=this,r=[],a=[],t=i.dataFrame.getFieldData(i.keyField),o=i.dataFrame.getFieldData(i.valueField),l=i.dataFrame.getFieldData(i.parentField),s={};return u._.each(t,function(t,e){var n=[];i.parentField&&n.push(l[e]),n=n.concat(t.split(/[|]/)),u._.each(n,function(t){void 0===s[t]&&(s[t]=r.length,r.push({name:t}))})}),u._.each(t,function(t,e){var n=[];i.parentField&&n.push(l[e]),2==(n=n.concat(t.split(/[|]/))).length&&a.push({source:s[n[0]],target:s[n[1]],value:o[e]})}),(0,d.default)().nodeWidth(this.node.width).nodePadding(this.node.padding).nodeSort(this.node.sort).size([this.width,this.height]).nodes(r).links(a).layout(16)}},{key:"_widget",value:function(){this._drawNodes(),this._drawLinks(),this._drawLabels()}},{key:"_getColor",value:function(t,e,n){var i=t;return u._.isArray(i)&&(i=i[n]),u._.isFunction(i)&&(i=i(e)),i=i||this.app.getTheme(n)}},{key:"_drawNodes",value:function(){var t=this.data.nodes(),r=this;u._.each(t,function(t,e){var n=r._getColor(r.node.fillStyle,t,e),i=new g({xyToInt:!1,context:{x:t.x,y:t.y,width:r.data.nodeWidth(),height:Math.max(t.dy,1),fillStyle:n}});i.data=t,r._nodes.addChild(i)})}},{key:"_drawLinks",value:function(){var t=this.data.links(),a=this;u._.each(t,function(t,e){var n=a._getColor(a.line.strokeStyle,t,e),i=a.data.link()(t),r=new y({xyToInt:!1,context:{path:i,fillStyle:n,globalAlpha:a.line.alpha,cursor:"pointer"}});r.__glpha=a.line.alpha,r.link=t,r.on(u.event.types.get(),function(t){a.line.focus.enabled&&("mouseover"==t.type&&(this.__glpha+=.1),"mouseout"==t.type&&(this.__glpha-=.1));var e=this.link;e.type="sankey",t.eventInfo={trigger:a.node,title:e.source.name+" --<span style='position:relative;top:-0.5px;font-size:16px;left:-3px;'>></span> "+e.target.name,nodes:[e]},a.app.fire(t.type,t)}),a._links.addChild(r)})}},{key:"_drawLabels",value:function(){var t=this.data.nodes(),o=this;u._.each(t,function(t){var e=o.label.textAlign,n=t.x+o.data.nodeWidth()+4,i=t.y+Math.max(t.dy/2,1),r=o.label.format?o.label.format(t.name,t):t.name,a=new l.default.Display.Text(r,{context:{x:n,y:i,fillStyle:o.label.fontColor,fontSize:o.label.fontSize,textAlign:e,textBaseline:o.label.verticalAlign}});o._labels.addChild(a),a.getTextWidth()+n>o.width&&(a.context.x=t.x-4,a.context.textAlign="right")})}}]),v);function v(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),(n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?f(t):e}(this,s(v).call(this,t,e))).type="sankey",u._.extend(!0,f(n),(0,u.getDefaultProps)(v.defaultProps()),t),n.init(),n}u.global.registerComponent(_,"graphs","sankey"),t.default=_}(e,n,y,D,i)})),t(e(function(t,e){!function(t,e,n,y){Object.defineProperty(t,"__esModule",{value:!0});var g=i(e);function i(t){return t&&t.__esModule?t:{default:t}}function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t){return(a=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function s(t,e,n){return e&&l(t.prototype,e),n&&l(t,n),t}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var d=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u(t,e)}(f,i(n).default),s(f,null,[{key:"defaultProps",value:function(){return{node:{detail:"进度条设置",propertys:{width:{detail:"进度条的宽度",default:20},radius:{detail:"进度条两端的圆角半径",default:10},fillStyle:{detail:"进度条的填充色",documentation:"可以是单个颜色，也可以是数组，也可以是一个函数,也可以是个lineargradient",default:null}}},label:{detail:"进度值文本",propertys:{enabled:{detail:"是否启用label",default:"true"},unit:{detail:"单位值，默认%",default:"%"},unitColor:{detail:"单位值的颜色",default:null},unitFontSize:{detail:"单位值的大小",default:14},fontColor:{detail:"label颜色",default:null},fontSize:{detail:"label文本大小",default:26},fixNum:{detail:"toFixed的位数",default:2},format:{detail:"label格式化处理函数",default:function(t){return t.toFixed(this.label.fixNum)}},lineWidth:{detail:"label文本描边线宽",default:null},strokeStyle:{detail:"label描边颜色",default:null},rotation:{detail:"label旋转角度",default:0},textAlign:{detail:"label textAlign",default:"center",values:["left","center","right"]},verticalAlign:{detail:"label verticalAlign",default:"middle",values:["top","middle","bottom"]},position:{detail:"label位置",default:"origin"},offsetX:{detail:"label在x方向的偏移量",default:0},offsetY:{detail:"label在y方向的偏移量",default:0}}},bgEnabled:{detail:"是否开启背景",default:!0},bgColor:{detail:"进度条背景颜色",default:"#f7f7f7"},radius:{detail:"半径",default:null},allAngle:{detail:"总角度",documentation:"默认为null，则和坐标系同步",default:null},startAngle:{detail:"其实角度",documentation:"默认为null，则和坐标系同步",default:null}}}}]),s(f,[{key:"init",value:function(){}},{key:"draw",value:function(t){t=t||{};var e=this;y._.extend(!0,this,t),e.grow(function(t){e.data=e._trimGraphs(t),e._widget()}),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y}},{key:"_trimGraphs",value:function(s){var u=this;null==s&&(s=1);var t=this.app.getComponent({name:"coord"});this.enabledField=t.filterEnabledFields(this.field);var d=u.startAngle||t.startAngle,f=u.allAngle||t.allAngle;startAngle,allAngle,this.bgNodeData=this._getNodeData(d,f),this.bgNodeData.fillStyle=this._getStyle(this.bgNodeData,this.bgColor);var e={};return y._.each(this.enabledField,function(o){var t=u.dataFrame.getFieldData(o),l=[];y._.each(t,function(t,e){t*=s;var n=l.slice(-1)[0],i=n?n.endAngle:d,r=f*(t/100),a=u._getNodeData(i,r,o,t,e);a.fillStyle=u._getStyle(a,u.node.fillStyle),l.push(a)}),e[o]=l}),e}},{key:"_getNodeData",value:function(t,e,n,i,r){var a=this,o=this.app.getComponent({name:"coord"}),l=t+e/2,s=t+e,u=Math.PI*t/180,d=Math.PI*l/180,f=Math.PI*s/180,c=a.radius||o.radius,h=c-a.node.width,p={field:n,value:i,text:i,iNode:r,allAngle:e,startAngle:t,middleAngle:l,endAngle:s,startRadian:u,middleRadian:d,endRadian:f,outRadius:c,innerRadius:h,startOutPoint:o.getPointInRadianOfR(u,c),middleOutPoint:o.getPointInRadianOfR(d,c),endOutPoint:o.getPointInRadianOfR(f,c),startInnerPoint:o.getPointInRadianOfR(u,h),middleInnerPoint:o.getPointInRadianOfR(d,h),endInnerPoint:o.getPointInRadianOfR(f,h),rowData:a.dataFrame.getRowDataAt(r),fillStyle:null};return n&&a.label.format&&y._.isFunction(a.label.format)&&(p.text=a.label.format.apply(this,[i,p])),p}},{key:"_widget",value:function(){var p=this;if(p.bgEnabled){var t=p._getPathStr(this.bgNodeData);p._bgPathElement?p._bgPathElement.context.path=t:(p._bgPathElement=new g.default.Shapes.Path({context:{path:t}}),p.sprite.addChild(p._bgPathElement)),p._bgPathElement.context.fillStyle=this.bgNodeData.fillStyle}y._.each(this.data,function(t){y._.each(t,function(t,e){var n=p._getPathStr(t),i="progress_bar_"+t.field+"_"+e,r=p.sprite.getChildById(i);if(r?r.context.path=n:(r=new g.default.Shapes.Path({id:i,context:{path:n}}),p.sprite.addChild(r)),r.context.fillStyle=t.fillStyle,p.label.enabled){var a="progress_label_"+t.field+"_sprite_"+e,o=p.sprite.getChildById(a);o||(o=new g.default.Display.Sprite({id:a}),p.sprite.addChild(o)),o.context.x=p.label.offsetX-6,o.context.y=p.label.offsetY;var l={fillStyle:p.label.fontColor||t.fillStyle,fontSize:p.label.fontSize,lineWidth:p.label.lineWidth,strokeStyle:p.label.strokeStyle,textAlign:p.label.textAlign,textBaseline:p.label.verticalAlign,rotation:p.label.rotation},s="progress_label_"+t.field+"_"+e;if(u=o.getChildById(s))u.resetText(t.text),y._.extend(u.context,l);else{var u=new g.default.Display.Text(t.text,{id:s,context:l});o.addChild(u)}var d="progress_label_"+t.field+"_symbol_"+e,f=o.getChildById(d),c={x:u.getTextWidth()/2+2,y:3,fillStyle:p.label.unitColor||p.label.fontColor||t.fillStyle,fontSize:p.label.unitFontSize,textAlign:"left",textBaseline:p.label.verticalAlign};if(f)y._.extend(f.context,c);else{var h=p.label.unit;f=new g.default.Display.Text(h,{id:d,context:c}),o.addChild(f)}}})})}},{key:"_getPathStr",value:function(t){var e="M"+t.startOutPoint.x+" "+t.startOutPoint.y;return e+="A"+t.outRadius+" "+t.outRadius+" 0 0 1 "+t.middleOutPoint.x+" "+t.middleOutPoint.y,e+="A"+t.outRadius+" "+t.outRadius+" 0 0 1 "+t.endOutPoint.x+" "+t.endOutPoint.y,t.allAngle,e+="L"+t.endInnerPoint.x+" "+t.endInnerPoint.y,e+="A"+t.innerRadius+" "+t.innerRadius+" 0 0 0 "+t.middleInnerPoint.x+" "+t.middleInnerPoint.y,e+="A"+t.innerRadius+" "+t.innerRadius+" 0 0 0 "+t.startInnerPoint.x+" "+t.startInnerPoint.y,e+="Z"}},{key:"_getStyle",value:function(t,e,n){var i=this.app.getComponent({name:"coord"}).getFieldMapOf(t.field);if(n=n||(i?i.color:"#171717"),e&&(y._.isString(e)&&(r=e),y._.isArray(e)&&(r=e[t.iNode]),y._.isFunction(e)&&(r=e.apply(this,arguments)),e&&e.lineargradient)){var r=this.ctx.createLinearGradient(t.startOutPoint.x,t.startOutPoint.y,t.endOutPoint.x,t.endOutPoint.y);y._.each(e.lineargradient,function(t,e){r.addColorStop(t.position,t.color)})}return r=r||n}}]),f);function f(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,f),(n=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?o(t):e}(this,a(f).call(this,t,e))).type="progress",y._.extend(!0,o(n),(0,y.getDefaultProps)(f.defaultProps()),t),n.bgNodeData=null,n.init(),n}y.global.registerComponent(d,"graphs","progress"),t.default=d}(e,n,y,i)}));var T=e(function(t,e){!function(t,h){Object.defineProperty(t,"__esModule",{value:!0}),t.arrayToTreeJsonForRelation=t.jsonToArrayForRelation=t.checkDataIsJson=void 0;var p="children";function r(t,e,n){p=n;return!!h._.isArray(t)&&(h._.every(t,function(t){return h._.isObject(t)})&&h._.every(t,function(t){return!h._.isArray(t[e])}),h._.some(t,function(t){return p in t}))}t.checkDataIsJson=r,t.jsonToArrayForRelation=function(t,e,n){p=n;var o=[],l=new WeakMap,s=e.field||"__key__",u=e.node&&e.node.content&&e.node.content.field;if(!r(t,s,p))return console.error("该数据不能正确绘制，请提供数组对象形式的数据！"),o;var d=[],f=0,c=void 0;h._.each(t,function(t){d.push(t)});for(var i=function(){c[s]||(c[s]=f);var t=c[p];t&&(h._.each(t,function(t){l.set(t,{parentIndex:f,parentNode:c})}),d=d.concat(t.reverse()));var n={};h._.each(c,function(t,e){e!==p&&(n[e]=t)}),o.push(n);var e=l.get(c);if(e){var i=e.parentIndex,r=e.parentNode,a={};a.key=[i,f].join(","),u&&(a[u]=[r[u],c[u]].join("_")),o.push(a)}f++};c=d.pop();)i();return o},t.arrayToTreeJsonForRelation=function(t,n){var a={},o={};h._.each(t,function(t){var e=t[n.field];1==e.split(",").length?a[e]=t:o[e]=t});var e=[];return h._.each(a,function(t,n){var i=!0;h._.each(o,function(t,e){if(e.split(",")[1]==n)return i=!1}),i&&(e.push(t),t.__inRelation=!0)}),function e(t){h._.each(t,function(i,t){if(!i.__cycle){var r=i[n.field];h._.each(o,function(t,e){if(e.split(",")[0]==r){var n=a[e.split(",")[1]];n&&(i.children||(i.children=[]),i.children.push(n),n.__inRelation&&(n.__cycle=!0))}}),i.children&&i.children.length&&e(i.children)}})}(e),e}}(e,i)});t(T),t(e(function(t,e){!function(t,e,n,h,s){Object.defineProperty(t,"__esModule",{value:!0});var l=r(e),i=r(n);function r(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=l.default.Shapes.Rect,g=l.default.Shapes.Path,_=l.default.Shapes.Arrow,v=(l.default.Shapes.Circle,function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(x,i.default),c(x,null,[{key:"defaultProps",value:function(){return{field:{detail:"key字段设置",documentation:"",default:null},childrenField:{detail:"树结构数据的关联字段",documentation:"如果是树结构的关联数据，不是行列式，那么就通过这个字段来建立父子关系",default:"children"},rankdir:{detail:"布局方向",default:null},node:{detail:"单个节点的配置",propertys:{shapeType:{detail:"节点图形，目前只支持rect",default:"rect"},maxWidth:{detail:"节点最大的width",default:200},width:{detail:"内容的width",default:null},height:{detail:"内容的height",default:null},radius:{detail:"圆角角度",default:6},fillStyle:{detail:"节点背景色",default:"#ffffff"},strokeStyle:{detail:"描边颜色",default:"#e5e5e5"},padding:{detail:"node节点容器到内容的边距",default:10},content:{detail:"节点内容配置",propertys:{field:{detail:"内容字段",documentation:"默认content字段",default:"content"},fontColor:{detail:"内容文本颜色",default:"#666"},format:{detail:"内容格式化处理函数",default:null},textAlign:{detail:"textAlign",default:"center"},textBaseline:{detail:"textBaseline",default:"middle"}}}}},line:{detail:"两个节点连线配置",propertys:{isTree:{detail:"是否树结构的连线",documentation:"非树结构启用该配置可能会有意想不到的惊喜，慎用",default:!1},inflectionRadius:{detail:"树状连线的拐点圆角半径",default:0},shapeType:{detail:"连线的图形样式 brokenLine or bezier",default:"bezier"},lineWidth:{detail:"线宽",default:1},strokeStyle:{detail:"连线的颜色",default:"#e5e5e5"},lineType:{detail:"连线样式（虚线等）",default:"solid"},arrow:{detail:"是否有箭头",default:!0}}},layout:{detail:"采用的布局引擎,比如dagre",default:"dagre"},layoutOpts:{detail:"布局引擎对应的配置,dagre详见dagre的官方wiki",propertys:{}},status:{detail:"一些开关配置",propertys:{transform:{detail:"是否启动拖拽缩放整个画布",propertys:{fitView:{detail:"自动缩放",default:""},enabled:{detail:"是否开启",default:!0},scale:{detail:"缩放值",default:1},scaleOrigin:{detail:"缩放原点",default:{x:0,y:0}}}}}}}}}]),c(x,[{key:"init",value:function(){this.initInduce(),this.nodesSp=new l.default.Display.Sprite({id:"nodesSp"}),this.edgesSp=new l.default.Display.Sprite({id:"edgesSp"}),this.graphsSp=new l.default.Display.Sprite({id:"graphsSp"}),this.graphsSp.addChild(this.edgesSp),this.graphsSp.addChild(this.nodesSp),this._grahsSpClone=new l.default.Display.Sprite({id:"graphsSp_clone"}),this.sprite.addChild(this.graphsSp),this.sprite.addChild(this._grahsSpClone),window.gsp=this.graphsSp}},{key:"initInduce",value:function(){var r=this;this.induce=new y({id:"induce",context:{width:0,height:0,fillStyle:"#000000",globalAlpha:0}}),this.sprite.addChild(this.induce);var t=!1,e=null,n=r.app.canvax.domView.style.cursor,a=null,o=0;this.induce.on(h.event.types.get(),function(i){r.status.transform.enabled&&("mousedown"==i.type&&(r.induce.toFront(),t=!0,e=i.point,r.app.canvax.domView.style.cursor="move"),"mouseup"!=i.type&&"mouseout"!=i.type||(r.induce.toBack(),t=!1,e=null,r.app.canvax.domView.style.cursor=n),"mousemove"==i.type&&t&&(r.graphsSp.context.x+=i.point.x-e.x,r.graphsSp.context.y+=i.point.y-e.y,e=i.point),"wheel"==i.type&&(Math.abs(i.deltaY)>Math.abs(o)&&(o=i.deltaY),a=a||setTimeout(function(){var t=i.deltaY/30*.02;Math.abs(t)<.04&&(t=.04*Math.sign(t)),.08<Math.abs(t)&&(t=.08*Math.sign(t));var e=r.status.transform.scale+t;e<=.1&&(e=.1),1<=e&&(e=1);var n=i.target.localToGlobal(i.point);r.scale(e,n),a=null,o=0},32),i.preventDefault()))})}},{key:"scale",value:function(){}},{key:"draw",value:function(t){t=t||{},h._.extend(!0,this,t),this.data=t.data||this._initData(),"dagre"==this.layout?this.dagreLayout(this.data):"tree"==this.layout?this.treeLayout(this.data):h._.isFunction(this.layout)&&this.layout(this.data),this.widget(),this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,"autoZoom"==this.status.transform.fitView&&(this.sprite.context.scaleX=this.width/this.data.size.width,this.sprite.context.scaleY=this.height/this.data.size.height);var e=(this.width-this.data.size.width)/2;e<0&&(e=0),this.graphsSp.context.x=e,this._grahsSpClone.context.x=e}},{key:"_initData",value:function(){var t={nodes:[],edges:[],size:{width:0,height:0}},e=this.app._data;(0,s.checkDataIsJson)(e,this.field,this.childrenField)?(this.jsonData=(0,s.jsonToArrayForRelation)(e,this,this.childrenField),this.dataFrame=this.app.dataFrame=(0,h.dataFrame)(this.jsonData)):"tree"==this.layout&&(this.jsonData=(0,s.arrayToTreeJsonForRelation)(this.app.dataFrame.jsonOrg,this));for(var n={},i=0;i<this.dataFrame.length;i++){var r=this.dataFrame.getRowDataAt(i),a=h._.flatten([(r[this.field]+"").split(",")]),o=this._getContent(r),l={type:"relation",iNode:i,rowData:r,key:1==a.length?a[0]:a,content:o,ctype:this._checkHtml(o)?"html":"canvas",element:null,width:null,height:null,x:null,y:null,shapeType:null,source:null,target:null};h._.extend(l,this._getElementAndSize(l)),1==a.length?(l.shapeType=this.getProp(this.node.shapeType,l),t.nodes.push(l),n[l.key]=l):(l.shapeType=this.getProp(this.line.shapeType,l),t.edges.push(l))}return h._.each(t.edges,function(t){var e=t.key;t.source=n[e[0]],t.target=n[e[1]]}),t}},{key:"dagreLayout",value:function(t){var e=h.global.layout.dagre,n=new e.graphlib.Graph;return n.setGraph(this.layoutOpts.graph),n.setDefaultEdgeLabel(function(){return{}}),h._.each(t.nodes,function(t){n.setNode(t.key,t)}),h._.each(t.edges,function(t){n.setEdge.apply(n,o(t.key).concat([t]))}),e.layout(n),t.size.width=n.graph().width,t.size.height=n.graph().height,t}},{key:"treeLayout",value:function(){var t=h.global.layout.tree().separation(function(t,e){return(t.width+e.width)/2+10}),e=t.nodes(this.jsonData[0]).reverse();t.links(e)}},{key:"widget",value:function(){var o=this;h._.each(this.data.edges,function(t){o.line.isTree&&o._setTreePoints(t);var e=o.getProp(o.line.lineWidth,t),n=o.getProp(o.line.strokeStyle,t),i=new g({context:{path:o._getPathStr(t,o.line.inflectionRadius),lineWidth:e,strokeStyle:n}}),r=t.points.slice(-2,-1)[0];if("bezier"==o.line.shapeType&&("TB"!=o.rankdir&&"BT"!=o.rankdir||(r.x+=(t.source.x-t.target.x)/20),"LR"!=o.rankdir&&"RL"!=o.rankdir||(r.y+=(t.source.y-t.target.y)/20)),o.edgesSp.addChild(i),o.line.arrow){var a=new _({context:{control:r,point:t.points.slice(-1)[0],strokeStyle:n}});o.edgesSp.addChild(a)}}),h._.each(this.data.nodes,function(e){var n=new y({context:{x:e.x-e.width/2,y:e.y-e.height/2,width:e.width,height:e.height,lineWidth:1,fillStyle:o.getProp(o.node.fillStyle,e),strokeStyle:o.getProp(o.node.strokeStyle,e),radius:h._.flatten([o.getProp(o.node.radius,e)])}});n.nodeData=e,o.nodesSp.addChild(n),n.on(h.event.types.get(),function(t){t.eventInfo={trigger:o.node,nodes:[this.nodeData]},o.app.fire(t.type,t)}),"canvas"==e.ctype&&(e.element.context.x=e.x-e.width/2,e.element.context.y=e.y-e.height/2,o.nodesSp.addChild(e.element)),"html"==e.ctype&&n.on("transform",function(){var t="undefined"!=typeof window?window.devicePixelRatio:1;e.element.style.transform="matrix("+n.worldTransform.clone().scale(1/t,1/t).toArray().join()+")",e.element.style.transformOrigin="left top",e.element.style.marginLeft=o.getProp(o.node.padding,e)*o.status.transform.scale+"px",e.element.style.marginTop=o.getProp(o.node.padding,e)*o.status.transform.scale+"px",e.element.style.visibility="visible"})}),this.induce.context.width=this.width,this.induce.context.height=this.height}},{key:"_setTreePoints",value:function(t){var e=t.points;"TB"!=this.rankdir&&"BT"!=this.rankdir||(e[0]={x:t.source.x,y:t.source.y+("BT"==this.rankdir?-1:1)*t.source.height/2},e.splice(1,0,{x:t.source.x,y:e.slice(-2,-1)[0].y})),"LR"!=this.rankdir&&"RL"!=this.rankdir||(e[0]={x:t.source.x+("RL"==this.rankdir?-1:1)*t.source.width/2,y:t.source.y},e.splice(1,0,{x:e.slice(-2,-1)[0].x,y:t.source.y})),t.points=e}},{key:"_getPathStr",value:function(t,d){var f=t.points,e=f[0],n=f.slice(-1)[0],c="M"+e.x+" "+e.y;return"bezier"==t.shapeType&&(3==f.length&&(c+=",Q"+f[1].x+" "+f[1].y+" "+n.x+" "+n.y),4==f.length&&(c+=",C"+f[1].x+" "+f[1].y+" "+f[2].x+" "+f[2].y+" "+n.x+" "+n.y)),"brokenLine"==t.shapeType&&h._.each(f,function(n,t){if(t)if(d&&t<f.length-1){var e=f[t-1],i=f[t+1],r=d,a=Math.max(Math.abs(e.x-n.x)/2,Math.abs(e.y-n.y)/2),o=Math.max(Math.abs(i.x-n.x)/2,Math.abs(i.y-n.y)/2);if(r=h._.min([r,a,o]),n.x==e.x&&n.y==e.y||n.x==i.x&&n.y==i.y||Math.atan2(n.y-e.y,n.x-e.x)==Math.atan2(i.y-n.y,i.x-n.x))return;var l=function(t){var e=Math.atan2(t.y-n.y,t.x-n.x);return{x:n.x+r*Math.cos(e),y:n.y+r*Math.sin(e)}},s=l(e),u=l(i);c+=",L"+s.x+" "+s.y+",Q"+n.x+" "+n.y+" "+u.x+" "+u.y}else c+=",L"+n.x+" "+n.y}),c}},{key:"_checkHtml",value:function(t){return/<[^>]+>/g.test(t)}},{key:"_getContent",value:function(t){var e;return this._isField(this.node.content.field)&&(e=t[this.node.content.field]),this.node.content.format&&h._.isFunction(this.node.content.format)&&(e=this.node.content.format.apply(this,[e,t])),e}},{key:"_isField",value:function(t){return~this.dataFrame.fields.indexOf(t)}},{key:"_getElementAndSize",value:function(t){var e=t.ctype;return this._isField(e)&&(e=t.rowData[e]),"canvas"==(e=e||"canvas")?this._getEleAndsetCanvasSize(t):"html"==e?this._getEleAndsetHtmlSize(t):void 0}},{key:"_getEleAndsetCanvasSize",value:function(t){var e=this,n=t.content,i=t.rowData.width,r=t.rowData.height,a=new l.default.Display.Sprite({}),o=new l.default.Display.Text(n,{context:{fillStyle:e.getProp(e.node.content.fontColor,t),textAlign:e.getProp(e.node.content.textAlign,t),textBaseline:e.getProp(e.node.content.textBaseline,t)}});return i=i||o.getTextWidth()+e.getProp(e.node.padding,t)*e.status.transform.scale*2,r=r||o.getTextHeight()+e.getProp(e.node.padding,t)*e.status.transform.scale*2,a.addChild(o),a.context.width=parseInt(i),a.context.height=parseInt(r),o.context.x=parseInt(i/2),o.context.y=parseInt(r/2),{element:a,width:i,height:r}}},{key:"_getEleAndsetHtmlSize",value:function(t){var e=this,n=t.content,i=t.rowData.width,r=t.rowData.height,a=document.createElement("div");return a.className="chartx_relation_node",a.style.cssText+="; position:absolute;visibility:hidden;",a.style.cssText+="; color:"+e.getProp(e.node.content.fontColor,t)+";",a.style.cssText+="; text-align:"+e.getProp(e.node.content.textAlign,t)+";",a.style.cssText+="; vertical-align:"+e.getProp(e.node.content.textBaseline,t)+";",a.innerHTML=n,this.domContainer.appendChild(a),{element:a,width:i=i||a.offsetWidth+e.getProp(e.node.padding,t)*e.status.transform.scale*2,height:r=r||a.offsetHeight+e.getProp(e.node.padding,t)*e.status.transform.scale*2}}},{key:"getNodesAt",value:function(){}},{key:"getProp",value:function(t,e){var n=t;return this._isField(t)?n=e.rowData[t]:(h._.isArray(t)&&(n=t[e.iNode]),h._.isFunction(t)&&(n=t.apply(this,[e]))),n}}]),x);function x(t,e){var n;if(!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,x),(n=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?d(t):e}(this,u(x).call(this,t,e))).type="relation",h._.extend(!0,d(n),(0,h.getDefaultProps)(x.defaultProps()),t),"dagre"===n.layout){var i={graph:{rankdir:"TB",nodesep:10,ranksep:10,edgesep:10,acyclicer:"greedy"},node:{},edge:{}};h._.extend(!0,i,n.layoutOpts),h._.extend(!0,n.layoutOpts,i),n.rankdir?n.layoutOpts.graph.rankdir=n.rankdir:n.rankdir=n.layoutOpts.graph.rankdir}return n.domContainer=e.canvax.domView,n.induce=null,n.init(),n}h.global.registerComponent(v,"graphs","relation"),t.default=v}(e,n,y,i,T)}));var L=e(function(t,e){function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n,i;n=t,i=e,function(t){"object"===(void 0===i?"undefined":c(i))&&void 0!==n?n.exports=t():("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this).dagre=t()}(function(){return function r(a,o,l){function s(e,t){if(!o[e]){if(!a[e]){if(!t&&d)return d(e,!0);if(u)return u(e,!0);var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}var i=o[e]={exports:{}};a[e][0].call(i.exports,function(t){return s(a[e][1][t]||t)},i,i.exports,r,a,o,l)}return o[e].exports}for(var u=d,t=0;t<l.length;t++)s(l[t]);return s}({1:[function(t,e,n){e.exports={graphlib:t("./lib/graphlib"),layout:t("./lib/layout"),debug:t("./lib/debug"),util:{time:t("./lib/util").time,notime:t("./lib/util").notime},version:t("./lib/version")}},{"./lib/debug":6,"./lib/graphlib":7,"./lib/layout":9,"./lib/util":29,"./lib/version":30}],2:[function(t,e,n){var l=t("./lodash"),s=t("./greedy-fas");e.exports={run:function(n){var i,r,a,o,e,t="greedy"===n.graph().acyclicer?s(n,(e=n,function(t){return e.edge(t).weight})):(i=n,r=[],a={},o={},l.forEach(i.nodes(),function e(t){l.has(o,t)||(o[t]=!0,a[t]=!0,l.forEach(i.outEdges(t),function(t){l.has(a,t.w)?r.push(t):e(t.w)}),delete a[t])}),r);l.forEach(t,function(t){var e=n.edge(t);n.removeEdge(t),e.forwardName=t.name,e.reversed=!0,n.setEdge(t.w,t.v,e,l.uniqueId("rev"))})},undo:function(i){l.forEach(i.edges(),function(t){var e=i.edge(t);if(e.reversed){i.removeEdge(t);var n=e.forwardName;delete e.reversed,delete e.forwardName,i.setEdge(t.w,t.v,e,n)}})}}},{"./greedy-fas":8,"./lodash":10}],3:[function(t,e,n){var l=t("./lodash"),u=t("./util");function s(t,e,n,i,r,a){var o={width:0,height:0,rank:a,borderType:e},l=r[e][a-1],s=u.addDummyNode(t,"border",o,n);r[e][a]=s,t.setParent(s,i),l&&t.setEdge(l,s,{weight:1})}e.exports=function(o){l.forEach(o.children(),function t(e){var n=o.children(e),i=o.node(e);if(n.length&&l.forEach(n,t),l.has(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var r=i.minRank,a=i.maxRank+1;r<a;++r)s(o,"borderLeft","_bl",e,i,r),s(o,"borderRight","_br",e,i,r)}})}},{"./lodash":10,"./util":29}],4:[function(t,e,n){var r=t("./lodash");function a(e){r.forEach(e.nodes(),function(t){i(e.node(t))}),r.forEach(e.edges(),function(t){i(e.edge(t))})}function i(t){var e=t.width;t.width=t.height,t.height=e}function o(t){t.y=-t.y}function l(t){var e=t.x;t.x=t.y,t.y=e}e.exports={adjust:function(t){var e=t.graph().rankdir.toLowerCase();"lr"!==e&&"rl"!==e||a(t)},undo:function(t){var n,i,e=t.graph().rankdir.toLowerCase();"bt"!==e&&"rl"!==e||(n=t,r.forEach(n.nodes(),function(t){o(n.node(t))}),r.forEach(n.edges(),function(t){var e=n.edge(t);r.forEach(e.points,o),r.has(e,"y")&&o(e)})),"lr"!==e&&"rl"!==e||(i=t,r.forEach(i.nodes(),function(t){l(i.node(t))}),r.forEach(i.edges(),function(t){var e=i.edge(t);r.forEach(e.points,l),r.has(e,"x")&&l(e)}),a(t))}}},{"./lodash":10}],5:[function(t,e,n){function i(){var t={};t._next=t._prev=t,this._sentinel=t}function r(t){t._prev._next=t._next,t._next._prev=t._prev,delete t._next,delete t._prev}function a(t,e){if("_next"!==t&&"_prev"!==t)return e}(e.exports=i).prototype.dequeue=function(){var t=this._sentinel,e=t._prev;if(e!==t)return r(e),e},i.prototype.enqueue=function(t){var e=this._sentinel;t._prev&&t._next&&r(t),t._next=e._next,e._next._prev=t,(e._next=t)._prev=e},i.prototype.toString=function(){for(var t=[],e=this._sentinel,n=e._prev;n!==e;)t.push(JSON.stringify(n,a)),n=n._prev;return"["+t.join(", ")+"]"}},{}],6:[function(t,e,n){var r=t("./lodash"),a=t("./util"),o=t("./graphlib").Graph;e.exports={debugOrdering:function(e){var t=a.buildLayerMatrix(e),i=new o({compound:!0,multigraph:!0}).setGraph({});return r.forEach(e.nodes(),function(t){i.setNode(t,{label:t}),i.setParent(t,"layer"+e.node(t).rank)}),r.forEach(e.edges(),function(t){i.setEdge(t.v,t.w,{},t.name)}),r.forEach(t,function(t,e){var n="layer"+e;i.setNode(n,{rank:"same"}),r.reduce(t,function(t,e){return i.setEdge(t,e,{style:"invis"}),e})}),i}}},{"./graphlib":7,"./lodash":10,"./util":29}],7:[function(t,e,n){var i;if("function"==typeof t)try{i=t("graphlib")}catch(t){}i=i||window.graphlib,e.exports=i},{graphlib:31}],8:[function(t,e,n){var s=t("./lodash"),u=t("./graphlib").Graph,d=t("./data/list");e.exports=function(e,t){if(e.nodeCount()<=1)return[];var n=function(t,r){var a=new u,o=0,l=0;s.forEach(t.nodes(),function(t){a.setNode(t,{v:t,in:0,out:0})}),s.forEach(t.edges(),function(t){var e=a.edge(t.v,t.w)||0,n=r(t),i=e+n;a.setEdge(t.v,t.w,i),l=Math.max(l,a.node(t.v).out+=n),o=Math.max(o,a.node(t.w).in+=n)});var e=s.range(l+o+3).map(function(){return new d}),n=o+1;return s.forEach(a.nodes(),function(t){c(e,n,a.node(t))}),{graph:a,buckets:e,zeroIdx:n}}(e,t||r),i=function(t,e,n){for(var i,r=[],a=e[e.length-1],o=e[0];t.nodeCount();){for(;i=o.dequeue();)f(t,e,n,i);for(;i=a.dequeue();)f(t,e,n,i);if(t.nodeCount())for(var l=e.length-2;0<l;--l)if(i=e[l].dequeue()){r=r.concat(f(t,e,n,i,!0));break}}return r}(n.graph,n.buckets,n.zeroIdx);return s.flatten(s.map(i,function(t){return e.outEdges(t.v,t.w)}),!0)};var r=s.constant(1);function f(r,a,o,t,i){var l=i?[]:void 0;return s.forEach(r.inEdges(t.v),function(t){var e=r.edge(t),n=r.node(t.v);i&&l.push({v:t.v,w:t.w}),n.out-=e,c(a,o,n)}),s.forEach(r.outEdges(t.v),function(t){var e=r.edge(t),n=t.w,i=r.node(n);i.in-=e,c(a,o,i)}),r.removeNode(t.v),l}function c(t,e,n){n.out?n.in?t[n.out-n.in+e].enqueue(n):t[t.length-1].enqueue(n):t[0].enqueue(n)}},{"./data/list":5,"./graphlib":7,"./lodash":10}],9:[function(t,e,n){var d=t("./lodash"),i=t("./acyclic"),r=t("./normalize"),o=t("./rank"),l=t("./util").normalizeRanks,s=t("./parent-dummy-chains"),f=t("./util").removeEmptyRanks,c=t("./nesting-graph"),h=t("./add-border-segments"),p=t("./coordinate-system"),y=t("./order"),g=t("./position"),_=t("./util"),u=t("./graphlib").Graph;e.exports=function(a,t){var n=t&&t.debugTiming?_.time:_.notime;n("layout",function(){var e=n("  buildLayoutGraph",function(){return n=a,i=new u({multigraph:!0,compound:!0}),t=P(n.graph()),i.setGraph(d.merge({},x,O(t,v),d.pick(t,b))),d.forEach(n.nodes(),function(t){var e=P(n.node(t));i.setNode(t,d.defaults(O(e,m),w)),i.setParent(t,n.parent(t))}),d.forEach(n.edges(),function(t){var e=P(n.edge(t));i.setEdge(t,d.merge({},k,O(e,S),d.pick(e,A)))}),i;var n,i,t});n("  runLayout",function(){var u,t;u=e,(t=n)("    makeSpaceForEdgeLabels",function(){var n,i;(i=(n=u).graph()).ranksep/=2,d.forEach(n.edges(),function(t){var e=n.edge(t);e.minlen*=2,"c"!==e.labelpos.toLowerCase()&&("TB"===i.rankdir||"BT"===i.rankdir?e.width+=e.labeloffset:e.height+=e.labeloffset)})}),t("    removeSelfEdges",function(){var n;n=u,d.forEach(n.edges(),function(t){if(t.v===t.w){var e=n.node(t.v);e.selfEdges||(e.selfEdges=[]),e.selfEdges.push({e:t,label:n.edge(t)}),n.removeEdge(t)}})}),t("    acyclic",function(){i.run(u)}),t("    nestingGraph.run",function(){c.run(u)}),t("    rank",function(){o(_.asNonCompoundGraph(u))}),t("    injectEdgeLabelProxies",function(){var r;r=u,d.forEach(r.edges(),function(t){var e=r.edge(t);if(e.width&&e.height){var n=r.node(t.v),i={rank:(r.node(t.w).rank-n.rank)/2+n.rank,e:t};_.addDummyNode(r,"edge-proxy",i,"_ep")}})}),t("    removeEmptyRanks",function(){f(u)}),t("    nestingGraph.cleanup",function(){c.cleanup(u)}),t("    normalizeRanks",function(){l(u)}),t("    assignRankMinMax",function(){var n,i;n=u,i=0,d.forEach(n.nodes(),function(t){var e=n.node(t);e.borderTop&&(e.minRank=n.node(e.borderTop).rank,e.maxRank=n.node(e.borderBottom).rank,i=d.max(i,e.maxRank))}),n.graph().maxRank=i}),t("    removeEdgeLabelProxies",function(){var n;n=u,d.forEach(n.nodes(),function(t){var e=n.node(t);"edge-proxy"===e.dummy&&(n.edge(e.e).labelRank=e.rank,n.removeNode(t))})}),t("    normalize.run",function(){r.run(u)}),t("    parentDummyChains",function(){s(u)}),t("    addBorderSegments",function(){h(u)}),t("    order",function(){y(u)}),t("    insertSelfEdges",function(){var r,t;r=u,t=_.buildLayerMatrix(r),d.forEach(t,function(t){var i=0;d.forEach(t,function(t,e){var n=r.node(t);n.order=e+i,d.forEach(n.selfEdges,function(t){_.addDummyNode(r,"selfedge",{width:t.label.width,height:t.label.height,rank:n.rank,order:e+ ++i,e:t.e,label:t.label},"_se")}),delete n.selfEdges})})}),t("    adjustCoordinateSystem",function(){p.adjust(u)}),t("    position",function(){g(u)}),t("    positionSelfEdges",function(){var l;l=u,d.forEach(l.nodes(),function(t){var e=l.node(t);if("selfedge"===e.dummy){var n=l.node(e.e.v),i=n.x+n.width/2,r=n.y,a=e.x-i,o=n.height/2;l.setEdge(e.e,e.label),l.removeNode(t),e.label.points=[{x:i+2*a/3,y:r-o},{x:i+5*a/6,y:r-o},{x:i+a,y:r},{x:i+5*a/6,y:r+o},{x:i+2*a/3,y:r+o}],e.label.x=e.x,e.label.y=e.y}})}),t("    removeBorderNodes",function(){var o;o=u,d.forEach(o.nodes(),function(t){if(o.children(t).length){var e=o.node(t),n=o.node(e.borderTop),i=o.node(e.borderBottom),r=o.node(d.last(e.borderLeft)),a=o.node(d.last(e.borderRight));e.width=Math.abs(a.x-r.x),e.height=Math.abs(i.y-n.y),e.x=r.x+e.width/2,e.y=n.y+e.height/2}}),d.forEach(o.nodes(),function(t){"border"===o.node(t).dummy&&o.removeNode(t)})}),t("    normalize.undo",function(){r.undo(u)}),t("    fixupEdgeLabelCoords",function(){var n;n=u,d.forEach(n.edges(),function(t){var e=n.edge(t);if(d.has(e,"x"))switch("l"!==e.labelpos&&"r"!==e.labelpos||(e.width-=e.labeloffset),e.labelpos){case"l":e.x-=e.width/2+e.labeloffset;break;case"r":e.x+=e.width/2+e.labeloffset}})}),t("    undoCoordinateSystem",function(){p.undo(u)}),t("    translateGraph",function(){function n(t){var e=t.x,n=t.y,i=t.width,r=t.height;a=Math.min(a,e-i/2),o=Math.max(o,e+i/2),l=Math.min(l,n-r/2),s=Math.max(s,n+r/2)}var i,a,o,l,s,t,e,r;i=u,a=Number.POSITIVE_INFINITY,o=0,l=Number.POSITIVE_INFINITY,s=0,t=i.graph(),e=t.marginx||0,r=t.marginy||0,d.forEach(i.nodes(),function(t){n(i.node(t))}),d.forEach(i.edges(),function(t){var e=i.edge(t);d.has(e,"x")&&n(e)}),a-=e,l-=r,d.forEach(i.nodes(),function(t){var e=i.node(t);e.x-=a,e.y-=l}),d.forEach(i.edges(),function(t){var e=i.edge(t);d.forEach(e.points,function(t){t.x-=a,t.y-=l}),d.has(e,"x")&&(e.x-=a),d.has(e,"y")&&(e.y-=l)}),t.width=o-a+e,t.height=s-l+r}),t("    assignNodeIntersects",function(){var o;o=u,d.forEach(o.edges(),function(t){var e,n,i=o.edge(t),r=o.node(t.v),a=o.node(t.w);n=i.points?(e=i.points[0],i.points[i.points.length-1]):(i.points=[],e=a,r),i.points.unshift(_.intersectRect(r,e)),i.points.push(_.intersectRect(a,n))})}),t("    reversePoints",function(){var n;n=u,d.forEach(n.edges(),function(t){var e=n.edge(t);e.reversed&&e.points.reverse()})}),t("    acyclic.undo",function(){i.undo(u)})}),n("  updateInputGraph",function(){var i,r;i=a,r=e,d.forEach(i.nodes(),function(t){var e=i.node(t),n=r.node(t);e&&(e.x=n.x,e.y=n.y,r.children(t).length&&(e.width=n.width,e.height=n.height))}),d.forEach(i.edges(),function(t){var e=i.edge(t),n=r.edge(t);e.points=n.points,d.has(n,"x")&&(e.x=n.x,e.y=n.y)}),i.graph().width=r.graph().width,i.graph().height=r.graph().height})})};var v=["nodesep","edgesep","ranksep","marginx","marginy"],x={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},b=["acyclicer","ranker","rankdir","align"],m=["width","height"],w={width:0,height:0},S=["minlen","weight","width","height","labeloffset"],k={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},A=["labelpos"];function O(t,e){return d.mapValues(d.pick(t,e),Number)}function P(t){var n={};return d.forEach(t,function(t,e){n[e.toLowerCase()]=t}),n}},{"./acyclic":2,"./add-border-segments":3,"./coordinate-system":4,"./graphlib":7,"./lodash":10,"./nesting-graph":11,"./normalize":12,"./order":17,"./parent-dummy-chains":22,"./position":24,"./rank":26,"./util":29}],10:[function(t,e,n){var i;if("function"==typeof t)try{i={cloneDeep:t("lodash/cloneDeep"),constant:t("lodash/constant"),defaults:t("lodash/defaults"),each:t("lodash/each"),filter:t("lodash/filter"),find:t("lodash/find"),flatten:t("lodash/flatten"),forEach:t("lodash/forEach"),forIn:t("lodash/forIn"),has:t("lodash/has"),isUndefined:t("lodash/isUndefined"),last:t("lodash/last"),map:t("lodash/map"),mapValues:t("lodash/mapValues"),max:t("lodash/max"),merge:t("lodash/merge"),min:t("lodash/min"),minBy:t("lodash/minBy"),now:t("lodash/now"),pick:t("lodash/pick"),range:t("lodash/range"),reduce:t("lodash/reduce"),sortBy:t("lodash/sortBy"),uniqueId:t("lodash/uniqueId"),values:t("lodash/values"),zipObject:t("lodash/zipObject")}}catch(t){}i=i||window._,e.exports=i},{"lodash/cloneDeep":227,"lodash/constant":228,"lodash/defaults":229,"lodash/each":230,"lodash/filter":232,"lodash/find":233,"lodash/flatten":235,"lodash/forEach":236,"lodash/forIn":237,"lodash/has":239,"lodash/isUndefined":258,"lodash/last":261,"lodash/map":262,"lodash/mapValues":263,"lodash/max":264,"lodash/merge":266,"lodash/min":267,"lodash/minBy":268,"lodash/now":270,"lodash/pick":271,"lodash/range":273,"lodash/reduce":274,"lodash/sortBy":276,"lodash/uniqueId":286,"lodash/values":287,"lodash/zipObject":288}],11:[function(t,e,n){var g=t("./lodash"),_=t("./util");e.exports={run:function(e){var r,a,n=_.addDummyNode(e,"root",{},"_root"),i=(r=e,a={},g.forEach(r.children(),function(t){!function e(t,n){var i=r.children(t);i&&i.length&&g.forEach(i,function(t){e(t,n+1)}),a[t]=n}(t,1)}),a),o=g.max(g.values(i))-1,l=2*o+1;e.graph().nestingRoot=n,g.forEach(e.edges(),function(t){e.edge(t).minlen*=l});var s,u=(s=e,g.reduce(s.edges(),function(t,e){return t+s.edge(e).weight},0)+1);g.forEach(e.children(),function(t){!function o(l,s,u,d,f,c,h){var t=l.children(h);if(t.length){var p=_.addBorderNode(l,"_bt"),y=_.addBorderNode(l,"_bb"),e=l.node(h);l.setParent(p,h),e.borderTop=p,l.setParent(y,h),e.borderBottom=y,g.forEach(t,function(t){o(l,s,u,d,f,c,t);var e=l.node(t),n=e.borderTop?e.borderTop:t,i=e.borderBottom?e.borderBottom:t,r=e.borderTop?d:2*d,a=n!==i?1:f-c[h]+1;l.setEdge(p,n,{weight:r,minlen:a,nestingEdge:!0}),l.setEdge(i,y,{weight:r,minlen:a,nestingEdge:!0})}),l.parent(h)||l.setEdge(s,p,{weight:0,minlen:f+c[h]})}else h!==s&&l.setEdge(s,h,{weight:0,minlen:u})}(e,n,l,u,o,i,t)}),e.graph().nodeRankFactor=l},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,g.forEach(e.edges(),function(t){e.edge(t).nestingEdge&&e.removeEdge(t)})}}},{"./lodash":10,"./util":29}],12:[function(t,e,n){var i=t("./lodash"),c=t("./util");e.exports={run:function(e){e.graph().dummyChains=[],i.forEach(e.edges(),function(t){!function(t,e){var n,i,r,a=e.v,o=t.node(a).rank,l=e.w,s=t.node(l).rank,u=e.name,d=t.edge(e),f=d.labelRank;if(s!==o+1){for(t.removeEdge(e),r=0,++o;o<s;++r,++o)d.points=[],i={width:0,height:0,edgeLabel:d,edgeObj:e,rank:o},n=c.addDummyNode(t,"edge",i,"_d"),o===f&&(i.width=d.width,i.height=d.height,i.dummy="edge-label",i.labelpos=d.labelpos),t.setEdge(a,n,{weight:d.weight},u),0===r&&t.graph().dummyChains.push(n),a=n;t.setEdge(a,l,{weight:d.weight},u)}}(e,t)})},undo:function(r){i.forEach(r.graph().dummyChains,function(t){var e,n=r.node(t),i=n.edgeLabel;for(r.setEdge(n.edgeObj,i);n.dummy;)e=r.successors(t)[0],r.removeNode(t),i.points.push({x:n.x,y:n.y}),"edge-label"===n.dummy&&(i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height),t=e,n=r.node(t)})}}},{"./lodash":10,"./util":29}],13:[function(t,e,n){var i=t("../lodash");e.exports=function(r,a,t){var o,l={};i.forEach(t,function(t){for(var e,n,i=r.parent(t);i;){if((e=r.parent(i))?(n=l[e],l[e]=i):(n=o,o=i),n&&n!==i)return void a.setEdge(n,i);i=e}})}},{"../lodash":10}],14:[function(t,e,n){var i=t("../lodash");e.exports=function(r,t){return i.map(t,function(t){var e=r.inEdges(t);if(e.length){var n=i.reduce(e,function(t,e){var n=r.edge(e),i=r.node(e.v);return{sum:t.sum+n.weight*i.order,weight:t.weight+n.weight}},{sum:0,weight:0});return{v:t,barycenter:n.sum/n.weight,weight:n.weight}}return{v:t}})}},{"../lodash":10}],15:[function(t,e,n){var s=t("../lodash"),r=t("../graphlib").Graph;e.exports=function(a,n,i){var o=function(t){for(var e;t.hasNode(e=s.uniqueId("_root")););return e}(a),l=new r({compound:!0}).setGraph({root:o}).setDefaultNodeLabel(function(t){return a.node(t)});return s.forEach(a.nodes(),function(r){var t=a.node(r),e=a.parent(r);(t.rank===n||t.minRank<=n&&n<=t.maxRank)&&(l.setNode(r),l.setParent(r,e||o),s.forEach(a[i](r),function(t){var e=t.v===r?t.w:t.v,n=l.edge(e,r),i=s.isUndefined(n)?0:n.weight;l.setEdge(e,r,{weight:a.edge(t).weight+i})}),s.has(t,"minRank")&&l.setNode(r,{borderLeft:t.borderLeft[n],borderRight:t.borderRight[n]}))}),l}},{"../graphlib":7,"../lodash":10}],16:[function(t,e,n){var u=t("../lodash");function r(e,t,n){for(var i=u.zipObject(n,u.map(n,function(t,e){return e})),r=u.flatten(u.map(t,function(t){return u.sortBy(u.map(e.outEdges(t),function(t){return{pos:i[t.w],weight:e.edge(t).weight}}),"pos")}),!0),a=1;a<n.length;)a<<=1;var o=2*a-1;a-=1;var l=u.map(new Array(o),function(){return 0}),s=0;return u.forEach(r.forEach(function(t){var e=t.pos+a;l[e]+=t.weight;for(var n=0;0<e;)e%2&&(n+=l[e+1]),l[e=e-1>>1]+=t.weight;s+=t.weight*n})),s}e.exports=function(t,e){for(var n=0,i=1;i<e.length;++i)n+=r(t,e[i-1],e[i]);return n}},{"../lodash":10}],17:[function(t,e,n){var d=t("../lodash"),f=t("./init-order"),c=t("./cross-count"),a=t("./sort-subgraph"),i=t("./build-layer-graph"),o=t("./add-subgraph-constraints"),l=t("../graphlib").Graph,h=t("../util");function p(e,t,n){return d.map(t,function(t){return i(e,t,n)})}function y(t,i){var r=new l;d.forEach(t,function(n){var t=n.graph().root,e=a(n,t,r,i);d.forEach(e.vs,function(t,e){n.node(t).order=e}),o(n,r,e.vs)})}function g(n,t){d.forEach(t,function(t){d.forEach(t,function(t,e){n.node(t).order=e})})}e.exports=function(t){var e=h.maxRank(t),n=p(t,d.range(1,e+1),"inEdges"),i=p(t,d.range(e-1,-1,-1),"outEdges"),r=f(t);g(t,r);for(var a,o=Number.POSITIVE_INFINITY,l=0,s=0;s<4;++l,++s){y(l%2?n:i,2<=l%4),r=h.buildLayerMatrix(t);var u=c(t,r);u<o&&(s=0,a=d.cloneDeep(r),o=u)}g(t,a)}},{"../graphlib":7,"../lodash":10,"../util":29,"./add-subgraph-constraints":13,"./build-layer-graph":15,"./cross-count":16,"./init-order":18,"./sort-subgraph":20}],18:[function(t,e,n){var o=t("../lodash");e.exports=function(i){var r={},t=o.filter(i.nodes(),function(t){return!i.children(t).length}),e=o.max(o.map(t,function(t){return i.node(t).rank})),a=o.map(o.range(e+1),function(){return[]}),n=o.sortBy(t,function(t){return i.node(t).rank});return o.forEach(n,function t(e){if(!o.has(r,e)){r[e]=!0;var n=i.node(e);a[n.rank].push(e),o.forEach(i.successors(e),t)}}),a}},{"../lodash":10}],19:[function(t,e,n){var o=t("../lodash");e.exports=function(t,e){var i={};return o.forEach(t,function(t,e){var n=i[t.v]={indegree:0,in:[],out:[],vs:[t.v],i:e};o.isUndefined(t.barycenter)||(n.barycenter=t.barycenter,n.weight=t.weight)}),o.forEach(e.edges(),function(t){var e=i[t.v],n=i[t.w];o.isUndefined(e)||o.isUndefined(n)||(n.indegree++,e.out.push(i[t.w]))}),function(n){var t=[];function e(a){return function(t){var e,n,i,r;t.merged||(o.isUndefined(t.barycenter)||o.isUndefined(a.barycenter)||t.barycenter>=a.barycenter)&&(n=t,r=i=0,(e=a).weight&&(i+=e.barycenter*e.weight,r+=e.weight),n.weight&&(i+=n.barycenter*n.weight,r+=n.weight),e.vs=n.vs.concat(e.vs),e.barycenter=i/r,e.weight=r,e.i=Math.min(n.i,e.i),n.merged=!0)}}function i(e){return function(t){t.in.push(e),0==--t.indegree&&n.push(t)}}for(;n.length;){var r=n.pop();t.push(r),o.forEach(r.in.reverse(),e(r)),o.forEach(r.out,i(r))}return o.map(o.filter(t,function(t){return!t.merged}),function(t){return o.pick(t,["vs","i","barycenter","weight"])})}(o.filter(i,function(t){return!t.indegree}))}},{"../lodash":10}],20:[function(t,e,n){var _=t("../lodash"),v=t("./barycenter"),x=t("./resolve-conflicts"),b=t("./sort");e.exports=function n(i,t,r,a){var e=i.children(t),o=i.node(t),l=o?o.borderLeft:void 0,s=o?o.borderRight:void 0,u={};l&&(e=_.filter(e,function(t){return t!==l&&t!==s}));var d=v(i,e);_.forEach(d,function(t){if(i.children(t.v).length){var e=n(i,t.v,r,a);u[t.v]=e,_.has(e,"barycenter")&&function(t,e){_.isUndefined(t.barycenter)?(t.barycenter=e.barycenter,t.weight=e.weight):(t.barycenter=(t.barycenter*t.weight+e.barycenter*e.weight)/(t.weight+e.weight),t.weight+=e.weight)}(t,e)}});var f,c,h=x(d,r);f=h,c=u,_.forEach(f,function(t){t.vs=_.flatten(t.vs.map(function(t){return c[t]?c[t].vs:t}),!0)});var p=b(h,a);if(l&&(p.vs=_.flatten([l,p.vs,s],!0),i.predecessors(l).length)){var y=i.node(i.predecessors(l)[0]),g=i.node(i.predecessors(s)[0]);_.has(p,"barycenter")||(p.barycenter=0,p.weight=0),p.barycenter=(p.barycenter*p.weight+y.order+g.order)/(p.weight+2),p.weight+=2}return p}},{"../lodash":10,"./barycenter":14,"./resolve-conflicts":19,"./sort":21}],21:[function(t,e,n){var f=t("../lodash"),c=t("../util");function h(t,e,n){for(var i;e.length&&(i=f.last(e)).i<=n;)e.pop(),t.push(i.vs),n++;return n}e.exports=function(t,e){var n,i=c.partition(t,function(t){return f.has(t,"barycenter")}),r=i.lhs,a=f.sortBy(i.rhs,function(t){return-t.i}),o=[],l=0,s=0,u=0;r.sort((n=!!e,function(t,e){return t.barycenter<e.barycenter?-1:t.barycenter>e.barycenter?1:n?e.i-t.i:t.i-e.i})),u=h(o,a,u),f.forEach(r,function(t){u+=t.vs.length,o.push(t.vs),l+=t.barycenter*t.weight,s+=t.weight,u=h(o,a,u)});var d={vs:f.flatten(o,!0)};return s&&(d.barycenter=l/s,d.weight=s),d}},{"../lodash":10,"../util":29}],22:[function(t,e,n){var o=t("./lodash");e.exports=function(u){var i,r,a,d=(i=u,r={},a=0,o.forEach(i.children(),function t(e){var n=a;o.forEach(i.children(e),t),r[e]={low:n,lim:a++}}),r);o.forEach(u.graph().dummyChains,function(t){for(var e=u.node(t),n=e.edgeObj,i=function(t,e,n,i){var r,a,o=[],l=[],s=Math.min(e[n].low,e[i].low),u=Math.max(e[n].lim,e[i].lim);for(r=n;r=t.parent(r),o.push(r),r&&(e[r].low>s||u>e[r].lim););for(a=r,r=i;(r=t.parent(r))!==a;)l.push(r);return{path:o.concat(l.reverse()),lca:a}}(u,d,n.v,n.w),r=i.path,a=i.lca,o=0,l=r[o],s=!0;t!==n.w;){if(e=u.node(t),s){for(;(l=r[o])!==a&&u.node(l).maxRank<e.rank;)o++;l===a&&(s=!1)}if(!s){for(;o<r.length-1&&u.node(l=r[o+1]).minRank<=e.rank;)o++;l=r[o]}u.setParent(t,l),t=u.successors(t)[0]}})}},{"./lodash":10}],23:[function(t,e,n){var x=t("../lodash"),b=t("../graphlib").Graph,i=t("../util");function r(u,t){var d={};return x.reduce(t,function(t,i){var a=0,o=0,l=t.length,s=x.last(i);return x.forEach(i,function(t,e){var n=function(e,t){if(e.node(t).dummy)return x.find(e.predecessors(t),function(t){return e.node(t).dummy})}(u,t),r=n?u.node(n).order:l;!n&&t!==s||(x.forEach(i.slice(o,e+1),function(i){x.forEach(u.predecessors(i),function(t){var e=u.node(t),n=e.order;!(n<a||r<n)||e.dummy&&u.node(i).dummy||f(d,t,i)})}),o=e+1,a=r)}),i}),d}function u(s,t){var o={};function u(e,t,n,i,r){var a;x.forEach(x.range(t,n),function(t){a=e[t],s.node(a).dummy&&x.forEach(s.predecessors(a),function(t){var e=s.node(t);e.dummy&&(e.order<i||e.order>r)&&f(o,t,a)})})}return x.reduce(t,function(i,r){var a,o=-1,l=0;return x.forEach(r,function(t,e){if("border"===s.node(t).dummy){var n=s.predecessors(t);n.length&&(a=s.node(n[0]).order,u(r,l,e,o,a),l=e,o=a)}u(r,l,r.length,a,i.length)}),r}),o}function f(t,e,n){if(n<e){var i=e;e=n,n=i}var r=t[e];r||(t[e]=r={}),r[n]=!0}function c(t,e,n){if(n<e){var i=e;e=n,n=i}return x.has(t[e],n)}function d(t,e,l,s){var u={},d={},f={};return x.forEach(e,function(t){x.forEach(t,function(t,e){u[t]=t,d[t]=t,f[t]=e})}),x.forEach(e,function(t){var o=-1;x.forEach(t,function(t){var e=s(t);if(e.length)for(var n=((e=x.sortBy(e,function(t){return f[t]})).length-1)/2,i=Math.floor(n),r=Math.ceil(n);i<=r;++i){var a=e[i];d[t]===t&&o<f[a]&&!c(l,t,a)&&(d[a]=t,d[t]=u[t]=u[a],o=f[a])}})}),{root:u,align:d}}function h(i,t,e,n,r){var a,o,l,s,u,d,f,c,h,p,y={},g=(a=i,o=t,l=e,s=r,c=new b,h=a.graph(),u=h.nodesep,d=h.edgesep,f=s,p=function(t,e,n){var i,r=t.node(e),a=t.node(n),o=0;if(o+=r.width/2,x.has(r,"labelpos"))switch(r.labelpos.toLowerCase()){case"l":i=-r.width/2;break;case"r":i=r.width/2}if(i&&(o+=f?i:-i),i=0,o+=(r.dummy?d:u)/2,o+=(a.dummy?d:u)/2,o+=a.width/2,x.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":i=a.width/2;break;case"r":i=-a.width/2}return i&&(o+=f?i:-i),i=0,o},x.forEach(o,function(t){var r;x.forEach(t,function(t){var e=l[t];if(c.setNode(e),r){var n=l[r],i=c.edge(n,e);c.setEdge(n,e,Math.max(p(a,t,r),i||0))}r=t})}),c),_=r?"borderLeft":"borderRight";function v(t,e){for(var n=g.nodes(),i=n.pop(),r={};i;)r[i]?t(i):(r[i]=!0,n.push(i),n=n.concat(e(i))),i=n.pop()}return v(function(t){y[t]=g.inEdges(t).reduce(function(t,e){return Math.max(t,y[e.v]+g.edge(e))},0)},g.predecessors.bind(g)),v(function(t){var e=g.outEdges(t).reduce(function(t,e){return Math.min(t,y[e.w]-g.edge(e))},Number.POSITIVE_INFINITY),n=i.node(t);e!==Number.POSITIVE_INFINITY&&n.borderType!==_&&(y[t]=Math.max(y[t],e))},g.successors.bind(g)),x.forEach(n,function(t){y[t]=y[e[t]]}),y}function p(o,t){return x.minBy(x.values(t),function(t){var r=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY;return x.forIn(t,function(t,e){var n,i=(n=e,o.node(n).width/2);r=Math.max(t+i,r),a=Math.min(t-i,a)}),r-a})}function y(o,l){var t=x.values(l),s=x.min(t),u=x.max(t);x.forEach(["u","d"],function(a){x.forEach(["l","r"],function(t){var e,n=a+t,i=o[n];if(i!==l){var r=x.values(i);(e="l"===t?s-x.min(r):u-x.max(r))&&(o[n]=x.mapValues(i,function(t){return t+e}))}})})}function g(i,r){return x.mapValues(i.ul,function(t,e){if(r)return i[r.toLowerCase()][e];var n=x.sortBy(x.map(i,e));return(n[1]+n[2])/2})}e.exports={positionX:function(a){var o,t=i.buildLayerMatrix(a),l=x.merge(r(a,t),u(a,t)),s={};x.forEach(["u","d"],function(r){o="u"===r?t:x.values(t).reverse(),x.forEach(["l","r"],function(t){"r"===t&&(o=x.map(o,function(t){return x.values(t).reverse()}));var e=("u"===r?a.predecessors:a.successors).bind(a),n=d(0,o,l,e),i=h(a,o,n.root,n.align,"r"===t);"r"===t&&(i=x.mapValues(i,function(t){return-t})),s[r+t]=i})});var e=p(a,s);return y(s,e),g(s,a.graph().align)},findType1Conflicts:r,findType2Conflicts:u,addConflict:f,hasConflict:c,verticalAlignment:d,horizontalCompaction:h,alignCoordinates:y,findSmallestWidthAlignment:p,balance:g}},{"../graphlib":7,"../lodash":10,"../util":29}],24:[function(t,e,n){var o=t("../lodash"),l=t("../util"),s=t("./bk").positionX;e.exports=function(n){var i,t,r,a;i=n=l.asNonCompoundGraph(n),t=l.buildLayerMatrix(i),r=i.graph().ranksep,a=0,o.forEach(t,function(t){var e=o.max(o.map(t,function(t){return i.node(t).height}));o.forEach(t,function(t){i.node(t).y=a+e/2}),a+=e+r}),o.forEach(s(n),function(t,e){n.node(e).x=t})}},{"../lodash":10,"../util":29,"./bk":23}],25:[function(t,e,n){var l=t("../lodash"),o=t("../graphlib").Graph,s=t("./util").slack;function u(a,o){return l.forEach(a.nodes(),function i(r){l.forEach(o.nodeEdges(r),function(t){var e=t.v,n=r===e?t.w:e;a.hasNode(n)||s(o,t)||(a.setNode(n,{}),a.setEdge(r,n,{}),i(n))})}),a.nodeCount()}function d(e,n){return l.minBy(n.edges(),function(t){if(e.hasNode(t.v)!==e.hasNode(t.w))return s(n,t)})}function f(t,e,n){l.forEach(t.nodes(),function(t){e.node(t).rank+=n})}e.exports=function(t){var e,n,i=new o({directed:!1}),r=t.nodes()[0],a=t.nodeCount();for(i.setNode(r,{});u(i,t)<a;)e=d(i,t),n=i.hasNode(e.v)?s(t,e):-s(t,e),f(i,t,n);return i}},{"../graphlib":7,"../lodash":10,"./util":28}],26:[function(t,e,n){var i=t("./util").longestPath,r=t("./feasible-tree"),a=t("./network-simplex");e.exports=function(t){switch(t.graph().ranker){case"network-simplex":l(t);break;case"tight-tree":i(e=t),r(e);break;case"longest-path":o(t);break;default:l(t)}var e};var o=i;function l(t){a(t)}},{"./feasible-tree":25,"./network-simplex":27,"./util":28}],27:[function(t,e,n){var p=t("../lodash"),i=t("./feasible-tree"),d=t("./util").slack,r=t("./util").longestPath,f=t("../graphlib").alg.preorder,l=t("../graphlib").alg.postorder,a=t("../util").simplify;function o(t){t=a(t),r(t);var e,n=i(t);for(h(n),c(n,t);e=u(n);)g(n,t,e,y(n,t,e))}function c(a,o){var t=l(a,a.nodes());t=t.slice(0,t.length-1),p.forEach(t,function(t){var e,n,i,r;n=o,i=t,r=(e=a).node(i).parent,e.edge(i,r).cutvalue=s(e,n,i)})}function s(s,u,d){var f=s.node(d).parent,c=!0,t=u.edge(d,f),h=0;return t||(c=!1,t=u.edge(f,d)),h=t.weight,p.forEach(u.nodeEdges(d),function(t){var e,n,i=t.v===d,r=i?t.w:t.v;if(r!==f){var a=i===c,o=u.edge(t).weight;if(h+=a?o:-o,e=d,n=r,s.hasEdge(e,n)){var l=s.edge(d,r).cutvalue;h+=a?-l:l}}}),h}function h(t,e){arguments.length<2&&(e=t.nodes()[0]),function e(n,i,r,a,t){var o=r,l=n.node(a);return i[a]=!0,p.forEach(n.neighbors(a),function(t){p.has(i,t)||(r=e(n,i,r,t,a))}),l.low=o,l.lim=r++,t?l.parent=t:delete l.parent,r}(t,{},1,e)}function u(e){return p.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function y(e,n,t){var i=t.v,r=t.w;n.hasEdge(i,r)||(i=t.w,r=t.v);var a=e.node(i),o=e.node(r),l=a,s=!1;a.lim>o.lim&&(l=o,s=!0);var u=p.filter(n.edges(),function(t){return s===_(e,e.node(t.v),l)&&s!==_(e,e.node(t.w),l)});return p.minBy(u,function(t){return d(n,t)})}function g(t,e,n,i){var r,a,o,l,s=n.v,u=n.w;t.removeEdge(s,u),t.setEdge(i.v,i.w,{}),h(t),c(t,e),r=t,a=e,o=p.find(r.nodes(),function(t){return!a.node(t).parent}),l=(l=f(r,o)).slice(1),p.forEach(l,function(t){var e=r.node(t).parent,n=a.edge(t,e),i=!1;n||(n=a.edge(e,t),i=!0),a.node(t).rank=a.node(e).rank+(i?n.minlen:-n.minlen)})}function _(t,e,n){return n.low<=e.lim&&e.lim<=n.lim}(e.exports=o).initLowLimValues=h,o.initCutValues=c,o.calcCutValue=s,o.leaveEdge=u,o.enterEdge=y,o.exchangeEdges=g},{"../graphlib":7,"../lodash":10,"../util":29,"./feasible-tree":25,"./util":28}],28:[function(t,e,n){var o=t("../lodash");e.exports={longestPath:function(r){var a={};o.forEach(r.sources(),function e(t){var n=r.node(t);if(o.has(a,t))return n.rank;a[t]=!0;var i=o.min(o.map(r.outEdges(t),function(t){return e(t.w)-r.edge(t).minlen}));return i!==Number.POSITIVE_INFINITY&&null!=i||(i=0),n.rank=i})},slack:function(t,e){return t.node(e.w).rank-t.node(e.v).rank-t.edge(e).minlen}}},{"../lodash":10}],29:[function(t,e,n){var l=t("./lodash"),a=t("./graphlib").Graph;function o(t,e,n,i){for(var r;r=l.uniqueId(i),t.hasNode(r););return n.dummy=e,t.setNode(r,n),r}function s(n){return l.max(l.map(n.nodes(),function(t){var e=n.node(t).rank;if(!l.isUndefined(e))return e}))}e.exports={addDummyNode:o,simplify:function(i){var r=(new a).setGraph(i.graph());return l.forEach(i.nodes(),function(t){r.setNode(t,i.node(t))}),l.forEach(i.edges(),function(t){var e=r.edge(t.v,t.w)||{weight:0,minlen:1},n=i.edge(t);r.setEdge(t.v,t.w,{weight:e.weight+n.weight,minlen:Math.max(e.minlen,n.minlen)})}),r},asNonCompoundGraph:function(e){var n=new a({multigraph:e.isMultigraph()}).setGraph(e.graph());return l.forEach(e.nodes(),function(t){e.children(t).length||n.setNode(t,e.node(t))}),l.forEach(e.edges(),function(t){n.setEdge(t,e.edge(t))}),n},successorWeights:function(n){var t=l.map(n.nodes(),function(t){var e={};return l.forEach(n.outEdges(t),function(t){e[t.w]=(e[t.w]||0)+n.edge(t).weight}),e});return l.zipObject(n.nodes(),t)},predecessorWeights:function(n){var t=l.map(n.nodes(),function(t){var e={};return l.forEach(n.inEdges(t),function(t){e[t.v]=(e[t.v]||0)+n.edge(t).weight}),e});return l.zipObject(n.nodes(),t)},intersectRect:function(t,e){var n,i,r=t.x,a=t.y,o=e.x-r,l=e.y-a,s=t.width/2,u=t.height/2;if(!o&&!l)throw new Error("Not possible to find intersection inside of the rectangle");return i=Math.abs(l)*s>Math.abs(o)*u?(l<0&&(u=-u),n=u*o/l,u):(o<0&&(s=-s),(n=s)*l/o),{x:r+n,y:a+i}},buildLayerMatrix:function(i){var r=l.map(l.range(s(i)+1),function(){return[]});return l.forEach(i.nodes(),function(t){var e=i.node(t),n=e.rank;l.isUndefined(n)||(r[n][e.order]=t)}),r},normalizeRanks:function(n){var i=l.min(l.map(n.nodes(),function(t){return n.node(t).rank}));l.forEach(n.nodes(),function(t){var e=n.node(t);l.has(e,"rank")&&(e.rank-=i)})},removeEmptyRanks:function(n){var i=l.min(l.map(n.nodes(),function(t){return n.node(t).rank})),r=[];l.forEach(n.nodes(),function(t){var e=n.node(t).rank-i;r[e]||(r[e]=[]),r[e].push(t)});var a=0,o=n.graph().nodeRankFactor;l.forEach(r,function(t,e){l.isUndefined(t)&&e%o!=0?--a:a&&l.forEach(t,function(t){n.node(t).rank+=a})})},addBorderNode:function(t,e,n,i){var r={width:0,height:0};return 4<=arguments.length&&(r.rank=n,r.order=i),o(t,"border",r,e)},maxRank:s,partition:function(t,e){var n={lhs:[],rhs:[]};return l.forEach(t,function(t){e(t)?n.lhs.push(t):n.rhs.push(t)}),n},time:function(t,e){var n=l.now();try{return e()}finally{console.log(t+" time: "+(l.now()-n)+"ms")}},notime:function(t,e){return e()}}},{"./graphlib":7,"./lodash":10}],30:[function(t,e,n){e.exports="0.8.4"},{}],31:[function(t,e,n){var i=t("./lib");e.exports={Graph:i.Graph,json:t("./lib/json"),alg:t("./lib/alg"),version:i.version}},{"./lib":47,"./lib/alg":38,"./lib/json":48}],32:[function(t,e,n){var o=t("../lodash");e.exports=function(e){var n,i={},r=[];function a(t){o.has(i,t)||(i[t]=!0,n.push(t),o.each(e.successors(t),a),o.each(e.predecessors(t),a))}return o.each(e.nodes(),function(t){n=[],a(t),n.length&&r.push(n)}),r}},{"../lodash":49}],33:[function(t,e,n){var l=t("../lodash");e.exports=function(e,t,n){l.isArray(t)||(t=[t]);var i=(e.isDirected()?e.successors:e.neighbors).bind(e),r=[],a={};return l.each(t,function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);!function e(n,t,i,r,a,o){l.has(r,t)||(r[t]=!0,i||o.push(t),l.each(a(t),function(t){e(n,t,i,r,a,o)}),i&&o.push(t))}(e,t,"post"===n,a,i,r)}),r}},{"../lodash":49}],34:[function(t,e,n){var a=t("./dijkstra"),o=t("../lodash");e.exports=function(n,i,r){return o.transform(n.nodes(),function(t,e){t[e]=a(n,e,i,r)},{})}},{"../lodash":49,"./dijkstra":35}],35:[function(t,e,n){var i=t("../lodash"),r=t("../data/priority-queue");e.exports=function(e,t,n,i){return function(t,n,a,e){function i(t){var e=t.v!==o?t.v:t.w,n=s[e],i=a(t),r=l.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+i);r<n.distance&&(n.distance=r,n.predecessor=o,u.decrease(e,r))}var o,l,s={},u=new r;for(t.nodes().forEach(function(t){var e=t===n?0:Number.POSITIVE_INFINITY;s[t]={distance:e},u.add(t,e)});0<u.size()&&(o=u.removeMin(),(l=s[o]).distance!==Number.POSITIVE_INFINITY);)e(o).forEach(i);return s}(e,String(t),n||a,i||function(t){return e.outEdges(t)})};var a=i.constant(1)},{"../data/priority-queue":45,"../lodash":49}],36:[function(t,e,n){var i=t("../lodash"),r=t("./tarjan");e.exports=function(e){return i.filter(r(e),function(t){return 1<t.length||1===t.length&&e.hasEdge(t[0],t[0])})}},{"../lodash":49,"./tarjan":43}],37:[function(t,e,n){var i=t("../lodash");e.exports=function(e,t,n){return r=t||o,a=n||function(t){return e.outEdges(t)},s={},(u=e.nodes()).forEach(function(i){s[i]={},s[i][i]={distance:0},u.forEach(function(t){i!==t&&(s[i][t]={distance:Number.POSITIVE_INFINITY})}),a(i).forEach(function(t){var e=t.v===i?t.w:t.v,n=r(t);s[i][e]={distance:n,predecessor:i}})}),u.forEach(function(o){var l=s[o];u.forEach(function(t){var a=s[t];u.forEach(function(t){var e=a[o],n=l[t],i=a[t],r=e.distance+n.distance;r<i.distance&&(i.distance=r,i.predecessor=n.predecessor)})})}),s;var r,a,s,u};var o=i.constant(1)},{"../lodash":49}],38:[function(t,e,n){e.exports={components:t("./components"),dijkstra:t("./dijkstra"),dijkstraAll:t("./dijkstra-all"),findCycles:t("./find-cycles"),floydWarshall:t("./floyd-warshall"),isAcyclic:t("./is-acyclic"),postorder:t("./postorder"),preorder:t("./preorder"),prim:t("./prim"),tarjan:t("./tarjan"),topsort:t("./topsort")}},{"./components":32,"./dijkstra":35,"./dijkstra-all":34,"./find-cycles":36,"./floyd-warshall":37,"./is-acyclic":39,"./postorder":40,"./preorder":41,"./prim":42,"./tarjan":43,"./topsort":44}],39:[function(t,e,n){var i=t("./topsort");e.exports=function(t){try{i(t)}catch(t){if(t instanceof i.CycleException)return!1;throw t}return!0}},{"./topsort":44}],40:[function(t,e,n){var i=t("./dfs");e.exports=function(t,e){return i(t,e,"post")}},{"./dfs":33}],41:[function(t,e,n){var i=t("./dfs");e.exports=function(t,e){return i(t,e,"pre")}},{"./dfs":33}],42:[function(t,e,n){var s=t("../lodash"),u=t("../graph"),d=t("../data/priority-queue");e.exports=function(t,r){var a,e=new u,o={},l=new d;function n(t){var e=t.v===a?t.w:t.v,n=l.priority(e);if(void 0!==n){var i=r(t);i<n&&(o[e]=a,l.decrease(e,i))}}if(0===t.nodeCount())return e;s.each(t.nodes(),function(t){l.add(t,Number.POSITIVE_INFINITY),e.setNode(t)}),l.decrease(t.nodes()[0],0);for(var i=!1;0<l.size();){if(a=l.removeMin(),s.has(o,a))e.setEdge(a,o[a]);else{if(i)throw new Error("Input graph is not connected: "+t);i=!0}t.nodeEdges(a).forEach(n)}return e}},{"../data/priority-queue":45,"../graph":46,"../lodash":49}],43:[function(t,e,n){var d=t("../lodash");e.exports=function(a){var o=0,l=[],s={},u=[];return a.nodes().forEach(function(t){d.has(s,t)||!function e(t){var n=s[t]={onStack:!0,lowlink:o,index:o++};if(l.push(t),a.successors(t).forEach(function(t){d.has(s,t)?s[t].onStack&&(n.lowlink=Math.min(n.lowlink,s[t].index)):(e(t),n.lowlink=Math.min(n.lowlink,s[t].lowlink))}),n.lowlink===n.index){for(var i,r=[];i=l.pop(),s[i].onStack=!1,r.push(i),t!==i;);u.push(r)}}(t)}),u}},{"../lodash":49}],44:[function(t,e,n){var o=t("../lodash");function l(){}((e.exports=function(n){var i={},r={},a=[];if(o.each(n.sinks(),function t(e){if(o.has(r,e))throw new l;o.has(i,e)||(r[e]=!0,i[e]=!0,o.each(n.predecessors(e),t),delete r[e],a.push(e))}),o.size(i)!==n.nodeCount())throw new l;return a}).CycleException=l).prototype=new Error},{"../lodash":49}],45:[function(t,e,n){var a=t("../lodash");function i(){this._arr=[],this._keyIndices={}}(e.exports=i).prototype.size=function(){return this._arr.length},i.prototype.keys=function(){return this._arr.map(function(t){return t.key})},i.prototype.has=function(t){return a.has(this._keyIndices,t)},i.prototype.priority=function(t){var e=this._keyIndices[t];if(void 0!==e)return this._arr[e].priority},i.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},i.prototype.add=function(t,e){var n=this._keyIndices;if(t=String(t),a.has(n,t))return!1;var i=this._arr,r=i.length;return n[t]=r,i.push({key:t,priority:e}),this._decrease(r),!0},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key},i.prototype.decrease=function(t,e){var n=this._keyIndices[t];if(e>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[n].priority+" New: "+e);this._arr[n].priority=e,this._decrease(n)},i.prototype._heapify=function(t){var e=this._arr,n=2*t,i=1+n,r=t;n<e.length&&(r=e[n].priority<e[r].priority?n:r,i<e.length&&(r=e[i].priority<e[r].priority?i:r),r!==t&&(this._swap(t,r),this._heapify(r)))},i.prototype._decrease=function(t){for(var e,n=this._arr,i=n[t].priority;0!==t&&!(n[e=t>>1].priority<i);)this._swap(t,e),t=e},i.prototype._swap=function(t,e){var n=this._arr,i=this._keyIndices,r=n[t],a=n[e];n[t]=a,n[e]=r,i[a.key]=t,i[r.key]=e}},{"../lodash":49}],46:[function(t,e,n){var l=t("./lodash");e.exports=r;var s="\0",i="\0",u="";function r(t){this._isDirected=!l.has(t,"directed")||t.directed,this._isMultigraph=!!l.has(t,"multigraph")&&t.multigraph,this._isCompound=!!l.has(t,"compound")&&t.compound,this._label=void 0,this._defaultNodeLabelFn=l.constant(void 0),this._defaultEdgeLabelFn=l.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[i]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function o(t,e){t[e]?t[e]++:t[e]=1}function a(t,e){--t[e]||delete t[e]}function d(t,e,n,i){var r=""+e,a=""+n;if(!t&&a<r){var o=r;r=a,a=o}return r+u+a+u+(l.isUndefined(i)?s:i)}function f(t,e){return d(t,e.v,e.w,e.name)}r.prototype._nodeCount=0,r.prototype._edgeCount=0,r.prototype.isDirected=function(){return this._isDirected},r.prototype.isMultigraph=function(){return this._isMultigraph},r.prototype.isCompound=function(){return this._isCompound},r.prototype.setGraph=function(t){return this._label=t,this},r.prototype.graph=function(){return this._label},r.prototype.setDefaultNodeLabel=function(t){return l.isFunction(t)||(t=l.constant(t)),this._defaultNodeLabelFn=t,this},r.prototype.nodeCount=function(){return this._nodeCount},r.prototype.nodes=function(){return l.keys(this._nodes)},r.prototype.sources=function(){var e=this;return l.filter(this.nodes(),function(t){return l.isEmpty(e._in[t])})},r.prototype.sinks=function(){var e=this;return l.filter(this.nodes(),function(t){return l.isEmpty(e._out[t])})},r.prototype.setNodes=function(t,e){var n=arguments,i=this;return l.each(t,function(t){1<n.length?i.setNode(t,e):i.setNode(t)}),this},r.prototype.setNode=function(t,e){return l.has(this._nodes,t)?1<arguments.length&&(this._nodes[t]=e):(this._nodes[t]=1<arguments.length?e:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=i,this._children[t]={},this._children[i][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount),this},r.prototype.node=function(t){return this._nodes[t]},r.prototype.hasNode=function(t){return l.has(this._nodes,t)},r.prototype.removeNode=function(t){var e=this;if(l.has(this._nodes,t)){var n=function(t){e.removeEdge(e._edgeObjs[t])};delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],l.each(this.children(t),function(t){e.setParent(t)}),delete this._children[t]),l.each(l.keys(this._in[t]),n),delete this._in[t],delete this._preds[t],l.each(l.keys(this._out[t]),n),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this},r.prototype.setParent=function(t,e){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(l.isUndefined(e))e=i;else{for(var n=e+="";!l.isUndefined(n);n=this.parent(n))if(n===t)throw new Error("Setting "+e+" as parent of "+t+" would create a cycle");this.setNode(e)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=e,this._children[e][t]=!0,this},r.prototype._removeFromParentsChildList=function(t){delete this._children[this._parent[t]][t]},r.prototype.parent=function(t){if(this._isCompound){var e=this._parent[t];if(e!==i)return e}},r.prototype.children=function(t){if(l.isUndefined(t)&&(t=i),this._isCompound){var e=this._children[t];if(e)return l.keys(e)}else{if(t===i)return this.nodes();if(this.hasNode(t))return[]}},r.prototype.predecessors=function(t){var e=this._preds[t];if(e)return l.keys(e)},r.prototype.successors=function(t){var e=this._sucs[t];if(e)return l.keys(e)},r.prototype.neighbors=function(t){var e=this.predecessors(t);if(e)return l.union(e,this.successors(t))},r.prototype.isLeaf=function(t){return 0===(this.isDirected()?this.successors(t):this.neighbors(t)).length},r.prototype.filterNodes=function(n){var i=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});i.setGraph(this.graph());var r=this;l.each(this._nodes,function(t,e){n(e)&&i.setNode(e,t)}),l.each(this._edgeObjs,function(t){i.hasNode(t.v)&&i.hasNode(t.w)&&i.setEdge(t,r.edge(t))});var a={};return this._isCompound&&l.each(i.nodes(),function(t){i.setParent(t,function t(e){var n=r.parent(e);return void 0===n||i.hasNode(n)?a[e]=n:n in a?a[n]:t(n)}(t))}),i},r.prototype.setDefaultEdgeLabel=function(t){return l.isFunction(t)||(t=l.constant(t)),this._defaultEdgeLabelFn=t,this},r.prototype.edgeCount=function(){return this._edgeCount},r.prototype.edges=function(){return l.values(this._edgeObjs)},r.prototype.setPath=function(t,n){var i=this,r=arguments;return l.reduce(t,function(t,e){return 1<r.length?i.setEdge(t,e,n):i.setEdge(t,e),e}),this},r.prototype.setEdge=function(){var s,u,t,e,n=!1,i=arguments[0];"object"===c(i)&&null!==i&&"v"in i?(s=i.v,u=i.w,t=i.name,2===arguments.length&&(e=arguments[1],n=!0)):(s=i,u=arguments[1],t=arguments[3],2<arguments.length&&(e=arguments[2],n=!0)),s=""+s,u=""+u,l.isUndefined(t)||(t=""+t);var r=d(this._isDirected,s,u,t);if(l.has(this._edgeLabels,r))return n&&(this._edgeLabels[r]=e),this;if(!l.isUndefined(t)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(s),this.setNode(u),this._edgeLabels[r]=n?e:this._defaultEdgeLabelFn(s,u,t);var a=function(t,e,n,i){var r=""+s,a=""+u;if(!t&&a<r){var o=r;r=a,a=o}var l={v:r,w:a};return i&&(l.name=i),l}(this._isDirected,0,0,t);return s=a.v,u=a.w,Object.freeze(a),this._edgeObjs[r]=a,o(this._preds[u],s),o(this._sucs[s],u),this._in[u][r]=a,this._out[s][r]=a,this._edgeCount++,this},r.prototype.edge=function(t,e,n){var i=1===arguments.length?f(this._isDirected,t):d(this._isDirected,t,e,n);return this._edgeLabels[i]},r.prototype.hasEdge=function(t,e,n){var i=1===arguments.length?f(this._isDirected,t):d(this._isDirected,t,e,n);return l.has(this._edgeLabels,i)},r.prototype.removeEdge=function(t,e,n){var i=1===arguments.length?f(this._isDirected,arguments[0]):d(this._isDirected,t,e,n),r=this._edgeObjs[i];return r&&(t=r.v,e=r.w,delete this._edgeLabels[i],delete this._edgeObjs[i],a(this._preds[e],t),a(this._sucs[t],e),delete this._in[e][i],delete this._out[t][i],this._edgeCount--),this},r.prototype.inEdges=function(t,e){var n=this._in[t];if(n){var i=l.values(n);return e?l.filter(i,function(t){return t.v===e}):i}},r.prototype.outEdges=function(t,e){var n=this._out[t];if(n){var i=l.values(n);return e?l.filter(i,function(t){return t.w===e}):i}},r.prototype.nodeEdges=function(t,e){var n=this.inEdges(t,e);if(n)return n.concat(this.outEdges(t,e))}},{"./lodash":49}],47:[function(t,e,n){e.exports={Graph:t("./graph"),version:t("./version")}},{"./graph":46,"./version":50}],48:[function(t,e,n){var a=t("./lodash"),i=t("./graph");e.exports={write:function(t){var i,r,e={options:{directed:t.isDirected(),multigraph:t.isMultigraph(),compound:t.isCompound()},nodes:(r=t,a.map(r.nodes(),function(t){var e=r.node(t),n=r.parent(t),i={v:t};return a.isUndefined(e)||(i.value=e),a.isUndefined(n)||(i.parent=n),i})),edges:(i=t,a.map(i.edges(),function(t){var e=i.edge(t),n={v:t.v,w:t.w};return a.isUndefined(t.name)||(n.name=t.name),a.isUndefined(e)||(n.value=e),n}))};return a.isUndefined(t.graph())||(e.value=a.clone(t.graph())),e},read:function(t){var e=new i(t.options).setGraph(t.value);return a.each(t.nodes,function(t){e.setNode(t.v,t.value),t.parent&&e.setParent(t.v,t.parent)}),a.each(t.edges,function(t){e.setEdge({v:t.v,w:t.w,name:t.name},t.value)}),e}}},{"./graph":46,"./lodash":49}],49:[function(t,e,n){var i;if("function"==typeof t)try{i={clone:t("lodash/clone"),constant:t("lodash/constant"),each:t("lodash/each"),filter:t("lodash/filter"),has:t("lodash/has"),isArray:t("lodash/isArray"),isEmpty:t("lodash/isEmpty"),isFunction:t("lodash/isFunction"),isUndefined:t("lodash/isUndefined"),keys:t("lodash/keys"),map:t("lodash/map"),reduce:t("lodash/reduce"),size:t("lodash/size"),transform:t("lodash/transform"),union:t("lodash/union"),values:t("lodash/values")}}catch(t){}i=i||window._,e.exports=i},{"lodash/clone":226,"lodash/constant":228,"lodash/each":230,"lodash/filter":232,"lodash/has":239,"lodash/isArray":243,"lodash/isEmpty":247,"lodash/isFunction":248,"lodash/isUndefined":258,"lodash/keys":259,"lodash/map":262,"lodash/reduce":274,"lodash/size":275,"lodash/transform":284,"lodash/union":285,"lodash/values":287}],50:[function(t,e,n){e.exports="2.1.7"},{}],51:[function(t,e,n){var i=t("./_getNative")(t("./_root"),"DataView");e.exports=i},{"./_getNative":163,"./_root":208}],52:[function(t,e,n){var i=t("./_hashClear"),r=t("./_hashDelete"),a=t("./_hashGet"),o=t("./_hashHas"),l=t("./_hashSet");function s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}s.prototype.clear=i,s.prototype.delete=r,s.prototype.get=a,s.prototype.has=o,s.prototype.set=l,e.exports=s},{"./_hashClear":172,"./_hashDelete":173,"./_hashGet":174,"./_hashHas":175,"./_hashSet":176}],53:[function(t,e,n){var i=t("./_listCacheClear"),r=t("./_listCacheDelete"),a=t("./_listCacheGet"),o=t("./_listCacheHas"),l=t("./_listCacheSet");function s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}s.prototype.clear=i,s.prototype.delete=r,s.prototype.get=a,s.prototype.has=o,s.prototype.set=l,e.exports=s},{"./_listCacheClear":188,"./_listCacheDelete":189,"./_listCacheGet":190,"./_listCacheHas":191,"./_listCacheSet":192}],54:[function(t,e,n){var i=t("./_getNative")(t("./_root"),"Map");e.exports=i},{"./_getNative":163,"./_root":208}],55:[function(t,e,n){var i=t("./_mapCacheClear"),r=t("./_mapCacheDelete"),a=t("./_mapCacheGet"),o=t("./_mapCacheHas"),l=t("./_mapCacheSet");function s(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}s.prototype.clear=i,s.prototype.delete=r,s.prototype.get=a,s.prototype.has=o,s.prototype.set=l,e.exports=s},{"./_mapCacheClear":193,"./_mapCacheDelete":194,"./_mapCacheGet":195,"./_mapCacheHas":196,"./_mapCacheSet":197}],56:[function(t,e,n){var i=t("./_getNative")(t("./_root"),"Promise");e.exports=i},{"./_getNative":163,"./_root":208}],57:[function(t,e,n){var i=t("./_getNative")(t("./_root"),"Set");e.exports=i},{"./_getNative":163,"./_root":208}],58:[function(t,e,n){var i=t("./_MapCache"),r=t("./_setCacheAdd"),a=t("./_setCacheHas");function o(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new i;++e<n;)this.add(t[e])}o.prototype.add=o.prototype.push=r,o.prototype.has=a,e.exports=o},{"./_MapCache":55,"./_setCacheAdd":210,"./_setCacheHas":211}],59:[function(t,e,n){var i=t("./_ListCache"),r=t("./_stackClear"),a=t("./_stackDelete"),o=t("./_stackGet"),l=t("./_stackHas"),s=t("./_stackSet");function u(t){var e=this.__data__=new i(t);this.size=e.size}u.prototype.clear=r,u.prototype.delete=a,u.prototype.get=o,u.prototype.has=l,u.prototype.set=s,e.exports=u},{"./_ListCache":53,"./_stackClear":215,"./_stackDelete":216,"./_stackGet":217,"./_stackHas":218,"./_stackSet":219}],60:[function(t,e,n){var i=t("./_root").Symbol;e.exports=i},{"./_root":208}],61:[function(t,e,n){var i=t("./_root").Uint8Array;e.exports=i},{"./_root":208}],62:[function(t,e,n){var i=t("./_getNative")(t("./_root"),"WeakMap");e.exports=i},{"./_getNative":163,"./_root":208}],63:[function(t,e,n){e.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},{}],64:[function(t,e,n){e.exports=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t}},{}],65:[function(t,e,n){e.exports=function(t,e){for(var n=-1,i=null==t?0:t.length,r=0,a=[];++n<i;){var o=t[n];e(o,n,t)&&(a[r++]=o)}return a}},{}],66:[function(t,e,n){var i=t("./_baseIndexOf");e.exports=function(t,e){return!(null==t||!t.length)&&-1<i(t,e,0)}},{"./_baseIndexOf":95}],67:[function(t,e,n){e.exports=function(t,e,n){for(var i=-1,r=null==t?0:t.length;++i<r;)if(n(e,t[i]))return!0;return!1}},{}],68:[function(t,e,n){var d=t("./_baseTimes"),f=t("./isArguments"),c=t("./isArray"),h=t("./isBuffer"),p=t("./_isIndex"),y=t("./isTypedArray"),g=Object.prototype.hasOwnProperty;e.exports=function(t,e){var n=c(t),i=!n&&f(t),r=!n&&!i&&h(t),a=!n&&!i&&!r&&y(t),o=n||i||r||a,l=o?d(t.length,String):[],s=l.length;for(var u in t)!e&&!g.call(t,u)||o&&("length"==u||r&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||p(u,s))||l.push(u);return l}},{"./_baseTimes":125,"./_isIndex":181,"./isArguments":242,"./isArray":243,"./isBuffer":246,"./isTypedArray":257}],69:[function(t,e,n){e.exports=function(t,e){for(var n=-1,i=null==t?0:t.length,r=Array(i);++n<i;)r[n]=e(t[n],n,t);return r}},{}],70:[function(t,e,n){e.exports=function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t}},{}],71:[function(t,e,n){e.exports=function(t,e,n,i){var r=-1,a=null==t?0:t.length;for(i&&a&&(n=t[++r]);++r<a;)n=e(n,t[r],r,t);return n}},{}],72:[function(t,e,n){e.exports=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1}},{}],73:[function(t,e,n){var i=t("./_baseProperty")("length");e.exports=i},{"./_baseProperty":117}],74:[function(t,e,n){var i=t("./_baseAssignValue"),r=t("./eq");e.exports=function(t,e,n){(void 0===n||r(t[e],n))&&(void 0!==n||e in t)||i(t,e,n)}},{"./_baseAssignValue":79,"./eq":231}],75:[function(t,e,n){var r=t("./_baseAssignValue"),a=t("./eq"),o=Object.prototype.hasOwnProperty;e.exports=function(t,e,n){var i=t[e];o.call(t,e)&&a(i,n)&&(void 0!==n||e in t)||r(t,e,n)}},{"./_baseAssignValue":79,"./eq":231}],76:[function(t,e,n){var i=t("./eq");e.exports=function(t,e){for(var n=t.length;n--;)if(i(t[n][0],e))return n;return-1}},{"./eq":231}],77:[function(t,e,n){var i=t("./_copyObject"),r=t("./keys");e.exports=function(t,e){return t&&i(e,r(e),t)}},{"./_copyObject":143,"./keys":259}],78:[function(t,e,n){var i=t("./_copyObject"),r=t("./keysIn");e.exports=function(t,e){return t&&i(e,r(e),t)}},{"./_copyObject":143,"./keysIn":260}],79:[function(t,e,n){var i=t("./_defineProperty");e.exports=function(t,e,n){"__proto__"==e&&i?i(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},{"./_defineProperty":153}],80:[function(t,e,n){var _=t("./_Stack"),v=t("./_arrayEach"),x=t("./_assignValue"),b=t("./_baseAssign"),m=t("./_baseAssignIn"),w=t("./_cloneBuffer"),S=t("./_copyArray"),k=t("./_copySymbols"),A=t("./_copySymbolsIn"),O=t("./_getAllKeys"),P=t("./_getAllKeysIn"),C=t("./_getTag"),j=t("./_initCloneArray"),E=t("./_initCloneByTag"),M=t("./_initCloneObject"),I=t("./isArray"),D=t("./isBuffer"),T=t("./isMap"),L=t("./isObject"),F=t("./isSet"),R=t("./keys"),N="[object Arguments]",z="[object Function]",W="[object Object]",G={};G[N]=G["[object Array]"]=G["[object ArrayBuffer]"]=G["[object DataView]"]=G["[object Boolean]"]=G["[object Date]"]=G["[object Float32Array]"]=G["[object Float64Array]"]=G["[object Int8Array]"]=G["[object Int16Array]"]=G["[object Int32Array]"]=G["[object Map]"]=G["[object Number]"]=G[W]=G["[object RegExp]"]=G["[object Set]"]=G["[object String]"]=G["[object Symbol]"]=G["[object Uint8Array]"]=G["[object Uint8ClampedArray]"]=G["[object Uint16Array]"]=G["[object Uint32Array]"]=!0,G["[object Error]"]=G[z]=G["[object WeakMap]"]=!1,e.exports=function n(i,r,a,t,e,o){var l,s=1&r,u=2&r,d=4&r;if(a&&(l=e?a(i,t,e,o):a(i)),void 0!==l)return l;if(!L(i))return i;var f=I(i);if(f){if(l=j(i),!s)return S(i,l)}else{var c=C(i),h=c==z||"[object GeneratorFunction]"==c;if(D(i))return w(i,s);if(c==W||c==N||h&&!e){if(l=u||h?{}:M(i),!s)return u?A(i,m(l,i)):k(i,b(l,i))}else{if(!G[c])return e?i:{};l=E(i,c,s)}}var p=(o=o||new _).get(i);if(p)return p;if(o.set(i,l),F(i))return i.forEach(function(t){l.add(n(t,r,a,t,i,o))}),l;if(T(i))return i.forEach(function(t,e){l.set(e,n(t,r,a,e,i,o))}),l;var y=d?u?P:O:u?keysIn:R,g=f?void 0:y(i);return v(g||i,function(t,e){g&&(t=i[e=t]),x(l,e,n(t,r,a,e,i,o))}),l}},{"./_Stack":59,"./_arrayEach":64,"./_assignValue":75,"./_baseAssign":77,"./_baseAssignIn":78,"./_cloneBuffer":135,"./_copyArray":142,"./_copySymbols":144,"./_copySymbolsIn":145,"./_getAllKeys":159,"./_getAllKeysIn":160,"./_getTag":168,"./_initCloneArray":177,"./_initCloneByTag":178,"./_initCloneObject":179,"./isArray":243,"./isBuffer":246,"./isMap":250,"./isObject":251,"./isSet":254,"./keys":259}],81:[function(t,e,n){var i=t("./isObject"),r=Object.create;function a(){}e.exports=function(t){if(!i(t))return{};if(r)return r(t);a.prototype=t;var e=new a;return a.prototype=void 0,e}},{"./isObject":251}],82:[function(t,e,n){var i=t("./_baseForOwn"),r=t("./_createBaseEach")(i);e.exports=r},{"./_baseForOwn":88,"./_createBaseEach":148}],83:[function(t,e,n){var u=t("./isSymbol");e.exports=function(t,e,n){for(var i=-1,r=t.length;++i<r;){var a=t[i],o=e(a);if(null!=o&&(void 0===l?o==o&&!u(o):n(o,l)))var l=o,s=a}return s}},{"./isSymbol":256}],84:[function(t,e,n){var a=t("./_baseEach");e.exports=function(t,i){var r=[];return a(t,function(t,e,n){i(t,e,n)&&r.push(t)}),r}},{"./_baseEach":82}],85:[function(t,e,n){e.exports=function(t,e,n,i){for(var r=t.length,a=n+(i?1:-1);i?a--:++a<r;)if(e(t[a],a,t))return a;return-1}},{}],86:[function(t,e,n){var u=t("./_arrayPush"),d=t("./_isFlattenable");e.exports=function t(e,n,i,r,a){var o=-1,l=e.length;for(i=i||d,a=a||[];++o<l;){var s=e[o];0<n&&i(s)?1<n?t(s,n-1,i,r,a):u(a,s):r||(a[a.length]=s)}return a}},{"./_arrayPush":70,"./_isFlattenable":180}],87:[function(t,e,n){var i=t("./_createBaseFor")();e.exports=i},{"./_createBaseFor":149}],88:[function(t,e,n){var i=t("./_baseFor"),r=t("./keys");e.exports=function(t,e){return t&&i(t,e,r)}},{"./_baseFor":87,"./keys":259}],89:[function(t,e,n){var r=t("./_castPath"),a=t("./_toKey");e.exports=function(t,e){for(var n=0,i=(e=r(e,t)).length;null!=t&&n<i;)t=t[a(e[n++])];return n&&n==i?t:void 0}},{"./_castPath":133,"./_toKey":223}],90:[function(t,e,n){var r=t("./_arrayPush"),a=t("./isArray");e.exports=function(t,e,n){var i=e(t);return a(t)?i:r(i,n(t))}},{"./_arrayPush":70,"./isArray":243}],91:[function(t,e,n){var i=t("./_Symbol"),r=t("./_getRawTag"),a=t("./_objectToString"),o=i?i.toStringTag:void 0;e.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":o&&o in Object(t)?r(t):a(t)}},{"./_Symbol":60,"./_getRawTag":165,"./_objectToString":205}],92:[function(t,e,n){e.exports=function(t,e){return e<t}},{}],93:[function(t,e,n){var i=Object.prototype.hasOwnProperty;e.exports=function(t,e){return null!=t&&i.call(t,e)}},{}],94:[function(t,e,n){e.exports=function(t,e){return null!=t&&e in Object(t)}},{}],95:[function(t,e,n){var i=t("./_baseFindIndex"),r=t("./_baseIsNaN"),a=t("./_strictIndexOf");e.exports=function(t,e,n){return e==e?a(t,e,n):i(t,r,n)}},{"./_baseFindIndex":85,"./_baseIsNaN":101,"./_strictIndexOf":220}],96:[function(t,e,n){var i=t("./_baseGetTag"),r=t("./isObjectLike");e.exports=function(t){return r(t)&&"[object Arguments]"==i(t)}},{"./_baseGetTag":91,"./isObjectLike":252}],97:[function(t,e,n){var o=t("./_baseIsEqualDeep"),l=t("./isObjectLike");e.exports=function t(e,n,i,r,a){return e===n||(null==e||null==n||!l(e)&&!l(n)?e!=e&&n!=n:o(e,n,i,r,t,a))}},{"./_baseIsEqualDeep":98,"./isObjectLike":252}],98:[function(t,e,n){var y=t("./_Stack"),g=t("./_equalArrays"),_=t("./_equalByTag"),v=t("./_equalObjects"),x=t("./_getTag"),b=t("./isArray"),m=t("./isBuffer"),w=t("./isTypedArray"),S="[object Arguments]",k="[object Array]",A="[object Object]",O=Object.prototype.hasOwnProperty;e.exports=function(t,e,n,i,r,a){var o=b(t),l=b(e),s=o?k:x(t),u=l?k:x(e),d=(s=s==S?A:s)==A,f=(u=u==S?A:u)==A,c=s==u;if(c&&m(t)){if(!m(e))return!1;d=!(o=!0)}if(c&&!d)return a=a||new y,o||w(t)?g(t,e,n,i,r,a):_(t,e,s,n,i,r,a);if(!(1&n)){var h=d&&O.call(t,"__wrapped__"),p=f&&O.call(e,"__wrapped__");if(h||p)return r(h?t.value():t,p?e.value():e,n,i,a=a||new y)}return c&&(a=a||new y,v(t,e,n,i,r,a))}},{"./_Stack":59,"./_equalArrays":154,"./_equalByTag":155,"./_equalObjects":156,"./_getTag":168,"./isArray":243,"./isBuffer":246,"./isTypedArray":257}],99:[function(t,e,n){var i=t("./_getTag"),r=t("./isObjectLike");e.exports=function(t){return r(t)&&"[object Map]"==i(t)}},{"./_getTag":168,"./isObjectLike":252}],100:[function(t,e,n){var h=t("./_Stack"),p=t("./_baseIsEqual");e.exports=function(t,e,n,i){var r=n.length,a=r,o=!i;if(null==t)return!a;for(t=Object(t);r--;){var l=n[r];if(o&&l[2]?l[1]!==t[l[0]]:!(l[0]in t))return!1}for(;++r<a;){var s=(l=n[r])[0],u=t[s],d=l[1];if(o&&l[2]){if(void 0===u&&!(s in t))return!1}else{var f=new h;if(i)var c=i(u,d,s,t,e,f);if(!(void 0===c?p(d,u,3,i,f):c))return!1}}return!0}},{"./_Stack":59,"./_baseIsEqual":97}],101:[function(t,e,n){e.exports=function(t){return t!=t}},{}],102:[function(t,e,n){var i=t("./isFunction"),r=t("./_isMasked"),a=t("./isObject"),o=t("./_toSource"),l=/^\[object .+?Constructor\]$/,s=Function.prototype,u=Object.prototype,d=s.toString,f=u.hasOwnProperty,c=RegExp("^"+d.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(t){return!(!a(t)||r(t))&&(i(t)?c:l).test(o(t))}},{"./_isMasked":185,"./_toSource":224,"./isFunction":248,"./isObject":251}],103:[function(t,e,n){var i=t("./_getTag"),r=t("./isObjectLike");e.exports=function(t){return r(t)&&"[object Set]"==i(t)}},{"./_getTag":168,"./isObjectLike":252}],104:[function(t,e,n){var i=t("./_baseGetTag"),r=t("./isLength"),a=t("./isObjectLike"),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1,e.exports=function(t){return a(t)&&r(t.length)&&!!o[i(t)]}},{"./_baseGetTag":91,"./isLength":249,"./isObjectLike":252}],105:[function(t,e,n){var i=t("./_baseMatches"),r=t("./_baseMatchesProperty"),a=t("./identity"),o=t("./isArray"),l=t("./property");e.exports=function(t){return"function"==typeof t?t:null==t?a:"object"==c(t)?o(t)?r(t[0],t[1]):i(t):l(t)}},{"./_baseMatches":110,"./_baseMatchesProperty":111,"./identity":241,"./isArray":243,"./property":272}],106:[function(t,e,n){var i=t("./_isPrototype"),r=t("./_nativeKeys"),a=Object.prototype.hasOwnProperty;e.exports=function(t){if(!i(t))return r(t);var e=[];for(var n in Object(t))a.call(t,n)&&"constructor"!=n&&e.push(n);return e}},{"./_isPrototype":186,"./_nativeKeys":202}],107:[function(t,e,n){var r=t("./isObject"),a=t("./_isPrototype"),o=t("./_nativeKeysIn"),l=Object.prototype.hasOwnProperty;e.exports=function(t){if(!r(t))return o(t);var e=a(t),n=[];for(var i in t)("constructor"!=i||!e&&l.call(t,i))&&n.push(i);return n}},{"./_isPrototype":186,"./_nativeKeysIn":203,"./isObject":251}],108:[function(t,e,n){e.exports=function(t,e){return t<e}},{}],109:[function(t,e,n){var o=t("./_baseEach"),l=t("./isArrayLike");e.exports=function(t,i){var r=-1,a=l(t)?Array(t.length):[];return o(t,function(t,e,n){a[++r]=i(t,e,n)}),a}},{"./_baseEach":82,"./isArrayLike":244}],110:[function(t,e,n){var i=t("./_baseIsMatch"),r=t("./_getMatchData"),a=t("./_matchesStrictComparable");e.exports=function(e){var n=r(e);return 1==n.length&&n[0][2]?a(n[0][0],n[0][1]):function(t){return t===e||i(t,e,n)}}},{"./_baseIsMatch":100,"./_getMatchData":162,"./_matchesStrictComparable":199}],111:[function(t,e,n){var r=t("./_baseIsEqual"),a=t("./get"),o=t("./hasIn"),l=t("./_isKey"),s=t("./_isStrictComparable"),u=t("./_matchesStrictComparable"),d=t("./_toKey");e.exports=function(n,i){return l(n)&&s(i)?u(d(n),i):function(t){var e=a(t,n);return void 0===e&&e===i?o(t,n):r(i,e,3)}}},{"./_baseIsEqual":97,"./_isKey":183,"./_isStrictComparable":187,"./_matchesStrictComparable":199,"./_toKey":223,"./get":238,"./hasIn":240}],112:[function(t,e,n){var u=t("./_Stack"),d=t("./_assignMergeValue"),f=t("./_baseFor"),c=t("./_baseMergeDeep"),h=t("./isObject"),p=t("./keysIn"),y=t("./_safeGet");e.exports=function i(r,a,o,l,s){r!==a&&f(a,function(t,e){if(h(t))s=s||new u,c(r,a,e,o,i,l,s);else{var n=l?l(y(r,e),t,e+"",r,a,s):void 0;void 0===n&&(n=t),d(r,e,n)}},p)}},{"./_Stack":59,"./_assignMergeValue":74,"./_baseFor":87,"./_baseMergeDeep":113,"./_safeGet":209,"./isObject":251,"./keysIn":260}],113:[function(t,e,n){var y=t("./_assignMergeValue"),g=t("./_cloneBuffer"),_=t("./_cloneTypedArray"),v=t("./_copyArray"),x=t("./_initCloneObject"),b=t("./isArguments"),m=t("./isArray"),w=t("./isArrayLikeObject"),S=t("./isBuffer"),k=t("./isFunction"),A=t("./isObject"),O=t("./isPlainObject"),P=t("./isTypedArray"),C=t("./_safeGet"),j=t("./toPlainObject");e.exports=function(t,e,n,i,r,a,o){var l=C(t,n),s=C(e,n),u=o.get(s);if(u)y(t,n,u);else{var d=a?a(l,s,n+"",t,e,o):void 0,f=void 0===d;if(f){var c=m(s),h=!c&&S(s),p=!c&&!h&&P(s);d=s,c||h||p?d=m(l)?l:w(l)?v(l):h?g(s,!(f=!1)):p?_(s,!(f=!1)):[]:O(s)||b(s)?b(d=l)?d=j(l):(!A(l)||i&&k(l))&&(d=x(s)):f=!1}f&&(o.set(s,d),r(d,s,i,a,o),o.delete(s)),y(t,n,d)}}},{"./_assignMergeValue":74,"./_cloneBuffer":135,"./_cloneTypedArray":139,"./_copyArray":142,"./_initCloneObject":179,"./_safeGet":209,"./isArguments":242,"./isArray":243,"./isArrayLikeObject":245,"./isBuffer":246,"./isFunction":248,"./isObject":251,"./isPlainObject":253,"./isTypedArray":257,"./toPlainObject":282}],114:[function(t,e,n){var a=t("./_arrayMap"),o=t("./_baseIteratee"),l=t("./_baseMap"),s=t("./_baseSortBy"),u=t("./_baseUnary"),d=t("./_compareMultiple"),f=t("./identity");e.exports=function(t,i,n){var r=-1;i=a(i.length?i:[f],u(o));var e=l(t,function(e,t,n){return{criteria:a(i,function(t){return t(e)}),index:++r,value:e}});return s(e,function(t,e){return d(t,e,n)})}},{"./_arrayMap":69,"./_baseIteratee":105,"./_baseMap":109,"./_baseSortBy":124,"./_baseUnary":127,"./_compareMultiple":141,"./identity":241}],115:[function(t,e,n){var i=t("./_basePickBy"),r=t("./hasIn");e.exports=function(n,t){return i(n,t,function(t,e){return r(n,e)})}},{"./_basePickBy":116,"./hasIn":240}],116:[function(t,e,n){var s=t("./_baseGet"),u=t("./_baseSet"),d=t("./_castPath");e.exports=function(t,e,n){for(var i=-1,r=e.length,a={};++i<r;){var o=e[i],l=s(t,o);n(l,o)&&u(a,d(o,t),l)}return a}},{"./_baseGet":89,"./_baseSet":122,"./_castPath":133}],117:[function(t,e,n){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},{}],118:[function(t,e,n){var i=t("./_baseGet");e.exports=function(e){return function(t){return i(t,e)}}},{"./_baseGet":89}],119:[function(t,e,n){var l=Math.ceil,s=Math.max;e.exports=function(t,e,n,i){for(var r=-1,a=s(l((e-t)/(n||1)),0),o=Array(a);a--;)o[i?a:++r]=t,t+=n;return o}},{}],120:[function(t,e,n){e.exports=function(t,i,r,a,e){return e(t,function(t,e,n){r=a?(a=!1,t):i(r,t,e,n)}),r}},{}],121:[function(t,e,n){var i=t("./identity"),r=t("./_overRest"),a=t("./_setToString");e.exports=function(t,e){return a(r(t,e,i),t+"")}},{"./_overRest":207,"./_setToString":213,"./identity":241}],122:[function(t,e,n){var f=t("./_assignValue"),c=t("./_castPath"),h=t("./_isIndex"),p=t("./isObject"),y=t("./_toKey");e.exports=function(t,e,n,i){if(!p(t))return t;for(var r=-1,a=(e=c(e,t)).length,o=a-1,l=t;null!=l&&++r<a;){var s=y(e[r]),u=n;if(r!=o){var d=l[s];void 0===(u=i?i(d,s,l):void 0)&&(u=p(d)?d:h(e[r+1])?[]:{})}f(l,s,u),l=l[s]}return t}},{"./_assignValue":75,"./_castPath":133,"./_isIndex":181,"./_toKey":223,"./isObject":251}],123:[function(t,e,n){var i=t("./constant"),r=t("./_defineProperty"),a=t("./identity"),o=r?function(t,e){return r(t,"toString",{configurable:!0,enumerable:!1,value:i(e),writable:!0})}:a;e.exports=o},{"./_defineProperty":153,"./constant":228,"./identity":241}],124:[function(t,e,n){e.exports=function(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}},{}],125:[function(t,e,n){e.exports=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}},{}],126:[function(t,e,n){var i=t("./_Symbol"),r=t("./_arrayMap"),a=t("./isArray"),o=t("./isSymbol"),l=i?i.prototype:void 0,s=l?l.toString:void 0;e.exports=function t(e){if("string"==typeof e)return e;if(a(e))return r(e,t)+"";if(o(e))return s?s.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},{"./_Symbol":60,"./_arrayMap":69,"./isArray":243,"./isSymbol":256}],127:[function(t,e,n){e.exports=function(e){return function(t){return e(t)}}},{}],128:[function(t,e,n){var h=t("./_SetCache"),p=t("./_arrayIncludes"),y=t("./_arrayIncludesWith"),g=t("./_cacheHas"),_=t("./_createSet"),v=t("./_setToArray");e.exports=function(t,e,n){var i=-1,r=p,a=t.length,o=!0,l=[],s=l;if(n)o=!1,r=y;else if(200<=a){var u=e?null:_(t);if(u)return v(u);o=!1,r=g,s=new h}else s=e?[]:l;t:for(;++i<a;){var d=t[i],f=e?e(d):d;if(d=n||0!==d?d:0,o&&f==f){for(var c=s.length;c--;)if(s[c]===f)continue t;e&&s.push(f),l.push(d)}else r(s,f,n)||(s!==l&&s.push(f),l.push(d))}return l}},{"./_SetCache":58,"./_arrayIncludes":66,"./_arrayIncludesWith":67,"./_cacheHas":131,"./_createSet":152,"./_setToArray":212}],129:[function(t,e,n){var i=t("./_arrayMap");e.exports=function(e,t){return i(t,function(t){return e[t]})}},{"./_arrayMap":69}],130:[function(t,e,n){e.exports=function(t,e,n){for(var i=-1,r=t.length,a=e.length,o={};++i<r;){var l=i<a?e[i]:void 0;n(o,t[i],l)}return o}},{}],131:[function(t,e,n){e.exports=function(t,e){return t.has(e)}},{}],132:[function(t,e,n){var i=t("./identity");e.exports=function(t){return"function"==typeof t?t:i}},{"./identity":241}],133:[function(t,e,n){var i=t("./isArray"),r=t("./_isKey"),a=t("./_stringToPath"),o=t("./toString");e.exports=function(t,e){return i(t)?t:r(t,e)?[t]:a(o(t))}},{"./_isKey":183,"./_stringToPath":222,"./isArray":243,"./toString":283}],134:[function(t,e,n){var i=t("./_Uint8Array");e.exports=function(t){var e=new t.constructor(t.byteLength);return new i(e).set(new i(t)),e}},{"./_Uint8Array":61}],135:[function(t,e,n){var i=t("./_root"),r="object"==c(n)&&n&&!n.nodeType&&n,a=r&&"object"==c(e)&&e&&!e.nodeType&&e,o=a&&a.exports===r?i.Buffer:void 0,l=o?o.allocUnsafe:void 0;e.exports=function(t,e){if(e)return t.slice();var n=t.length,i=l?l(n):new t.constructor(n);return t.copy(i),i}},{"./_root":208}],136:[function(t,e,n){var i=t("./_cloneArrayBuffer");e.exports=function(t,e){var n=e?i(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)}},{"./_cloneArrayBuffer":134}],137:[function(t,e,n){var i=/\w*$/;e.exports=function(t){var e=new t.constructor(t.source,i.exec(t));return e.lastIndex=t.lastIndex,e}},{}],138:[function(t,e,n){var i=t("./_Symbol"),r=i?i.prototype:void 0,a=r?r.valueOf:void 0;e.exports=function(t){return a?Object(a.call(t)):{}}},{"./_Symbol":60}],139:[function(t,e,n){var i=t("./_cloneArrayBuffer");e.exports=function(t,e){var n=e?i(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},{"./_cloneArrayBuffer":134}],140:[function(t,e,n){var d=t("./isSymbol");e.exports=function(t,e){if(t!==e){var n=void 0!==t,i=null===t,r=t==t,a=d(t),o=void 0!==e,l=null===e,s=e==e,u=d(e);if(!l&&!u&&!a&&e<t||a&&o&&s&&!l&&!u||i&&o&&s||!n&&s||!r)return 1;if(!i&&!a&&!u&&t<e||u&&n&&r&&!i&&!a||l&&n&&r||!o&&r||!s)return-1}return 0}},{"./isSymbol":256}],141:[function(t,e,n){var u=t("./_compareAscending");e.exports=function(t,e,n){for(var i=-1,r=t.criteria,a=e.criteria,o=r.length,l=n.length;++i<o;){var s=u(r[i],a[i]);if(s)return l<=i?s:s*("desc"==n[i]?-1:1)}return t.index-e.index}},{"./_compareAscending":140}],142:[function(t,e,n){e.exports=function(t,e){var n=-1,i=t.length;for(e=e||Array(i);++n<i;)e[n]=t[n];return e}},{}],143:[function(t,e,n){var u=t("./_assignValue"),d=t("./_baseAssignValue");e.exports=function(t,e,n,i){var r=!n;n=n||{};for(var a=-1,o=e.length;++a<o;){var l=e[a],s=i?i(n[l],t[l],l,n,t):void 0;void 0===s&&(s=t[l]),r?d(n,l,s):u(n,l,s)}return n}},{"./_assignValue":75,"./_baseAssignValue":79}],144:[function(t,e,n){var i=t("./_copyObject"),r=t("./_getSymbols");e.exports=function(t,e){return i(t,r(t),e)}},{"./_copyObject":143,"./_getSymbols":166}],145:[function(t,e,n){var i=t("./_copyObject"),r=t("./_getSymbolsIn");e.exports=function(t,e){return i(t,r(t),e)}},{"./_copyObject":143,"./_getSymbolsIn":167}],146:[function(t,e,n){var i=t("./_root")["__core-js_shared__"];e.exports=i},{"./_root":208}],147:[function(t,e,n){var i=t("./_baseRest"),s=t("./_isIterateeCall");e.exports=function(l){return i(function(t,e){var n=-1,i=e.length,r=1<i?e[i-1]:void 0,a=2<i?e[2]:void 0;for(r=3<l.length&&"function"==typeof r?(i--,r):void 0,a&&s(e[0],e[1],a)&&(r=i<3?void 0:r,i=1),t=Object(t);++n<i;){var o=e[n];o&&l(t,o,n,r)}return t})}},{"./_baseRest":121,"./_isIterateeCall":182}],148:[function(t,e,n){var l=t("./isArrayLike");e.exports=function(a,o){return function(t,e){if(null==t)return t;if(!l(t))return a(t,e);for(var n=t.length,i=o?n:-1,r=Object(t);(o?i--:++i<n)&&!1!==e(r[i],i,r););return t}}},{"./isArrayLike":244}],149:[function(t,e,n){e.exports=function(s){return function(t,e,n){for(var i=-1,r=Object(t),a=n(t),o=a.length;o--;){var l=a[s?o:++i];if(!1===e(r[l],l,r))break}return t}}},{}],150:[function(t,e,n){var l=t("./_baseIteratee"),s=t("./isArrayLike"),u=t("./keys");e.exports=function(o){return function(t,e,n){var i=Object(t);if(!s(t)){var r=l(e,3);t=u(t),e=function(t){return r(i[t],t,i)}}var a=o(t,e,n);return-1<a?i[r?t[a]:a]:void 0}}},{"./_baseIteratee":105,"./isArrayLike":244,"./keys":259}],151:[function(t,e,n){var r=t("./_baseRange"),a=t("./_isIterateeCall"),o=t("./toFinite");e.exports=function(i){return function(t,e,n){return n&&"number"!=typeof n&&a(t,e,n)&&(e=n=void 0),t=o(t),void 0===e?(e=t,t=0):e=o(e),n=void 0===n?t<e?1:-1:o(n),r(t,e,n,i)}}},{"./_baseRange":119,"./_isIterateeCall":182,"./toFinite":279}],152:[function(t,e,n){var i=t("./_Set"),r=t("./noop"),a=t("./_setToArray"),o=i&&1/a(new i([,-0]))[1]==1/0?function(t){return new i(t)}:r;e.exports=o},{"./_Set":57,"./_setToArray":212,"./noop":269}],153:[function(t,e,n){var i=t("./_getNative"),r=function(){try{var t=i(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();e.exports=r},{"./_getNative":163}],154:[function(t,e,n){var g=t("./_SetCache"),_=t("./_arraySome"),v=t("./_cacheHas");e.exports=function(t,e,n,i,r,a){var o=1&n,l=t.length,s=e.length;if(l!=s&&!(o&&l<s))return!1;var u=a.get(t);if(u&&a.get(e))return u==e;var d=-1,f=!0,c=2&n?new g:void 0;for(a.set(t,e),a.set(e,t);++d<l;){var h=t[d],p=e[d];if(i)var y=o?i(p,h,d,e,t,a):i(h,p,d,t,e,a);if(void 0!==y){if(y)continue;f=!1;break}if(c){if(!_(e,function(t,e){if(!v(c,e)&&(h===t||r(h,t,n,i,a)))return c.push(e)})){f=!1;break}}else if(h!==p&&!r(h,p,n,i,a)){f=!1;break}}return a.delete(t),a.delete(e),f}},{"./_SetCache":58,"./_arraySome":72,"./_cacheHas":131}],155:[function(t,e,n){var i=t("./_Symbol"),f=t("./_Uint8Array"),c=t("./eq"),h=t("./_equalArrays"),p=t("./_mapToArray"),y=t("./_setToArray"),r=i?i.prototype:void 0,g=r?r.valueOf:void 0;e.exports=function(t,e,n,i,r,a,o){switch(n){case"[object DataView]":if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case"[object ArrayBuffer]":return!(t.byteLength!=e.byteLength||!a(new f(t),new f(e)));case"[object Boolean]":case"[object Date]":case"[object Number]":return c(+t,+e);case"[object Error]":return t.name==e.name&&t.message==e.message;case"[object RegExp]":case"[object String]":return t==e+"";case"[object Map]":var l=p;case"[object Set]":var s=1&i;if(l=l||y,t.size!=e.size&&!s)return!1;var u=o.get(t);if(u)return u==e;i|=2,o.set(t,e);var d=h(l(t),l(e),i,r,a,o);return o.delete(t),d;case"[object Symbol]":if(g)return g.call(t)==g.call(e)}return!1}},{"./_Symbol":60,"./_Uint8Array":61,"./_equalArrays":154,"./_mapToArray":198,"./_setToArray":212,"./eq":231}],156:[function(t,e,n){var x=t("./_getAllKeys"),b=Object.prototype.hasOwnProperty;e.exports=function(t,e,n,i,r,a){var o=1&n,l=x(t),s=l.length;if(s!=x(e).length&&!o)return!1;for(var u=s;u--;){var d=l[u];if(!(o?d in e:b.call(e,d)))return!1}var f=a.get(t);if(f&&a.get(e))return f==e;var c=!0;a.set(t,e),a.set(e,t);for(var h=o;++u<s;){var p=t[d=l[u]],y=e[d];if(i)var g=o?i(y,p,d,e,t,a):i(p,y,d,t,e,a);if(!(void 0===g?p===y||r(p,y,n,i,a):g)){c=!1;break}h=h||"constructor"==d}if(c&&!h){var _=t.constructor,v=e.constructor;_!=v&&"constructor"in t&&"constructor"in e&&!("function"==typeof _&&_ instanceof _&&"function"==typeof v&&v instanceof v)&&(c=!1)}return a.delete(t),a.delete(e),c}},{"./_getAllKeys":159}],157:[function(t,e,n){var i=t("./flatten"),r=t("./_overRest"),a=t("./_setToString");e.exports=function(t){return a(r(t,void 0,i),t+"")}},{"./_overRest":207,"./_setToString":213,"./flatten":235}],158:[function(t,n,e){(function(t){var e="object"==c(t)&&t&&t.Object===Object&&t;n.exports=e}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],159:[function(t,e,n){var i=t("./_baseGetAllKeys"),r=t("./_getSymbols"),a=t("./keys");e.exports=function(t){return i(t,a,r)}},{"./_baseGetAllKeys":90,"./_getSymbols":166,"./keys":259}],160:[function(t,e,n){var i=t("./_baseGetAllKeys"),r=t("./_getSymbolsIn"),a=t("./keysIn");e.exports=function(t){return i(t,a,r)}},{"./_baseGetAllKeys":90,"./_getSymbolsIn":167,"./keysIn":260}],161:[function(t,e,n){var i=t("./_isKeyable");e.exports=function(t,e){var n=t.__data__;return i(e)?n["string"==typeof e?"string":"hash"]:n.map}},{"./_isKeyable":184}],162:[function(t,e,n){var a=t("./_isStrictComparable"),o=t("./keys");e.exports=function(t){for(var e=o(t),n=e.length;n--;){var i=e[n],r=t[i];e[n]=[i,r,a(r)]}return e}},{"./_isStrictComparable":187,"./keys":259}],163:[function(t,e,n){var i=t("./_baseIsNative"),r=t("./_getValue");e.exports=function(t,e){var n=r(t,e);return i(n)?n:void 0}},{"./_baseIsNative":102,"./_getValue":169}],164:[function(t,e,n){var i=t("./_overArg")(Object.getPrototypeOf,Object);e.exports=i},{"./_overArg":206}],165:[function(t,e,n){var i=t("./_Symbol"),r=Object.prototype,a=r.hasOwnProperty,o=r.toString,l=i?i.toStringTag:void 0;e.exports=function(t){var e=a.call(t,l),n=t[l];try{var i=!(t[l]=void 0)}catch(t){}var r=o.call(t);return i&&(e?t[l]=n:delete t[l]),r}},{"./_Symbol":60}],166:[function(t,e,n){var i=t("./_arrayFilter"),r=t("./stubArray"),a=Object.prototype.propertyIsEnumerable,o=Object.getOwnPropertySymbols,l=o?function(e){return null==e?[]:(e=Object(e),i(o(e),function(t){return a.call(e,t)}))}:r;e.exports=l},{"./_arrayFilter":65,"./stubArray":277}],167:[function(t,e,n){var i=t("./_arrayPush"),r=t("./_getPrototype"),a=t("./_getSymbols"),o=t("./stubArray"),l=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)i(e,a(t)),t=r(t);return e}:o;e.exports=l},{"./_arrayPush":70,"./_getPrototype":164,"./_getSymbols":166,"./stubArray":277}],168:[function(t,e,n){var i=t("./_DataView"),r=t("./_Map"),a=t("./_Promise"),o=t("./_Set"),l=t("./_WeakMap"),s=t("./_baseGetTag"),u=t("./_toSource"),d="[object Map]",f="[object Promise]",c="[object Set]",h="[object WeakMap]",p="[object DataView]",y=u(i),g=u(r),_=u(a),v=u(o),x=u(l),b=s;(i&&b(new i(new ArrayBuffer(1)))!=p||r&&b(new r)!=d||a&&b(a.resolve())!=f||o&&b(new o)!=c||l&&b(new l)!=h)&&(b=function(t){var e=s(t),n="[object Object]"==e?t.constructor:void 0,i=n?u(n):"";if(i)switch(i){case y:return p;case g:return d;case _:return f;case v:return c;case x:return h}return e}),e.exports=b},{"./_DataView":51,"./_Map":54,"./_Promise":56,"./_Set":57,"./_WeakMap":62,"./_baseGetTag":91,"./_toSource":224}],169:[function(t,e,n){e.exports=function(t,e){return null==t?void 0:t[e]}},{}],170:[function(t,e,n){var l=t("./_castPath"),s=t("./isArguments"),u=t("./isArray"),d=t("./_isIndex"),f=t("./isLength"),c=t("./_toKey");e.exports=function(t,e,n){for(var i=-1,r=(e=l(e,t)).length,a=!1;++i<r;){var o=c(e[i]);if(!(a=null!=t&&n(t,o)))break;t=t[o]}return a||++i!=r?a:!!(r=null==t?0:t.length)&&f(r)&&d(o,r)&&(u(t)||s(t))}},{"./_castPath":133,"./_isIndex":181,"./_toKey":223,"./isArguments":242,"./isArray":243,"./isLength":249}],171:[function(t,e,n){var i=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(t){return i.test(t)}},{}],172:[function(t,e,n){var i=t("./_nativeCreate");e.exports=function(){this.__data__=i?i(null):{},this.size=0}},{"./_nativeCreate":201}],173:[function(t,e,n){e.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},{}],174:[function(t,e,n){var i=t("./_nativeCreate"),r=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;if(i){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return r.call(e,t)?e[t]:void 0}},{"./_nativeCreate":201}],175:[function(t,e,n){var i=t("./_nativeCreate"),r=Object.prototype.hasOwnProperty;e.exports=function(t){var e=this.__data__;return i?void 0!==e[t]:r.call(e,t)}},{"./_nativeCreate":201}],176:[function(t,e,n){var i=t("./_nativeCreate");e.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=i&&void 0===e?"__lodash_hash_undefined__":e,this}},{"./_nativeCreate":201}],177:[function(t,e,n){var i=Object.prototype.hasOwnProperty;e.exports=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&i.call(t,"index")&&(n.index=t.index,n.input=t.input),n}},{}],178:[function(t,e,n){var r=t("./_cloneArrayBuffer"),a=t("./_cloneDataView"),o=t("./_cloneRegExp"),l=t("./_cloneSymbol"),s=t("./_cloneTypedArray");e.exports=function(t,e,n){var i=t.constructor;switch(e){case"[object ArrayBuffer]":return r(t);case"[object Boolean]":case"[object Date]":return new i(+t);case"[object DataView]":return a(t,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(t,n);case"[object Map]":return new i;case"[object Number]":case"[object String]":return new i(t);case"[object RegExp]":return o(t);case"[object Set]":return new i;case"[object Symbol]":return l(t)}}},{"./_cloneArrayBuffer":134,"./_cloneDataView":136,"./_cloneRegExp":137,"./_cloneSymbol":138,"./_cloneTypedArray":139}],179:[function(t,e,n){var i=t("./_baseCreate"),r=t("./_getPrototype"),a=t("./_isPrototype");e.exports=function(t){return"function"!=typeof t.constructor||a(t)?{}:i(r(t))}},{"./_baseCreate":81,"./_getPrototype":164,"./_isPrototype":186}],180:[function(t,e,n){var i=t("./_Symbol"),r=t("./isArguments"),a=t("./isArray"),o=i?i.isConcatSpreadable:void 0;e.exports=function(t){return a(t)||r(t)||!!(o&&t&&t[o])}},{"./_Symbol":60,"./isArguments":242,"./isArray":243}],181:[function(t,e,n){var i=/^(?:0|[1-9]\d*)$/;e.exports=function(t,e){var n=c(t);return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&i.test(t))&&-1<t&&t%1==0&&t<e}},{}],182:[function(t,e,n){var r=t("./eq"),a=t("./isArrayLike"),o=t("./_isIndex"),l=t("./isObject");e.exports=function(t,e,n){if(!l(n))return!1;var i=c(e);return!!("number"==i?a(n)&&o(e,n.length):"string"==i&&e in n)&&r(n[e],t)}},{"./_isIndex":181,"./eq":231,"./isArrayLike":244,"./isObject":251}],183:[function(t,e,n){var i=t("./isArray"),r=t("./isSymbol"),a=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o=/^\w*$/;e.exports=function(t,e){if(i(t))return!1;var n=c(t);return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!r(t))||o.test(t)||!a.test(t)||null!=e&&t in Object(e)}},{"./isArray":243,"./isSymbol":256}],184:[function(t,e,n){e.exports=function(t){var e=c(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},{}],185:[function(t,e,n){var i,r=t("./_coreJsData"),a=(i=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";e.exports=function(t){return!!a&&a in t}},{"./_coreJsData":146}],186:[function(t,e,n){var i=Object.prototype;e.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||i)}},{}],187:[function(t,e,n){var i=t("./isObject");e.exports=function(t){return t==t&&!i(t)}},{"./isObject":251}],188:[function(t,e,n){e.exports=function(){this.__data__=[],this.size=0}},{}],189:[function(t,e,n){var i=t("./_assocIndexOf"),r=Array.prototype.splice;e.exports=function(t){var e=this.__data__,n=i(e,t);return!(n<0||(n==e.length-1?e.pop():r.call(e,n,1),--this.size,0))}},{"./_assocIndexOf":76}],190:[function(t,e,n){var i=t("./_assocIndexOf");e.exports=function(t){var e=this.__data__,n=i(e,t);return n<0?void 0:e[n][1]}},{"./_assocIndexOf":76}],191:[function(t,e,n){var i=t("./_assocIndexOf");e.exports=function(t){return-1<i(this.__data__,t)}},{"./_assocIndexOf":76}],192:[function(t,e,n){var r=t("./_assocIndexOf");e.exports=function(t,e){var n=this.__data__,i=r(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this}},{"./_assocIndexOf":76}],193:[function(t,e,n){var i=t("./_Hash"),r=t("./_ListCache"),a=t("./_Map");e.exports=function(){this.size=0,this.__data__={hash:new i,map:new(a||r),string:new i}}},{"./_Hash":52,"./_ListCache":53,"./_Map":54}],194:[function(t,e,n){var i=t("./_getMapData");e.exports=function(t){var e=i(this,t).delete(t);return this.size-=e?1:0,e}},{"./_getMapData":161}],195:[function(t,e,n){var i=t("./_getMapData");e.exports=function(t){return i(this,t).get(t)}},{"./_getMapData":161}],196:[function(t,e,n){var i=t("./_getMapData");e.exports=function(t){return i(this,t).has(t)}},{"./_getMapData":161}],197:[function(t,e,n){var r=t("./_getMapData");e.exports=function(t,e){var n=r(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this}},{"./_getMapData":161}],198:[function(t,e,n){e.exports=function(t){var n=-1,i=Array(t.size);return t.forEach(function(t,e){i[++n]=[e,t]}),i}},{}],199:[function(t,e,n){e.exports=function(e,n){return function(t){return null!=t&&t[e]===n&&(void 0!==n||e in Object(t))}}},{}],200:[function(t,e,n){var i=t("./memoize");e.exports=function(t){var e=i(t,function(t){return 500===n.size&&n.clear(),t}),n=e.cache;return e}},{"./memoize":265}],201:[function(t,e,n){var i=t("./_getNative")(Object,"create");e.exports=i},{"./_getNative":163}],202:[function(t,e,n){var i=t("./_overArg")(Object.keys,Object);e.exports=i},{"./_overArg":206}],203:[function(t,e,n){e.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},{}],204:[function(t,e,n){var i=t("./_freeGlobal"),r="object"==c(n)&&n&&!n.nodeType&&n,a=r&&"object"==c(e)&&e&&!e.nodeType&&e,o=a&&a.exports===r&&i.process,l=function(){try{return a&&a.require&&a.require("util").types||o&&o.binding&&o.binding("util")}catch(t){}}();e.exports=l},{"./_freeGlobal":158}],205:[function(t,e,n){var i=Object.prototype.toString;e.exports=function(t){return i.call(t)}},{}],206:[function(t,e,n){e.exports=function(e,n){return function(t){return e(n(t))}}},{}],207:[function(t,e,n){var s=t("./_apply"),u=Math.max;e.exports=function(a,o,l){return o=u(void 0===o?a.length-1:o,0),function(){for(var t=arguments,e=-1,n=u(t.length-o,0),i=Array(n);++e<n;)i[e]=t[o+e];e=-1;for(var r=Array(o+1);++e<o;)r[e]=t[e];return r[o]=l(i),s(a,this,r)}}},{"./_apply":63}],208:[function(t,e,n){var i=t("./_freeGlobal"),r="object"==("undefined"==typeof self?"undefined":c(self))&&self&&self.Object===Object&&self,a=i||r||Function("return this")();e.exports=a},{"./_freeGlobal":158}],209:[function(t,e,n){e.exports=function(t,e){return"__proto__"==e?void 0:t[e]}},{}],210:[function(t,e,n){e.exports=function(t){return this.__data__.set(t,"__lodash_hash_undefined__"),this}},{}],211:[function(t,e,n){e.exports=function(t){return this.__data__.has(t)}},{}],212:[function(t,e,n){e.exports=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n}},{}],213:[function(t,e,n){var i=t("./_baseSetToString"),r=t("./_shortOut")(i);e.exports=r},{"./_baseSetToString":123,"./_shortOut":214}],214:[function(t,e,n){var a=Date.now;e.exports=function(n){var i=0,r=0;return function(){var t=a(),e=16-(t-r);if(r=t,0<e){if(800<=++i)return arguments[0]}else i=0;return n.apply(void 0,arguments)}}},{}],215:[function(t,e,n){var i=t("./_ListCache");e.exports=function(){this.__data__=new i,this.size=0}},{"./_ListCache":53}],216:[function(t,e,n){e.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},{}],217:[function(t,e,n){e.exports=function(t){return this.__data__.get(t)}},{}],218:[function(t,e,n){e.exports=function(t){return this.__data__.has(t)}},{}],219:[function(t,e,n){var r=t("./_ListCache"),a=t("./_Map"),o=t("./_MapCache");e.exports=function(t,e){var n=this.__data__;if(n instanceof r){var i=n.__data__;if(!a||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new o(i)}return n.set(t,e),this.size=n.size,this}},{"./_ListCache":53,"./_Map":54,"./_MapCache":55}],220:[function(t,e,n){e.exports=function(t,e,n){for(var i=n-1,r=t.length;++i<r;)if(t[i]===e)return i;return-1}},{}],221:[function(t,e,n){var i=t("./_asciiSize"),r=t("./_hasUnicode"),a=t("./_unicodeSize");e.exports=function(t){return r(t)?a(t):i(t)}},{"./_asciiSize":73,"./_hasUnicode":171,"./_unicodeSize":225}],222:[function(t,e,n){var i=t("./_memoizeCapped"),a=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,r=i(function(t){var r=[];return 46===t.charCodeAt(0)&&r.push(""),t.replace(a,function(t,e,n,i){r.push(n?i.replace(o,"$1"):e||t)}),r});e.exports=r},{"./_memoizeCapped":200}],223:[function(t,e,n){var i=t("./isSymbol");e.exports=function(t){if("string"==typeof t||i(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},{"./isSymbol":256}],224:[function(t,e,n){var i=Function.prototype.toString;e.exports=function(t){if(null!=t){try{return i.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},{}],225:[function(t,e,n){var i="\\ud800-\\udfff",r="["+i+"]",a="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",o="\\ud83c[\\udffb-\\udfff]",l="[^"+i+"]",s="(?:\\ud83c[\\udde6-\\uddff]){2}",u="[\\ud800-\\udbff][\\udc00-\\udfff]",d="(?:"+a+"|"+o+")?",f="[\\ufe0e\\ufe0f]?",c=f+d+"(?:\\u200d(?:"+[l,s,u].join("|")+")"+f+d+")*",h="(?:"+[l+a+"?",a,s,u,r].join("|")+")",p=RegExp(o+"(?="+o+")|"+h+c,"g");e.exports=function(t){for(var e=p.lastIndex=0;p.test(t);)++e;return e}},{}],226:[function(t,e,n){var i=t("./_baseClone");e.exports=function(t){return i(t,4)}},{"./_baseClone":80}],227:[function(t,e,n){var i=t("./_baseClone");e.exports=function(t){return i(t,5)}},{"./_baseClone":80}],228:[function(t,e,n){e.exports=function(t){return function(){return t}}},{}],229:[function(t,e,n){var i=t("./_baseRest"),f=t("./eq"),c=t("./_isIterateeCall"),h=t("./keysIn"),p=Object.prototype,y=p.hasOwnProperty,r=i(function(t,e){t=Object(t);var n=-1,i=e.length,r=2<i?e[2]:void 0;for(r&&c(e[0],e[1],r)&&(i=1);++n<i;)for(var a=e[n],o=h(a),l=-1,s=o.length;++l<s;){var u=o[l],d=t[u];(void 0===d||f(d,p[u])&&!y.call(t,u))&&(t[u]=a[u])}return t});e.exports=r},{"./_baseRest":121,"./_isIterateeCall":182,"./eq":231,"./keysIn":260}],230:[function(t,e,n){e.exports=t("./forEach")},{"./forEach":236}],231:[function(t,e,n){e.exports=function(t,e){return t===e||t!=t&&e!=e}},{}],232:[function(t,e,n){var i=t("./_arrayFilter"),r=t("./_baseFilter"),a=t("./_baseIteratee"),o=t("./isArray");e.exports=function(t,e){return(o(t)?i:r)(t,a(e,3))}},{"./_arrayFilter":65,"./_baseFilter":84,"./_baseIteratee":105,"./isArray":243}],233:[function(t,e,n){var i=t("./_createFind")(t("./findIndex"));e.exports=i},{"./_createFind":150,"./findIndex":234}],234:[function(t,e,n){var a=t("./_baseFindIndex"),o=t("./_baseIteratee"),l=t("./toInteger"),s=Math.max;e.exports=function(t,e,n){var i=null==t?0:t.length;if(!i)return-1;var r=null==n?0:l(n);return r<0&&(r=s(i+r,0)),a(t,o(e,3),r)}},{"./_baseFindIndex":85,"./_baseIteratee":105,"./toInteger":280}],235:[function(t,e,n){var i=t("./_baseFlatten");e.exports=function(t){return null!=t&&t.length?i(t,1):[]}},{"./_baseFlatten":86}],236:[function(t,e,n){var i=t("./_arrayEach"),r=t("./_baseEach"),a=t("./_castFunction"),o=t("./isArray");e.exports=function(t,e){return(o(t)?i:r)(t,a(e))}},{"./_arrayEach":64,"./_baseEach":82,"./_castFunction":132,"./isArray":243}],237:[function(t,e,n){var i=t("./_baseFor"),r=t("./_castFunction"),a=t("./keysIn");e.exports=function(t,e){return null==t?t:i(t,r(e),a)}},{"./_baseFor":87,"./_castFunction":132,"./keysIn":260}],238:[function(t,e,n){var r=t("./_baseGet");e.exports=function(t,e,n){var i=null==t?void 0:r(t,e);return void 0===i?n:i}},{"./_baseGet":89}],239:[function(t,e,n){var i=t("./_baseHas"),r=t("./_hasPath");e.exports=function(t,e){return null!=t&&r(t,e,i)}},{"./_baseHas":93,"./_hasPath":170}],240:[function(t,e,n){var i=t("./_baseHasIn"),r=t("./_hasPath");e.exports=function(t,e){return null!=t&&r(t,e,i)}},{"./_baseHasIn":94,"./_hasPath":170}],241:[function(t,e,n){e.exports=function(t){return t}},{}],242:[function(t,e,n){var i=t("./_baseIsArguments"),r=t("./isObjectLike"),a=Object.prototype,o=a.hasOwnProperty,l=a.propertyIsEnumerable,s=i(function(){return arguments}())?i:function(t){return r(t)&&o.call(t,"callee")&&!l.call(t,"callee")};e.exports=s},{"./_baseIsArguments":96,"./isObjectLike":252}],243:[function(t,e,n){var i=Array.isArray;e.exports=i},{}],244:[function(t,e,n){var i=t("./isFunction"),r=t("./isLength");e.exports=function(t){return null!=t&&r(t.length)&&!i(t)}},{"./isFunction":248,"./isLength":249}],245:[function(t,e,n){var i=t("./isArrayLike"),r=t("./isObjectLike");e.exports=function(t){return r(t)&&i(t)}},{"./isArrayLike":244,"./isObjectLike":252}],246:[function(t,e,n){var i=t("./_root"),r=t("./stubFalse"),a="object"==c(n)&&n&&!n.nodeType&&n,o=a&&"object"==c(e)&&e&&!e.nodeType&&e,l=o&&o.exports===a?i.Buffer:void 0,s=(l?l.isBuffer:void 0)||r;e.exports=s},{"./_root":208,"./stubFalse":278}],247:[function(t,e,n){var i=t("./_baseKeys"),r=t("./_getTag"),a=t("./isArguments"),o=t("./isArray"),l=t("./isArrayLike"),s=t("./isBuffer"),u=t("./_isPrototype"),d=t("./isTypedArray"),f=Object.prototype.hasOwnProperty;e.exports=function(t){if(null==t)return!0;if(l(t)&&(o(t)||"string"==typeof t||"function"==typeof t.splice||s(t)||d(t)||a(t)))return!t.length;var e=r(t);if("[object Map]"==e||"[object Set]"==e)return!t.size;if(u(t))return!i(t).length;for(var n in t)if(f.call(t,n))return!1;return!0}},{"./_baseKeys":106,"./_getTag":168,"./_isPrototype":186,"./isArguments":242,"./isArray":243,"./isArrayLike":244,"./isBuffer":246,"./isTypedArray":257}],248:[function(t,e,n){var i=t("./_baseGetTag"),r=t("./isObject");e.exports=function(t){if(!r(t))return!1;var e=i(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},{"./_baseGetTag":91,"./isObject":251}],249:[function(t,e,n){e.exports=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},{}],250:[function(t,e,n){var i=t("./_baseIsMap"),r=t("./_baseUnary"),a=t("./_nodeUtil"),o=a&&a.isMap,l=o?r(o):i;e.exports=l},{"./_baseIsMap":99,"./_baseUnary":127,"./_nodeUtil":204}],251:[function(t,e,n){e.exports=function(t){var e=c(t);return null!=t&&("object"==e||"function"==e)}},{}],252:[function(t,e,n){e.exports=function(t){return null!=t&&"object"==c(t)}},{}],253:[function(t,e,n){var i=t("./_baseGetTag"),r=t("./_getPrototype"),a=t("./isObjectLike"),o=Function.prototype,l=Object.prototype,s=o.toString,u=l.hasOwnProperty,d=s.call(Object);e.exports=function(t){if(!a(t)||"[object Object]"!=i(t))return!1;var e=r(t);if(null===e)return!0;var n=u.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&s.call(n)==d}},{"./_baseGetTag":91,"./_getPrototype":164,"./isObjectLike":252}],254:[function(t,e,n){var i=t("./_baseIsSet"),r=t("./_baseUnary"),a=t("./_nodeUtil"),o=a&&a.isSet,l=o?r(o):i;e.exports=l},{"./_baseIsSet":103,"./_baseUnary":127,"./_nodeUtil":204}],255:[function(t,e,n){var i=t("./_baseGetTag"),r=t("./isArray"),a=t("./isObjectLike");e.exports=function(t){return"string"==typeof t||!r(t)&&a(t)&&"[object String]"==i(t)}},{"./_baseGetTag":91,"./isArray":243,"./isObjectLike":252}],256:[function(t,e,n){var i=t("./_baseGetTag"),r=t("./isObjectLike");e.exports=function(t){return"symbol"==c(t)||r(t)&&"[object Symbol]"==i(t)}},{"./_baseGetTag":91,"./isObjectLike":252}],257:[function(t,e,n){var i=t("./_baseIsTypedArray"),r=t("./_baseUnary"),a=t("./_nodeUtil"),o=a&&a.isTypedArray,l=o?r(o):i;e.exports=l},{"./_baseIsTypedArray":104,"./_baseUnary":127,"./_nodeUtil":204}],258:[function(t,e,n){e.exports=function(t){return void 0===t}},{}],259:[function(t,e,n){var i=t("./_arrayLikeKeys"),r=t("./_baseKeys"),a=t("./isArrayLike");e.exports=function(t){return a(t)?i(t):r(t)}},{"./_arrayLikeKeys":68,"./_baseKeys":106,"./isArrayLike":244}],260:[function(t,e,n){var i=t("./_arrayLikeKeys"),r=t("./_baseKeysIn"),a=t("./isArrayLike");e.exports=function(t){return a(t)?i(t,!0):r(t)}},{"./_arrayLikeKeys":68,"./_baseKeysIn":107,"./isArrayLike":244}],261:[function(t,e,n){e.exports=function(t){var e=null==t?0:t.length;return e?t[e-1]:void 0}},{}],262:[function(t,e,n){var i=t("./_arrayMap"),r=t("./_baseIteratee"),a=t("./_baseMap"),o=t("./isArray");e.exports=function(t,e){return(o(t)?i:a)(t,r(e,3))}},{"./_arrayMap":69,"./_baseIteratee":105,"./_baseMap":109,"./isArray":243}],263:[function(t,e,n){var a=t("./_baseAssignValue"),o=t("./_baseForOwn"),l=t("./_baseIteratee");e.exports=function(t,i){var r={};return i=l(i,3),o(t,function(t,e,n){a(r,e,i(t,e,n))}),r}},{"./_baseAssignValue":79,"./_baseForOwn":88,"./_baseIteratee":105}],264:[function(t,e,n){var i=t("./_baseExtremum"),r=t("./_baseGt"),a=t("./identity");e.exports=function(t){return t&&t.length?i(t,a,r):void 0}},{"./_baseExtremum":83,"./_baseGt":92,"./identity":241}],265:[function(t,e,n){var i=t("./_MapCache"),l="Expected a function";function s(r,a){if("function"!=typeof r||null!=a&&"function"!=typeof a)throw new TypeError(l);function o(){var t=arguments,e=a?a.apply(this,t):t[0],n=o.cache;if(n.has(e))return n.get(e);var i=r.apply(this,t);return o.cache=n.set(e,i)||n,i}return o.cache=new(s.Cache||i),o}s.Cache=i,e.exports=s},{"./_MapCache":55}],266:[function(t,e,n){var i=t("./_baseMerge"),r=t("./_createAssigner")(function(t,e,n){i(t,e,n)});e.exports=r},{"./_baseMerge":112,"./_createAssigner":147}],267:[function(t,e,n){var i=t("./_baseExtremum"),r=t("./_baseLt"),a=t("./identity");e.exports=function(t){return t&&t.length?i(t,a,r):void 0}},{"./_baseExtremum":83,"./_baseLt":108,"./identity":241}],268:[function(t,e,n){var i=t("./_baseExtremum"),r=t("./_baseIteratee"),a=t("./_baseLt");e.exports=function(t,e){return t&&t.length?i(t,r(e,2),a):void 0}},{"./_baseExtremum":83,"./_baseIteratee":105,"./_baseLt":108}],269:[function(t,e,n){e.exports=function(){}},{}],270:[function(t,e,n){var i=t("./_root");e.exports=function(){return i.Date.now()}},{"./_root":208}],271:[function(t,e,n){var i=t("./_basePick"),r=t("./_flatRest")(function(t,e){return null==t?{}:i(t,e)});e.exports=r},{"./_basePick":115,"./_flatRest":157}],272:[function(t,e,n){var i=t("./_baseProperty"),r=t("./_basePropertyDeep"),a=t("./_isKey"),o=t("./_toKey");e.exports=function(t){return a(t)?i(o(t)):r(t)}},{"./_baseProperty":117,"./_basePropertyDeep":118,"./_isKey":183,"./_toKey":223}],273:[function(t,e,n){var i=t("./_createRange")();e.exports=i},{"./_createRange":151}],274:[function(t,e,n){var a=t("./_arrayReduce"),o=t("./_baseEach"),l=t("./_baseIteratee"),s=t("./_baseReduce"),u=t("./isArray");e.exports=function(t,e,n){var i=u(t)?a:s,r=arguments.length<3;return i(t,l(e,4),n,r,o)}},{"./_arrayReduce":71,"./_baseEach":82,"./_baseIteratee":105,"./_baseReduce":120,"./isArray":243}],275:[function(t,e,n){var i=t("./_baseKeys"),r=t("./_getTag"),a=t("./isArrayLike"),o=t("./isString"),l=t("./_stringSize");e.exports=function(t){if(null==t)return 0;if(a(t))return o(t)?l(t):t.length;var e=r(t);return"[object Map]"==e||"[object Set]"==e?t.size:i(t).length}},{"./_baseKeys":106,"./_getTag":168,"./_stringSize":221,"./isArrayLike":244,"./isString":255}],276:[function(t,e,n){var i=t("./_baseFlatten"),r=t("./_baseOrderBy"),a=t("./_baseRest"),o=t("./_isIterateeCall"),l=a(function(t,e){if(null==t)return[];var n=e.length;return 1<n&&o(t,e[0],e[1])?e=[]:2<n&&o(e[0],e[1],e[2])&&(e=[e[0]]),r(t,i(e,1),[])});e.exports=l},{"./_baseFlatten":86,"./_baseOrderBy":114,"./_baseRest":121,"./_isIterateeCall":182}],277:[function(t,e,n){e.exports=function(){return[]}},{}],278:[function(t,e,n){e.exports=function(){return!1}},{}],279:[function(t,e,n){var i=t("./toNumber");e.exports=function(t){return t?(t=i(t))!==1/0&&t!==-1/0?t==t?t:0:17976931348623157e292*(t<0?-1:1):0===t?t:0}},{"./toNumber":281}],280:[function(t,e,n){var i=t("./toFinite");e.exports=function(t){var e=i(t),n=e%1;return e==e?n?e-n:e:0}},{"./toFinite":279}],281:[function(t,e,n){var i=t("./isObject"),r=t("./isSymbol"),a=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,s=/^0o[0-7]+$/i,u=parseInt;e.exports=function(t){if("number"==typeof t)return t;if(r(t))return NaN;if(i(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=i(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(a,"");var n=l.test(t);return n||s.test(t)?u(t.slice(2),n?2:8):o.test(t)?NaN:+t}},{"./isObject":251,"./isSymbol":256}],282:[function(t,e,n){var i=t("./_copyObject"),r=t("./keysIn");e.exports=function(t){return i(t,r(t))}},{"./_copyObject":143,"./keysIn":260}],283:[function(t,e,n){var i=t("./_baseToString");e.exports=function(t){return null==t?"":i(t)}},{"./_baseToString":126}],284:[function(t,e,n){var o=t("./_arrayEach"),l=t("./_baseCreate"),s=t("./_baseForOwn"),u=t("./_baseIteratee"),d=t("./_getPrototype"),f=t("./isArray"),c=t("./isBuffer"),h=t("./isFunction"),p=t("./isObject"),y=t("./isTypedArray");e.exports=function(t,i,r){var e=f(t),n=e||c(t)||y(t);if(i=u(i,4),null==r){var a=t&&t.constructor;r=n?e?new a:[]:p(t)&&h(a)?l(d(t)):{}}return(n?o:s)(t,function(t,e,n){return i(r,t,e,n)}),r}},{"./_arrayEach":64,"./_baseCreate":81,"./_baseForOwn":88,"./_baseIteratee":105,"./_getPrototype":164,"./isArray":243,"./isBuffer":246,"./isFunction":248,"./isObject":251,"./isTypedArray":257}],285:[function(t,e,n){var i=t("./_baseFlatten"),r=t("./_baseRest"),a=t("./_baseUniq"),o=t("./isArrayLikeObject"),l=r(function(t){return a(i(t,1,o,!0))});e.exports=l},{"./_baseFlatten":86,"./_baseRest":121,"./_baseUniq":128,"./isArrayLikeObject":245}],286:[function(t,e,n){var i=t("./toString"),r=0;e.exports=function(t){var e=++r;return i(t)+e}},{"./toString":283}],287:[function(t,e,n){var i=t("./_baseValues"),r=t("./keys");e.exports=function(t){return null==t?[]:i(t,r(t))}},{"./_baseValues":129,"./keys":259}],288:[function(t,e,n){var i=t("./_assignValue"),r=t("./_baseZipObject");e.exports=function(t,e){return r(t||[],e||[],i)}},{"./_assignValue":75,"./_baseZipObject":130}]},{},[1])(1)})});t(e(function(t,e){!function(t,e,n){Object.defineProperty(t,"__esModule",{value:!0});var i,r=(i=n)&&i.__esModule?i:{default:i};e.global.registerLayout("dagre",r.default),t.default=r.default}(e,i,L)})),t(e(function(t,e){!function(t,e,n){Object.defineProperty(t,"__esModule",{value:!0});var i,v=(i=e)&&i.__esModule?i:{default:i};function r(){var f=(0,v.default)().sort(null).value(null),y=a,c=[1,1],h=null;function e(t,e){var n=f.call(this,t,e),i=n[0],r=function(t){var e,n={A:null,children:[t]},i=[n];for(;null!=(e=i.pop());)for(var r,a=e.children,o=0,l=a.length;o<l;++o)i.push((a[o]=r={_:a[o],parent:e,children:(r=a[o].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=r);return n.children[0]}(i);if(v.default.layout_hierarchyVisitAfter(r,p),r.parent.m=-r.z,v.default.layout_hierarchyVisitBefore(r,g),h)v.default.layout_hierarchyVisitBefore(i,_);else{var a=i,o=i,l=i;v.default.layout_hierarchyVisitBefore(i,function(t){t.x<a.x&&(a=t),t.x>o.x&&(o=t),t.depth>l.depth&&(l=t)});var s=y(a,o)/2-a.x,u=c[0]/(o.x+y(o,a)/2+s),d=c[1]/(l.depth||1);v.default.layout_hierarchyVisitBefore(i,function(t){t.x=(t.x+s)*u,t.y=t.depth*d})}return n}function p(t){var e=t.children,n=t.parent.children,i=t.i?n[t.i-1]:null;if(e.length){!function(t){var e,n=0,i=0,r=t.children,a=r.length;for(;0<=--a;)(e=r[a]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}(t);var r=(e[0].z+e[e.length-1].z)/2;i?(t.z=i.z+y(t._,i._),t.m=t.z-r):t.z=r}else i&&(t.z=i.z+y(t._,i._));t.parent.A=function(t,e,n){if(e){for(var i,r=t,a=t,o=e,l=r.parent.children[0],s=r.m,u=a.m,d=o.m,f=l.m;o=b(o),r=x(r),o&&r;)l=x(l),(a=b(a)).a=t,0<(i=o.z+d-r.z-s+y(o._,r._))&&(m((h=t,p=n,(c=o).a.parent===h.parent?c.a:p),t,i),s+=i,u+=i),d+=o.m,s+=r.m,f+=l.m,u+=a.m;o&&!b(a)&&(a.t=o,a.m+=d-u),r&&!x(l)&&(l.t=r,l.m+=s-f,n=t)}var c,h,p;return n}(t,i,t.parent.A||n[0])}function g(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function _(t){t.x*=c[0],t.y=t.depth*c[1]}return e.separation=function(t){return arguments.length?(y=t,e):y},e.size=function(t){return arguments.length?(h=null==(c=t)?_:null,e):h?null:c},e.nodeSize=function(t){return arguments.length?(h=null==(c=t)?null:_,e):h?c:null},v.default.layout_hierarchyRebind(e,f)}function a(t,e){return t.parent==e.parent?1:2}function x(t){var e=t.children;return e.length?e[0]:t.t}function b(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function m(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}n.global.registerLayout("tree",r),t.default=r}(e,M,i)}));var F=e(function(t,e){var n;n=e,Object.defineProperty(n,"__esModule",{value:!0}),n.default=function e(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};!function(t){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),this.comp=t,this.params=n}});return t(F),t(e(function(t,e){!function(t,e,n,v,i){Object.defineProperty(t,"__esModule",{value:!0});var r=a(e),x=a(n),b=a(i);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var m=x.default.Shapes.Circle,c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(h,r.default),d(h,null,[{key:"defaultProps",value:function(){return{data:{detail:"图例数据",default:[],documentation:'                    数据结构为：{name: "uv", color: "#ff8533", field: "" ...}                    如果手动传入数据只需要前面这三个 enabled: true, ind: 0                    外部只需要传field和fillStyle就行了                    '},position:{detail:"图例位置",documentation:"图例所在的方向top,right,bottom,left",default:"top"},direction:{detail:"图例布局方向",default:"h",documentation:"横向 top,bottom --\x3e h left,right -- >v"},textAlign:{detail:"水平方向的对其，默认居左对其",default:"left",documentation:"可选left，center，right"},verticalAlign:{detail:"垂直方向的对其方式，默认居中（待实现）",default:"middle",documentation:"可选top，middle，bottom"},icon:{detail:"图标设置",propertys:{height:{detail:"高",default:26},width:{detail:"图标宽",default:"auto"},shapeType:{detail:"图标的图形类型，目前只实现了圆形",default:"circle"},radius:{detail:"图标（circle）半径",default:5},lineWidth:{detail:"图标描边宽度",default:1},fillStyle:{detail:"图标颜色，一般会从data里面取，这里是默认色",default:"#999"}}},label:{detail:"文本配置",propertys:{textAlign:{detail:"水平对齐方式",default:"left"},textBaseline:{detail:"文本基线对齐方式",default:"middle"},fontColor:{detail:"文本颜色",default:"#333333"},cursor:{detail:"鼠标样式",default:"pointer"},format:{detail:"文本格式化处理函数",default:null}}},activeEnabled:{detail:"是否启动图例的",default:!0},tipsEnabled:{detail:"是否开启图例的tips",default:!1}}}}]),d(h,[{key:"_getLegendData",value:function(t){var e=t.data;return e?v._.each(e,function(t,e){t.enabled=!0,t.ind=e}):e=this.app.getLegendData(),e||[]}},{key:"layout",value:function(){var t,e=this.app,n=this.width+this.margin.left+this.margin.right,i=this.height+this.margin.top+this.margin.bottom,r=e.padding.left,a=e.padding.top;return"right"==this.position&&(r=e.width-e.padding.right-n),"bottom"==this.position&&(a=e.height-e.padding.bottom-i/2),"left"==this.position||"right"==this.position?(e.padding[this.position]+=n,t=n,e.height,e.padding.top,e.padding.bottom):"top"!=this.position&&"bottom"!=this.position||(e.padding[this.position]+=i,t=e.width-e.padding.right-e.padding.left),"center"==this.textAlign&&(r+=t/2-this.width/2),"right"==this.textAlign&&(r+=t-this.width),this.pos={x:r,y:a},this.pos}},{key:"draw",value:function(){var t=this.app.getComponent({name:"coord"});t&&"rect"==t.type&&("left"!=this.textAlign||"top"!=this.position&&"bottom"!=this.position||(this.pos.x=t.getSizeAndOrigin().origin.x+this.icon.radius)),this.setPosition()}},{key:"widget",value:function(){var s=this,u=this.app.width-this.app.padding.left-this.app.padding.right,d=this.app.height-this.app.padding.top-this.app.padding.bottom,f=0,c=0,h=0,p=0,y=0,g=1,_=!1;v._.each(this.data,function(e,t){if(!_){var n=new m({id:"legend_field_icon_"+t,context:{x:0,y:s.icon.height/3,fillStyle:e.enabled?e.color||"#999":"#ccc",r:s.icon.radius,cursor:"pointer"}});n.on(v.event.types.get(),function(t){});var i=e.name;s.label.format&&(i=s.label.format(e.name,e));var r=new x.default.Display.Text(i,{id:"legend_field_txt_"+t,context:{x:s.icon.radius+3,y:s.icon.height/3,textAlign:s.label.textAlign,textBaseline:s.label.textBaseline,fillStyle:s.label.fontColor,cursor:s.label.cursor}});r.on(v.event.types.get(),function(t){});var a=r.getTextWidth()+2*s.icon.radius+20;f=Math.max(f,a);var o={height:s.icon.height};if("v"==s.direction){if(y+s.icon.height>d){if(.3*u<p)return void(_=!0);p+=f,y=0}o.x=p,o.y=y,y+=s.icon.height,h=Math.max(h,y)}else{if(u<p+a){if(s.icon.height*(g+1)>.3*d)return void(_=!0);p=0,g++}o.x=p,o.y=s.icon.height*(g-1),p+=a,c=Math.max(c,p)}var l=new x.default.Display.Sprite({id:"legend_field_"+t,context:o});l.addChild(n),l.addChild(r),l.context.width=a,s.sprite.addChild(l),l.on(v.event.types.get(),function(t){if("click"==t.type&&s.activeEnabled){if(1==v._.filter(s.data,function(t){return t.enabled}).length&&e.enabled)return;e.enabled=!e.enabled,n.context.fillStyle=e.enabled?e.color||"#999":"#ccc",e.enabled?s.app.show(e.name,new b.default(this,e)):s.app.hide(e.name,new b.default(this,e))}s.tipsEnabled&&("mouseover"!=t.type&&"mousemove"!=t.type||(t.eventInfo=s._getInfoHandler(t,e)),"mouseout"==t.type&&delete t.eventInfo,s.app.fire(t.type,t))})}}),"h"==this.direction?(s.width=s.sprite.context.width=c,s.height=s.sprite.context.height=s.icon.height*g):(s.width=s.sprite.context.width=p+f,s.height=s.sprite.context.height=h)}},{key:"_getInfoHandler",value:function(t,e){return{type:"legend",triggerType:"legend",trigger:this,tipsEnabled:this.tipsEnabled,nodes:[{name:e.name,fillStyle:e.color}]}}}]),h);function h(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?s(t):e}(this,l(h).call(this,t,e))).name="legend",v._.extend(!0,s(n),(0,v.getDefaultProps)(h.defaultProps()),t),n.data=n._getLegendData(t),!t.direction&&t.position&&("left"==n.position||"right"==n.position?n.direction="v":n.direction="h"),n.sprite=new x.default.Display.Sprite({id:"LegendSprite",context:{x:n.pos.x,y:n.pos.y}}),n.app.stage.addChild(n.sprite),n.widget(),n.layout(),n}v.global.registerComponent(c,"legend"),t.default=c}(e,a,n,i,F)})),t(e(function(t,e){!function(t,e,n,d,i){Object.defineProperty(t,"__esModule",{value:!0});var r=a(e),l=a(n),o=a(i);function a(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function h(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var y=l.default.Shapes.Line,g=l.default.Shapes.Rect,_=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&p(t,e)}(v,r.default),h(v,null,[{key:"defaultProps",value:function(){return{position:{detail:"位置",default:"bottom"},direction:{detail:"方向",default:"h"},height:{detail:"高",default:26},width:{detail:"宽",default:100},color:{detail:"颜色",default:"#008ae6"},range:{detail:"范围设置",propertys:{start:{detail:"开始位置",default:0},end:{detail:"结束位置，默认为null，表示到最后",default:null},max:{detail:"可以外围控制智能在哪个区间拖动",default:null},min:{detail:"最少至少选中了几个数据",default:1}}},left:{detail:"左边按钮",propertys:{eventEnabled:{detail:"是否响应事件",default:!0},fillStyle:{detail:"颜色，默认取组件.color",default:null}}},right:{detail:"右边按钮",propertys:{eventEnabled:{detail:"是否响应事件",default:!0},fillStyle:{detail:"颜色，默认取组件.color",default:null}}},center:{detail:"中间位置设置",propertys:{eventEnabled:{detail:"是否响应事件",default:!0},fillStyle:{detail:"填充色",default:"#000000"},alpha:{detail:"透明度",default:.015}}},bg:{detail:"背景设置",propertys:{enabled:{detail:"是否开启",default:!0},fillStyle:{detail:"填充色",default:""},strokeStyle:{detail:"边框色",default:"#e6e6e6"},lineWidth:{detail:"线宽",default:1}}},graphAlpha:{detail:"图形的透明度",default:.6},graphStyle:{detail:"图形的颜色",default:"#dddddd"},underline:{detail:"underline",propertys:{enabled:{detail:"是否开启",default:!0},strokeStyle:{detail:"线条色",default:null},lineWidth:{detail:"线宽",default:2}}},btnOut:{detail:"left,right按钮突出的大小",default:6},btnHeight:{detail:"left,right按钮高",default:20,documentation:"left,right按钮的高，不在left，right下面，统一在这个属性里， 以为要强制保持一致"},btnWidth:{detail:"left,right按钮的宽",default:8,documentation:"left,right按钮的宽，不在left，right下面，统一在这个属性里， 以为要强制保持一致"}}}}]),h(v,[{key:"layout",value:function(){var t=this.app;"bottom"==this.position&&(this.pos.y=t.height-(this.height+t.padding.bottom+this.margin.bottom),t.padding.bottom+=this.height+this.margin.top+this.margin.bottom),"top"==this.position&&(this.pos.y=t.padding.top+this.margin.top,t.padding.top+=this.height+this.margin.top+this.margin.bottom)}},{key:"_getCloneChart",value:function(){var o=this,l=this.app,s=l.getCoord(),t=l.constructor,e=l.el.cloneNode();e.innerHTML="",e.id=l.el.id+"_currclone",e.style.position="absolute",e.style.width=this.width+"px",e.style.height=this.btnHeight+"px",e.style.top="10000px",document.body.appendChild(e);var u=[];d._.each(l.getComponents({name:"graphs"}),function(t){var e=t.enabledField||t.field;if(d._.flatten([e]).length){var n=d._.extend(!0,{},t._opt);n.field=e;var i={};"bar"==t.type&&(i={node:{}},o.graphStyle&&(i.node.fillStyle=o.graphStyle)),"line"==t.type&&(i={line:{lineWidth:1},node:{enabled:!1},area:{}},o.graphStyle&&(i.line.strokeStyle=o.graphStyle,i.area.fillStyle=o.graphStyle));var r=s.height||l.el.offsetHeight,a=o.btnHeight/r||1;"scat"==t.type&&(i={node:{radiusScale:a}},o.graphStyle),u.push(d._.extend(!0,n,i,{label:{enabled:!1},animation:!1}))}});var n={coord:l._opt.coord,graphs:u};n.coord.horizontal&&delete n.coord.horizontal,n.coord.enabled=!1,n.coord.padding=0;var i=new t(e,l._data,n,l.componentModules);return i.draw(),{thumbChart:i,cloneEl:e}}},{key:"_setDataZoomOpt",value:function(){var e=this.app,t=e.getComponent({name:"coord"}).getSizeAndOrigin(),a=this;d._.extend(!0,this,{width:parseInt(t.width),pos:{x:t.origin.x},dragIng:function(r){var t;"proportion"==a.axisLayoutType?(t=new o.default(a,{min:r.start,max:r.end}),e.dataFrame.filters.datazoom=function(t){var e=t[a.axis.field],n=a.axis.getValOfPos(r.start),i=a.axis.getValOfPos(r.end);return n<=e&&e<=i}):(t=new o.default(a,{left:e.dataFrame.range.start-r.start,right:r.end-e.dataFrame.range.end}),d._.extend(e.dataFrame.range,r)),e.resetData(null,t),e.fire("dataZoomDragIng")},dragEnd:function(){e.updateChecked&&e.updateChecked(),e.fire("dataZoomDragEnd")}})}},{key:"draw",value:function(){this._setDataZoomOpt(),this._cloneChart=this._getCloneChart(),this.axis=this._cloneChart.thumbChart.getComponent({name:"coord"})._xAxis,this.axisLayoutType=this.axis.layoutType,this._computeAttrs(),this.widget(),this._setLines(),this.setZoomBg(),this.setPosition()}},{key:"destroy",value:function(){this.sprite.destroy()}},{key:"reset",value:function(t){t=t||{};var e=this.count,n=this.range.start,i=this.range.end;t&&d._.extend(!0,this,t),this._cloneChart=this._getCloneChart(),this._computeAttrs(t),e==this.count&&(!t.range||t.range.start==n&&t.range.end==i)||(this.widget(),this._setLines()),this.setZoomBg()}},{key:"_computeAttrs",value:function(){var t=this._cloneChart.thumbChart;switch(this.dataLen=t.dataFrame.length,this.axisLayoutType){case"rule":this.count=this.dataLen-1;break;case"peak":this.count=this.dataLen;break;case"proportion":this.count=this.width}(!this._opt.range||this._opt.range&&!this._opt.range.max||this.range.max>this.count)&&(this.range.max=this.count-1),(!this._opt.range||this._opt.range&&!this._opt.range.end||this.range.end>this.dataLen-1)&&(this.range.end=this.dataLen-1,"proportion"==this.axisLayoutType&&(this.range.end=this.count-1)),!this.direction&&this.position&&("left"==this.position||"right"==this.position?this.direction="v":this.direction="h"),this.disPart=this._getDisPart(),this.btnHeight=this.height-this.btnOut}},{key:"_getDisPart",value:function(){var t=this,e=Math.max(parseInt(t.range.min/2/t.count*t.width),23),n=parseInt((t.range.max+1)/t.count*t.width);return"peak"==this.axisLayoutType&&(e=Math.max(parseInt(t.range.min/t.count*t.width),23)),"proportion"==this.axisLayoutType&&(n=t.width),{min:e,max:n}}},{key:"_getRangeEnd",value:function(t){return void 0===t&&(t=this.range.end),"peak"==this.axisLayoutType&&(t+=1),"proportion"==this.axisLayoutType&&(t+=1),t}},{key:"widget",value:function(){function t(){e._setLines.apply(e,arguments)}var e=this;if(e.bg.enabled){var n={x:0,y:0,width:e.width,height:e.btnHeight,lineWidth:e.bg.lineWidth,strokeStyle:e.bg.strokeStyle,fillStyle:e.bg.fillStyle};e._bgRect?e._bgRect.animate(n,{onUpdate:t}):(e._bgRect=new g({context:n}),e.dataZoomBg.addChild(e._bgRect))}if(e.underline.enabled){var i={start:{x:e.range.start/e.count*e.width+e.btnWidth/2,y:e.btnHeight},end:{x:e._getRangeEnd()/e.count*e.width-e.btnWidth/2,y:e.btnHeight},lineWidth:e.underline.lineWidth,strokeStyle:e.underline.strokeStyle||e.color};e._underline?e._underline.animate(i,{onUpdate:t}):(e._underline=e._addLine(i),e.dataZoomBg.addChild(e._underline))}var r={x:e.range.start/e.count*e.width,y:-e.btnOut/2+1,width:e.btnWidth,height:e.btnHeight+e.btnOut,fillStyle:e.left.fillStyle||e.color,cursor:e.left.eventEnabled&&"move"};e._btnLeft?e._btnLeft.animate(r,{onUpdate:t}):(e._btnLeft=new g({id:"btnLeft",dragEnabled:e.left.eventEnabled,context:r}),e._btnLeft.on("draging",function(t){this.context.y=-e.btnOut/2+1,this.context.x<0&&(this.context.x=0),this.context.x>e._btnRight.context.x-e.btnWidth-2&&(this.context.x=e._btnRight.context.x-e.btnWidth-2),e._btnRight.context.x+e.btnWidth-this.context.x>=e.disPart.max&&(this.context.x=e._btnRight.context.x+e.btnWidth-e.disPart.max),e._btnRight.context.x+e.btnWidth-this.context.x<e.disPart.min&&(this.context.x=e._btnRight.context.x+e.btnWidth-e.disPart.min),e.rangeRect.context.width=e._btnRight.context.x-this.context.x-e.btnWidth,e.rangeRect.context.x=this.context.x+e.btnWidth,e._setRange()}),e._btnLeft.on("dragend",function(t){e.dragEnd(e.range)}),this.dataZoomBtns.addChild(this._btnLeft));var a={x:e._getRangeEnd()/e.count*e.width-e.btnWidth,y:-e.btnOut/2+1,width:e.btnWidth,height:e.btnHeight+e.btnOut,fillStyle:e.right.fillStyle||e.color,cursor:e.right.eventEnabled&&"move"};e._btnRight?e._btnRight.animate(a,{onUpdate:t}):(e._btnRight=new g({id:"btnRight",dragEnabled:e.right.eventEnabled,context:a}),e._btnRight.on("draging",function(t){this.context.y=-e.btnOut/2+1,this.context.x>e.width-e.btnWidth&&(this.context.x=e.width-e.btnWidth),this.context.x+e.btnWidth-e._btnLeft.context.x>=e.disPart.max&&(this.context.x=e.disPart.max-(e.btnWidth-e._btnLeft.context.x)),this.context.x+e.btnWidth-e._btnLeft.context.x<e.disPart.min&&(this.context.x=e.disPart.min-e.btnWidth+e._btnLeft.context.x),e.rangeRect.context.width=this.context.x-e._btnLeft.context.x-e.btnWidth,e._setRange()}),e._btnRight.on("dragend",function(t){e.dragEnd(e.range)}),this.dataZoomBtns.addChild(this._btnRight));var o={x:r.x+e.btnWidth,y:1,width:a.x-r.x-e.btnWidth,height:this.btnHeight-1,fillStyle:e.center.fillStyle,fillAlpha:e.center.alpha,cursor:"move"};this.rangeRect?this.rangeRect.animate(o,{onUpdate:t}):(this.rangeRect=new g({id:"btnCenter",dragEnabled:!0,context:o}),this.rangeRect.on("draging",function(t){this.context.y=1,this.context.x<e.btnWidth&&(this.context.x=e.btnWidth),this.context.x>e.width-this.context.width-e.btnWidth&&(this.context.x=e.width-this.context.width-e.btnWidth),e._btnLeft.context.x=this.context.x-e.btnWidth,e._btnRight.context.x=this.context.x+this.context.width,e._setRange("btnCenter")}),this.rangeRect.on("dragend",function(t){e.dragEnd(e.range)}),this.dataZoomBtns.addChild(this.rangeRect)),this.linesLeft||(this.linesLeft=new l.default.Display.Sprite({id:"linesLeft"}),this.left.eventEnabled&&this._addLines({sprite:this.linesLeft}),this.dataZoomBtns.addChild(this.linesLeft)),this.linesRight||(this.linesRight=new l.default.Display.Sprite({id:"linesRight"}),this.right.eventEnabled&&this._addLines({sprite:this.linesRight}),this.dataZoomBtns.addChild(this.linesRight)),this.linesCenter||(this.linesCenter=new l.default.Display.Sprite({id:"linesCenter"}),this._addLines({count:3,sprite:this.linesCenter,strokeStyle:this.color}),this.dataZoomBtns.addChild(this.linesCenter))}},{key:"_setRange",value:function(t){var e=this,n=e._getRangeEnd(),i=n-e.range.start,r=e._btnLeft.context.x/e.width*e.count,a=(e._btnRight.context.x+e.btnWidth)/e.width*e.count;a="peak"==this.axisLayoutType?(r=Math.round(r),Math.round(a)):(this.axisLayoutType,r=parseInt(r),parseInt(a)),"btnCenter"==t&&a-r!=i&&(a=r+i),r==e.range.start&&a==n||(e.range.start=r,"peak"==e.axisLayoutType&&(a-=1),e.range.end=a,e.dragIng(e.range)),e._setLines()}},{key:"_setLines",value:function(){var t=this,e=this.linesLeft,n=this.linesRight,i=this.linesCenter,r=this._btnLeft,a=this._btnRight,o=this.rangeRect;e.context.x=r.context.x+(r.context.width-e.context.width)/2,e.context.y=r.context.y+(r.context.height-e.context.height)/2,n.context.x=a.context.x+(a.context.width-n.context.width)/2,n.context.y=a.context.y+(a.context.height-n.context.height)/2,i.context.x=o.context.x+(o.context.width-i.context.width)/2,i.context.y=o.context.y+(o.context.height-i.context.height)/2,t.underline.enabled&&(t._underline.context.start.x=e.context.x+t.btnWidth/2,t._underline.context.end.x=n.context.x+t.btnWidth/2)}},{key:"_addLines",value:function(t){for(var e=t.count||2,n=t.sprite,i=t.dis||2,r=0,a=e;r<a;r++)n.addChild(this._addLine({x:r*i,strokeStyle:t.strokeStyle||""}));n.context.width=r*i-1,n.context.height=6}},{key:"_addLine",value:function(t){var e=t||{};return new y({id:e.id||"",context:{x:e.x||0,y:e.y||0,start:{x:e.start?e.start.x:0,y:e.start?e.start.y:0},end:{x:e.end?e.end.x:0,y:e.end?e.end.y:6},lineWidth:e.lineWidth||1,strokeStyle:e.strokeStyle||"#ffffff"}})}},{key:"setZoomBg",value:function(){this.__graphssp&&this.__graphssp.destroy();var t=this._cloneChart.thumbChart.graphsSprite;t.setEventEnable(!1);var e=this._cloneChart.thumbChart.getComponent({name:"coord"});t.id=t.id+"_datazoomthumbChartbg",t.context.x=-e.origin.x,t.context.scaleY=this.btnHeight/e.height,t.context.scaleX=this.width/e.width,t.context.globalAlpha=this.graphAlpha,this.dataZoomBg.addChild(t,0),this.__graphssp=t,this._cloneChart.thumbChart.destroy(),this._cloneChart.cloneEl.parentNode.removeChild(this._cloneChart.cloneEl)}}]),v);function v(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,v),(n=function(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?f(t):e}(this,u(v).call(this,t,e))).name="dataZoom",n._cloneChart=null,n.count=1,n.dataLen=1,n.axisLayoutType=null,n.dragIng=function(){},n.dragEnd=function(){},n.disPart={},n._btnLeft=null,n._btnRight=null,n._underline=null,n.sprite=new l.default.Display.Sprite({id:"dataZoom",context:{x:n.pos.x,y:n.pos.y}}),n.sprite.noSkip=!0,n.dataZoomBg=new l.default.Display.Sprite({id:"dataZoomBg"}),n.dataZoomBtns=new l.default.Display.Sprite({id:"dataZoomBtns"}),n.sprite.addChild(n.dataZoomBg),n.sprite.addChild(n.dataZoomBtns),e.stage.addChild(n.sprite),d._.extend(!0,f(n),(0,d.getDefaultProps)(v.defaultProps()),t),"margin"in t||("bottom"==n.position&&(n.margin.top=10),"top"==n.position&&(n.margin.bottom=10)),n.axis=null,n.layout(),n}d.global.registerComponent(_,"dataZoom"),t.default=_}(e,a,n,i,F)})),t(e(function(t,e){!function(t,e,n,u){Object.defineProperty(t,"__esModule",{value:!0});var i=a(e),r=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=r.default.Shapes.BrokenLine,p=r.default.Display.Sprite,y=r.default.Display.Text,g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(_,i.default),f(_,null,[{key:"defaultProps",value:function(){return{markTo:{detail:"标准哪个目标字段",default:null},yVal:{detail:"组件的值",default:0,documentation:"可能是个function，均值计算就是个function"},line:{detail:"线的配置",propertys:{strokeStyle:{detail:"线的颜色",default:"#999999"},lineWidth:{detail:"线宽",default:1},lineType:{detail:"线样式",default:"dashed"}}},label:{detail:"文本",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本字体颜色",default:"#999999"},fontSize:{detail:"文本字体大小",default:12},text:{detail:"文本内容",default:null},format:{detail:"文本格式化函数",default:null}}}}}}]),f(_,[{key:"draw",value:function(){this._calculateProps(),this.setPosition(),this.widget()}},{key:"_calculateProps",value:function(){var t=this._opt,i=t.markTo,e=this.app.getComponent({name:"coord"});if(!i||-1!=u._.indexOf(this.app.dataFrame.fields,i)){var n,r=e._yAxis[0];i&&u._.each(e._yAxis,function(t,e){var n=u._.flatten([t.field]);0<=u._.indexOf(n,i)&&(r=t)}),t.yAxisAlign&&(r=e._yAxis["left"==t.yAxisAlign?0:1]),n=void 0!==t.y&&null!==t.y?Number(t.y):function(){var t=this.app.dataFrame.getFieldData(i),e=0;return u._.each(t,function(t){Number(t)&&(e+=t)}),e/t.length},isNaN(n)||r.drawWaterLine(n);var a="#777",o=e.getFieldMapOf(i);o&&(a=o.color);var l=t.line&&t.line.strokeStyle||a,s=t.label&&t.label.fontColor||a;this._yAxis=r,this.width=e.width,this.height=e.height,this.yVal=n,this.pos={x:e.origin.x,y:e.origin.y},this.line.list=[[0,0],[this.width,0]],this.label.fontColor=s,l&&(this.line.strokeStyle=l)}}},{key:"widget",value:function(){var t=this,e=this._getYPos(),n=new h({id:"line",context:{y:e,pointList:t.line.list,strokeStyle:t.line.strokeStyle,lineWidth:t.line.lineWidth,lineType:t.line.lineType}});if(t.sprite.addChild(n),t._line=n,t.label.enabled){var i=new y(t._getLabel(),{context:t.label});this._txt=i,t.sprite.addChild(i),t._setTxtPos(e)}this.line.y=e}},{key:"reset",value:function(t){t&&u._.extend(!0,this,t);var e=this,n=this._getYPos();n!=this.line.y&&this._line.animate({y:n},{duration:300,onUpdate:function(t){e.label.enabled&&(e._txt.resetText(e._getLabel()),e._setTxtPos(t.y))}}),this._line.context.strokeStyle=this.line.strokeStyle,this.line.y=n}},{key:"_setTxtPos",value:function(t){var e=this._txt;"left"==this._yAxis.align?e.context.x=5:e.context.x=this.width-e.getTextWidth()-5,u._.isNumber(this.label.y)?e.context.y=this.label.y:e.context.y=t-e.getTextHeight()}},{key:"_getYVal",value:function(t){var e=t=t||this.yVal;return u._.isFunction(t)&&(e=t.apply(this)),e}},{key:"_getYPos",value:function(){return-this._yAxis.getPosOfVal(this._getYVal())}},{key:"_getLabel",value:function(){var t=this._getYVal();return u._.isFunction(this.label.format)?this.label.format(t,this):u._.isString(this.label.text)?this.label.text:t}}]),_);function _(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,_),(n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?s(t):e}(this,l(_).call(this,t,e))).name="markLine",n._yAxis=null,n.line={y:0,list:[]},n._txt=null,n._line=null,n.sprite=new p,n.app.graphsSprite.addChild(n.sprite),u._.extend(!0,s(n),(0,u.getDefaultProps)(_.defaultProps()),t),n}u.global.registerComponent(g,"markLine"),t.default=g}(e,a,n,i)})),t(e(function(t,e){!function(t,e,n,l,r){Object.defineProperty(t,"__esModule",{value:!0});var i=o(e),a=o(n);function o(t){return t&&t.__esModule?t:{default:t}}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function c(t,e,n){return e&&f(t.prototype,e),n&&f(t,n),t}function h(t,e){return(h=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var p=a.default.Shapes.Rect,y=a.default.Shapes.Line,g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&h(t,e)}(_,i.default),c(_,null,[{key:"defaultProps",value:function(){return{enabled:{detail:"是否开启Tips",default:!0},content:{detail:"自定义tips的内容（html）",default:null},borderRadius:{detail:"tips的边框圆角半径",default:5},strokeStyle:{detail:"tips边框颜色",default:"#ccc"},fillStyle:{detail:"tips背景色",default:"rgba(255,255,255,0.95)"},fontColor:{detail:"tips文本颜色",default:"#999999"},positionOfPoint:{detail:"在触发点的位置",default:"right"},offsetX:{detail:"tips内容到鼠标位置的偏移量x",default:10},offsetY:{detail:"tips内容到鼠标位置的偏移量y",default:10},positionInRange:{detail:"tip的浮层是否限定在画布区域",default:!0},pointer:{detail:"触发tips的时候的指针样式",default:"line",documentation:'tips的指针,默认为直线，可选为："line" | "region"(柱状图中一般用region)'},pointerAnim:{detail:"tips移动的时候，指针是否开启动画",default:!0}}}}]),c(_,[{key:"show",value:function(t){if(this.enabled){if(t.eventInfo){this.eventInfo=t.eventInfo;var e=t.target.getStage();e?(this.cW=e.context.width,this.cH=e.context.height):"canvax"==t.target.type&&(this.cW=t.target.width,this.cH=t.target.height),this._setContent(t)?(this._setPosition(t),this.sprite.toFront()):this.hide(t)}this._tipsPointerShow(t)}}},{key:"move",value:function(t){this.enabled&&(t.eventInfo&&(this.eventInfo=t.eventInfo,this._setContent(t)?this._setPosition(t):this._hideDialogTips()),this._tipsPointerMove(t))}},{key:"hide",value:function(t){this.enabled&&(this._hideDialogTips(t),this._tipsPointerHide(t))}},{key:"_hideDialogTips",value:function(){this.eventInfo&&(this.eventInfo=null,this.sprite.removeAllChildren(),this._removeContent())}},{key:"_setPosition",value:function(t){if(this.enabled&&this._tipDom){var e=t.pos||t.target.localToGlobal(t.point),n=this._checkX(e.x+this.offsetX),i=this._checkY(e.y+this.offsetY);this._tipDom.style.cssText+=";visibility:visible;left:"+n+"px;top:"+i+"px;-webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none;","left"==this.positionOfPoint&&(this._tipDom.style.left=this._checkX(e.x-this.offsetX-this._tipDom.offsetWidth)+"px")}}},{key:"_creatTipDom",value:function(){this._tipDom=document.createElement("div"),this._tipDom.className="chart-tips",this._tipDom.style.cssText+="; border-radius:"+this.borderRadius+"px;background:"+this.fillStyle+";border:1px solid "+this.strokeStyle+";visibility:hidden;position:absolute;enabled:inline-block;*enabled:inline;*zoom:1;padding:6px;color:"+this.fontColor+";line-height:1.5",this._tipDom.style.cssText+="; box-shadow:1px 1px 3px "+this.strokeStyle+";",this._tipDom.style.cssText+="; border:none;white-space:nowrap;word-wrap:normal;",this._tipDom.style.cssText+="; text-align:left;",this.tipDomContainer.appendChild(this._tipDom)}},{key:"_removeContent",value:function(){this._tipDom&&(this.tipDomContainer.removeChild(this._tipDom),this._tipDom=null)}},{key:"_setContent",value:function(t){var e=this._getContent(t);if(e||0===e)return this._tipDom||this._creatTipDom(t),this._tipDom.innerHTML=e,this.dW=this._tipDom.offsetWidth,this.dH=this._tipDom.offsetHeight,e}},{key:"_getContent",value:function(t){return this.content?r._.isFunction(this.content)?this.content(t.eventInfo,t):this.content:this._getDefaultContent(t.eventInfo)}},{key:"_getDefaultContent",value:function(t){var o="";return t.nodes.length&&(void 0!==t.title&&null!==t.title&&""!==t.title&&(o+="<div style='font-size:14px;border-bottom:1px solid #f0f0f0;padding:4px;margin-bottom:6px;'>"+t.title+"</div>"),r._.each(t.nodes,function(t,e){var n=t.color||t.fillStyle||t.strokeStyle,i=t.name||t.field||t.content,r="object"==s(t.value)?JSON.stringify(t.value):(0,l.numAddSymbol)(t.value),a=t.value||0==t.value;o+="<div style='line-height:1.5;font-size:12px;padding:0 4px;'>",n&&(o+="<span style='background:"+n+";margin-right:8px;margin-top:7px;float:left;width:8px;height:8px;border-radius:4px;overflow:hidden;font-size:0;'></span>"),i&&(o+="<span style='margin-right:5px;'>"+i,a&&(o+="："),o+="</span>"),a&&(o+=r),o+="</div>"})),o}},{key:"_checkX",value:function(t){if(this.positionInRange){var e=this.dW+2;t<0&&(t=0),t+e>this.cW&&(t=this.cW-e)}return t}},{key:"_checkY",value:function(t){if(this.positionInRange){var e=this.dH+2;t<0&&(t=0),t+e>this.cH&&(t=this.cH-e)}return t}},{key:"_tipsPointerShow",value:function(t){if(t.eventInfo&&t.eventInfo.xAxis){var e=this.app.getComponent({name:"coord"});if(e&&"rect"==e.type&&this.pointer){var n=this._tipsPointer,i=e.origin.y-e.height,r=0;if("line"==this.pointer&&(r=e.origin.x+t.eventInfo.xAxis.x),"region"==this.pointer){var a=e._xAxis.getCellLengthOfPos(t.eventInfo.xAxis.x);r=e.origin.x+t.eventInfo.xAxis.x-a/2,t.eventInfo.xAxis.ind<0&&(r=e.origin.x)}n?this.pointerAnim&&"proportion"!=e._xAxis.layoutType?(n.__animation&&n.__animation.stop(),n.__animation=n.animate({x:r,y:i},{duration:200})):(n.context.x=r,n.context.y=i):("line"==this.pointer&&(n=new y({context:{x:r,y:i,start:{x:0,y:0},end:{x:0,y:e.height},lineWidth:1,strokeStyle:"#cccccc"}})),"region"==this.pointer&&(a=e._xAxis.getCellLengthOfPos(r),n=new p({context:{width:a,height:e.height,x:r,y:i,fillStyle:"#cccccc",globalAlpha:.3}})),this.app.graphsSprite.addChild(n,0),this._tipsPointer=n)}}}},{key:"_tipsPointerHide",value:function(t){if(t.eventInfo&&t.eventInfo.xAxis){var e=this.app.getComponent({name:"coord"});e&&"rect"==e.type&&this.pointer&&this._tipsPointer&&(this._tipsPointer.destroy(),this._tipsPointer=null)}}},{key:"_tipsPointerMove",value:function(t){if(t.eventInfo&&t.eventInfo.xAxis){var e=this.app.getComponent({name:"coord"});if(e&&"rect"==e.type&&this.pointer&&this._tipsPointer){var n=this._tipsPointer,i=e.origin.x+t.eventInfo.xAxis.x;if("region"==this.pointer){var r=e._xAxis.getCellLengthOfPos(t.eventInfo.xAxis.x);i=e.origin.x+t.eventInfo.xAxis.x-r/2,t.eventInfo.xAxis.ind<0&&(i=e.origin.x)}var a=e.origin.y-e.height;i!=n.__targetX&&(this.pointerAnim&&"proportion"!=e._xAxis.layoutType?(n.__animation&&n.__animation.stop(),n.__targetX=i,n.__animation=n.animate({x:i,y:a},{duration:200,onComplete:function(){delete n.__targetX,delete n.__animation}})):(n.context.x=i,n.context.y=a))}}}}]),_);function _(t,e){var n;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,_),(n=function(t,e){return!e||"object"!==s(e)&&"function"!=typeof e?d(t):e}(this,u(_).call(this,t,e))).name="tips",n.tipDomContainer=n.app.canvax.domView,n.cW=0,n.cH=0,n.dW=0,n.dH=0,n._tipDom=null,n._tipsPointer=null,n.eventInfo=null,n.sprite=null,n.sprite=new a.default.Display.Sprite({id:"TipSprite"}),n.app.stage.addChild(n.sprite);var i=d(n);return n.sprite.on("destroy",function(){i._tipDom=null}),r._.extend(!0,d(n),(0,r.getDefaultProps)(_.defaultProps()),t),n}r.global.registerComponent(g,"tips"),t.default=g}(e,a,n,l,i)})),t(e(function(t,e){!function(t,e,n,r){Object.defineProperty(t,"__esModule",{value:!0});var i=o(e),a=o(n);function o(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=a.default.Shapes.Line,p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(y,i.default),f(y,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},barField:{detail:"这个bartgi组件对应的bar Graph 的field",default:null},yAxisAlign:{detail:"这个bartgi组件回到到哪个y轴",default:"left"},standardVal:{detail:"tgi标准线",default:100},line:{detail:"bar对应的tgi线配置",propertys:{lineWidth:{detail:"线宽",default:3},strokeStyle:{detail:"线颜色",default:function(t){return t>=this.standardVal?"#43cbb5":"#ff6060"}}}}}}}]),f(y,[{key:"reset",value:function(t){r._.extend(!0,this,t),this.barDatas=null,this.data=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var a=this,t=this.app.getComponent({name:"coord"});this.pos={x:t.origin.x,y:t.origin.y},this.setPosition(),r._.each(a.app.getComponents({name:"graphs"}),function(t){if("bar"==t.type&&t.data[a.barField])return a.barDatas=t.data[a.barField],!1}),this.data=r._.flatten(a.app.dataFrame.getDataOrg(a.field)),this.barDatas&&r._.each(this.data,function(t,e){var n=-a._yAxis.getPosOfVal(t),i=a.barDatas[e],r=new h({context:{start:{x:i.x,y:n},end:{x:i.x+i.width,y:n},lineWidth:2,strokeStyle:a._getProp(a.line.strokeStyle,t,e)}});a.sprite.addChild(r)})}},{key:"_getProp",value:function(t,e,n){var i=t;return r._.isFunction(t)&&(i=t.apply(this,[e,n])),i}}]),y);function y(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(n=function(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?u(t):e}(this,s(y).call(this,t,e))).name="barTgi",n.data=null,n.barDatas=null,n._yAxis=null,n.sprite=null,n.pos={x:0,y:0},r._.extend(!0,u(n),(0,r.getDefaultProps)(y.defaultProps()),t),n._yAxis=n.app.getComponent({name:"coord"})._yAxis["left"==n.yAxisAlign?0:1],n.sprite=new a.default.Display.Sprite,n.app.graphsSprite.addChild(n.sprite),n}r.global.registerComponent(p,"barTgi"),t.default=p}(e,a,n,i)})),t(e(function(t,e){!function(t,e,n,s){Object.defineProperty(t,"__esModule",{value:!0});var i=r(e),u=r(n);function r(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(p,i.default),f(p,null,[{key:"defaultProps",value:function(){return{field:{detail:"字段配置",default:null},barField:{detail:"这个guide对应的bar Graph 的field",default:null},yAxisAlign:{detail:"这个guide组件回到到哪个y轴",default:"left"},node:{detail:"单个节点配置",propertys:{shapeType:{detail:"节点绘制的图形类型",default:"circle"},lineWidth:{detail:"图表描边线宽",default:3},radius:{detail:"图形半径",default:6},fillStyle:{detail:"填充色",default:"#19dea1"},strokeStyle:{detail:"描边色",default:"#fff"}}},label:{detail:"文本配置",propertys:{fontSize:{detail:"字体大小",default:12},fontColor:{detail:"字体颜色",default:"#19dea1"},verticalAlign:{detail:"垂直对齐方式",default:"bottom"},textAlign:{detail:"水平对齐方式",default:"center"},strokeStyle:{detail:"文本描边颜色",default:"#fff"},lineWidth:{detail:"文本描边线宽",default:0},format:{detail:"文本格式处理函数",default:null}}}}}}]),f(p,[{key:"reset",value:function(t){s._.extend(!0,this,t),this.barDatas=null,this.data=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var l=this,t=this.app.getComponent({name:"coord"});this.pos={x:t.origin.x,y:t.origin.y},this.setPosition(),s._.each(l.app.getComponents({name:"graphs"}),function(t){if("bar"==t.type&&t.data[l.barField])return l.barDatas=t.data[l.barField],!1}),this.data=s._.flatten(l.app.dataFrame.getDataOrg(l.field)),this.barDatas&&s._.each(this.data,function(t,e){var n=-l._yAxis.getPosOfVal(t),i=l.barDatas[e],r=new u.default.Shapes.Circle({context:{x:i.x+i.width/2,y:n,r:l.node.radius,fillStyle:l.node.fillStyle,strokeStyle:l.node.strokeStyle,lineWidth:l.node.lineWidth}}),a=t;s._.isFunction(l.label.format)&&(a=l.label.format(t,i));var o=new u.default.Display.Text(a,{context:{x:i.x+i.width/2,y:n-l.node.radius-1,fillStyle:l.label.fontColor,lineWidth:l.label.lineWidth,strokeStyle:l.label.strokeStyle,fontSize:l.label.fontSize,textAlign:l.label.textAlign,textBaseline:l.label.verticalAlign}});l.sprite.addChild(r),l.sprite.addChild(o)})}},{key:"_getProp",value:function(t,e,n){var i=t;return s._.isFunction(t)&&(i=t.apply(this,[e,n])),i}}]),p);function p(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p),(n=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?l(t):e}(this,o(p).call(this,t,e))).name="barGuide",n.data=null,n.barDatas=null,n._yAxis=null,n.sprite=null,s._.extend(!0,l(n),(0,s.getDefaultProps)(p.defaultProps()),t),n._yAxis=n.app.getComponent({name:"coord"})._yAxis["left"==n.yAxisAlign?0:1],n.sprite=new u.default.Display.Sprite,n.app.graphsSprite.addChild(n.sprite),n}s.global.registerComponent(h,"barGuide"),t.default=h}(e,a,n,i)})),t(e(function(t,e){!function(t,e,n){var i;function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function o(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}Object.defineProperty(t,"__esModule",{value:!0});var u,d,f=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}(c,((i=e)&&i.__esModule?i:{default:i}).default),u=c,(d=[{key:"set",value:function(t){return this.colors=t,this.colors}},{key:"get",value:function(){var t=this.colors;return n._.isArray(t)||(t=[t]),t}},{key:"mergeTo",value:function(t){t=t||[];for(var e=0,n=this.colors.length;e<n;e++)t[e]?t[e]=this.colors[e]:t.push(this.colors[e]);return t}}])&&a(u.prototype,d),c);function c(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=o(this,l(c).call(this,t,e))).name="theme",n.colors=t||[],n}n.global.registerComponent(f,"theme"),t.default=f}(e,a,i)})),t(e(function(t,e){!function(t,e,i,n){Object.defineProperty(t,"__esModule",{value:!0});var s=r(e);function r(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function d(t,e,n){return e&&u(t.prototype,e),n&&u(t,n),t}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var c=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f(t,e)}(h,r(n).default),d(h,null,[{key:"defaultProps",value:function(){return{text:{detail:"水印内容",default:"chartx"},fontSize:{detail:"字体大小",default:20},fontColor:{detail:"水印颜色",default:"#cccccc"},alpha:{detail:"水印透明度",default:.2},rotation:{detail:"水印旋转角度",default:45}}}}]),d(h,[{key:"draw",value:function(){for(var t=new s.default.Display.Text(this.text,{context:{fontSize:this.fontSize,fillStyle:this.fontColor}}),e=t.getTextWidth(),n=t.getTextHeight(),i=parseInt(this.height/(5*n))+1,r=parseInt(this.width/(1.5*e))+1,a=0;a<i;a++)for(var o=0;o<r;o++){var l=new s.default.Display.Text(this.text,{context:{rotation:this.rotation,fontSize:this.fontSize,fillStyle:this.fontColor,globalAlpha:this.alpha}});l.context.x=1.5*e*o+.25*e,l.context.y=5*n*a,this.spripte.addChild(l)}}}]),h);function h(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),(n=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?l(t):e}(this,o(h).call(this,t,e))).name="waterMark",n.width=n.app.width,n.height=n.app.height,i._.extend(!0,l(n),(0,i.getDefaultProps)(h.defaultProps()),t),n.spripte=new s.default.Display.Sprite({id:"watermark"}),n.app.stage.addChild(n.spripte),n.draw(),n}i.global.registerComponent(c,"waterMark"),t.default=c}(e,n,i,a)})),t(e(function(t,e){!function(t,e,n,i){Object.defineProperty(t,"__esModule",{value:!0});var r=o(e),a=o(n);function o(t){return t&&t.__esModule?t:{default:t}}function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=a.default.Shapes.Line,p=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(y,r.default),f(y,null,[{key:"defaultProps",value:function(){return{aimPoint:{detail:"准心位置",propertys:{x:{detail:"x",default:0},y:{detail:"y",default:0}}},line:{detail:"线配置",propertys:{strokeStyle:{detail:"线颜色",default:"#cccccc"},lineWidth:{detail:"线宽",default:1},lineType:{detail:"线样式类型",default:"solid"}}}}}}]),f(y,[{key:"draw",value:function(){var t=this,e=this.app.getComponent({name:"coord"});this.pos={x:e.origin.x,y:e.origin.y},this.width=e.width,this.height=e.height,this.aimPoint={x:this.width/2,y:this.height/2},this.setPosition(),t._hLine=new h({context:{start:{x:0,y:-this.aimPoint.y},end:{x:t.width,y:-this.aimPoint.y},strokeStyle:t.line.strokeStyle,lineWidth:t.line.lineWidth,lineType:t.line.lineType}}),t.sprite.addChild(t._hLine),t._vLine=new h({context:{start:{x:this.aimPoint.x,y:0},end:{x:this.aimPoint.x,y:-t.height},strokeStyle:t.line.strokeStyle,lineWidth:t.line.lineWidth,lineType:t.line.lineType}}),t.sprite.addChild(t._vLine)}}]),y);function y(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,y),(n=function(t,e){return!e||"object"!==l(e)&&"function"!=typeof e?u(t):e}(this,s(y).call(this,t,e))).name="cross",n.width=t.width||0,n.height=t.height||0,n.x=null,n.y=null,n._hLine=null,n._vLine=null,i._.extend(!0,u(n),(0,i.getDefaultProps)(y.defaultProps()),t),n._yAxis=n.app.getComponent({name:"coord"})._yAxis["left"==n.yAxisAlign?0:1],n.sprite=new a.default.Display.Sprite,n.app.graphsSprite.addChild(n.sprite),n}i.global.registerComponent(p,"cross"),t.default=p}(e,a,n,i)})),t(e(function(t,e){!function(t,e,n,y){Object.defineProperty(t,"__esModule",{value:!0});var i=r(e),g=r(n);function r(t){return t&&t.__esModule?t:{default:t}}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e,n){return e&&s(t.prototype,e),n&&s(t,n),t}function d(t,e){return(d=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var f=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d(t,e)}(c,i.default),u(c,null,[{key:"defaultProps",value:function(){return{lineField:{detail:"对应的line字段",default:null},style:{detail:"默认色",default:"#3995ff"},fillStyle:{detail:"节点填充色",default:"#ffffff"},lineWidth:{detail:"线宽",default:2},radius:{detail:"圆点半径",default:6},timeFontSize:{detail:"时间文本大小",default:14},timeFontColor:{detail:"时间文本颜色",default:"#606060"},listFontSize:{detail:"列表信息文本大小",default:12}}}}]),u(c,[{key:"reset",value:function(t){y._.extend(!0,this,t),this.lineDatas=null,this.sprite.removeAllChildren(),this.draw()}},{key:"draw",value:function(){var t=this,e=this.app.getComponent({name:"coord"});this.pos={x:e.origin.x,y:e.origin.y},this.setPosition();var n=t.app.getComponent({name:"graphs",type:"line",field:t.lineField});t.lineDatas=n.data[t.lineField].data;var i=this.app.getComponent({name:"coord"}).getAxis({type:"xAxis"}).getIndexOfVal(this.time);if(-1!=i){var r=this.lineDatas[i];if(null!=r.y){var a=t._getNodeY(r,e),o=r.x,l=new g.default.Display.Sprite({context:{x:o-20}});this.sprite.addChild(l);var s=0,u=new g.default.Display.Text(t.time,{context:{fillStyle:this.timeFontColor||this.style,fontSize:this.timeFontSize}});l.addChild(u),s=u.getTextHeight();var d=u.getTextWidth(),f=new g.default.Display.Text(y._.flatten([t.list]).join("\n"),{context:{y:s,fillStyle:this.listFontColor||this.style,fontSize:this.listFontSize}});l.addChild(f),s+=f.getTextHeight(),(d=Math.max(d,f.getTextWidth()))+o-20>e.width+t.app.padding.right&&(l.context.x=e.width+t.app.padding.right,u.context.textAlign="right",f.context.textAlign="right");var c=0;"online"==t.status?(c=a-(this.radius+3)-s,Math.abs(c)>e.origin.y&&(c=-e.origin.y,a=-(e.origin.y-(this.radius+3)-s))):0<(c=a+(this.radius+3))+s&&(c=-s,a=-(this.radius+3)-s),l.context.y=c;var h=new g.default.Shapes.BrokenLine({context:{pointList:[[o,a],[o,r.y]],strokeStyle:t.style,lineWidth:t.lineWidth}});t.sprite.addChild(h);var p=new g.default.Shapes.Circle({context:{x:o,y:a,r:t.radius,fillStyle:t.fillStyle,strokeStyle:t.style,lineWidth:t.lineWidth}});t.sprite.addChild(p)}}}},{key:"_getNodeY",value:function(t,e){var n=this.app.height,i=(e.height,t.y);return"online"==this.status?i-=Math.min(50,.3*(n-Math.abs(i))):i+=Math.min(50,.3*Math.abs(i)),i}}]),c);function c(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,c),(n=function(t,e){return!e||"object"!==a(e)&&"function"!=typeof e?l(t):e}(this,o(c).call(this,t,e))).name="lineSchedu",y._.extend(!0,l(n),(0,y.getDefaultProps)(c.defaultProps()),t),n.lineDatas=null,n.sprite=new g.default.Display.Sprite,n.app.graphsSprite.addChild(n.sprite),n}y.global.registerComponent(f,"lineSchedu"),t.default=f}(e,a,n,i)})),t(e(function(t,e){!function(t,e,n,l){Object.defineProperty(t,"__esModule",{value:!0});var i=a(e),r=a(n);function a(t){return t&&t.__esModule?t:{default:t}}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function f(t,e,n){return e&&d(t.prototype,e),n&&d(t,n),t}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var h=r.default.Shapes.Line,p=r.default.Shapes.Circle,y=r.default.Display.Text,g=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(_,i.default),f(_,null,[{key:"defaultProps",value:function(){return{xVal:{detail:"x的value值",default:null},x:{detail:"x的像素值",default:null},markTo:{detail:"标准哪个目标字段",documentation:"如果设置了这个字段，那么line的起点将是这个graphs上的node节点",default:null},line:{detail:"线的配置",propertys:{enabled:{detail:"是否开启",default:!0},lineWidth:{detail:"线宽",default:2},strokeStyle:{detail:"线的颜色",default:"#d5d5d5"},lineType:{detail:"线的样式，虚线(dashed)实线(solid)",default:"solid"},startY:{detail:"startY",default:0},endY:{detail:"startY",default:null}}},node:{detail:"数据图形节点",propertys:{enabled:{detail:"是否开启",default:!0},radius:{detail:"节点半径",default:5},fillStyle:{detail:"节点图形的背景色",default:"#ffffff"},strokeStyle:{detail:"节点图形的描边色，默认和line.strokeStyle保持一致",default:null},lineWidth:{detail:"节点图形边宽大小",default:2}}},label:{detail:"文本",propertys:{enabled:{detail:"是否开启",default:!1},fontColor:{detail:"文本字体颜色",default:null},fontSize:{detail:"文本字体大小",default:12},text:{detail:"文本内容",documentation:"可以是函数",default:null},format:{detail:"文本格式化函数",default:null}}}}}}]),f(_,[{key:"draw",value:function(t){t=t||{},this.width=t.width,this.height=t.height,this.origin=t.origin,this.sprite.context.x=this.origin.x,this.sprite.context.y=this.origin.y,this._widget()}},{key:"reset",value:function(t){t&&l._.extend(!0,this,t),this._widget()}},{key:"_widget",value:function(){var i,r=this,t=this.app.getComponent({name:"coord"})._xAxis;if(null!=this.xVal&&(i=t.getNodeInfoOfVal(this.xVal)),null!=this.x&&(i=t.getNodeInfoOfPos(this.x)),i){r.nodes=[],r.on("complete",function(){r._drawLine(i),r._drawNodes(i),r._drawLabels(i)});var a=0,o=this.app.getGraphs();l._.each(o,function(n){function t(){if(a++,!r.markTo||-1!=l._.flatten([n.field]).indexOf(r.markTo)){var t=n.getNodesOfPos(i.x);if(r.markTo){var e=l._.find(t,function(t){return t.field==r.markTo});e&&(r.nodes=[e])}else r.nodes=r.nodes.concat(t)}a==o.length&&r.fire("complete")}n.inited?t():n.on("complete",function(){t()})})}}},{key:"_drawLine",value:function(t){var e=this;if(e.line.enabled){var n=l._.extend(!0,{x:parseInt(t.x),start:{x:0,y:0},end:{x:0,y:-e.height},lineWidth:1,strokeStyle:"#cccccc"},this.line);if(null!=e.line.endY){var i=0;l._.isNumber(e.line.endY)&&(i=e.line.endY),"auto"==e.line.endY&&l._.each(e.nodes,function(t){i=Math.min(t.y)}),n.end.y=i}this._line?l._.extend(this._line.context,n):(this._line=new h({context:n}),this._lineSp.addChild(this._line),this._line.on(l.event.types.get(),function(t){t.eventInfo={xAxis:{},nodes:e.nodes},null!=e.xVal&&(t.eventInfo.xAxis.value=e.xVal,t.eventInfo.xAxis.text=e.xVal+"",t.eventInfo.title=e.xVal+""),e.app.fire(t.type,t)}))}}},{key:"_drawNodes",value:function(){var i=this;i.node.enabled&&(i._nodes.removeAllChildren(),l._.each(i.nodes,function(e){var t=l._.extend({x:e.x,y:e.y,cursor:"pointer",r:i.node.radius,lineWidth:i.node.lineWidth||e.lineWidth,strokeStyle:i.node.strokeStyle||e.color,fillStyle:i.node.fillStyle||e.fillStyle}),n=new p({context:t});n.nodeData=e,n.on(l.event.types.get(),function(t){t.eventInfo={xAxis:{},nodes:[e]},null!=i.xVal&&(t.eventInfo.xAxis.value=i.xVal,t.eventInfo.xAxis.text=i.xVal+"",t.eventInfo.title=i.xVal+""),i.app.fire(t.type,t)}),i._nodes.addChild(n)}))}},{key:"_drawLabels",value:function(){var r=this;r.node.enabled&&(r._labels.removeAllChildren(),l._.each(r.nodes,function(t){var e={x:t.x,y:t.y-r.node.radius-2,fillStyle:r.label.fontColor||t.color,fontSize:r.label.fontSize,textAlign:"center",textBaseline:"bottom"},n=r.label.text;if(l._.isFunction(n)&&(n=n.apply(r,[t])),n){var i=new y(n,{context:e});r._labels.addChild(i),i.localToGlobal().x+i.getTextWidth()/2>r.app.width&&(i.context.x=r.app.width-i.getTextWidth()/2-i.parent.localToGlobal().x)}}))}}]),_);function _(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,_),(n=function(t,e){return!e||"object"!==o(e)&&"function"!=typeof e?u(t):e}(this,s(_).call(this,t,e))).name="markcloumn",l._.extend(!0,u(n),(0,l.getDefaultProps)(_.defaultProps()),t),n.sprite=new r.default.Display.Sprite,n.app.graphsSprite.addChild(n.sprite),n._line=null,n._lineSp=new r.default.Display.Sprite,n.sprite.addChild(n._lineSp),n.nodes=[],n._nodes=new r.default.Display.Sprite,n.sprite.addChild(n._nodes),n._labels=new r.default.Display.Sprite,n.sprite.addChild(n._labels),n}l.global.registerComponent(g,"markcloumn"),t.default=g}(e,a,n,i)})),t(e(function(t,e){!function(t,e){Object.defineProperty(t,"__esModule",{value:!0});var n=[];n.length&&e.global.setGlobalTheme(n);var i={options:{}};for(var r in e.global)i[r]=e.global[r];t.default=i}(e,i)}))});