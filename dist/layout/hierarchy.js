"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _rebind=_interopRequireDefault(require("./utils/rebind")),_arrays=_interopRequireDefault(require("./utils/arrays")),Hierarchy=function h(){var o=layout_hierarchySort,c=layout_hierarchyChildren,f=layout_hierarchyValue;function v(e){var r,u=[e],a=[];for(e.depth=0;null!=(r=u.pop());)if(a.push(r),(l=c.call(v,r,r.depth))&&(t=l.length)){for(var t,l,i;0<=--t;)u.push(i=l[t]),i.parent=r,i.depth=r.depth+1;if(f){var n=+f.call(v,r,r.depth);n&&!isNaN(n)&&(r._value=n)}f&&(r.value=0),r.children=l}else f&&(r.value=+f.call(v,r,r.depth)||0),delete r.children;return h.layout_hierarchyVisitAfter(e,function(e){var r,u;o&&(r=e.children)&&r.sort(o),f&&(u=e.parent)&&(u.value+=e.value),e._value&&e._value>e.value&&(e.value=e._value),delete e._value}),a}return v.sort=function(e){return arguments.length?(o=e,v):o},v.children=function(e){return arguments.length?(c=e,v):c},v.value=function(e){return arguments.length?(f=e,v):f},v.revalue=function(e){return f&&(h.layout_hierarchyVisitBefore(e,function(e){e.children&&(e.value=0)}),h.layout_hierarchyVisitAfter(e,function(e){var r;e.children||(e.value=+f.call(v,e,e.depth)||0),(r=e.parent)&&(r.value+=e.value),e._value&&e._value>e.value&&(e.value=e._value),delete e._value})),e},v};function layout_hierarchyChildren(e){return e.children}function layout_hierarchyValue(e){return e.value}function layout_hierarchySort(e,r){return r.value-e.value}function layout_hierarchyLinks(e){return _arrays.default.merge(e.map(function(r){return(r.children||[]).map(function(e){return{source:r,target:e}})}))}Hierarchy.layout_hierarchyRebind=function(e,r){return(0,_rebind.default)(e,r,"sort","children","value"),(e.nodes=e).links=layout_hierarchyLinks,e},Hierarchy.layout_hierarchyVisitBefore=function(e,r){for(var u=[e];null!=(e=u.pop());)if(r(e),(t=e.children)&&(a=t.length))for(var a,t;0<=--a;)u.push(t[a])},Hierarchy.layout_hierarchyVisitAfter=function(e,r){for(var u=[e],a=[];null!=(e=u.pop());)if(a.push(e),(l=e.children)&&(t=l.length))for(var t,l,i=-1;++i<t;)u.push(l[i]);for(;null!=(e=a.pop());)r(e)};var _default=Hierarchy;exports.default=_default;